VERSION 5.00
Object = "{E2D000D0-2DA1-11D2-B358-00104B59D73D}#1.0#0"; "titext6.ocx"
Object = "{49CBFCC0-1337-11D2-9BBF-00A024695830}#1.0#0"; "tinumb6.ocx"
Object = "{A49CE0E0-C0F9-11D2-B0EA-00A024695830}#1.0#0"; "tidate6.ocx"
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.1#0"; "MSCOMCTL.OCX"
Object = "{DEF7CADD-83C0-11D0-A0F1-00A024703500}#7.0#0"; "todg7.ocx"
Object = "{BDC217C8-ED16-11CD-956C-0000C04E4C0A}#1.1#0"; "TABCTL32.OCX"
Object = "{DEF7CB36-83C0-11D0-A0F1-00A024703500}#7.0#0"; "todl7.ocx"
Object = "{67397AA1-7FB1-11D0-B148-00A0C922E820}#6.0#0"; "MSADODC.OCX"
Object = "{0D452EE1-E08F-101A-852E-02608C4D0BB4}#2.0#0"; "FM20.DLL"
Object = "{280CBA51-58D5-46E7-950F-21C424D176BF}#1.0#0"; "RmFrame.ocx"
Begin VB.Form frmManAsientosContables 
   Caption         =   "Registro de Asientos Contables"
   ClientHeight    =   6645
   ClientLeft      =   1725
   ClientTop       =   3510
   ClientWidth     =   12375
   BeginProperty Font 
      Name            =   "Arial"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmManAsientosContables.frx":0000
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MDIChild        =   -1  'True
   ScaleHeight     =   6645
   ScaleWidth      =   12375
   Begin VB.Frame Frame3 
      BackColor       =   &H00800000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1785
      Left            =   5880
      TabIndex        =   61
      Top             =   2310
      Visible         =   0   'False
      Width           =   5280
      Begin pRmFrame.RmFrame rmBarra 
         Height          =   330
         Left            =   45
         TabIndex        =   122
         Top             =   45
         Width           =   5190
         _ExtentX        =   9155
         _ExtentY        =   582
         BorderStyle     =   6
         BorderType      =   16384
         Caption         =   "   Cambio de Libro"
         CaptionAlign    =   36
         BackColor       =   11035138
         ForeColor       =   16777215
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         GradientColor1  =   11035138
         GradientColor2  =   16306595
         BackgroundType  =   1
         Begin VB.Image ImgCerrar 
            Height          =   210
            Left            =   4905
            Picture         =   "frmManAsientosContables.frx":0ECA
            Stretch         =   -1  'True
            Top             =   45
            Width           =   240
         End
      End
      Begin VB.Frame Frame1 
         BorderStyle     =   0  'None
         Height          =   1680
         Left            =   50
         TabIndex        =   113
         Top             =   45
         Width           =   5190
         Begin VB.TextBox Text3 
            Height          =   315
            Left            =   3885
            MaxLength       =   10
            TabIndex        =   116
            Top             =   840
            Width           =   1005
         End
         Begin VB.TextBox Text2 
            BackColor       =   &H00EFD8C2&
            Height          =   315
            Left            =   3885
            Locked          =   -1  'True
            MaxLength       =   10
            TabIndex        =   115
            Top             =   495
            Width           =   1005
         End
         Begin VB.TextBox Text1 
            BackColor       =   &H00EFD8C2&
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   6.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Left            =   1440
            Locked          =   -1  'True
            TabIndex        =   114
            Top             =   495
            Width           =   2415
         End
         Begin TrueOleDBList70.TDBCombo tdbcLibro_cambio 
            Height          =   300
            Left            =   1440
            TabIndex        =   117
            Tag             =   "enabled"
            Top             =   840
            Width           =   2415
            _ExtentX        =   4260
            _ExtentY        =   529
            _LayoutType     =   4
            _RowHeight      =   -2147483647
            _WasPersistedAsPixels=   0
            _DropdownWidth  =   0
            Columns(0)._VlistStyle=   0
            Columns(0)._MaxComboItems=   5
            Columns(0).DataField=   ""
            Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(1)._VlistStyle=   0
            Columns(1)._MaxComboItems=   5
            Columns(1).DataField=   ""
            Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(2)._VlistStyle=   0
            Columns(2)._MaxComboItems=   5
            Columns(2).DataField=   ""
            Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(3)._VlistStyle=   0
            Columns(3)._MaxComboItems=   5
            Columns(3).DataField=   ""
            Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(4)._VlistStyle=   0
            Columns(4)._MaxComboItems=   5
            Columns(4).DataField=   ""
            Columns(4)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(5)._VlistStyle=   0
            Columns(5)._MaxComboItems=   5
            Columns(5).DataField=   ""
            Columns(5)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(6)._VlistStyle=   0
            Columns(6)._MaxComboItems=   5
            Columns(6).DataField=   ""
            Columns(6)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(7)._VlistStyle=   0
            Columns(7)._MaxComboItems=   5
            Columns(7).DataField=   ""
            Columns(7)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(8)._VlistStyle=   0
            Columns(8)._MaxComboItems=   5
            Columns(8).DataField=   ""
            Columns(8)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(9)._VlistStyle=   0
            Columns(9)._MaxComboItems=   5
            Columns(9).DataField=   ""
            Columns(9)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns.Count   =   10
            Splits(0)._UserFlags=   0
            Splits(0).ExtendRightColumn=   -1  'True
            Splits(0).AllowRowSizing=   0   'False
            Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
            Splits(0)._ColumnProps(0)=   "Columns.Count=10"
            Splits(0)._ColumnProps(1)=   "Column(0).Width=688"
            Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
            Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=609"
            Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
            Splits(0)._ColumnProps(5)=   "Column(0).Order=1"
            Splits(0)._ColumnProps(6)=   "Column(1).Width=847"
            Splits(0)._ColumnProps(7)=   "Column(1).DividerColor=0"
            Splits(0)._ColumnProps(8)=   "Column(1)._WidthInPix=767"
            Splits(0)._ColumnProps(9)=   "Column(1)._EditAlways=0"
            Splits(0)._ColumnProps(10)=   "Column(1).Order=2"
            Splits(0)._ColumnProps(11)=   "Column(2).Width=1138"
            Splits(0)._ColumnProps(12)=   "Column(2).DividerColor=0"
            Splits(0)._ColumnProps(13)=   "Column(2)._WidthInPix=1058"
            Splits(0)._ColumnProps(14)=   "Column(2)._EditAlways=0"
            Splits(0)._ColumnProps(15)=   "Column(2).Visible=0"
            Splits(0)._ColumnProps(16)=   "Column(2).Order=3"
            Splits(0)._ColumnProps(17)=   "Column(3).Width=2196"
            Splits(0)._ColumnProps(18)=   "Column(3).DividerColor=0"
            Splits(0)._ColumnProps(19)=   "Column(3)._WidthInPix=2117"
            Splits(0)._ColumnProps(20)=   "Column(3)._EditAlways=0"
            Splits(0)._ColumnProps(21)=   "Column(3).Visible=0"
            Splits(0)._ColumnProps(22)=   "Column(3).Order=4"
            Splits(0)._ColumnProps(23)=   "Column(4).Width=2196"
            Splits(0)._ColumnProps(24)=   "Column(4).DividerColor=0"
            Splits(0)._ColumnProps(25)=   "Column(4)._WidthInPix=2117"
            Splits(0)._ColumnProps(26)=   "Column(4)._EditAlways=0"
            Splits(0)._ColumnProps(27)=   "Column(4).Visible=0"
            Splits(0)._ColumnProps(28)=   "Column(4).Order=5"
            Splits(0)._ColumnProps(29)=   "Column(5).Width=2196"
            Splits(0)._ColumnProps(30)=   "Column(5).DividerColor=0"
            Splits(0)._ColumnProps(31)=   "Column(5)._WidthInPix=2117"
            Splits(0)._ColumnProps(32)=   "Column(5)._EditAlways=0"
            Splits(0)._ColumnProps(33)=   "Column(5).Visible=0"
            Splits(0)._ColumnProps(34)=   "Column(5).Order=6"
            Splits(0)._ColumnProps(35)=   "Column(6).Width=2196"
            Splits(0)._ColumnProps(36)=   "Column(6).DividerColor=0"
            Splits(0)._ColumnProps(37)=   "Column(6)._WidthInPix=2117"
            Splits(0)._ColumnProps(38)=   "Column(6)._EditAlways=0"
            Splits(0)._ColumnProps(39)=   "Column(6).Visible=0"
            Splits(0)._ColumnProps(40)=   "Column(6).Order=7"
            Splits(0)._ColumnProps(41)=   "Column(7).Width=2196"
            Splits(0)._ColumnProps(42)=   "Column(7).DividerColor=0"
            Splits(0)._ColumnProps(43)=   "Column(7)._WidthInPix=2117"
            Splits(0)._ColumnProps(44)=   "Column(7)._EditAlways=0"
            Splits(0)._ColumnProps(45)=   "Column(7).Visible=0"
            Splits(0)._ColumnProps(46)=   "Column(7).Order=8"
            Splits(0)._ColumnProps(47)=   "Column(8).Width=2196"
            Splits(0)._ColumnProps(48)=   "Column(8).DividerColor=0"
            Splits(0)._ColumnProps(49)=   "Column(8)._WidthInPix=2117"
            Splits(0)._ColumnProps(50)=   "Column(8)._EditAlways=0"
            Splits(0)._ColumnProps(51)=   "Column(8).Visible=0"
            Splits(0)._ColumnProps(52)=   "Column(8).Order=9"
            Splits(0)._ColumnProps(53)=   "Column(9).Width=2196"
            Splits(0)._ColumnProps(54)=   "Column(9).DividerColor=0"
            Splits(0)._ColumnProps(55)=   "Column(9)._WidthInPix=2117"
            Splits(0)._ColumnProps(56)=   "Column(9)._EditAlways=0"
            Splits(0)._ColumnProps(57)=   "Column(9).Visible=0"
            Splits(0)._ColumnProps(58)=   "Column(9).Order=10"
            Splits.Count    =   1
            Appearance      =   1
            BorderStyle     =   1
            ComboStyle      =   2
            AutoCompletion  =   0   'False
            LimitToList     =   0   'False
            ColumnHeaders   =   0   'False
            ColumnFooters   =   0   'False
            DataMode        =   5
            DefColWidth     =   0
            Enabled         =   -1  'True
            HeadLines       =   1
            FootLines       =   1
            RowDividerStyle =   0
            Caption         =   ""
            EditFont        =   "Size=6.75,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
            LayoutName      =   ""
            LayoutFileName  =   ""
            MultipleLines   =   0
            EmptyRows       =   -1  'True
            CellTips        =   0
            EditHeight      =   299.906
            AutoSize        =   -1  'True
            GapHeight       =   30.047
            ListField       =   ""
            BoundColumn     =   ""
            IntegralHeight  =   0   'False
            CellTipsWidth   =   0
            CellTipsDelay   =   1000
            AutoDropdown    =   -1  'True
            RowTracking     =   -1  'True
            RightToLeft     =   0   'False
            RowMember       =   ""
            MouseIcon       =   0
            MouseIcon.vt    =   3
            MousePointer    =   0
            MatchEntryTimeout=   2000
            OLEDragMode     =   0
            OLEDropMode     =   0
            AnimateWindow   =   0
            AnimateWindowDirection=   0
            AnimateWindowTime=   200
            AnimateWindowClose=   0
            DropdownPosition=   0
            Locked          =   0   'False
            ScrollTrack     =   0   'False
            RowDividerColor =   12632256
            RowSubDividerColor=   12632256
            AddItemSeparator=   ";"
            _PropDict       =   $"frmManAsientosContables.frx":11F1
            _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
            _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
            _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
            _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=825,.italic=0"
            _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
            _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bold=0,.fontsize=675,.italic=0"
            _StyleDefs(7)   =   ":id=1,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(8)   =   ":id=1,.fontname=Arial"
            _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
            _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34"
            _StyleDefs(11)  =   "FooterStyle:id=3,.parent=1,.namedParent=35"
            _StyleDefs(12)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(13)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
            _StyleDefs(14)  =   "EditorStyle:id=7,.parent=1"
            _StyleDefs(15)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
            _StyleDefs(16)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
            _StyleDefs(17)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
            _StyleDefs(18)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
            _StyleDefs(19)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
            _StyleDefs(20)  =   "Splits(0).Style:id=13,.parent=1"
            _StyleDefs(21)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
            _StyleDefs(22)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
            _StyleDefs(23)  =   "Splits(0).FooterStyle:id=15,.parent=3"
            _StyleDefs(24)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
            _StyleDefs(25)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
            _StyleDefs(26)  =   "Splits(0).EditorStyle:id=17,.parent=7"
            _StyleDefs(27)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
            _StyleDefs(28)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
            _StyleDefs(29)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
            _StyleDefs(30)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
            _StyleDefs(31)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
            _StyleDefs(32)  =   "Splits(0).Columns(0).Style:id=46,.parent=13"
            _StyleDefs(33)  =   "Splits(0).Columns(0).HeadingStyle:id=43,.parent=14"
            _StyleDefs(34)  =   "Splits(0).Columns(0).FooterStyle:id=44,.parent=15"
            _StyleDefs(35)  =   "Splits(0).Columns(0).EditorStyle:id=45,.parent=17"
            _StyleDefs(36)  =   "Splits(0).Columns(1).Style:id=28,.parent=13"
            _StyleDefs(37)  =   "Splits(0).Columns(1).HeadingStyle:id=25,.parent=14"
            _StyleDefs(38)  =   "Splits(0).Columns(1).FooterStyle:id=26,.parent=15"
            _StyleDefs(39)  =   "Splits(0).Columns(1).EditorStyle:id=27,.parent=17"
            _StyleDefs(40)  =   "Splits(0).Columns(2).Style:id=32,.parent=13"
            _StyleDefs(41)  =   "Splits(0).Columns(2).HeadingStyle:id=29,.parent=14"
            _StyleDefs(42)  =   "Splits(0).Columns(2).FooterStyle:id=30,.parent=15"
            _StyleDefs(43)  =   "Splits(0).Columns(2).EditorStyle:id=31,.parent=17"
            _StyleDefs(44)  =   "Splits(0).Columns(3).Style:id=50,.parent=13"
            _StyleDefs(45)  =   "Splits(0).Columns(3).HeadingStyle:id=47,.parent=14"
            _StyleDefs(46)  =   "Splits(0).Columns(3).FooterStyle:id=48,.parent=15"
            _StyleDefs(47)  =   "Splits(0).Columns(3).EditorStyle:id=49,.parent=17"
            _StyleDefs(48)  =   "Splits(0).Columns(4).Style:id=54,.parent=13"
            _StyleDefs(49)  =   "Splits(0).Columns(4).HeadingStyle:id=51,.parent=14"
            _StyleDefs(50)  =   "Splits(0).Columns(4).FooterStyle:id=52,.parent=15"
            _StyleDefs(51)  =   "Splits(0).Columns(4).EditorStyle:id=53,.parent=17"
            _StyleDefs(52)  =   "Splits(0).Columns(5).Style:id=58,.parent=13"
            _StyleDefs(53)  =   "Splits(0).Columns(5).HeadingStyle:id=55,.parent=14"
            _StyleDefs(54)  =   "Splits(0).Columns(5).FooterStyle:id=56,.parent=15"
            _StyleDefs(55)  =   "Splits(0).Columns(5).EditorStyle:id=57,.parent=17"
            _StyleDefs(56)  =   "Splits(0).Columns(6).Style:id=62,.parent=13"
            _StyleDefs(57)  =   "Splits(0).Columns(6).HeadingStyle:id=59,.parent=14"
            _StyleDefs(58)  =   "Splits(0).Columns(6).FooterStyle:id=60,.parent=15"
            _StyleDefs(59)  =   "Splits(0).Columns(6).EditorStyle:id=61,.parent=17"
            _StyleDefs(60)  =   "Splits(0).Columns(7).Style:id=66,.parent=13"
            _StyleDefs(61)  =   "Splits(0).Columns(7).HeadingStyle:id=63,.parent=14"
            _StyleDefs(62)  =   "Splits(0).Columns(7).FooterStyle:id=64,.parent=15"
            _StyleDefs(63)  =   "Splits(0).Columns(7).EditorStyle:id=65,.parent=17"
            _StyleDefs(64)  =   "Splits(0).Columns(8).Style:id=70,.parent=13"
            _StyleDefs(65)  =   "Splits(0).Columns(8).HeadingStyle:id=67,.parent=14"
            _StyleDefs(66)  =   "Splits(0).Columns(8).FooterStyle:id=68,.parent=15"
            _StyleDefs(67)  =   "Splits(0).Columns(8).EditorStyle:id=69,.parent=17"
            _StyleDefs(68)  =   "Splits(0).Columns(9).Style:id=74,.parent=13"
            _StyleDefs(69)  =   "Splits(0).Columns(9).HeadingStyle:id=71,.parent=14"
            _StyleDefs(70)  =   "Splits(0).Columns(9).FooterStyle:id=72,.parent=15"
            _StyleDefs(71)  =   "Splits(0).Columns(9).EditorStyle:id=73,.parent=17"
            _StyleDefs(72)  =   "Named:id=33:Normal"
            _StyleDefs(73)  =   ":id=33,.parent=0"
            _StyleDefs(74)  =   "Named:id=34:Heading"
            _StyleDefs(75)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(76)  =   ":id=34,.wraptext=-1"
            _StyleDefs(77)  =   "Named:id=35:Footing"
            _StyleDefs(78)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(79)  =   "Named:id=36:Selected"
            _StyleDefs(80)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(81)  =   "Named:id=37:Caption"
            _StyleDefs(82)  =   ":id=37,.parent=34,.alignment=2"
            _StyleDefs(83)  =   "Named:id=38:HighlightRow"
            _StyleDefs(84)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(85)  =   "Named:id=39:EvenRow"
            _StyleDefs(86)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
            _StyleDefs(87)  =   "Named:id=40:OddRow"
            _StyleDefs(88)  =   ":id=40,.parent=33"
            _StyleDefs(89)  =   "Named:id=41:RecordSelector"
            _StyleDefs(90)  =   ":id=41,.parent=34"
            _StyleDefs(91)  =   "Named:id=42:FilterBar"
            _StyleDefs(92)  =   ":id=42,.parent=33"
         End
         Begin VB.Label Label23 
            AutoSize        =   -1  'True
            BackColor       =   &H00FFFFFF&
            BackStyle       =   0  'Transparent
            Caption         =   "Libro Anterior"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Index           =   0
            Left            =   225
            TabIndex        =   121
            Top             =   540
            Width           =   1170
         End
         Begin VB.Label Label24 
            AutoSize        =   -1  'True
            BackColor       =   &H00FFFFFF&
            BackStyle       =   0  'Transparent
            Caption         =   "Nuevo Libro"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Index           =   0
            Left            =   225
            TabIndex        =   120
            Top             =   855
            Width           =   990
         End
         Begin MSForms.CommandButton Command4 
            Height          =   390
            Left            =   2790
            TabIndex        =   119
            Top             =   1230
            Width           =   1305
            Caption         =   " Cancelar"
            PicturePosition =   327683
            Size            =   "2302;688"
            FontHeight      =   165
            FontCharSet     =   0
            FontPitchAndFamily=   2
            ParagraphAlign  =   3
         End
         Begin MSForms.CommandButton Command3 
            Height          =   390
            Left            =   1440
            TabIndex        =   118
            Top             =   1230
            Width           =   1305
            Caption         =   " Aceptar"
            PicturePosition =   327683
            Size            =   "2302;688"
            FontHeight      =   165
            FontCharSet     =   0
            FontPitchAndFamily=   2
            ParagraphAlign  =   3
         End
      End
   End
   Begin MSComctlLib.ImageList ImageList1 
      Left            =   6435
      Top             =   0
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   80
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   11
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":1278
            Key             =   "IMG1"
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":1652
            Key             =   "IMG2"
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":1A2C
            Key             =   "IMG3"
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":1E06
            Key             =   "IMG4"
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":21E0
            Key             =   "IMG5"
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":25BA
            Key             =   "IMG6"
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":2994
            Key             =   "IMG7"
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":2D6E
            Key             =   "IMG8"
         EndProperty
         BeginProperty ListImage9 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":3D88
            Key             =   "IMG9"
         EndProperty
         BeginProperty ListImage10 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":4CDA
            Key             =   "IMG10"
         EndProperty
         BeginProperty ListImage11 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":5C2C
            Key             =   "IMG11"
         EndProperty
      EndProperty
   End
   Begin VB.ListBox lstProvDeleted 
      Height          =   480
      Left            =   10665
      TabIndex        =   50
      Top             =   6825
      Visible         =   0   'False
      Width           =   1455
   End
   Begin MSComctlLib.ImageList imglstdisabled 
      Left            =   4140
      Top             =   45
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   8
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":6C46
            Key             =   ""
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":6DA0
            Key             =   ""
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":6EFA
            Key             =   ""
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":7054
            Key             =   ""
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":71AE
            Key             =   ""
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":7308
            Key             =   ""
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":7462
            Key             =   ""
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":75BC
            Key             =   ""
         EndProperty
      EndProperty
   End
   Begin MSComctlLib.ImageList imglstTool 
      Left            =   4770
      Top             =   0
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   8
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":7716
            Key             =   ""
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":7CB0
            Key             =   ""
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":824A
            Key             =   ""
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":87E4
            Key             =   ""
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":8D7E
            Key             =   ""
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":9318
            Key             =   ""
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":98B2
            Key             =   ""
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmManAsientosContables.frx":9E4C
            Key             =   ""
         EndProperty
      EndProperty
   End
   Begin MSComctlLib.Toolbar tbrOpciones 
      Height          =   330
      Left            =   -15
      TabIndex        =   144
      Top             =   0
      Width           =   3585
      _ExtentX        =   6324
      _ExtentY        =   582
      ButtonWidth     =   609
      ButtonHeight    =   582
      Style           =   1
      ImageList       =   "imglstTool"
      DisabledImageList=   "imglstdisabled"
      HotImageList    =   "imglstTool"
      _Version        =   393216
      BeginProperty Buttons {66833FE8-8583-11D1-B16A-00C0F0283628} 
         NumButtons      =   7
         BeginProperty Button1 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Object.ToolTipText     =   "Nuevo F2"
            ImageIndex      =   1
         EndProperty
         BeginProperty Button2 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Object.ToolTipText     =   "Ver Datos F3"
            ImageIndex      =   2
         EndProperty
         BeginProperty Button3 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Enabled         =   0   'False
            Object.ToolTipText     =   "Grabar F4"
            ImageIndex      =   3
         EndProperty
         BeginProperty Button4 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Object.ToolTipText     =   "Eliminar F5"
            ImageIndex      =   5
         EndProperty
         BeginProperty Button5 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Object.ToolTipText     =   "Editar F6"
            ImageIndex      =   4
         EndProperty
         BeginProperty Button6 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Object.ToolTipText     =   "Imprimir F7"
            ImageIndex      =   6
         EndProperty
         BeginProperty Button7 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Object.ToolTipText     =   "Cancelar o Salir ESC"
            ImageIndex      =   7
         EndProperty
      EndProperty
   End
   Begin VB.Timer TimerKey 
      Enabled         =   0   'False
      Interval        =   50
      Left            =   2385
      Top             =   3600
   End
   Begin TabDlg.SSTab sstAsientos 
      Height          =   6150
      Left            =   0
      TabIndex        =   22
      Top             =   360
      Width           =   12240
      _ExtentX        =   21590
      _ExtentY        =   10848
      _Version        =   393216
      Tabs            =   2
      Tab             =   1
      TabsPerRow      =   2
      TabHeight       =   520
      BackColor       =   16777215
      ForeColor       =   8388608
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Verdana"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      TabCaption(0)   =   "Consulta de Asientos"
      TabPicture(0)   =   "frmManAsientosContables.frx":A3E6
      Tab(0).ControlEnabled=   0   'False
      Tab(0).Control(0)=   "fraLista"
      Tab(0).Control(0).Enabled=   0   'False
      Tab(0).ControlCount=   1
      TabCaption(1)   =   "Registro de Asientos Contables"
      TabPicture(1)   =   "frmManAsientosContables.frx":A402
      Tab(1).ControlEnabled=   -1  'True
      Tab(1).Control(0)=   "tdbdMoneDet"
      Tab(1).Control(0).Enabled=   0   'False
      Tab(1).Control(1)=   "tdbdOperaTC"
      Tab(1).Control(1).Enabled=   0   'False
      Tab(1).Control(2)=   "tdbgDetalle"
      Tab(1).Control(2).Enabled=   0   'False
      Tab(1).Control(3)=   "fraCabecera"
      Tab(1).Control(3).Enabled=   0   'False
      Tab(1).Control(4)=   "tdbtCambio"
      Tab(1).Control(4).Enabled=   0   'False
      Tab(1).Control(5)=   "fra03"
      Tab(1).Control(5).Enabled=   0   'False
      Tab(1).Control(6)=   "fra02"
      Tab(1).Control(6).Enabled=   0   'False
      Tab(1).Control(7)=   "fra01"
      Tab(1).Control(7).Enabled=   0   'False
      Tab(1).Control(8)=   "tdbtMonto"
      Tab(1).Control(8).Enabled=   0   'False
      Tab(1).Control(9)=   "tdbtMonto2"
      Tab(1).Control(9).Enabled=   0   'False
      Tab(1).Control(10)=   "tdbtMonto3"
      Tab(1).Control(10).Enabled=   0   'False
      Tab(1).Control(11)=   "tdbtMonto4"
      Tab(1).Control(11).Enabled=   0   'False
      Tab(1).Control(12)=   "dtpFechaDoc"
      Tab(1).Control(12).Enabled=   0   'False
      Tab(1).Control(13)=   "fraBusqueda"
      Tab(1).Control(13).Enabled=   0   'False
      Tab(1).ControlCount=   14
      Begin VB.Frame fraBusqueda 
         BackColor       =   &H00800000&
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1785
         Left            =   540
         TabIndex        =   130
         Top             =   1950
         Visible         =   0   'False
         Width           =   5280
         Begin pRmFrame.RmFrame rmBarra2 
            Height          =   330
            Left            =   30
            TabIndex        =   131
            Top             =   45
            Width           =   5190
            _ExtentX        =   9155
            _ExtentY        =   582
            BorderStyle     =   6
            BorderType      =   16384
            Caption         =   "   Buscar "
            CaptionAlign    =   36
            BackColor       =   11035138
            ForeColor       =   16777215
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Tahoma"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            GradientColor1  =   11035138
            GradientColor2  =   16306595
            BackgroundType  =   1
            Begin VB.Image ImgCerrarBusqueda 
               Height          =   210
               Left            =   4905
               Picture         =   "frmManAsientosContables.frx":A41E
               Stretch         =   -1  'True
               Top             =   45
               Width           =   240
            End
         End
         Begin VB.Frame fraFondoBusqueda 
            BorderStyle     =   0  'None
            Height          =   1680
            Left            =   45
            TabIndex        =   132
            Top             =   45
            Width           =   5190
            Begin TDBText6Ctl.TDBText tdbtBusCodEnt 
               Height          =   285
               Left            =   3600
               TabIndex        =   138
               ToolTipText     =   " Codigo de Entidad "
               Top             =   495
               Width           =   1365
               _Version        =   65536
               _ExtentX        =   2408
               _ExtentY        =   503
               Caption         =   "frmManAsientosContables.frx":A745
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               DropDown        =   "frmManAsientosContables.frx":A7A9
               Key             =   "frmManAsientosContables.frx":A7C7
               BackColor       =   -2147483643
               EditMode        =   0
               ForeColor       =   -2147483640
               ReadOnly        =   0
               ShowContextMenu =   -1
               MarginLeft      =   1
               MarginRight     =   1
               MarginTop       =   1
               MarginBottom    =   1
               Enabled         =   -1
               MousePointer    =   0
               Appearance      =   1
               BorderStyle     =   1
               AlignHorizontal =   0
               AlignVertical   =   0
               MultiLine       =   0
               ScrollBars      =   0
               PasswordChar    =   ""
               AllowSpace      =   -1
               Format          =   ""
               FormatMode      =   1
               AutoConvert     =   -1
               ErrorBeep       =   0
               MaxLength       =   0
               LengthAsByte    =   0
               Text            =   ""
               Furigana        =   0
               HighlightText   =   0
               IMEMode         =   0
               IMEStatus       =   0
               DropWndWidth    =   0
               DropWndHeight   =   0
               ScrollBarMode   =   0
               MoveOnLRKey     =   0
               OLEDragMode     =   0
               OLEDropMode     =   0
            End
            Begin TDBText6Ctl.TDBText tdbtBusSerieDoc 
               Height          =   285
               Left            =   3330
               TabIndex        =   140
               Tag             =   "enabled"
               ToolTipText     =   " Serie del documento "
               Top             =   855
               Width           =   555
               _Version        =   65536
               _ExtentX        =   979
               _ExtentY        =   503
               Caption         =   "frmManAsientosContables.frx":A809
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               DropDown        =   "frmManAsientosContables.frx":A875
               Key             =   "frmManAsientosContables.frx":A893
               BackColor       =   -2147483643
               EditMode        =   0
               ForeColor       =   -2147483640
               ReadOnly        =   0
               ShowContextMenu =   1
               MarginLeft      =   1
               MarginRight     =   1
               MarginTop       =   1
               MarginBottom    =   1
               Enabled         =   -1
               MousePointer    =   0
               Appearance      =   1
               BorderStyle     =   1
               AlignHorizontal =   0
               AlignVertical   =   0
               MultiLine       =   0
               ScrollBars      =   0
               PasswordChar    =   ""
               AllowSpace      =   -1
               Format          =   ""
               FormatMode      =   1
               AutoConvert     =   -1
               ErrorBeep       =   0
               MaxLength       =   5
               LengthAsByte    =   0
               Text            =   ""
               Furigana        =   0
               HighlightText   =   -1
               IMEMode         =   0
               IMEStatus       =   0
               DropWndWidth    =   0
               DropWndHeight   =   0
               ScrollBarMode   =   0
               MoveOnLRKey     =   0
               OLEDragMode     =   0
               OLEDropMode     =   0
            End
            Begin TDBText6Ctl.TDBText tdbtBusNumero 
               Height          =   285
               Left            =   3960
               TabIndex        =   141
               Tag             =   "enabled"
               ToolTipText     =   " Número del documento "
               Top             =   855
               Width           =   990
               _Version        =   65536
               _ExtentX        =   1746
               _ExtentY        =   503
               Caption         =   "frmManAsientosContables.frx":A8D5
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               DropDown        =   "frmManAsientosContables.frx":A941
               Key             =   "frmManAsientosContables.frx":A95F
               BackColor       =   -2147483643
               EditMode        =   0
               ForeColor       =   -2147483640
               ReadOnly        =   0
               ShowContextMenu =   1
               MarginLeft      =   1
               MarginRight     =   1
               MarginTop       =   1
               MarginBottom    =   1
               Enabled         =   -1
               MousePointer    =   0
               Appearance      =   1
               BorderStyle     =   1
               AlignHorizontal =   0
               AlignVertical   =   0
               MultiLine       =   0
               ScrollBars      =   0
               PasswordChar    =   ""
               AllowSpace      =   -1
               Format          =   ""
               FormatMode      =   1
               AutoConvert     =   -1
               ErrorBeep       =   0
               MaxLength       =   10
               LengthAsByte    =   0
               Text            =   ""
               Furigana        =   0
               HighlightText   =   -1
               IMEMode         =   0
               IMEStatus       =   0
               DropWndWidth    =   0
               DropWndHeight   =   0
               ScrollBarMode   =   0
               MoveOnLRKey     =   0
               OLEDragMode     =   0
               OLEDropMode     =   0
            End
            Begin TDBText6Ctl.TDBText tdbtBusTD 
               Height          =   285
               Left            =   3015
               TabIndex        =   139
               Tag             =   "enabled"
               ToolTipText     =   " Tipo del documento "
               Top             =   855
               Width           =   270
               _Version        =   65536
               _ExtentX        =   476
               _ExtentY        =   503
               Caption         =   "frmManAsientosContables.frx":A9A1
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               DropDown        =   "frmManAsientosContables.frx":AA0D
               Key             =   "frmManAsientosContables.frx":AA2B
               BackColor       =   -2147483643
               EditMode        =   0
               ForeColor       =   -2147483640
               ReadOnly        =   0
               ShowContextMenu =   1
               MarginLeft      =   1
               MarginRight     =   1
               MarginTop       =   1
               MarginBottom    =   1
               Enabled         =   -1
               MousePointer    =   0
               Appearance      =   1
               BorderStyle     =   1
               AlignHorizontal =   2
               AlignVertical   =   0
               MultiLine       =   0
               ScrollBars      =   0
               PasswordChar    =   ""
               AllowSpace      =   -1
               Format          =   ""
               FormatMode      =   1
               AutoConvert     =   -1
               ErrorBeep       =   0
               MaxLength       =   2
               LengthAsByte    =   0
               Text            =   ""
               Furigana        =   0
               HighlightText   =   -1
               IMEMode         =   0
               IMEStatus       =   0
               DropWndWidth    =   0
               DropWndHeight   =   0
               ScrollBarMode   =   0
               MoveOnLRKey     =   0
               OLEDragMode     =   0
               OLEDropMode     =   0
            End
            Begin TDBText6Ctl.TDBText tdbtBusCuenta 
               Height          =   285
               Left            =   870
               TabIndex        =   137
               ToolTipText     =   " Cuenta Contable "
               Top             =   480
               Width           =   1365
               _Version        =   65536
               _ExtentX        =   2408
               _ExtentY        =   503
               Caption         =   "frmManAsientosContables.frx":AA6D
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               DropDown        =   "frmManAsientosContables.frx":AAD1
               Key             =   "frmManAsientosContables.frx":AAEF
               BackColor       =   -2147483643
               EditMode        =   0
               ForeColor       =   -2147483640
               ReadOnly        =   0
               ShowContextMenu =   -1
               MarginLeft      =   1
               MarginRight     =   1
               MarginTop       =   1
               MarginBottom    =   1
               Enabled         =   -1
               MousePointer    =   0
               Appearance      =   1
               BorderStyle     =   1
               AlignHorizontal =   0
               AlignVertical   =   0
               MultiLine       =   0
               ScrollBars      =   0
               PasswordChar    =   ""
               AllowSpace      =   -1
               Format          =   "9"
               FormatMode      =   0
               AutoConvert     =   -1
               ErrorBeep       =   0
               MaxLength       =   12
               LengthAsByte    =   0
               Text            =   ""
               Furigana        =   0
               HighlightText   =   0
               IMEMode         =   0
               IMEStatus       =   0
               DropWndWidth    =   0
               DropWndHeight   =   0
               ScrollBarMode   =   0
               MoveOnLRKey     =   0
               OLEDragMode     =   0
               OLEDropMode     =   0
            End
            Begin VB.Label Label20 
               AutoSize        =   -1  'True
               Caption         =   "Documento (Tipo, Serie y Numero)"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H00800000&
               Height          =   210
               Left            =   135
               TabIndex        =   135
               Top             =   900
               Width           =   2835
            End
            Begin MSForms.CommandButton cmdBuscar 
               Height          =   390
               Left            =   1440
               TabIndex        =   142
               Top             =   1230
               Width           =   1305
               Caption         =   " Buscar"
               PicturePosition =   327683
               Size            =   "2302;688"
               FontHeight      =   165
               FontCharSet     =   0
               FontPitchAndFamily=   2
               ParagraphAlign  =   3
            End
            Begin MSForms.CommandButton cmdCancelarBusqueda 
               Height          =   390
               Left            =   2790
               TabIndex        =   143
               Top             =   1230
               Width           =   1305
               Caption         =   " Salir"
               PicturePosition =   327683
               Size            =   "2302;688"
               FontHeight      =   165
               FontCharSet     =   0
               FontPitchAndFamily=   2
               ParagraphAlign  =   3
            End
            Begin VB.Label Label24 
               AutoSize        =   -1  'True
               BackColor       =   &H00FFFFFF&
               BackStyle       =   0  'Transparent
               Caption         =   "Codigo Entidad"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H00800000&
               Height          =   210
               Index           =   1
               Left            =   2295
               TabIndex        =   134
               Top             =   495
               Width           =   1230
            End
            Begin VB.Label Label23 
               AutoSize        =   -1  'True
               BackColor       =   &H00FFFFFF&
               BackStyle       =   0  'Transparent
               Caption         =   "Cuenta"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H00800000&
               Height          =   210
               Index           =   1
               Left            =   135
               TabIndex        =   133
               Top             =   495
               Width           =   585
            End
         End
      End
      Begin TDBDate6Ctl.TDBDate dtpFechaDoc 
         Height          =   225
         Left            =   0
         TabIndex        =   76
         Tag             =   "enabled"
         Top             =   2190
         Visible         =   0   'False
         Width           =   1170
         _Version        =   65536
         _ExtentX        =   2064
         _ExtentY        =   397
         Calendar        =   "frmManAsientosContables.frx":AB31
         Caption         =   "frmManAsientosContables.frx":AC33
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         DropDown        =   "frmManAsientosContables.frx":AC97
         Keys            =   "frmManAsientosContables.frx":ACB5
         Spin            =   "frmManAsientosContables.frx":AD09
         AlignHorizontal =   0
         AlignVertical   =   0
         Appearance      =   0
         BackColor       =   16777215
         BorderStyle     =   0
         BtnPositioning  =   0
         ClipMode        =   0
         CursorPosition  =   0
         DataProperty    =   0
         DisplayFormat   =   "dd/mm/yyyy"
         EditMode        =   0
         Enabled         =   -1
         ErrorBeep       =   0
         FirstMonth      =   1
         ForeColor       =   -2147483640
         Format          =   "dd/mm/yyyy"
         HighlightText   =   0
         IMEMode         =   3
         MarginBottom    =   1
         MarginLeft      =   1
         MarginRight     =   1
         MarginTop       =   1
         MaxDate         =   73415
         MinDate         =   2
         MousePointer    =   0
         MoveOnLRKey     =   0
         OLEDragMode     =   0
         OLEDropMode     =   0
         PromptChar      =   "_"
         ReadOnly        =   0
         ShowContextMenu =   1
         ShowLiterals    =   0
         TabAction       =   0
         Text            =   "__/__/____"
         ValidateMode    =   0
         ValueVT         =   2010185729
         Value           =   38974
         CenturyMode     =   0
      End
      Begin TDBNumber6Ctl.TDBNumber tdbtMonto4 
         BeginProperty DataFormat 
            Type            =   0
            Format          =   "0"
            HaveTrueFalseNull=   0
            FirstDayOfWeek  =   0
            FirstWeekOfYear =   0
            LCID            =   3082
            SubFormatType   =   0
         EndProperty
         Height          =   375
         Left            =   3330
         TabIndex        =   64
         Top             =   3690
         Visible         =   0   'False
         Width           =   855
         _Version        =   65536
         _ExtentX        =   1508
         _ExtentY        =   661
         Calculator      =   "frmManAsientosContables.frx":AD31
         Caption         =   "frmManAsientosContables.frx":AD51
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         DropDown        =   "frmManAsientosContables.frx":ADB5
         Keys            =   "frmManAsientosContables.frx":ADD3
         Spin            =   "frmManAsientosContables.frx":AE0D
         AlignHorizontal =   1
         AlignVertical   =   0
         Appearance      =   1
         BackColor       =   16777215
         BorderStyle     =   0
         BtnPositioning  =   0
         ClipMode        =   0
         ClearAction     =   0
         DecimalPoint    =   "."
         DisplayFormat   =   "###,###,###,##0.00"
         EditMode        =   2
         Enabled         =   -1
         ErrorBeep       =   1
         ForeColor       =   -2147483640
         Format          =   "###,###,###,##0.00"
         HighlightText   =   1
         MarginBottom    =   1
         MarginLeft      =   1
         MarginRight     =   1
         MarginTop       =   1
         MaxValue        =   999999999999
         MinValue        =   0
         MousePointer    =   0
         MoveOnLRKey     =   0
         NegativeColor   =   255
         OLEDragMode     =   0
         OLEDropMode     =   0
         ReadOnly        =   0
         Separator       =   ","
         ShowContextMenu =   1
         ValueVT         =   1
         Value           =   0
         MaxValueVT      =   6750213
         MinValueVT      =   3538949
      End
      Begin TDBNumber6Ctl.TDBNumber tdbtMonto3 
         Height          =   375
         Left            =   2295
         TabIndex        =   63
         Top             =   3690
         Visible         =   0   'False
         Width           =   975
         _Version        =   65536
         _ExtentX        =   1720
         _ExtentY        =   661
         Calculator      =   "frmManAsientosContables.frx":AE35
         Caption         =   "frmManAsientosContables.frx":AE55
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         DropDown        =   "frmManAsientosContables.frx":AEB9
         Keys            =   "frmManAsientosContables.frx":AED7
         Spin            =   "frmManAsientosContables.frx":AF11
         AlignHorizontal =   1
         AlignVertical   =   0
         Appearance      =   1
         BackColor       =   16777215
         BorderStyle     =   0
         BtnPositioning  =   0
         ClipMode        =   0
         ClearAction     =   0
         DecimalPoint    =   "."
         DisplayFormat   =   "###,###,###,##0.00"
         EditMode        =   2
         Enabled         =   -1
         ErrorBeep       =   1
         ForeColor       =   -2147483640
         Format          =   "###,###,###,##0.00"
         HighlightText   =   1
         MarginBottom    =   1
         MarginLeft      =   1
         MarginRight     =   1
         MarginTop       =   1
         MaxValue        =   999999999999
         MinValue        =   0
         MousePointer    =   0
         MoveOnLRKey     =   0
         NegativeColor   =   255
         OLEDragMode     =   0
         OLEDropMode     =   0
         ReadOnly        =   0
         Separator       =   ","
         ShowContextMenu =   1
         ValueVT         =   1
         Value           =   0
         MaxValueVT      =   5
         MinValueVT      =   5
      End
      Begin TDBNumber6Ctl.TDBNumber tdbtMonto2 
         Height          =   375
         Left            =   1215
         TabIndex        =   62
         Top             =   3690
         Visible         =   0   'False
         Width           =   975
         _Version        =   65536
         _ExtentX        =   1720
         _ExtentY        =   661
         Calculator      =   "frmManAsientosContables.frx":AF39
         Caption         =   "frmManAsientosContables.frx":AF59
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         DropDown        =   "frmManAsientosContables.frx":AFBD
         Keys            =   "frmManAsientosContables.frx":AFDB
         Spin            =   "frmManAsientosContables.frx":B015
         AlignHorizontal =   1
         AlignVertical   =   0
         Appearance      =   1
         BackColor       =   16777215
         BorderStyle     =   0
         BtnPositioning  =   0
         ClipMode        =   0
         ClearAction     =   0
         DecimalPoint    =   "."
         DisplayFormat   =   "###,###,###,##0.00"
         EditMode        =   2
         Enabled         =   -1
         ErrorBeep       =   1
         ForeColor       =   -2147483640
         Format          =   "###,###,###,##0.00"
         HighlightText   =   1
         MarginBottom    =   1
         MarginLeft      =   1
         MarginRight     =   1
         MarginTop       =   1
         MaxValue        =   999999999999
         MinValue        =   0
         MousePointer    =   0
         MoveOnLRKey     =   0
         NegativeColor   =   255
         OLEDragMode     =   0
         OLEDropMode     =   0
         ReadOnly        =   0
         Separator       =   ","
         ShowContextMenu =   1
         ValueVT         =   1
         Value           =   0
         MaxValueVT      =   6750213
         MinValueVT      =   3538949
      End
      Begin TDBNumber6Ctl.TDBNumber tdbtMonto 
         Height          =   375
         Left            =   4320
         TabIndex        =   34
         Top             =   3690
         Visible         =   0   'False
         Width           =   975
         _Version        =   65536
         _ExtentX        =   1720
         _ExtentY        =   661
         Calculator      =   "frmManAsientosContables.frx":B03D
         Caption         =   "frmManAsientosContables.frx":B05D
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         DropDown        =   "frmManAsientosContables.frx":B0C1
         Keys            =   "frmManAsientosContables.frx":B0DF
         Spin            =   "frmManAsientosContables.frx":B119
         AlignHorizontal =   1
         AlignVertical   =   0
         Appearance      =   1
         BackColor       =   16777215
         BorderStyle     =   0
         BtnPositioning  =   0
         ClipMode        =   0
         ClearAction     =   0
         DecimalPoint    =   "."
         DisplayFormat   =   "###,###,###,##0.00"
         EditMode        =   2
         Enabled         =   -1
         ErrorBeep       =   1
         ForeColor       =   -2147483640
         Format          =   "###,###,###,##0.00"
         HighlightText   =   1
         MarginBottom    =   1
         MarginLeft      =   1
         MarginRight     =   1
         MarginTop       =   1
         MaxValue        =   999999999999
         MinValue        =   0
         MousePointer    =   0
         MoveOnLRKey     =   0
         NegativeColor   =   255
         OLEDragMode     =   0
         OLEDropMode     =   0
         ReadOnly        =   0
         Separator       =   ","
         ShowContextMenu =   1
         ValueVT         =   1507329
         Value           =   0
         MaxValueVT      =   5
         MinValueVT      =   5
      End
      Begin VB.Frame fra01 
         BackColor       =   &H00FFFFFF&
         Height          =   600
         Left            =   45
         TabIndex        =   105
         Top             =   3600
         Width           =   12000
         Begin VB.PictureBox pbMontosAdic 
            Appearance      =   0  'Flat
            BackColor       =   &H00C0FFFF&
            ForeColor       =   &H80000008&
            Height          =   330
            Left            =   9360
            ScaleHeight     =   300
            ScaleWidth      =   1905
            TabIndex        =   148
            Top             =   240
            Visible         =   0   'False
            Width           =   1935
            Begin TrueOleDBList70.TDBCombo tdbcMonedaAdic 
               Height          =   300
               Left            =   0
               TabIndex        =   149
               Tag             =   "_"
               Top             =   0
               Width           =   795
               _ExtentX        =   1402
               _ExtentY        =   529
               _LayoutType     =   4
               _RowHeight      =   -2147483647
               _WasPersistedAsPixels=   0
               _DropdownWidth  =   3254
               Columns(0)._VlistStyle=   0
               Columns(0)._MaxComboItems=   5
               Columns(0).DataField=   ""
               Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns(1)._VlistStyle=   0
               Columns(1)._MaxComboItems=   5
               Columns(1).DataField=   ""
               Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns(2)._VlistStyle=   0
               Columns(2)._MaxComboItems=   5
               Columns(2).DataField=   ""
               Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns(3)._VlistStyle=   0
               Columns(3)._MaxComboItems=   5
               Columns(3).DataField=   ""
               Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns(4)._VlistStyle=   0
               Columns(4)._MaxComboItems=   5
               Columns(4).DataField=   ""
               Columns(4)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns.Count   =   5
               Splits(0)._UserFlags=   0
               Splits(0).ExtendRightColumn=   -1  'True
               Splits(0).AllowRowSizing=   0   'False
               Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
               Splits(0)._ColumnProps(0)=   "Columns.Count=5"
               Splits(0)._ColumnProps(1)=   "Column(0).Width=609"
               Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
               Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=529"
               Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
               Splits(0)._ColumnProps(5)=   "Column(0).Visible=0"
               Splits(0)._ColumnProps(6)=   "Column(0).Order=1"
               Splits(0)._ColumnProps(7)=   "Column(1).Width=370"
               Splits(0)._ColumnProps(8)=   "Column(1).DividerColor=0"
               Splits(0)._ColumnProps(9)=   "Column(1)._WidthInPix=291"
               Splits(0)._ColumnProps(10)=   "Column(1)._EditAlways=0"
               Splits(0)._ColumnProps(11)=   "Column(1).Order=2"
               Splits(0)._ColumnProps(12)=   "Column(2).Width=847"
               Splits(0)._ColumnProps(13)=   "Column(2).DividerColor=0"
               Splits(0)._ColumnProps(14)=   "Column(2)._WidthInPix=767"
               Splits(0)._ColumnProps(15)=   "Column(2)._EditAlways=0"
               Splits(0)._ColumnProps(16)=   "Column(2).Visible=0"
               Splits(0)._ColumnProps(17)=   "Column(2).Order=3"
               Splits(0)._ColumnProps(18)=   "Column(3).Width=1376"
               Splits(0)._ColumnProps(19)=   "Column(3).DividerColor=0"
               Splits(0)._ColumnProps(20)=   "Column(3)._WidthInPix=1296"
               Splits(0)._ColumnProps(21)=   "Column(3)._EditAlways=0"
               Splits(0)._ColumnProps(22)=   "Column(3).Visible=0"
               Splits(0)._ColumnProps(23)=   "Column(3).Order=4"
               Splits(0)._ColumnProps(24)=   "Column(4).Width=2196"
               Splits(0)._ColumnProps(25)=   "Column(4).DividerColor=0"
               Splits(0)._ColumnProps(26)=   "Column(4)._WidthInPix=2117"
               Splits(0)._ColumnProps(27)=   "Column(4)._EditAlways=0"
               Splits(0)._ColumnProps(28)=   "Column(4).Visible=0"
               Splits(0)._ColumnProps(29)=   "Column(4).Order=5"
               Splits.Count    =   1
               Appearance      =   1
               BorderStyle     =   1
               ComboStyle      =   2
               AutoCompletion  =   0   'False
               LimitToList     =   0   'False
               ColumnHeaders   =   0   'False
               ColumnFooters   =   0   'False
               DataMode        =   4
               DefColWidth     =   0
               Enabled         =   0   'False
               HeadLines       =   1
               FootLines       =   1
               RowDividerStyle =   0
               Caption         =   ""
               EditFont        =   "Size=6.75,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
               LayoutName      =   ""
               LayoutFileName  =   ""
               MultipleLines   =   0
               EmptyRows       =   -1  'True
               CellTips        =   1
               EditHeight      =   299.906
               AutoSize        =   -1  'True
               GapHeight       =   30.047
               ListField       =   ""
               BoundColumn     =   ""
               IntegralHeight  =   0   'False
               CellTipsWidth   =   0
               CellTipsDelay   =   1000
               AutoDropdown    =   -1  'True
               RowTracking     =   -1  'True
               RightToLeft     =   0   'False
               RowMember       =   ""
               MouseIcon       =   0
               MouseIcon.vt    =   3
               MousePointer    =   0
               MatchEntryTimeout=   2000
               OLEDragMode     =   0
               OLEDropMode     =   0
               AnimateWindow   =   0
               AnimateWindowDirection=   0
               AnimateWindowTime=   200
               AnimateWindowClose=   0
               DropdownPosition=   0
               Locked          =   0   'False
               ScrollTrack     =   0   'False
               RowDividerColor =   12632256
               RowSubDividerColor=   12632256
               AddItemSeparator=   ";"
               _PropDict       =   $"frmManAsientosContables.frx":B141
               _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
               _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
               _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
               _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=825,.italic=0"
               _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
               _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
               _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bgcolor=&HC0FFFF&,.fgcolor=&H0&,.bold=0"
               _StyleDefs(7)   =   ":id=1,.fontsize=675,.italic=0,.underline=0,.strikethrough=0,.charset=0"
               _StyleDefs(8)   =   ":id=1,.fontname=Arial"
               _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
               _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34"
               _StyleDefs(11)  =   "FooterStyle:id=3,.parent=1,.namedParent=35"
               _StyleDefs(12)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
               _StyleDefs(13)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
               _StyleDefs(14)  =   "EditorStyle:id=7,.parent=1"
               _StyleDefs(15)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
               _StyleDefs(16)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
               _StyleDefs(17)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
               _StyleDefs(18)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
               _StyleDefs(19)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
               _StyleDefs(20)  =   "Splits(0).Style:id=13,.parent=1"
               _StyleDefs(21)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
               _StyleDefs(22)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
               _StyleDefs(23)  =   "Splits(0).FooterStyle:id=15,.parent=3"
               _StyleDefs(24)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
               _StyleDefs(25)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
               _StyleDefs(26)  =   "Splits(0).EditorStyle:id=17,.parent=7"
               _StyleDefs(27)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
               _StyleDefs(28)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
               _StyleDefs(29)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
               _StyleDefs(30)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
               _StyleDefs(31)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
               _StyleDefs(32)  =   "Splits(0).Columns(0).Style:id=46,.parent=13"
               _StyleDefs(33)  =   "Splits(0).Columns(0).HeadingStyle:id=43,.parent=14"
               _StyleDefs(34)  =   "Splits(0).Columns(0).FooterStyle:id=44,.parent=15"
               _StyleDefs(35)  =   "Splits(0).Columns(0).EditorStyle:id=45,.parent=17"
               _StyleDefs(36)  =   "Splits(0).Columns(1).Style:id=50,.parent=13"
               _StyleDefs(37)  =   "Splits(0).Columns(1).HeadingStyle:id=47,.parent=14"
               _StyleDefs(38)  =   "Splits(0).Columns(1).FooterStyle:id=48,.parent=15"
               _StyleDefs(39)  =   "Splits(0).Columns(1).EditorStyle:id=49,.parent=17"
               _StyleDefs(40)  =   "Splits(0).Columns(2).Style:id=28,.parent=13"
               _StyleDefs(41)  =   "Splits(0).Columns(2).HeadingStyle:id=25,.parent=14"
               _StyleDefs(42)  =   "Splits(0).Columns(2).FooterStyle:id=26,.parent=15"
               _StyleDefs(43)  =   "Splits(0).Columns(2).EditorStyle:id=27,.parent=17"
               _StyleDefs(44)  =   "Splits(0).Columns(3).Style:id=32,.parent=13"
               _StyleDefs(45)  =   "Splits(0).Columns(3).HeadingStyle:id=29,.parent=14"
               _StyleDefs(46)  =   "Splits(0).Columns(3).FooterStyle:id=30,.parent=15"
               _StyleDefs(47)  =   "Splits(0).Columns(3).EditorStyle:id=31,.parent=17"
               _StyleDefs(48)  =   "Splits(0).Columns(4).Style:id=54,.parent=13"
               _StyleDefs(49)  =   "Splits(0).Columns(4).HeadingStyle:id=51,.parent=14"
               _StyleDefs(50)  =   "Splits(0).Columns(4).FooterStyle:id=52,.parent=15"
               _StyleDefs(51)  =   "Splits(0).Columns(4).EditorStyle:id=53,.parent=17"
               _StyleDefs(52)  =   "Named:id=33:Normal"
               _StyleDefs(53)  =   ":id=33,.parent=0"
               _StyleDefs(54)  =   "Named:id=34:Heading"
               _StyleDefs(55)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
               _StyleDefs(56)  =   ":id=34,.wraptext=-1"
               _StyleDefs(57)  =   "Named:id=35:Footing"
               _StyleDefs(58)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
               _StyleDefs(59)  =   "Named:id=36:Selected"
               _StyleDefs(60)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
               _StyleDefs(61)  =   "Named:id=37:Caption"
               _StyleDefs(62)  =   ":id=37,.parent=34,.alignment=2"
               _StyleDefs(63)  =   "Named:id=38:HighlightRow"
               _StyleDefs(64)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
               _StyleDefs(65)  =   "Named:id=39:EvenRow"
               _StyleDefs(66)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
               _StyleDefs(67)  =   "Named:id=40:OddRow"
               _StyleDefs(68)  =   ":id=40,.parent=33"
               _StyleDefs(69)  =   "Named:id=41:RecordSelector"
               _StyleDefs(70)  =   ":id=41,.parent=34"
               _StyleDefs(71)  =   "Named:id=42:FilterBar"
               _StyleDefs(72)  =   ":id=42,.parent=33"
            End
         End
         Begin VB.PictureBox pbDescripcion 
            Appearance      =   0  'Flat
            BackColor       =   &H80000005&
            BorderStyle     =   0  'None
            ForeColor       =   &H80000008&
            Height          =   375
            Left            =   45
            ScaleHeight     =   375
            ScaleWidth      =   9330
            TabIndex        =   106
            Top             =   180
            Width           =   9330
            Begin VB.Label lblNomEnti 
               Appearance      =   0  'Flat
               BackColor       =   &H00FFFFFF&
               ForeColor       =   &H00800000&
               Height          =   210
               Left            =   5970
               TabIndex        =   110
               Top             =   45
               Width           =   3240
            End
            Begin VB.Label lblDesCta 
               Appearance      =   0  'Flat
               BackColor       =   &H00FFFFFF&
               ForeColor       =   &H00800000&
               Height          =   210
               Left            =   765
               TabIndex        =   109
               Top             =   45
               Width           =   4035
            End
            Begin VB.Label lblCuenta 
               Appearance      =   0  'Flat
               BackColor       =   &H00FFFFFF&
               Caption         =   "CUENTA :"
               ForeColor       =   &H00800000&
               Height          =   210
               Left            =   0
               TabIndex        =   108
               Top             =   45
               Width           =   750
            End
            Begin VB.Label lblEntidad 
               Appearance      =   0  'Flat
               BackColor       =   &H00FFFFFF&
               ForeColor       =   &H00800000&
               Height          =   210
               Left            =   4860
               TabIndex        =   107
               Top             =   30
               Width           =   1110
            End
         End
      End
      Begin VB.Frame fra02 
         BackColor       =   &H00FFFFFF&
         Height          =   1230
         Left            =   45
         TabIndex        =   53
         Top             =   4140
         Width           =   12000
         Begin TrueOleDBList70.TDBCombo tdbcTipoPago 
            Height          =   300
            Left            =   9000
            TabIndex        =   111
            Tag             =   "_"
            ToolTipText     =   " Tipo de Medio de Pago "
            Top             =   135
            Visible         =   0   'False
            Width           =   2295
            _ExtentX        =   4048
            _ExtentY        =   529
            _LayoutType     =   4
            _RowHeight      =   -2147483647
            _WasPersistedAsPixels=   0
            _DropdownWidth  =   8811
            Columns(0)._VlistStyle=   0
            Columns(0)._MaxComboItems=   5
            Columns(0).DataField=   ""
            Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(1)._VlistStyle=   0
            Columns(1)._MaxComboItems=   5
            Columns(1).DataField=   ""
            Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(2)._VlistStyle=   0
            Columns(2)._MaxComboItems=   5
            Columns(2).DataField=   ""
            Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(3)._VlistStyle=   0
            Columns(3)._MaxComboItems=   5
            Columns(3).DataField=   ""
            Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(4)._VlistStyle=   0
            Columns(4)._MaxComboItems=   5
            Columns(4).DataField=   ""
            Columns(4)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns.Count   =   5
            Splits(0)._UserFlags=   0
            Splits(0).ExtendRightColumn=   -1  'True
            Splits(0).AllowRowSizing=   0   'False
            Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
            Splits(0)._ColumnProps(0)=   "Columns.Count=5"
            Splits(0)._ColumnProps(1)=   "Column(0).Width=609"
            Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
            Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=529"
            Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
            Splits(0)._ColumnProps(5)=   "Column(0).Visible=0"
            Splits(0)._ColumnProps(6)=   "Column(0).Order=1"
            Splits(0)._ColumnProps(7)=   "Column(1).Width=370"
            Splits(0)._ColumnProps(8)=   "Column(1).DividerColor=0"
            Splits(0)._ColumnProps(9)=   "Column(1)._WidthInPix=291"
            Splits(0)._ColumnProps(10)=   "Column(1)._EditAlways=0"
            Splits(0)._ColumnProps(11)=   "Column(1).Order=2"
            Splits(0)._ColumnProps(12)=   "Column(2).Width=847"
            Splits(0)._ColumnProps(13)=   "Column(2).DividerColor=0"
            Splits(0)._ColumnProps(14)=   "Column(2)._WidthInPix=767"
            Splits(0)._ColumnProps(15)=   "Column(2)._EditAlways=0"
            Splits(0)._ColumnProps(16)=   "Column(2).Visible=0"
            Splits(0)._ColumnProps(17)=   "Column(2).Order=3"
            Splits(0)._ColumnProps(18)=   "Column(3).Width=1376"
            Splits(0)._ColumnProps(19)=   "Column(3).DividerColor=0"
            Splits(0)._ColumnProps(20)=   "Column(3)._WidthInPix=1296"
            Splits(0)._ColumnProps(21)=   "Column(3)._EditAlways=0"
            Splits(0)._ColumnProps(22)=   "Column(3).Visible=0"
            Splits(0)._ColumnProps(23)=   "Column(3).Order=4"
            Splits(0)._ColumnProps(24)=   "Column(4).Width=2196"
            Splits(0)._ColumnProps(25)=   "Column(4).DividerColor=0"
            Splits(0)._ColumnProps(26)=   "Column(4)._WidthInPix=2117"
            Splits(0)._ColumnProps(27)=   "Column(4)._EditAlways=0"
            Splits(0)._ColumnProps(28)=   "Column(4).Visible=0"
            Splits(0)._ColumnProps(29)=   "Column(4).Order=5"
            Splits.Count    =   1
            Appearance      =   1
            BorderStyle     =   1
            ComboStyle      =   2
            AutoCompletion  =   0   'False
            LimitToList     =   0   'False
            ColumnHeaders   =   0   'False
            ColumnFooters   =   0   'False
            DataMode        =   5
            DefColWidth     =   0
            Enabled         =   0   'False
            HeadLines       =   1
            FootLines       =   1
            RowDividerStyle =   0
            Caption         =   ""
            EditFont        =   "Size=6.75,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
            LayoutName      =   ""
            LayoutFileName  =   ""
            MultipleLines   =   0
            EmptyRows       =   -1  'True
            CellTips        =   1
            EditHeight      =   299.906
            AutoSize        =   -1  'True
            GapHeight       =   30.047
            ListField       =   ""
            BoundColumn     =   ""
            IntegralHeight  =   0   'False
            CellTipsWidth   =   0
            CellTipsDelay   =   1000
            AutoDropdown    =   -1  'True
            RowTracking     =   -1  'True
            RightToLeft     =   0   'False
            RowMember       =   ""
            MouseIcon       =   0
            MouseIcon.vt    =   3
            MousePointer    =   0
            MatchEntryTimeout=   2000
            OLEDragMode     =   0
            OLEDropMode     =   0
            AnimateWindow   =   0
            AnimateWindowDirection=   0
            AnimateWindowTime=   200
            AnimateWindowClose=   0
            DropdownPosition=   4
            Locked          =   0   'False
            ScrollTrack     =   0   'False
            RowDividerColor =   12632256
            RowSubDividerColor=   12632256
            MaxComboItems   =   6
            AddItemSeparator=   ";"
            _PropDict       =   $"frmManAsientosContables.frx":B1C8
            _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
            _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
            _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
            _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=825,.italic=0"
            _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
            _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bold=0,.fontsize=675,.italic=0"
            _StyleDefs(7)   =   ":id=1,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(8)   =   ":id=1,.fontname=Arial"
            _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
            _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34"
            _StyleDefs(11)  =   "FooterStyle:id=3,.parent=1,.namedParent=35"
            _StyleDefs(12)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(13)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
            _StyleDefs(14)  =   "EditorStyle:id=7,.parent=1"
            _StyleDefs(15)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
            _StyleDefs(16)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
            _StyleDefs(17)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
            _StyleDefs(18)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
            _StyleDefs(19)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
            _StyleDefs(20)  =   "Splits(0).Style:id=13,.parent=1"
            _StyleDefs(21)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
            _StyleDefs(22)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
            _StyleDefs(23)  =   "Splits(0).FooterStyle:id=15,.parent=3"
            _StyleDefs(24)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
            _StyleDefs(25)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
            _StyleDefs(26)  =   "Splits(0).EditorStyle:id=17,.parent=7"
            _StyleDefs(27)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
            _StyleDefs(28)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
            _StyleDefs(29)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
            _StyleDefs(30)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
            _StyleDefs(31)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
            _StyleDefs(32)  =   "Splits(0).Columns(0).Style:id=46,.parent=13"
            _StyleDefs(33)  =   "Splits(0).Columns(0).HeadingStyle:id=43,.parent=14"
            _StyleDefs(34)  =   "Splits(0).Columns(0).FooterStyle:id=44,.parent=15"
            _StyleDefs(35)  =   "Splits(0).Columns(0).EditorStyle:id=45,.parent=17"
            _StyleDefs(36)  =   "Splits(0).Columns(1).Style:id=50,.parent=13"
            _StyleDefs(37)  =   "Splits(0).Columns(1).HeadingStyle:id=47,.parent=14"
            _StyleDefs(38)  =   "Splits(0).Columns(1).FooterStyle:id=48,.parent=15"
            _StyleDefs(39)  =   "Splits(0).Columns(1).EditorStyle:id=49,.parent=17"
            _StyleDefs(40)  =   "Splits(0).Columns(2).Style:id=28,.parent=13"
            _StyleDefs(41)  =   "Splits(0).Columns(2).HeadingStyle:id=25,.parent=14"
            _StyleDefs(42)  =   "Splits(0).Columns(2).FooterStyle:id=26,.parent=15"
            _StyleDefs(43)  =   "Splits(0).Columns(2).EditorStyle:id=27,.parent=17"
            _StyleDefs(44)  =   "Splits(0).Columns(3).Style:id=32,.parent=13"
            _StyleDefs(45)  =   "Splits(0).Columns(3).HeadingStyle:id=29,.parent=14"
            _StyleDefs(46)  =   "Splits(0).Columns(3).FooterStyle:id=30,.parent=15"
            _StyleDefs(47)  =   "Splits(0).Columns(3).EditorStyle:id=31,.parent=17"
            _StyleDefs(48)  =   "Splits(0).Columns(4).Style:id=54,.parent=13"
            _StyleDefs(49)  =   "Splits(0).Columns(4).HeadingStyle:id=51,.parent=14"
            _StyleDefs(50)  =   "Splits(0).Columns(4).FooterStyle:id=52,.parent=15"
            _StyleDefs(51)  =   "Splits(0).Columns(4).EditorStyle:id=53,.parent=17"
            _StyleDefs(52)  =   "Named:id=33:Normal"
            _StyleDefs(53)  =   ":id=33,.parent=0"
            _StyleDefs(54)  =   "Named:id=34:Heading"
            _StyleDefs(55)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(56)  =   ":id=34,.wraptext=-1"
            _StyleDefs(57)  =   "Named:id=35:Footing"
            _StyleDefs(58)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(59)  =   "Named:id=36:Selected"
            _StyleDefs(60)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(61)  =   "Named:id=37:Caption"
            _StyleDefs(62)  =   ":id=37,.parent=34,.alignment=2"
            _StyleDefs(63)  =   "Named:id=38:HighlightRow"
            _StyleDefs(64)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(65)  =   "Named:id=39:EvenRow"
            _StyleDefs(66)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
            _StyleDefs(67)  =   "Named:id=40:OddRow"
            _StyleDefs(68)  =   ":id=40,.parent=33"
            _StyleDefs(69)  =   "Named:id=41:RecordSelector"
            _StyleDefs(70)  =   ":id=41,.parent=34"
            _StyleDefs(71)  =   "Named:id=42:FilterBar"
            _StyleDefs(72)  =   ":id=42,.parent=33"
         End
         Begin VB.CheckBox chkRegAux 
            Alignment       =   1  'Right Justify
            BackColor       =   &H00FFFFFF&
            Caption         =   "Reg.Aux"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   330
            Left            =   3870
            TabIndex        =   112
            ToolTipText     =   " Indica si el comprobante se detallará en Registros Auxiliares "
            Top             =   510
            Visible         =   0   'False
            Width           =   1005
         End
         Begin TDBText6Ctl.TDBText tdbtGlosa 
            Height          =   285
            Left            =   720
            TabIndex        =   8
            Tag             =   "enabled"
            Top             =   135
            Width           =   4065
            _Version        =   65536
            _ExtentX        =   7170
            _ExtentY        =   503
            Caption         =   "frmManAsientosContables.frx":B24F
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":B2BB
            Key             =   "frmManAsientosContables.frx":B2D9
            BackColor       =   -2147483643
            EditMode        =   0
            ForeColor       =   -2147483640
            ReadOnly        =   0
            ShowContextMenu =   1
            MarginLeft      =   1
            MarginRight     =   1
            MarginTop       =   1
            MarginBottom    =   1
            Enabled         =   0
            MousePointer    =   0
            Appearance      =   1
            BorderStyle     =   1
            AlignHorizontal =   0
            AlignVertical   =   0
            MultiLine       =   0
            ScrollBars      =   0
            PasswordChar    =   ""
            AllowSpace      =   -1
            Format          =   "a"
            FormatMode      =   1
            AutoConvert     =   -1
            ErrorBeep       =   0
            MaxLength       =   250
            LengthAsByte    =   0
            Text            =   ""
            Furigana        =   0
            HighlightText   =   -1
            IMEMode         =   0
            IMEStatus       =   0
            DropWndWidth    =   0
            DropWndHeight   =   0
            ScrollBarMode   =   0
            MoveOnLRKey     =   0
            OLEDragMode     =   0
            OLEDropMode     =   0
         End
         Begin VB.CheckBox CheckCuadraCompMan 
            Alignment       =   1  'Right Justify
            BackColor       =   &H00FFFFFF&
            Caption         =   "Manual"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Left            =   4815
            TabIndex        =   11
            ToolTipText     =   " Permite realizar los calculos manualmente en el voucher "
            Top             =   180
            Width           =   930
         End
         Begin VB.CheckBox chkCC 
            Alignment       =   1  'Right Justify
            Caption         =   "CC"
            Enabled         =   0   'False
            Height          =   255
            Left            =   2745
            TabIndex        =   9
            Top             =   135
            Visible         =   0   'False
            Width           =   510
         End
         Begin VB.CheckBox chkProv 
            Alignment       =   1  'Right Justify
            Caption         =   "Prov"
            Enabled         =   0   'False
            Height          =   255
            Left            =   2655
            TabIndex        =   10
            Top             =   135
            Visible         =   0   'False
            Width           =   660
         End
         Begin TDBText6Ctl.TDBText tdbtSerDocRef 
            Height          =   285
            Left            =   6660
            TabIndex        =   15
            Tag             =   "enabled"
            ToolTipText     =   " Serie del documento de referencia "
            Top             =   525
            Width           =   555
            _Version        =   65536
            _ExtentX        =   979
            _ExtentY        =   503
            Caption         =   "frmManAsientosContables.frx":B30D
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":B379
            Key             =   "frmManAsientosContables.frx":B397
            BackColor       =   -2147483643
            EditMode        =   0
            ForeColor       =   -2147483640
            ReadOnly        =   0
            ShowContextMenu =   1
            MarginLeft      =   1
            MarginRight     =   1
            MarginTop       =   1
            MarginBottom    =   1
            Enabled         =   0
            MousePointer    =   0
            Appearance      =   1
            BorderStyle     =   1
            AlignHorizontal =   0
            AlignVertical   =   0
            MultiLine       =   0
            ScrollBars      =   0
            PasswordChar    =   ""
            AllowSpace      =   -1
            Format          =   "a@"
            FormatMode      =   1
            AutoConvert     =   -1
            ErrorBeep       =   0
            MaxLength       =   5
            LengthAsByte    =   0
            Text            =   "12345"
            Furigana        =   0
            HighlightText   =   -1
            IMEMode         =   0
            IMEStatus       =   0
            DropWndWidth    =   0
            DropWndHeight   =   0
            ScrollBarMode   =   0
            MoveOnLRKey     =   0
            OLEDragMode     =   0
            OLEDropMode     =   0
         End
         Begin TDBText6Ctl.TDBText tdbtNroDocRef 
            Height          =   285
            Left            =   8055
            TabIndex        =   16
            Tag             =   "enabled"
            ToolTipText     =   " Número del documento de referencia "
            Top             =   525
            Width           =   990
            _Version        =   65536
            _ExtentX        =   1746
            _ExtentY        =   503
            Caption         =   "frmManAsientosContables.frx":B3CB
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":B437
            Key             =   "frmManAsientosContables.frx":B455
            BackColor       =   -2147483643
            EditMode        =   0
            ForeColor       =   -2147483640
            ReadOnly        =   0
            ShowContextMenu =   1
            MarginLeft      =   1
            MarginRight     =   1
            MarginTop       =   1
            MarginBottom    =   1
            Enabled         =   0
            MousePointer    =   0
            Appearance      =   1
            BorderStyle     =   1
            AlignHorizontal =   0
            AlignVertical   =   0
            MultiLine       =   0
            ScrollBars      =   0
            PasswordChar    =   ""
            AllowSpace      =   -1
            Format          =   "a@"
            FormatMode      =   1
            AutoConvert     =   -1
            ErrorBeep       =   0
            MaxLength       =   10
            LengthAsByte    =   0
            Text            =   ""
            Furigana        =   0
            HighlightText   =   -1
            IMEMode         =   0
            IMEStatus       =   0
            DropWndWidth    =   0
            DropWndHeight   =   0
            ScrollBarMode   =   0
            MoveOnLRKey     =   0
            OLEDragMode     =   0
            OLEDropMode     =   0
         End
         Begin TDBDate6Ctl.TDBDate dtpFecDocRef 
            Height          =   300
            Left            =   10080
            TabIndex        =   17
            Tag             =   "enabled"
            ToolTipText     =   " Fecha del documento de referencia "
            Top             =   525
            Width           =   1215
            _Version        =   65536
            _ExtentX        =   2143
            _ExtentY        =   529
            Calendar        =   "frmManAsientosContables.frx":B489
            Caption         =   "frmManAsientosContables.frx":B58B
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":B5EF
            Keys            =   "frmManAsientosContables.frx":B60D
            Spin            =   "frmManAsientosContables.frx":B653
            AlignHorizontal =   0
            AlignVertical   =   0
            Appearance      =   1
            BackColor       =   -2147483643
            BorderStyle     =   1
            BtnPositioning  =   0
            ClipMode        =   0
            CursorPosition  =   0
            DataProperty    =   0
            DisplayFormat   =   "dd/mm/yyyy"
            EditMode        =   0
            Enabled         =   0
            ErrorBeep       =   0
            FirstMonth      =   1
            ForeColor       =   -2147483640
            Format          =   "dd/mm/yyyy"
            HighlightText   =   0
            IMEMode         =   3
            MarginBottom    =   1
            MarginLeft      =   1
            MarginRight     =   1
            MarginTop       =   1
            MaxDate         =   73415
            MinDate         =   2
            MousePointer    =   0
            MoveOnLRKey     =   0
            OLEDragMode     =   0
            OLEDropMode     =   0
            PromptChar      =   "_"
            ReadOnly        =   0
            ShowContextMenu =   1
            ShowLiterals    =   0
            TabAction       =   0
            Text            =   "__/__/____"
            ValidateMode    =   0
            ValueVT         =   1
            Value           =   38718
            CenturyMode     =   0
         End
         Begin TDBText6Ctl.TDBText tdbtNroConsta 
            Height          =   285
            Left            =   8055
            TabIndex        =   20
            Tag             =   "enabled"
            ToolTipText     =   " Número del documento de depósito de detracción "
            Top             =   855
            Width           =   990
            _Version        =   65536
            _ExtentX        =   1746
            _ExtentY        =   503
            Caption         =   "frmManAsientosContables.frx":B67B
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":B6E7
            Key             =   "frmManAsientosContables.frx":B705
            BackColor       =   -2147483643
            EditMode        =   0
            ForeColor       =   -2147483640
            ReadOnly        =   0
            ShowContextMenu =   1
            MarginLeft      =   1
            MarginRight     =   1
            MarginTop       =   1
            MarginBottom    =   1
            Enabled         =   0
            MousePointer    =   0
            Appearance      =   1
            BorderStyle     =   1
            AlignHorizontal =   0
            AlignVertical   =   0
            MultiLine       =   0
            ScrollBars      =   0
            PasswordChar    =   ""
            AllowSpace      =   -1
            Format          =   "a@"
            FormatMode      =   1
            AutoConvert     =   -1
            ErrorBeep       =   0
            MaxLength       =   20
            LengthAsByte    =   0
            Text            =   "1234567890"
            Furigana        =   0
            HighlightText   =   -1
            IMEMode         =   0
            IMEStatus       =   0
            DropWndWidth    =   0
            DropWndHeight   =   0
            ScrollBarMode   =   0
            MoveOnLRKey     =   0
            OLEDragMode     =   0
            OLEDropMode     =   0
         End
         Begin TDBDate6Ctl.TDBDate dtpFecDeposito 
            Height          =   300
            Left            =   10080
            TabIndex        =   21
            Tag             =   "enabled"
            ToolTipText     =   " Fecha de depósito de detracción "
            Top             =   855
            Width           =   1215
            _Version        =   65536
            _ExtentX        =   2143
            _ExtentY        =   529
            Calendar        =   "frmManAsientosContables.frx":B739
            Caption         =   "frmManAsientosContables.frx":B83B
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":B89F
            Keys            =   "frmManAsientosContables.frx":B8BD
            Spin            =   "frmManAsientosContables.frx":B903
            AlignHorizontal =   0
            AlignVertical   =   0
            Appearance      =   1
            BackColor       =   16777215
            BorderStyle     =   1
            BtnPositioning  =   0
            ClipMode        =   0
            CursorPosition  =   0
            DataProperty    =   0
            DisplayFormat   =   "dd/mm/yyyy"
            EditMode        =   0
            Enabled         =   0
            ErrorBeep       =   0
            FirstMonth      =   1
            ForeColor       =   -2147483640
            Format          =   "dd/mm/yyyy"
            HighlightText   =   0
            IMEMode         =   3
            MarginBottom    =   1
            MarginLeft      =   1
            MarginRight     =   1
            MarginTop       =   1
            MaxDate         =   73415
            MinDate         =   2
            MousePointer    =   0
            MoveOnLRKey     =   0
            OLEDragMode     =   0
            OLEDropMode     =   0
            PromptChar      =   "_"
            ReadOnly        =   0
            ShowContextMenu =   1
            ShowLiterals    =   0
            TabAction       =   0
            Text            =   "__/__/____"
            ValidateMode    =   0
            ValueVT         =   1
            Value           =   38974
            CenturyMode     =   0
         End
         Begin TrueOleDBList70.TDBCombo tdbcPagoIGV 
            Height          =   300
            Left            =   1560
            TabIndex        =   13
            Tag             =   "_"
            Top             =   525
            Width           =   2295
            _ExtentX        =   4048
            _ExtentY        =   529
            _LayoutType     =   4
            _RowHeight      =   -2147483647
            _WasPersistedAsPixels=   0
            _DropdownWidth  =   7064
            Columns(0)._VlistStyle=   0
            Columns(0)._MaxComboItems=   5
            Columns(0).DataField=   ""
            Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(1)._VlistStyle=   0
            Columns(1)._MaxComboItems=   5
            Columns(1).DataField=   ""
            Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(2)._VlistStyle=   0
            Columns(2)._MaxComboItems=   5
            Columns(2).DataField=   ""
            Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(3)._VlistStyle=   0
            Columns(3)._MaxComboItems=   5
            Columns(3).DataField=   ""
            Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns.Count   =   4
            Splits(0)._UserFlags=   0
            Splits(0).ExtendRightColumn=   -1  'True
            Splits(0).AllowRowSizing=   0   'False
            Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
            Splits(0)._ColumnProps(0)=   "Columns.Count=4"
            Splits(0)._ColumnProps(1)=   "Column(0).Width=688"
            Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
            Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=609"
            Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
            Splits(0)._ColumnProps(5)=   "Column(0).Visible=0"
            Splits(0)._ColumnProps(6)=   "Column(0).Order=1"
            Splits(0)._ColumnProps(7)=   "Column(1).Width=370"
            Splits(0)._ColumnProps(8)=   "Column(1).DividerColor=0"
            Splits(0)._ColumnProps(9)=   "Column(1)._WidthInPix=291"
            Splits(0)._ColumnProps(10)=   "Column(1)._EditAlways=0"
            Splits(0)._ColumnProps(11)=   "Column(1).Order=2"
            Splits(0)._ColumnProps(12)=   "Column(2).Width=847"
            Splits(0)._ColumnProps(13)=   "Column(2).DividerColor=0"
            Splits(0)._ColumnProps(14)=   "Column(2)._WidthInPix=767"
            Splits(0)._ColumnProps(15)=   "Column(2)._EditAlways=0"
            Splits(0)._ColumnProps(16)=   "Column(2).Visible=0"
            Splits(0)._ColumnProps(17)=   "Column(2).Order=3"
            Splits(0)._ColumnProps(18)=   "Column(3).Width=1376"
            Splits(0)._ColumnProps(19)=   "Column(3).DividerColor=0"
            Splits(0)._ColumnProps(20)=   "Column(3)._WidthInPix=1296"
            Splits(0)._ColumnProps(21)=   "Column(3)._EditAlways=0"
            Splits(0)._ColumnProps(22)=   "Column(3).Visible=0"
            Splits(0)._ColumnProps(23)=   "Column(3).Order=4"
            Splits.Count    =   1
            Appearance      =   1
            BorderStyle     =   1
            ComboStyle      =   2
            AutoCompletion  =   0   'False
            LimitToList     =   0   'False
            ColumnHeaders   =   0   'False
            ColumnFooters   =   0   'False
            DataMode        =   5
            DefColWidth     =   0
            Enabled         =   0   'False
            HeadLines       =   1
            FootLines       =   1
            RowDividerStyle =   0
            Caption         =   ""
            EditFont        =   "Size=6.75,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
            LayoutName      =   ""
            LayoutFileName  =   ""
            MultipleLines   =   0
            EmptyRows       =   -1  'True
            CellTips        =   1
            EditHeight      =   299.906
            AutoSize        =   -1  'True
            GapHeight       =   30.047
            ListField       =   ""
            BoundColumn     =   ""
            IntegralHeight  =   0   'False
            CellTipsWidth   =   0
            CellTipsDelay   =   1000
            AutoDropdown    =   -1  'True
            RowTracking     =   -1  'True
            RightToLeft     =   0   'False
            RowMember       =   ""
            MouseIcon       =   0
            MouseIcon.vt    =   3
            MousePointer    =   0
            MatchEntryTimeout=   2000
            OLEDragMode     =   0
            OLEDropMode     =   0
            AnimateWindow   =   0
            AnimateWindowDirection=   0
            AnimateWindowTime=   200
            AnimateWindowClose=   0
            DropdownPosition=   0
            Locked          =   0   'False
            ScrollTrack     =   0   'False
            RowDividerColor =   12632256
            RowSubDividerColor=   12632256
            AddItemSeparator=   ";"
            _PropDict       =   $"frmManAsientosContables.frx":B92B
            _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
            _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
            _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
            _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=825,.italic=0"
            _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
            _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bold=0,.fontsize=675,.italic=0"
            _StyleDefs(7)   =   ":id=1,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(8)   =   ":id=1,.fontname=Arial"
            _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
            _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34"
            _StyleDefs(11)  =   "FooterStyle:id=3,.parent=1,.namedParent=35"
            _StyleDefs(12)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(13)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
            _StyleDefs(14)  =   "EditorStyle:id=7,.parent=1"
            _StyleDefs(15)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
            _StyleDefs(16)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
            _StyleDefs(17)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
            _StyleDefs(18)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
            _StyleDefs(19)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
            _StyleDefs(20)  =   "Splits(0).Style:id=13,.parent=1"
            _StyleDefs(21)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
            _StyleDefs(22)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
            _StyleDefs(23)  =   "Splits(0).FooterStyle:id=15,.parent=3"
            _StyleDefs(24)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
            _StyleDefs(25)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
            _StyleDefs(26)  =   "Splits(0).EditorStyle:id=17,.parent=7"
            _StyleDefs(27)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
            _StyleDefs(28)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
            _StyleDefs(29)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
            _StyleDefs(30)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
            _StyleDefs(31)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
            _StyleDefs(32)  =   "Splits(0).Columns(0).Style:id=46,.parent=13"
            _StyleDefs(33)  =   "Splits(0).Columns(0).HeadingStyle:id=43,.parent=14"
            _StyleDefs(34)  =   "Splits(0).Columns(0).FooterStyle:id=44,.parent=15"
            _StyleDefs(35)  =   "Splits(0).Columns(0).EditorStyle:id=45,.parent=17"
            _StyleDefs(36)  =   "Splits(0).Columns(1).Style:id=50,.parent=13"
            _StyleDefs(37)  =   "Splits(0).Columns(1).HeadingStyle:id=47,.parent=14"
            _StyleDefs(38)  =   "Splits(0).Columns(1).FooterStyle:id=48,.parent=15"
            _StyleDefs(39)  =   "Splits(0).Columns(1).EditorStyle:id=49,.parent=17"
            _StyleDefs(40)  =   "Splits(0).Columns(2).Style:id=28,.parent=13"
            _StyleDefs(41)  =   "Splits(0).Columns(2).HeadingStyle:id=25,.parent=14"
            _StyleDefs(42)  =   "Splits(0).Columns(2).FooterStyle:id=26,.parent=15"
            _StyleDefs(43)  =   "Splits(0).Columns(2).EditorStyle:id=27,.parent=17"
            _StyleDefs(44)  =   "Splits(0).Columns(3).Style:id=32,.parent=13"
            _StyleDefs(45)  =   "Splits(0).Columns(3).HeadingStyle:id=29,.parent=14"
            _StyleDefs(46)  =   "Splits(0).Columns(3).FooterStyle:id=30,.parent=15"
            _StyleDefs(47)  =   "Splits(0).Columns(3).EditorStyle:id=31,.parent=17"
            _StyleDefs(48)  =   "Named:id=33:Normal"
            _StyleDefs(49)  =   ":id=33,.parent=0"
            _StyleDefs(50)  =   "Named:id=34:Heading"
            _StyleDefs(51)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(52)  =   ":id=34,.wraptext=-1"
            _StyleDefs(53)  =   "Named:id=35:Footing"
            _StyleDefs(54)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(55)  =   "Named:id=36:Selected"
            _StyleDefs(56)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(57)  =   "Named:id=37:Caption"
            _StyleDefs(58)  =   ":id=37,.parent=34,.alignment=2"
            _StyleDefs(59)  =   "Named:id=38:HighlightRow"
            _StyleDefs(60)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(61)  =   "Named:id=39:EvenRow"
            _StyleDefs(62)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
            _StyleDefs(63)  =   "Named:id=40:OddRow"
            _StyleDefs(64)  =   ":id=40,.parent=33"
            _StyleDefs(65)  =   "Named:id=41:RecordSelector"
            _StyleDefs(66)  =   ":id=41,.parent=34"
            _StyleDefs(67)  =   "Named:id=42:FilterBar"
            _StyleDefs(68)  =   ":id=42,.parent=33"
         End
         Begin TDBText6Ctl.TDBText tdbtTipDocRef 
            Height          =   285
            Left            =   5760
            TabIndex        =   14
            Tag             =   "enabled"
            ToolTipText     =   " Tipo del documento de referencia "
            Top             =   525
            Width           =   270
            _Version        =   65536
            _ExtentX        =   476
            _ExtentY        =   503
            Caption         =   "frmManAsientosContables.frx":B9B2
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":BA1E
            Key             =   "frmManAsientosContables.frx":BA3C
            BackColor       =   -2147483643
            EditMode        =   0
            ForeColor       =   -2147483640
            ReadOnly        =   0
            ShowContextMenu =   1
            MarginLeft      =   1
            MarginRight     =   1
            MarginTop       =   1
            MarginBottom    =   1
            Enabled         =   0
            MousePointer    =   0
            Appearance      =   1
            BorderStyle     =   1
            AlignHorizontal =   2
            AlignVertical   =   0
            MultiLine       =   0
            ScrollBars      =   0
            PasswordChar    =   ""
            AllowSpace      =   -1
            Format          =   "a"
            FormatMode      =   1
            AutoConvert     =   -1
            ErrorBeep       =   0
            MaxLength       =   2
            LengthAsByte    =   0
            Text            =   "12"
            Furigana        =   0
            HighlightText   =   -1
            IMEMode         =   0
            IMEStatus       =   0
            DropWndWidth    =   0
            DropWndHeight   =   0
            ScrollBarMode   =   0
            MoveOnLRKey     =   0
            OLEDragMode     =   0
            OLEDropMode     =   0
         End
         Begin TrueOleDBList70.TDBCombo tdbcTipoTx 
            Height          =   300
            Left            =   1125
            TabIndex        =   19
            Tag             =   "_"
            Top             =   855
            Width           =   3990
            _ExtentX        =   7038
            _ExtentY        =   529
            _LayoutType     =   4
            _RowHeight      =   -2147483647
            _WasPersistedAsPixels=   0
            _DropdownWidth  =   7064
            Columns(0)._VlistStyle=   0
            Columns(0)._MaxComboItems=   5
            Columns(0).DataField=   ""
            Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(1)._VlistStyle=   0
            Columns(1)._MaxComboItems=   5
            Columns(1).DataField=   ""
            Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(2)._VlistStyle=   0
            Columns(2)._MaxComboItems=   5
            Columns(2).DataField=   ""
            Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(3)._VlistStyle=   0
            Columns(3)._MaxComboItems=   5
            Columns(3).DataField=   ""
            Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(4)._VlistStyle=   0
            Columns(4)._MaxComboItems=   5
            Columns(4).DataField=   ""
            Columns(4)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns.Count   =   5
            Splits(0)._UserFlags=   0
            Splits(0).ExtendRightColumn=   -1  'True
            Splits(0).AllowRowSizing=   0   'False
            Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
            Splits(0)._ColumnProps(0)=   "Columns.Count=5"
            Splits(0)._ColumnProps(1)=   "Column(0).Width=609"
            Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
            Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=529"
            Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
            Splits(0)._ColumnProps(5)=   "Column(0).Visible=0"
            Splits(0)._ColumnProps(6)=   "Column(0).Order=1"
            Splits(0)._ColumnProps(7)=   "Column(1).Width=370"
            Splits(0)._ColumnProps(8)=   "Column(1).DividerColor=0"
            Splits(0)._ColumnProps(9)=   "Column(1)._WidthInPix=291"
            Splits(0)._ColumnProps(10)=   "Column(1)._EditAlways=0"
            Splits(0)._ColumnProps(11)=   "Column(1).Order=2"
            Splits(0)._ColumnProps(12)=   "Column(2).Width=847"
            Splits(0)._ColumnProps(13)=   "Column(2).DividerColor=0"
            Splits(0)._ColumnProps(14)=   "Column(2)._WidthInPix=767"
            Splits(0)._ColumnProps(15)=   "Column(2)._EditAlways=0"
            Splits(0)._ColumnProps(16)=   "Column(2).Visible=0"
            Splits(0)._ColumnProps(17)=   "Column(2).Order=3"
            Splits(0)._ColumnProps(18)=   "Column(3).Width=1376"
            Splits(0)._ColumnProps(19)=   "Column(3).DividerColor=0"
            Splits(0)._ColumnProps(20)=   "Column(3)._WidthInPix=1296"
            Splits(0)._ColumnProps(21)=   "Column(3)._EditAlways=0"
            Splits(0)._ColumnProps(22)=   "Column(3).Visible=0"
            Splits(0)._ColumnProps(23)=   "Column(3).Order=4"
            Splits(0)._ColumnProps(24)=   "Column(4).Width=2196"
            Splits(0)._ColumnProps(25)=   "Column(4).DividerColor=0"
            Splits(0)._ColumnProps(26)=   "Column(4)._WidthInPix=2117"
            Splits(0)._ColumnProps(27)=   "Column(4)._EditAlways=0"
            Splits(0)._ColumnProps(28)=   "Column(4).Visible=0"
            Splits(0)._ColumnProps(29)=   "Column(4).Order=5"
            Splits.Count    =   1
            Appearance      =   1
            BorderStyle     =   1
            ComboStyle      =   2
            AutoCompletion  =   0   'False
            LimitToList     =   0   'False
            ColumnHeaders   =   0   'False
            ColumnFooters   =   0   'False
            DataMode        =   5
            DefColWidth     =   0
            Enabled         =   0   'False
            HeadLines       =   1
            FootLines       =   1
            RowDividerStyle =   0
            Caption         =   ""
            EditFont        =   "Size=6.75,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
            LayoutName      =   ""
            LayoutFileName  =   ""
            MultipleLines   =   0
            EmptyRows       =   -1  'True
            CellTips        =   0
            EditHeight      =   299.906
            AutoSize        =   -1  'True
            GapHeight       =   30.047
            ListField       =   ""
            BoundColumn     =   ""
            IntegralHeight  =   0   'False
            CellTipsWidth   =   0
            CellTipsDelay   =   1000
            AutoDropdown    =   -1  'True
            RowTracking     =   -1  'True
            RightToLeft     =   0   'False
            RowMember       =   ""
            MouseIcon       =   0
            MouseIcon.vt    =   3
            MousePointer    =   0
            MatchEntryTimeout=   2000
            OLEDragMode     =   0
            OLEDropMode     =   0
            AnimateWindow   =   0
            AnimateWindowDirection=   0
            AnimateWindowTime=   200
            AnimateWindowClose=   0
            DropdownPosition=   0
            Locked          =   0   'False
            ScrollTrack     =   0   'False
            RowDividerColor =   12632256
            RowSubDividerColor=   12632256
            AddItemSeparator=   ";"
            _PropDict       =   $"frmManAsientosContables.frx":BA70
            _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
            _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
            _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
            _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=825,.italic=0"
            _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
            _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bold=0,.fontsize=675,.italic=0"
            _StyleDefs(7)   =   ":id=1,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(8)   =   ":id=1,.fontname=Arial"
            _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
            _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34"
            _StyleDefs(11)  =   "FooterStyle:id=3,.parent=1,.namedParent=35"
            _StyleDefs(12)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(13)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
            _StyleDefs(14)  =   "EditorStyle:id=7,.parent=1"
            _StyleDefs(15)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
            _StyleDefs(16)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
            _StyleDefs(17)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
            _StyleDefs(18)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
            _StyleDefs(19)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
            _StyleDefs(20)  =   "Splits(0).Style:id=13,.parent=1"
            _StyleDefs(21)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
            _StyleDefs(22)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
            _StyleDefs(23)  =   "Splits(0).FooterStyle:id=15,.parent=3"
            _StyleDefs(24)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
            _StyleDefs(25)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
            _StyleDefs(26)  =   "Splits(0).EditorStyle:id=17,.parent=7"
            _StyleDefs(27)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
            _StyleDefs(28)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
            _StyleDefs(29)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
            _StyleDefs(30)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
            _StyleDefs(31)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
            _StyleDefs(32)  =   "Splits(0).Columns(0).Style:id=46,.parent=13"
            _StyleDefs(33)  =   "Splits(0).Columns(0).HeadingStyle:id=43,.parent=14"
            _StyleDefs(34)  =   "Splits(0).Columns(0).FooterStyle:id=44,.parent=15"
            _StyleDefs(35)  =   "Splits(0).Columns(0).EditorStyle:id=45,.parent=17"
            _StyleDefs(36)  =   "Splits(0).Columns(1).Style:id=50,.parent=13"
            _StyleDefs(37)  =   "Splits(0).Columns(1).HeadingStyle:id=47,.parent=14"
            _StyleDefs(38)  =   "Splits(0).Columns(1).FooterStyle:id=48,.parent=15"
            _StyleDefs(39)  =   "Splits(0).Columns(1).EditorStyle:id=49,.parent=17"
            _StyleDefs(40)  =   "Splits(0).Columns(2).Style:id=28,.parent=13"
            _StyleDefs(41)  =   "Splits(0).Columns(2).HeadingStyle:id=25,.parent=14"
            _StyleDefs(42)  =   "Splits(0).Columns(2).FooterStyle:id=26,.parent=15"
            _StyleDefs(43)  =   "Splits(0).Columns(2).EditorStyle:id=27,.parent=17"
            _StyleDefs(44)  =   "Splits(0).Columns(3).Style:id=32,.parent=13"
            _StyleDefs(45)  =   "Splits(0).Columns(3).HeadingStyle:id=29,.parent=14"
            _StyleDefs(46)  =   "Splits(0).Columns(3).FooterStyle:id=30,.parent=15"
            _StyleDefs(47)  =   "Splits(0).Columns(3).EditorStyle:id=31,.parent=17"
            _StyleDefs(48)  =   "Splits(0).Columns(4).Style:id=54,.parent=13"
            _StyleDefs(49)  =   "Splits(0).Columns(4).HeadingStyle:id=51,.parent=14"
            _StyleDefs(50)  =   "Splits(0).Columns(4).FooterStyle:id=52,.parent=15"
            _StyleDefs(51)  =   "Splits(0).Columns(4).EditorStyle:id=53,.parent=17"
            _StyleDefs(52)  =   "Named:id=33:Normal"
            _StyleDefs(53)  =   ":id=33,.parent=0"
            _StyleDefs(54)  =   "Named:id=34:Heading"
            _StyleDefs(55)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(56)  =   ":id=34,.wraptext=-1"
            _StyleDefs(57)  =   "Named:id=35:Footing"
            _StyleDefs(58)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(59)  =   "Named:id=36:Selected"
            _StyleDefs(60)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(61)  =   "Named:id=37:Caption"
            _StyleDefs(62)  =   ":id=37,.parent=34,.alignment=2"
            _StyleDefs(63)  =   "Named:id=38:HighlightRow"
            _StyleDefs(64)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(65)  =   "Named:id=39:EvenRow"
            _StyleDefs(66)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
            _StyleDefs(67)  =   "Named:id=40:OddRow"
            _StyleDefs(68)  =   ":id=40,.parent=33"
            _StyleDefs(69)  =   "Named:id=41:RecordSelector"
            _StyleDefs(70)  =   ":id=41,.parent=34"
            _StyleDefs(71)  =   "Named:id=42:FilterBar"
            _StyleDefs(72)  =   ":id=42,.parent=33"
         End
         Begin TDBText6Ctl.TDBText tdbtComprobante 
            Height          =   285
            Left            =   6210
            TabIndex        =   84
            Tag             =   "enabled"
            ToolTipText     =   " Número de comprobante de pago emitido por sujeto no domiciliado "
            Top             =   855
            Width           =   990
            _Version        =   65536
            _ExtentX        =   1746
            _ExtentY        =   503
            Caption         =   "frmManAsientosContables.frx":BAF7
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":BB63
            Key             =   "frmManAsientosContables.frx":BB81
            BackColor       =   -2147483643
            EditMode        =   0
            ForeColor       =   -2147483640
            ReadOnly        =   0
            ShowContextMenu =   1
            MarginLeft      =   1
            MarginRight     =   1
            MarginTop       =   1
            MarginBottom    =   1
            Enabled         =   0
            MousePointer    =   0
            Appearance      =   1
            BorderStyle     =   1
            AlignHorizontal =   0
            AlignVertical   =   0
            MultiLine       =   0
            ScrollBars      =   0
            PasswordChar    =   ""
            AllowSpace      =   -1
            Format          =   "a@"
            FormatMode      =   1
            AutoConvert     =   -1
            ErrorBeep       =   0
            MaxLength       =   10
            LengthAsByte    =   0
            Text            =   "1234567890"
            Furigana        =   0
            HighlightText   =   -1
            IMEMode         =   0
            IMEStatus       =   0
            DropWndWidth    =   0
            DropWndHeight   =   0
            ScrollBarMode   =   0
            MoveOnLRKey     =   0
            OLEDragMode     =   0
            OLEDropMode     =   0
         End
         Begin TrueOleDBList70.TDBCombo tdbcProceso 
            Height          =   300
            Left            =   6345
            TabIndex        =   87
            Tag             =   "_"
            ToolTipText     =   " Proceso  en el Registro de costos "
            Top             =   135
            Width           =   2070
            _ExtentX        =   3651
            _ExtentY        =   529
            _LayoutType     =   4
            _RowHeight      =   -2147483647
            _WasPersistedAsPixels=   0
            _DropdownWidth  =   6879
            Columns(0)._VlistStyle=   0
            Columns(0)._MaxComboItems=   5
            Columns(0).DataField=   ""
            Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(1)._VlistStyle=   0
            Columns(1)._MaxComboItems=   5
            Columns(1).DataField=   ""
            Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(2)._VlistStyle=   0
            Columns(2)._MaxComboItems=   5
            Columns(2).DataField=   ""
            Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(3)._VlistStyle=   0
            Columns(3)._MaxComboItems=   5
            Columns(3).DataField=   ""
            Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(4)._VlistStyle=   0
            Columns(4)._MaxComboItems=   5
            Columns(4).DataField=   ""
            Columns(4)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns.Count   =   5
            Splits(0)._UserFlags=   0
            Splits(0).ExtendRightColumn=   -1  'True
            Splits(0).AllowRowSizing=   0   'False
            Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
            Splits(0)._ColumnProps(0)=   "Columns.Count=5"
            Splits(0)._ColumnProps(1)=   "Column(0).Width=609"
            Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
            Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=529"
            Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
            Splits(0)._ColumnProps(5)=   "Column(0).Visible=0"
            Splits(0)._ColumnProps(6)=   "Column(0).Order=1"
            Splits(0)._ColumnProps(7)=   "Column(1).Width=370"
            Splits(0)._ColumnProps(8)=   "Column(1).DividerColor=0"
            Splits(0)._ColumnProps(9)=   "Column(1)._WidthInPix=291"
            Splits(0)._ColumnProps(10)=   "Column(1)._EditAlways=0"
            Splits(0)._ColumnProps(11)=   "Column(1).Order=2"
            Splits(0)._ColumnProps(12)=   "Column(2).Width=847"
            Splits(0)._ColumnProps(13)=   "Column(2).DividerColor=0"
            Splits(0)._ColumnProps(14)=   "Column(2)._WidthInPix=767"
            Splits(0)._ColumnProps(15)=   "Column(2)._EditAlways=0"
            Splits(0)._ColumnProps(16)=   "Column(2).Visible=0"
            Splits(0)._ColumnProps(17)=   "Column(2).Order=3"
            Splits(0)._ColumnProps(18)=   "Column(3).Width=1376"
            Splits(0)._ColumnProps(19)=   "Column(3).DividerColor=0"
            Splits(0)._ColumnProps(20)=   "Column(3)._WidthInPix=1296"
            Splits(0)._ColumnProps(21)=   "Column(3)._EditAlways=0"
            Splits(0)._ColumnProps(22)=   "Column(3).Visible=0"
            Splits(0)._ColumnProps(23)=   "Column(3).Order=4"
            Splits(0)._ColumnProps(24)=   "Column(4).Width=2196"
            Splits(0)._ColumnProps(25)=   "Column(4).DividerColor=0"
            Splits(0)._ColumnProps(26)=   "Column(4)._WidthInPix=2117"
            Splits(0)._ColumnProps(27)=   "Column(4)._EditAlways=0"
            Splits(0)._ColumnProps(28)=   "Column(4).Visible=0"
            Splits(0)._ColumnProps(29)=   "Column(4).Order=5"
            Splits.Count    =   1
            Appearance      =   1
            BorderStyle     =   1
            ComboStyle      =   2
            AutoCompletion  =   0   'False
            LimitToList     =   0   'False
            ColumnHeaders   =   0   'False
            ColumnFooters   =   0   'False
            DataMode        =   5
            DefColWidth     =   0
            Enabled         =   0   'False
            HeadLines       =   1
            FootLines       =   1
            RowDividerStyle =   0
            Caption         =   ""
            EditFont        =   "Size=6.75,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
            LayoutName      =   ""
            LayoutFileName  =   ""
            MultipleLines   =   0
            EmptyRows       =   -1  'True
            CellTips        =   1
            EditHeight      =   299.906
            AutoSize        =   -1  'True
            GapHeight       =   30.047
            ListField       =   ""
            BoundColumn     =   ""
            IntegralHeight  =   0   'False
            CellTipsWidth   =   0
            CellTipsDelay   =   1000
            AutoDropdown    =   -1  'True
            RowTracking     =   -1  'True
            RightToLeft     =   0   'False
            RowMember       =   ""
            MouseIcon       =   0
            MouseIcon.vt    =   3
            MousePointer    =   0
            MatchEntryTimeout=   2000
            OLEDragMode     =   0
            OLEDropMode     =   0
            AnimateWindow   =   0
            AnimateWindowDirection=   0
            AnimateWindowTime=   200
            AnimateWindowClose=   0
            DropdownPosition=   0
            Locked          =   0   'False
            ScrollTrack     =   0   'False
            RowDividerColor =   12632256
            RowSubDividerColor=   12632256
            AddItemSeparator=   ";"
            _PropDict       =   $"frmManAsientosContables.frx":BBB5
            _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
            _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
            _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
            _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=825,.italic=0"
            _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
            _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bold=0,.fontsize=675,.italic=0"
            _StyleDefs(7)   =   ":id=1,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(8)   =   ":id=1,.fontname=Arial"
            _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
            _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34"
            _StyleDefs(11)  =   "FooterStyle:id=3,.parent=1,.namedParent=35"
            _StyleDefs(12)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(13)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
            _StyleDefs(14)  =   "EditorStyle:id=7,.parent=1"
            _StyleDefs(15)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
            _StyleDefs(16)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
            _StyleDefs(17)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
            _StyleDefs(18)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
            _StyleDefs(19)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
            _StyleDefs(20)  =   "Splits(0).Style:id=13,.parent=1"
            _StyleDefs(21)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
            _StyleDefs(22)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
            _StyleDefs(23)  =   "Splits(0).FooterStyle:id=15,.parent=3"
            _StyleDefs(24)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
            _StyleDefs(25)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
            _StyleDefs(26)  =   "Splits(0).EditorStyle:id=17,.parent=7"
            _StyleDefs(27)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
            _StyleDefs(28)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
            _StyleDefs(29)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
            _StyleDefs(30)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
            _StyleDefs(31)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
            _StyleDefs(32)  =   "Splits(0).Columns(0).Style:id=46,.parent=13"
            _StyleDefs(33)  =   "Splits(0).Columns(0).HeadingStyle:id=43,.parent=14"
            _StyleDefs(34)  =   "Splits(0).Columns(0).FooterStyle:id=44,.parent=15"
            _StyleDefs(35)  =   "Splits(0).Columns(0).EditorStyle:id=45,.parent=17"
            _StyleDefs(36)  =   "Splits(0).Columns(1).Style:id=50,.parent=13"
            _StyleDefs(37)  =   "Splits(0).Columns(1).HeadingStyle:id=47,.parent=14"
            _StyleDefs(38)  =   "Splits(0).Columns(1).FooterStyle:id=48,.parent=15"
            _StyleDefs(39)  =   "Splits(0).Columns(1).EditorStyle:id=49,.parent=17"
            _StyleDefs(40)  =   "Splits(0).Columns(2).Style:id=28,.parent=13"
            _StyleDefs(41)  =   "Splits(0).Columns(2).HeadingStyle:id=25,.parent=14"
            _StyleDefs(42)  =   "Splits(0).Columns(2).FooterStyle:id=26,.parent=15"
            _StyleDefs(43)  =   "Splits(0).Columns(2).EditorStyle:id=27,.parent=17"
            _StyleDefs(44)  =   "Splits(0).Columns(3).Style:id=32,.parent=13"
            _StyleDefs(45)  =   "Splits(0).Columns(3).HeadingStyle:id=29,.parent=14"
            _StyleDefs(46)  =   "Splits(0).Columns(3).FooterStyle:id=30,.parent=15"
            _StyleDefs(47)  =   "Splits(0).Columns(3).EditorStyle:id=31,.parent=17"
            _StyleDefs(48)  =   "Splits(0).Columns(4).Style:id=54,.parent=13"
            _StyleDefs(49)  =   "Splits(0).Columns(4).HeadingStyle:id=51,.parent=14"
            _StyleDefs(50)  =   "Splits(0).Columns(4).FooterStyle:id=52,.parent=15"
            _StyleDefs(51)  =   "Splits(0).Columns(4).EditorStyle:id=53,.parent=17"
            _StyleDefs(52)  =   "Named:id=33:Normal"
            _StyleDefs(53)  =   ":id=33,.parent=0"
            _StyleDefs(54)  =   "Named:id=34:Heading"
            _StyleDefs(55)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(56)  =   ":id=34,.wraptext=-1"
            _StyleDefs(57)  =   "Named:id=35:Footing"
            _StyleDefs(58)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(59)  =   "Named:id=36:Selected"
            _StyleDefs(60)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(61)  =   "Named:id=37:Caption"
            _StyleDefs(62)  =   ":id=37,.parent=34,.alignment=2"
            _StyleDefs(63)  =   "Named:id=38:HighlightRow"
            _StyleDefs(64)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(65)  =   "Named:id=39:EvenRow"
            _StyleDefs(66)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
            _StyleDefs(67)  =   "Named:id=40:OddRow"
            _StyleDefs(68)  =   ":id=40,.parent=33"
            _StyleDefs(69)  =   "Named:id=41:RecordSelector"
            _StyleDefs(70)  =   ":id=41,.parent=34"
            _StyleDefs(71)  =   "Named:id=42:FilterBar"
            _StyleDefs(72)  =   ":id=42,.parent=33"
         End
         Begin TrueOleDBList70.TDBCombo tdbcBaseImponible 
            Height          =   300
            Left            =   9000
            TabIndex        =   12
            Tag             =   "_"
            ToolTipText     =   " Tipo de Base "
            Top             =   135
            Width           =   2295
            _ExtentX        =   4048
            _ExtentY        =   529
            _LayoutType     =   4
            _RowHeight      =   -2147483647
            _WasPersistedAsPixels=   0
            _DropdownWidth  =   5741
            Columns(0)._VlistStyle=   0
            Columns(0)._MaxComboItems=   5
            Columns(0).DataField=   ""
            Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(1)._VlistStyle=   0
            Columns(1)._MaxComboItems=   5
            Columns(1).DataField=   ""
            Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(2)._VlistStyle=   0
            Columns(2)._MaxComboItems=   5
            Columns(2).DataField=   ""
            Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(3)._VlistStyle=   0
            Columns(3)._MaxComboItems=   5
            Columns(3).DataField=   ""
            Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(4)._VlistStyle=   0
            Columns(4)._MaxComboItems=   5
            Columns(4).DataField=   ""
            Columns(4)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns.Count   =   5
            Splits(0)._UserFlags=   0
            Splits(0).ExtendRightColumn=   -1  'True
            Splits(0).AllowRowSizing=   0   'False
            Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
            Splits(0)._ColumnProps(0)=   "Columns.Count=5"
            Splits(0)._ColumnProps(1)=   "Column(0).Width=609"
            Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
            Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=529"
            Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
            Splits(0)._ColumnProps(5)=   "Column(0).Visible=0"
            Splits(0)._ColumnProps(6)=   "Column(0).Order=1"
            Splits(0)._ColumnProps(7)=   "Column(1).Width=370"
            Splits(0)._ColumnProps(8)=   "Column(1).DividerColor=0"
            Splits(0)._ColumnProps(9)=   "Column(1)._WidthInPix=291"
            Splits(0)._ColumnProps(10)=   "Column(1)._EditAlways=0"
            Splits(0)._ColumnProps(11)=   "Column(1).Order=2"
            Splits(0)._ColumnProps(12)=   "Column(2).Width=847"
            Splits(0)._ColumnProps(13)=   "Column(2).DividerColor=0"
            Splits(0)._ColumnProps(14)=   "Column(2)._WidthInPix=767"
            Splits(0)._ColumnProps(15)=   "Column(2)._EditAlways=0"
            Splits(0)._ColumnProps(16)=   "Column(2).Visible=0"
            Splits(0)._ColumnProps(17)=   "Column(2).Order=3"
            Splits(0)._ColumnProps(18)=   "Column(3).Width=1376"
            Splits(0)._ColumnProps(19)=   "Column(3).DividerColor=0"
            Splits(0)._ColumnProps(20)=   "Column(3)._WidthInPix=1296"
            Splits(0)._ColumnProps(21)=   "Column(3)._EditAlways=0"
            Splits(0)._ColumnProps(22)=   "Column(3).Visible=0"
            Splits(0)._ColumnProps(23)=   "Column(3).Order=4"
            Splits(0)._ColumnProps(24)=   "Column(4).Width=2196"
            Splits(0)._ColumnProps(25)=   "Column(4).DividerColor=0"
            Splits(0)._ColumnProps(26)=   "Column(4)._WidthInPix=2117"
            Splits(0)._ColumnProps(27)=   "Column(4)._EditAlways=0"
            Splits(0)._ColumnProps(28)=   "Column(4).Visible=0"
            Splits(0)._ColumnProps(29)=   "Column(4).Order=5"
            Splits.Count    =   1
            Appearance      =   1
            BorderStyle     =   1
            ComboStyle      =   2
            AutoCompletion  =   0   'False
            LimitToList     =   0   'False
            ColumnHeaders   =   0   'False
            ColumnFooters   =   0   'False
            DataMode        =   5
            DefColWidth     =   0
            Enabled         =   0   'False
            HeadLines       =   1
            FootLines       =   1
            RowDividerStyle =   0
            Caption         =   ""
            EditFont        =   "Size=6.75,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
            LayoutName      =   ""
            LayoutFileName  =   ""
            MultipleLines   =   0
            EmptyRows       =   -1  'True
            CellTips        =   1
            EditHeight      =   299.906
            AutoSize        =   -1  'True
            GapHeight       =   30.047
            ListField       =   ""
            BoundColumn     =   ""
            IntegralHeight  =   0   'False
            CellTipsWidth   =   0
            CellTipsDelay   =   1000
            AutoDropdown    =   -1  'True
            RowTracking     =   -1  'True
            RightToLeft     =   0   'False
            RowMember       =   ""
            MouseIcon       =   0
            MouseIcon.vt    =   3
            MousePointer    =   0
            MatchEntryTimeout=   2000
            OLEDragMode     =   0
            OLEDropMode     =   0
            AnimateWindow   =   0
            AnimateWindowDirection=   0
            AnimateWindowTime=   200
            AnimateWindowClose=   0
            DropdownPosition=   3
            Locked          =   0   'False
            ScrollTrack     =   0   'False
            RowDividerColor =   12632256
            RowSubDividerColor=   12632256
            MaxComboItems   =   6
            AddItemSeparator=   ";"
            _PropDict       =   $"frmManAsientosContables.frx":BC3C
            _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
            _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
            _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
            _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=825,.italic=0"
            _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
            _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bold=0,.fontsize=675,.italic=0"
            _StyleDefs(7)   =   ":id=1,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(8)   =   ":id=1,.fontname=Arial"
            _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
            _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34"
            _StyleDefs(11)  =   "FooterStyle:id=3,.parent=1,.namedParent=35"
            _StyleDefs(12)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(13)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
            _StyleDefs(14)  =   "EditorStyle:id=7,.parent=1"
            _StyleDefs(15)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
            _StyleDefs(16)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
            _StyleDefs(17)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
            _StyleDefs(18)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
            _StyleDefs(19)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
            _StyleDefs(20)  =   "Splits(0).Style:id=13,.parent=1"
            _StyleDefs(21)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
            _StyleDefs(22)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
            _StyleDefs(23)  =   "Splits(0).FooterStyle:id=15,.parent=3"
            _StyleDefs(24)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
            _StyleDefs(25)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
            _StyleDefs(26)  =   "Splits(0).EditorStyle:id=17,.parent=7"
            _StyleDefs(27)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
            _StyleDefs(28)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
            _StyleDefs(29)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
            _StyleDefs(30)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
            _StyleDefs(31)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
            _StyleDefs(32)  =   "Splits(0).Columns(0).Style:id=46,.parent=13"
            _StyleDefs(33)  =   "Splits(0).Columns(0).HeadingStyle:id=43,.parent=14"
            _StyleDefs(34)  =   "Splits(0).Columns(0).FooterStyle:id=44,.parent=15"
            _StyleDefs(35)  =   "Splits(0).Columns(0).EditorStyle:id=45,.parent=17"
            _StyleDefs(36)  =   "Splits(0).Columns(1).Style:id=50,.parent=13"
            _StyleDefs(37)  =   "Splits(0).Columns(1).HeadingStyle:id=47,.parent=14"
            _StyleDefs(38)  =   "Splits(0).Columns(1).FooterStyle:id=48,.parent=15"
            _StyleDefs(39)  =   "Splits(0).Columns(1).EditorStyle:id=49,.parent=17"
            _StyleDefs(40)  =   "Splits(0).Columns(2).Style:id=28,.parent=13"
            _StyleDefs(41)  =   "Splits(0).Columns(2).HeadingStyle:id=25,.parent=14"
            _StyleDefs(42)  =   "Splits(0).Columns(2).FooterStyle:id=26,.parent=15"
            _StyleDefs(43)  =   "Splits(0).Columns(2).EditorStyle:id=27,.parent=17"
            _StyleDefs(44)  =   "Splits(0).Columns(3).Style:id=32,.parent=13"
            _StyleDefs(45)  =   "Splits(0).Columns(3).HeadingStyle:id=29,.parent=14"
            _StyleDefs(46)  =   "Splits(0).Columns(3).FooterStyle:id=30,.parent=15"
            _StyleDefs(47)  =   "Splits(0).Columns(3).EditorStyle:id=31,.parent=17"
            _StyleDefs(48)  =   "Splits(0).Columns(4).Style:id=54,.parent=13"
            _StyleDefs(49)  =   "Splits(0).Columns(4).HeadingStyle:id=51,.parent=14"
            _StyleDefs(50)  =   "Splits(0).Columns(4).FooterStyle:id=52,.parent=15"
            _StyleDefs(51)  =   "Splits(0).Columns(4).EditorStyle:id=53,.parent=17"
            _StyleDefs(52)  =   "Named:id=33:Normal"
            _StyleDefs(53)  =   ":id=33,.parent=0"
            _StyleDefs(54)  =   "Named:id=34:Heading"
            _StyleDefs(55)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(56)  =   ":id=34,.wraptext=-1"
            _StyleDefs(57)  =   "Named:id=35:Footing"
            _StyleDefs(58)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(59)  =   "Named:id=36:Selected"
            _StyleDefs(60)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(61)  =   "Named:id=37:Caption"
            _StyleDefs(62)  =   ":id=37,.parent=34,.alignment=2"
            _StyleDefs(63)  =   "Named:id=38:HighlightRow"
            _StyleDefs(64)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(65)  =   "Named:id=39:EvenRow"
            _StyleDefs(66)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
            _StyleDefs(67)  =   "Named:id=40:OddRow"
            _StyleDefs(68)  =   ":id=40,.parent=33"
            _StyleDefs(69)  =   "Named:id=41:RecordSelector"
            _StyleDefs(70)  =   ":id=41,.parent=34"
            _StyleDefs(71)  =   "Named:id=42:FilterBar"
            _StyleDefs(72)  =   ":id=42,.parent=33"
         End
         Begin TDBNumber6Ctl.TDBNumber tdbtMonedaAdic 
            Height          =   270
            Left            =   6230
            TabIndex        =   18
            Top             =   850
            Width           =   990
            _Version        =   65536
            _ExtentX        =   1746
            _ExtentY        =   476
            Calculator      =   "frmManAsientosContables.frx":BCC3
            Caption         =   "frmManAsientosContables.frx":BCE3
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":BD47
            Keys            =   "frmManAsientosContables.frx":BD65
            Spin            =   "frmManAsientosContables.frx":BD9F
            AlignHorizontal =   1
            AlignVertical   =   2
            Appearance      =   0
            BackColor       =   12648447
            BorderStyle     =   0
            BtnPositioning  =   0
            ClipMode        =   0
            ClearAction     =   0
            DecimalPoint    =   "."
            DisplayFormat   =   "###,###,##0.00"
            EditMode        =   0
            Enabled         =   -1
            ErrorBeep       =   1
            ForeColor       =   0
            Format          =   "####0"
            HighlightText   =   1
            MarginBottom    =   1
            MarginLeft      =   1
            MarginRight     =   1
            MarginTop       =   1
            MaxValue        =   999999999
            MinValue        =   0
            MousePointer    =   0
            MoveOnLRKey     =   0
            NegativeColor   =   255
            OLEDragMode     =   0
            OLEDropMode     =   0
            ReadOnly        =   0
            Separator       =   ","
            ShowContextMenu =   1
            ValueVT         =   2424833
            Value           =   0
            MaxValueVT      =   5
            MinValueVT      =   5
         End
         Begin VB.PictureBox pctValorEmB 
            Appearance      =   0  'Flat
            BackColor       =   &H00C0FFFF&
            ForeColor       =   &H80000008&
            Height          =   315
            Left            =   6200
            ScaleHeight     =   285
            ScaleWidth      =   1005
            TabIndex        =   150
            Top             =   840
            Width           =   1035
         End
         Begin VB.Label lblValorEmb 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "Valor Emb.:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Left            =   5160
            TabIndex        =   147
            Top             =   900
            Width           =   930
         End
         Begin VB.Label Label6 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "Proc :"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Left            =   5850
            TabIndex        =   86
            ToolTipText     =   " Proceso "
            Top             =   180
            Width           =   465
         End
         Begin VB.Label lblComp 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "Nro.Comp:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Left            =   5220
            TabIndex        =   85
            Top             =   900
            Width           =   870
         End
         Begin VB.Label lblTipoTx 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "Transacción"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Left            =   45
            TabIndex        =   67
            Top             =   900
            Width           =   1005
         End
         Begin VB.Label lblBaseImponible 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "Base :"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Left            =   8460
            TabIndex        =   66
            ToolTipText     =   " Tipo  de Base "
            Top             =   180
            Width           =   495
         End
         Begin VB.Line Line1 
            BorderColor     =   &H00808080&
            X1              =   0
            X2              =   11385
            Y1              =   450
            Y2              =   450
         End
         Begin VB.Label Label21 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "Número:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Index           =   1
            Left            =   7290
            TabIndex        =   65
            Top             =   555
            Width           =   705
         End
         Begin VB.Label Label22 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "Fecha Doc:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Left            =   9135
            TabIndex        =   60
            Top             =   555
            Width           =   870
         End
         Begin VB.Label Label21 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "Serie:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Index           =   0
            Left            =   6120
            TabIndex        =   59
            Top             =   555
            Width           =   480
         End
         Begin VB.Label Label19 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "Fecha Dep:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Left            =   9135
            TabIndex        =   58
            Top             =   900
            Width           =   885
         End
         Begin VB.Label Label18 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "Doc. Dep:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Left            =   7290
            TabIndex        =   57
            Top             =   900
            Width           =   750
         End
         Begin VB.Label Label17 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "Sistema/Regimen"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Left            =   75
            TabIndex        =   56
            Top             =   555
            Width           =   1455
         End
         Begin VB.Label Label16 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "Doc. Ref :"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Left            =   4950
            TabIndex        =   55
            Top             =   555
            Width           =   750
         End
         Begin VB.Label Label14 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "Glosa :"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   210
            Left            =   75
            TabIndex        =   54
            Top             =   150
            Width           =   555
         End
      End
      Begin VB.Frame fra03 
         BackColor       =   &H00FFFFFF&
         Height          =   885
         Left            =   45
         TabIndex        =   68
         Top             =   5220
         Width           =   12000
         Begin TDBNumber6Ctl.TDBNumber tdbnDiferenciaME 
            Height          =   300
            Left            =   3240
            TabIndex        =   69
            Top             =   225
            Width           =   1380
            _Version        =   65536
            _ExtentX        =   2434
            _ExtentY        =   529
            Calculator      =   "frmManAsientosContables.frx":BDC7
            Caption         =   "frmManAsientosContables.frx":BDE7
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":BE4B
            Keys            =   "frmManAsientosContables.frx":BE69
            Spin            =   "frmManAsientosContables.frx":BEA3
            AlignHorizontal =   1
            AlignVertical   =   2
            Appearance      =   0
            BackColor       =   0
            BorderStyle     =   1
            BtnPositioning  =   0
            ClipMode        =   0
            ClearAction     =   0
            DecimalPoint    =   "."
            DisplayFormat   =   "###,###,###,##0.00"
            EditMode        =   0
            Enabled         =   -1
            ErrorBeep       =   0
            ForeColor       =   65535
            Format          =   "###,###,###,##0.00"
            HighlightText   =   1
            MarginBottom    =   1
            MarginLeft      =   1
            MarginRight     =   3
            MarginTop       =   1
            MaxValue        =   999999999999
            MinValue        =   -999999999999
            MousePointer    =   0
            MoveOnLRKey     =   0
            NegativeColor   =   255
            OLEDragMode     =   0
            OLEDropMode     =   0
            ReadOnly        =   1
            Separator       =   ","
            ShowContextMenu =   1
            ValueVT         =   1769473
            Value           =   0
            MaxValueVT      =   5
            MinValueVT      =   5
         End
         Begin TDBNumber6Ctl.TDBNumber tdbnDiferenciaMN 
            Height          =   300
            Left            =   1350
            TabIndex        =   70
            Top             =   225
            Width           =   1380
            _Version        =   65536
            _ExtentX        =   2434
            _ExtentY        =   529
            Calculator      =   "frmManAsientosContables.frx":BECB
            Caption         =   "frmManAsientosContables.frx":BEEB
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":BF4F
            Keys            =   "frmManAsientosContables.frx":BF6D
            Spin            =   "frmManAsientosContables.frx":BFA7
            AlignHorizontal =   1
            AlignVertical   =   2
            Appearance      =   0
            BackColor       =   0
            BorderStyle     =   1
            BtnPositioning  =   0
            ClipMode        =   0
            ClearAction     =   0
            DecimalPoint    =   "."
            DisplayFormat   =   "###,###,###,##0.00"
            EditMode        =   0
            Enabled         =   -1
            ErrorBeep       =   0
            ForeColor       =   65535
            Format          =   "###,###,###,##0.00"
            HighlightText   =   1
            MarginBottom    =   1
            MarginLeft      =   1
            MarginRight     =   3
            MarginTop       =   1
            MaxValue        =   999999999999
            MinValue        =   -999999999999
            MousePointer    =   0
            MoveOnLRKey     =   0
            NegativeColor   =   255
            OLEDragMode     =   0
            OLEDropMode     =   0
            ReadOnly        =   1
            Separator       =   ","
            ShowContextMenu =   1
            ValueVT         =   1769473
            Value           =   0
            MaxValueVT      =   5
            MinValueVT      =   5
         End
         Begin VB.Label Label8 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "F8"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H000000FF&
            Height          =   195
            Index           =   0
            Left            =   1320
            TabIndex        =   104
            Top             =   630
            Width           =   240
         End
         Begin VB.Label Label13 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "F11"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H000000FF&
            Height          =   195
            Index           =   0
            Left            =   7560
            TabIndex        =   103
            Top             =   630
            Width           =   360
         End
         Begin VB.Label Label13 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "F12"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H000000FF&
            Height          =   195
            Index           =   1
            Left            =   9600
            TabIndex        =   102
            Top             =   630
            Width           =   360
         End
         Begin VB.Label Label13 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "- Repetir Ant."
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00C00000&
            Height          =   195
            Index           =   3
            Left            =   9960
            TabIndex        =   101
            Top             =   630
            Width           =   1305
         End
         Begin VB.Label Label13 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "- Repetir Todo"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00C00000&
            Height          =   195
            Index           =   4
            Left            =   7920
            TabIndex        =   100
            Top             =   630
            Width           =   1395
         End
         Begin VB.Label Label8 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "- Asientos Tipo"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00C00000&
            Height          =   195
            Index           =   1
            Left            =   1560
            TabIndex        =   99
            Top             =   630
            Width           =   1470
         End
         Begin VB.Label Label8 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "- Igv Automático"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00C00000&
            Height          =   195
            Index           =   2
            Left            =   3720
            TabIndex        =   98
            Top             =   630
            Width           =   1650
         End
         Begin VB.Label Label8 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "F9"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H000000FF&
            Height          =   195
            Index           =   3
            Left            =   3480
            TabIndex        =   97
            Top             =   630
            Width           =   240
         End
         Begin VB.Label Label8 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "F10"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H000000FF&
            Height          =   195
            Index           =   4
            Left            =   5520
            TabIndex        =   96
            Top             =   630
            Width           =   405
         End
         Begin VB.Label Label8 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "- Copia Acum."
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00C00000&
            Height          =   195
            Index           =   5
            Left            =   5880
            TabIndex        =   95
            Top             =   630
            Width           =   1350
         End
         Begin VB.Label Label8 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "F1"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H000000FF&
            Height          =   195
            Index           =   6
            Left            =   45
            TabIndex        =   94
            Top             =   630
            Width           =   240
         End
         Begin VB.Label Label8 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "- Ayuda"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00C00000&
            Height          =   195
            Index           =   7
            Left            =   285
            TabIndex        =   93
            Top             =   630
            Width           =   765
         End
         Begin MSForms.CommandButton cmdEliminaItem 
            Height          =   390
            Left            =   4725
            TabIndex        =   92
            ToolTipText     =   "Elimina la fila seleccionada"
            Top             =   225
            Width           =   1305
            Caption         =   " Eliminar"
            PicturePosition =   327683
            Size            =   "2302;688"
            FontHeight      =   165
            FontCharSet     =   0
            FontPitchAndFamily=   2
            ParagraphAlign  =   3
         End
         Begin MSForms.CommandButton cmdCancelaciones 
            Height          =   390
            Left            =   6030
            TabIndex        =   91
            ToolTipText     =   "Cancelar proviciones ingresadas"
            Top             =   225
            Width           =   1305
            Caption         =   " Provisiones"
            PicturePosition =   327683
            Size            =   "2302;688"
            FontHeight      =   165
            FontCharSet     =   0
            FontPitchAndFamily=   2
            ParagraphAlign  =   3
         End
         Begin MSForms.CommandButton cmdTipoAsiento 
            Height          =   390
            Left            =   7350
            TabIndex        =   90
            ToolTipText     =   "Ingresar asientos contables predefinidos"
            Top             =   225
            Width           =   1305
            Caption         =   " Asientos"
            PicturePosition =   327683
            Size            =   "2302;688"
            FontHeight      =   165
            FontCharSet     =   0
            FontPitchAndFamily=   2
            ParagraphAlign  =   3
         End
         Begin MSForms.CommandButton cmdGenerarDifCambio 
            Height          =   390
            Left            =   8640
            TabIndex        =   89
            ToolTipText     =   "Verifica el asiento ingresado"
            Top             =   225
            Width           =   1305
            Caption         =   " Verifica"
            PicturePosition =   327683
            Size            =   "2302;688"
            FontHeight      =   165
            FontCharSet     =   0
            FontPitchAndFamily=   2
            ParagraphAlign  =   3
         End
         Begin MSForms.CommandButton cmdCrearEntidad 
            Height          =   390
            Left            =   9945
            TabIndex        =   88
            ToolTipText     =   "Permite ingresar o actualizar el maestro de entidades"
            Top             =   225
            Width           =   1305
            Caption         =   " Entidad"
            PicturePosition =   327683
            Size            =   "2302;688"
            FontHeight      =   165
            FontCharSet     =   0
            FontPitchAndFamily=   2
            ParagraphAlign  =   3
         End
         Begin VB.Label Label13 
            BackColor       =   &H00000000&
            Caption         =   " MN"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   210
            Index           =   5
            Left            =   945
            TabIndex        =   71
            Top             =   270
            Width           =   435
         End
         Begin VB.Label Label13 
            BackColor       =   &H00000000&
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   300
            Index           =   7
            Left            =   900
            TabIndex        =   74
            Top             =   225
            Width           =   480
         End
         Begin VB.Label Label13 
            AutoSize        =   -1  'True
            BackStyle       =   0  'Transparent
            Caption         =   "Difer:"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   195
            Index           =   2
            Left            =   60
            TabIndex        =   73
            Top             =   270
            Width           =   540
         End
         Begin VB.Label Label13 
            BackColor       =   &H00000000&
            Caption         =   " ME"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   210
            Index           =   6
            Left            =   2835
            TabIndex        =   72
            Top             =   270
            Width           =   435
         End
         Begin VB.Label Label13 
            BackColor       =   &H00000000&
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   300
            Index           =   8
            Left            =   2790
            TabIndex        =   75
            Top             =   225
            Width           =   480
         End
      End
      Begin TDBNumber6Ctl.TDBNumber tdbtCambio 
         Height          =   375
         Left            =   5280
         TabIndex        =   33
         Top             =   6255
         Visible         =   0   'False
         Width           =   735
         _Version        =   65536
         _ExtentX        =   1296
         _ExtentY        =   661
         Calculator      =   "frmManAsientosContables.frx":BFCF
         Caption         =   "frmManAsientosContables.frx":BFEF
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         DropDown        =   "frmManAsientosContables.frx":C053
         Keys            =   "frmManAsientosContables.frx":C071
         Spin            =   "frmManAsientosContables.frx":C0AB
         AlignHorizontal =   1
         AlignVertical   =   0
         Appearance      =   1
         BackColor       =   16777215
         BorderStyle     =   0
         BtnPositioning  =   0
         ClipMode        =   0
         ClearAction     =   0
         DecimalPoint    =   "."
         DisplayFormat   =   "###,##0.000"
         EditMode        =   0
         Enabled         =   -1
         ErrorBeep       =   0
         ForeColor       =   -2147483640
         Format          =   "###,##0.000"
         HighlightText   =   1
         MarginBottom    =   1
         MarginLeft      =   1
         MarginRight     =   1
         MarginTop       =   1
         MaxValue        =   999999
         MinValue        =   0
         MousePointer    =   0
         MoveOnLRKey     =   0
         NegativeColor   =   255
         OLEDragMode     =   0
         OLEDropMode     =   0
         ReadOnly        =   0
         Separator       =   ","
         ShowContextMenu =   1
         ValueVT         =   5
         Value           =   0
         MaxValueVT      =   1802698757
         MinValueVT      =   1769209861
      End
      Begin VB.Frame fraLista 
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   5550
         Left            =   -74880
         TabIndex        =   30
         Top             =   390
         Width           =   11190
         Begin TabDlg.SSTab SSTab1 
            Height          =   1575
            Left            =   120
            TabIndex        =   40
            Top             =   450
            Width           =   7260
            _ExtentX        =   12806
            _ExtentY        =   2778
            _Version        =   393216
            Tab             =   1
            TabHeight       =   520
            ForeColor       =   8388608
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            TabCaption(0)   =   "Fechas"
            TabPicture(0)   =   "frmManAsientosContables.frx":C0D3
            Tab(0).ControlEnabled=   0   'False
            Tab(0).Control(0)=   "Label3"
            Tab(0).Control(1)=   "Label11"
            Tab(0).Control(2)=   "dtpHasta"
            Tab(0).Control(3)=   "dtpDesde"
            Tab(0).Control(4)=   "cmdMostrar"
            Tab(0).Control(5)=   "chkDesde"
            Tab(0).ControlCount=   6
            TabCaption(1)   =   "Filtros"
            TabPicture(1)   =   "frmManAsientosContables.frx":C0EF
            Tab(1).ControlEnabled=   -1  'True
            Tab(1).Control(0)=   "Label9"
            Tab(1).Control(0).Enabled=   0   'False
            Tab(1).Control(1)=   "Label10"
            Tab(1).Control(1).Enabled=   0   'False
            Tab(1).Control(2)=   "Label12"
            Tab(1).Control(2).Enabled=   0   'False
            Tab(1).Control(3)=   "tdbcLibroCab"
            Tab(1).Control(3).Enabled=   0   'False
            Tab(1).Control(4)=   "tdbtMonedaBus"
            Tab(1).Control(4).Enabled=   0   'False
            Tab(1).Control(5)=   "tdbtNumVoucherBus"
            Tab(1).Control(5).Enabled=   0   'False
            Tab(1).Control(6)=   "Command1"
            Tab(1).Control(6).Enabled=   0   'False
            Tab(1).ControlCount=   7
            TabCaption(2)   =   "Otros"
            TabPicture(2)   =   "frmManAsientosContables.frx":C10B
            Tab(2).ControlEnabled=   0   'False
            Tab(2).Control(0)=   "cmdListar"
            Tab(2).Control(1)=   "cmdChequeVoucher"
            Tab(2).Control(2)=   "cmdCambioLibro"
            Tab(2).Control(3)=   "cmdEliminarVouchers"
            Tab(2).ControlCount=   4
            Begin VB.CommandButton cmdListar 
               Caption         =   "Listar"
               Height          =   615
               Left            =   -68565
               Picture         =   "frmManAsientosContables.frx":C127
               Style           =   1  'Graphical
               TabIndex        =   126
               ToolTipText     =   "Volver a cargar la lista de vouchers"
               Top             =   585
               Width           =   555
            End
            Begin VB.CommandButton cmdChequeVoucher 
               Caption         =   "Imprimir Voucher"
               Height          =   615
               Left            =   -71850
               Picture         =   "frmManAsientosContables.frx":C6B1
               Style           =   1  'Graphical
               TabIndex        =   125
               ToolTipText     =   "Muestra el voucher para impresion"
               Top             =   585
               Width           =   1335
            End
            Begin VB.CommandButton cmdCambioLibro 
               Caption         =   "Cambiar Libro"
               Height          =   615
               Left            =   -73155
               Picture         =   "frmManAsientosContables.frx":CC3B
               Style           =   1  'Graphical
               TabIndex        =   124
               ToolTipText     =   "Muestra el voucher para impresion"
               Top             =   585
               Width           =   1185
            End
            Begin VB.CommandButton cmdEliminarVouchers 
               Caption         =   "Eliminar Vouchers"
               Height          =   615
               Left            =   -74730
               Picture         =   "frmManAsientosContables.frx":D1C5
               Style           =   1  'Graphical
               TabIndex        =   123
               ToolTipText     =   "Muestra el voucher para impresion"
               Top             =   585
               Width           =   1455
            End
            Begin VB.CommandButton Command1 
               Caption         =   "Listar"
               Height          =   705
               Left            =   6480
               Picture         =   "frmManAsientosContables.frx":D74F
               Style           =   1  'Graphical
               TabIndex        =   81
               ToolTipText     =   "Volver a cargar la lista de vouchers"
               Top             =   585
               Width           =   555
            End
            Begin VB.CheckBox chkDesde 
               Caption         =   "Por fecha "
               Enabled         =   0   'False
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H00800000&
               Height          =   210
               Left            =   -74640
               TabIndex        =   41
               Top             =   480
               Value           =   1  'Checked
               Visible         =   0   'False
               Width           =   1335
            End
            Begin VB.CommandButton cmdMostrar 
               Caption         =   "Listar"
               Height          =   705
               Left            =   -70095
               Picture         =   "frmManAsientosContables.frx":DCD9
               Style           =   1  'Graphical
               TabIndex        =   45
               ToolTipText     =   "Volver a cargar la lista de vouchers"
               Top             =   630
               Width           =   600
            End
            Begin TDBDate6Ctl.TDBDate dtpDesde 
               Height          =   300
               Left            =   -71805
               TabIndex        =   43
               Tag             =   "enabled"
               Top             =   630
               Width           =   1380
               _Version        =   65536
               _ExtentX        =   2434
               _ExtentY        =   529
               Calendar        =   "frmManAsientosContables.frx":E263
               Caption         =   "frmManAsientosContables.frx":E365
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               DropDown        =   "frmManAsientosContables.frx":E3C9
               Keys            =   "frmManAsientosContables.frx":E3E7
               Spin            =   "frmManAsientosContables.frx":E43B
               AlignHorizontal =   0
               AlignVertical   =   0
               Appearance      =   1
               BackColor       =   -2147483643
               BorderStyle     =   1
               BtnPositioning  =   0
               ClipMode        =   0
               CursorPosition  =   0
               DataProperty    =   0
               DisplayFormat   =   "dd/mm/yyyy"
               EditMode        =   0
               Enabled         =   -1
               ErrorBeep       =   0
               FirstMonth      =   1
               ForeColor       =   -2147483640
               Format          =   "dd/mm/yyyy"
               HighlightText   =   0
               IMEMode         =   3
               MarginBottom    =   1
               MarginLeft      =   1
               MarginRight     =   1
               MarginTop       =   1
               MaxDate         =   73415
               MinDate         =   2
               MousePointer    =   0
               MoveOnLRKey     =   0
               OLEDragMode     =   0
               OLEDropMode     =   0
               PromptChar      =   "_"
               ReadOnly        =   0
               ShowContextMenu =   1
               ShowLiterals    =   0
               TabAction       =   0
               Text            =   "03/08/2004"
               ValidateMode    =   0
               ValueVT         =   2010185735
               Value           =   38202
               CenturyMode     =   0
            End
            Begin TDBDate6Ctl.TDBDate dtpHasta 
               Height          =   300
               Left            =   -71805
               TabIndex        =   44
               Tag             =   "enabled"
               Top             =   1035
               Width           =   1380
               _Version        =   65536
               _ExtentX        =   2434
               _ExtentY        =   529
               Calendar        =   "frmManAsientosContables.frx":E463
               Caption         =   "frmManAsientosContables.frx":E565
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               DropDown        =   "frmManAsientosContables.frx":E5C9
               Keys            =   "frmManAsientosContables.frx":E5E7
               Spin            =   "frmManAsientosContables.frx":E63B
               AlignHorizontal =   0
               AlignVertical   =   0
               Appearance      =   1
               BackColor       =   -2147483643
               BorderStyle     =   1
               BtnPositioning  =   0
               ClipMode        =   0
               CursorPosition  =   0
               DataProperty    =   0
               DisplayFormat   =   "dd/mm/yyyy"
               EditMode        =   0
               Enabled         =   -1
               ErrorBeep       =   0
               FirstMonth      =   1
               ForeColor       =   -2147483640
               Format          =   "dd/mm/yyyy"
               HighlightText   =   0
               IMEMode         =   3
               MarginBottom    =   1
               MarginLeft      =   1
               MarginRight     =   1
               MarginTop       =   1
               MaxDate         =   73415
               MinDate         =   2
               MousePointer    =   0
               MoveOnLRKey     =   0
               OLEDragMode     =   0
               OLEDropMode     =   0
               PromptChar      =   "_"
               ReadOnly        =   0
               ShowContextMenu =   1
               ShowLiterals    =   0
               TabAction       =   0
               Text            =   "03/08/2004"
               ValidateMode    =   0
               ValueVT         =   2010185735
               Value           =   38202
               CenturyMode     =   0
            End
            Begin TDBText6Ctl.TDBText tdbtNumVoucherBus 
               Height          =   300
               Left            =   1530
               TabIndex        =   79
               Top             =   960
               Width           =   975
               _Version        =   65536
               _ExtentX        =   1720
               _ExtentY        =   529
               Caption         =   "frmManAsientosContables.frx":E663
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               DropDown        =   "frmManAsientosContables.frx":E6C7
               Key             =   "frmManAsientosContables.frx":E6E5
               BackColor       =   -2147483643
               EditMode        =   0
               ForeColor       =   -2147483640
               ReadOnly        =   0
               ShowContextMenu =   1
               MarginLeft      =   1
               MarginRight     =   1
               MarginTop       =   1
               MarginBottom    =   1
               Enabled         =   -1
               MousePointer    =   0
               Appearance      =   1
               BorderStyle     =   1
               AlignHorizontal =   0
               AlignVertical   =   0
               MultiLine       =   0
               ScrollBars      =   0
               PasswordChar    =   ""
               AllowSpace      =   -1
               Format          =   "a@"
               FormatMode      =   1
               AutoConvert     =   -1
               ErrorBeep       =   0
               MaxLength       =   10
               LengthAsByte    =   0
               Text            =   ""
               Furigana        =   0
               HighlightText   =   -1
               IMEMode         =   0
               IMEStatus       =   0
               DropWndWidth    =   0
               DropWndHeight   =   0
               ScrollBarMode   =   0
               MoveOnLRKey     =   0
               OLEDragMode     =   0
               OLEDropMode     =   0
            End
            Begin TDBText6Ctl.TDBText tdbtMonedaBus 
               Height          =   300
               Left            =   3600
               TabIndex        =   80
               Top             =   960
               Width           =   2745
               _Version        =   65536
               _ExtentX        =   4842
               _ExtentY        =   529
               Caption         =   "frmManAsientosContables.frx":E719
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               DropDown        =   "frmManAsientosContables.frx":E77D
               Key             =   "frmManAsientosContables.frx":E79B
               BackColor       =   -2147483643
               EditMode        =   0
               ForeColor       =   -2147483640
               ReadOnly        =   0
               ShowContextMenu =   1
               MarginLeft      =   1
               MarginRight     =   1
               MarginTop       =   1
               MarginBottom    =   1
               Enabled         =   -1
               MousePointer    =   0
               Appearance      =   1
               BorderStyle     =   1
               AlignHorizontal =   0
               AlignVertical   =   0
               MultiLine       =   0
               ScrollBars      =   0
               PasswordChar    =   ""
               AllowSpace      =   -1
               Format          =   "a"
               FormatMode      =   1
               AutoConvert     =   -1
               ErrorBeep       =   0
               MaxLength       =   50
               LengthAsByte    =   0
               Text            =   ""
               Furigana        =   0
               HighlightText   =   -1
               IMEMode         =   0
               IMEStatus       =   0
               DropWndWidth    =   0
               DropWndHeight   =   0
               ScrollBarMode   =   0
               MoveOnLRKey     =   0
               OLEDragMode     =   0
               OLEDropMode     =   0
            End
            Begin TrueOleDBList70.TDBCombo tdbcLibroCab 
               Height          =   300
               Left            =   1530
               TabIndex        =   78
               Tag             =   "enabled"
               Top             =   585
               Width           =   4815
               _ExtentX        =   8493
               _ExtentY        =   529
               _LayoutType     =   4
               _RowHeight      =   -2147483647
               _WasPersistedAsPixels=   0
               _DropdownWidth  =   0
               Columns(0)._VlistStyle=   0
               Columns(0)._MaxComboItems=   5
               Columns(0).DataField=   ""
               Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns(1)._VlistStyle=   0
               Columns(1)._MaxComboItems=   5
               Columns(1).DataField=   ""
               Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns(2)._VlistStyle=   0
               Columns(2)._MaxComboItems=   5
               Columns(2).DataField=   ""
               Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns(3)._VlistStyle=   0
               Columns(3)._MaxComboItems=   5
               Columns(3).DataField=   ""
               Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns(4)._VlistStyle=   0
               Columns(4)._MaxComboItems=   5
               Columns(4).DataField=   ""
               Columns(4)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns(5)._VlistStyle=   0
               Columns(5)._MaxComboItems=   5
               Columns(5).DataField=   ""
               Columns(5)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns(6)._VlistStyle=   0
               Columns(6)._MaxComboItems=   5
               Columns(6).DataField=   ""
               Columns(6)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns(7)._VlistStyle=   0
               Columns(7)._MaxComboItems=   5
               Columns(7).DataField=   ""
               Columns(7)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns(8)._VlistStyle=   0
               Columns(8)._MaxComboItems=   5
               Columns(8).DataField=   ""
               Columns(8)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns(9)._VlistStyle=   0
               Columns(9)._MaxComboItems=   5
               Columns(9).DataField=   ""
               Columns(9)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
               Columns.Count   =   10
               Splits(0)._UserFlags=   0
               Splits(0).ExtendRightColumn=   -1  'True
               Splits(0).AllowRowSizing=   0   'False
               Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
               Splits(0)._ColumnProps(0)=   "Columns.Count=10"
               Splits(0)._ColumnProps(1)=   "Column(0).Width=582"
               Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
               Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=503"
               Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
               Splits(0)._ColumnProps(5)=   "Column(0).Order=1"
               Splits(0)._ColumnProps(6)=   "Column(1).Width=847"
               Splits(0)._ColumnProps(7)=   "Column(1).DividerColor=0"
               Splits(0)._ColumnProps(8)=   "Column(1)._WidthInPix=767"
               Splits(0)._ColumnProps(9)=   "Column(1)._EditAlways=0"
               Splits(0)._ColumnProps(10)=   "Column(1).Order=2"
               Splits(0)._ColumnProps(11)=   "Column(2).Width=1138"
               Splits(0)._ColumnProps(12)=   "Column(2).DividerColor=0"
               Splits(0)._ColumnProps(13)=   "Column(2)._WidthInPix=1058"
               Splits(0)._ColumnProps(14)=   "Column(2)._EditAlways=0"
               Splits(0)._ColumnProps(15)=   "Column(2).Visible=0"
               Splits(0)._ColumnProps(16)=   "Column(2).Order=3"
               Splits(0)._ColumnProps(17)=   "Column(3).Width=2196"
               Splits(0)._ColumnProps(18)=   "Column(3).DividerColor=0"
               Splits(0)._ColumnProps(19)=   "Column(3)._WidthInPix=2117"
               Splits(0)._ColumnProps(20)=   "Column(3)._EditAlways=0"
               Splits(0)._ColumnProps(21)=   "Column(3).Visible=0"
               Splits(0)._ColumnProps(22)=   "Column(3).Order=4"
               Splits(0)._ColumnProps(23)=   "Column(4).Width=2196"
               Splits(0)._ColumnProps(24)=   "Column(4).DividerColor=0"
               Splits(0)._ColumnProps(25)=   "Column(4)._WidthInPix=2117"
               Splits(0)._ColumnProps(26)=   "Column(4)._EditAlways=0"
               Splits(0)._ColumnProps(27)=   "Column(4).Visible=0"
               Splits(0)._ColumnProps(28)=   "Column(4).Order=5"
               Splits(0)._ColumnProps(29)=   "Column(5).Width=2196"
               Splits(0)._ColumnProps(30)=   "Column(5).DividerColor=0"
               Splits(0)._ColumnProps(31)=   "Column(5)._WidthInPix=2117"
               Splits(0)._ColumnProps(32)=   "Column(5)._EditAlways=0"
               Splits(0)._ColumnProps(33)=   "Column(5).Visible=0"
               Splits(0)._ColumnProps(34)=   "Column(5).Order=6"
               Splits(0)._ColumnProps(35)=   "Column(6).Width=2196"
               Splits(0)._ColumnProps(36)=   "Column(6).DividerColor=0"
               Splits(0)._ColumnProps(37)=   "Column(6)._WidthInPix=2117"
               Splits(0)._ColumnProps(38)=   "Column(6)._EditAlways=0"
               Splits(0)._ColumnProps(39)=   "Column(6).Visible=0"
               Splits(0)._ColumnProps(40)=   "Column(6).Order=7"
               Splits(0)._ColumnProps(41)=   "Column(7).Width=2196"
               Splits(0)._ColumnProps(42)=   "Column(7).DividerColor=0"
               Splits(0)._ColumnProps(43)=   "Column(7)._WidthInPix=2117"
               Splits(0)._ColumnProps(44)=   "Column(7)._EditAlways=0"
               Splits(0)._ColumnProps(45)=   "Column(7).Visible=0"
               Splits(0)._ColumnProps(46)=   "Column(7).Order=8"
               Splits(0)._ColumnProps(47)=   "Column(8).Width=2196"
               Splits(0)._ColumnProps(48)=   "Column(8).DividerColor=0"
               Splits(0)._ColumnProps(49)=   "Column(8)._WidthInPix=2117"
               Splits(0)._ColumnProps(50)=   "Column(8)._EditAlways=0"
               Splits(0)._ColumnProps(51)=   "Column(8).Visible=0"
               Splits(0)._ColumnProps(52)=   "Column(8).Order=9"
               Splits(0)._ColumnProps(53)=   "Column(9).Width=2196"
               Splits(0)._ColumnProps(54)=   "Column(9).DividerColor=0"
               Splits(0)._ColumnProps(55)=   "Column(9)._WidthInPix=2117"
               Splits(0)._ColumnProps(56)=   "Column(9)._EditAlways=0"
               Splits(0)._ColumnProps(57)=   "Column(9).Visible=0"
               Splits(0)._ColumnProps(58)=   "Column(9).Order=10"
               Splits.Count    =   1
               Appearance      =   1
               BorderStyle     =   1
               ComboStyle      =   2
               AutoCompletion  =   0   'False
               LimitToList     =   0   'False
               ColumnHeaders   =   0   'False
               ColumnFooters   =   0   'False
               DataMode        =   5
               DefColWidth     =   0
               Enabled         =   0   'False
               HeadLines       =   1
               FootLines       =   1
               RowDividerStyle =   0
               Caption         =   ""
               EditFont        =   "Size=6.75,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
               LayoutName      =   ""
               LayoutFileName  =   ""
               MultipleLines   =   0
               EmptyRows       =   -1  'True
               CellTips        =   0
               EditHeight      =   299.906
               AutoSize        =   -1  'True
               GapHeight       =   30.047
               ListField       =   ""
               BoundColumn     =   ""
               IntegralHeight  =   0   'False
               CellTipsWidth   =   0
               CellTipsDelay   =   1000
               AutoDropdown    =   -1  'True
               RowTracking     =   -1  'True
               RightToLeft     =   0   'False
               RowMember       =   ""
               MouseIcon       =   0
               MouseIcon.vt    =   3
               MousePointer    =   0
               MatchEntryTimeout=   2000
               OLEDragMode     =   0
               OLEDropMode     =   0
               AnimateWindow   =   0
               AnimateWindowDirection=   0
               AnimateWindowTime=   200
               AnimateWindowClose=   0
               DropdownPosition=   0
               Locked          =   0   'False
               ScrollTrack     =   0   'False
               RowDividerColor =   12632256
               RowSubDividerColor=   12632256
               AddItemSeparator=   ";"
               _PropDict       =   $"frmManAsientosContables.frx":E7CF
               _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
               _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
               _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
               _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=825,.italic=0"
               _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
               _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
               _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bold=0,.fontsize=675,.italic=0"
               _StyleDefs(7)   =   ":id=1,.underline=0,.strikethrough=0,.charset=0"
               _StyleDefs(8)   =   ":id=1,.fontname=Arial"
               _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
               _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34"
               _StyleDefs(11)  =   "FooterStyle:id=3,.parent=1,.namedParent=35"
               _StyleDefs(12)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
               _StyleDefs(13)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
               _StyleDefs(14)  =   "EditorStyle:id=7,.parent=1"
               _StyleDefs(15)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
               _StyleDefs(16)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
               _StyleDefs(17)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
               _StyleDefs(18)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
               _StyleDefs(19)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
               _StyleDefs(20)  =   "Splits(0).Style:id=13,.parent=1"
               _StyleDefs(21)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
               _StyleDefs(22)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
               _StyleDefs(23)  =   "Splits(0).FooterStyle:id=15,.parent=3"
               _StyleDefs(24)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
               _StyleDefs(25)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
               _StyleDefs(26)  =   "Splits(0).EditorStyle:id=17,.parent=7"
               _StyleDefs(27)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
               _StyleDefs(28)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
               _StyleDefs(29)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
               _StyleDefs(30)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
               _StyleDefs(31)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
               _StyleDefs(32)  =   "Splits(0).Columns(0).Style:id=46,.parent=13"
               _StyleDefs(33)  =   "Splits(0).Columns(0).HeadingStyle:id=43,.parent=14"
               _StyleDefs(34)  =   "Splits(0).Columns(0).FooterStyle:id=44,.parent=15"
               _StyleDefs(35)  =   "Splits(0).Columns(0).EditorStyle:id=45,.parent=17"
               _StyleDefs(36)  =   "Splits(0).Columns(1).Style:id=28,.parent=13"
               _StyleDefs(37)  =   "Splits(0).Columns(1).HeadingStyle:id=25,.parent=14"
               _StyleDefs(38)  =   "Splits(0).Columns(1).FooterStyle:id=26,.parent=15"
               _StyleDefs(39)  =   "Splits(0).Columns(1).EditorStyle:id=27,.parent=17"
               _StyleDefs(40)  =   "Splits(0).Columns(2).Style:id=32,.parent=13"
               _StyleDefs(41)  =   "Splits(0).Columns(2).HeadingStyle:id=29,.parent=14"
               _StyleDefs(42)  =   "Splits(0).Columns(2).FooterStyle:id=30,.parent=15"
               _StyleDefs(43)  =   "Splits(0).Columns(2).EditorStyle:id=31,.parent=17"
               _StyleDefs(44)  =   "Splits(0).Columns(3).Style:id=50,.parent=13"
               _StyleDefs(45)  =   "Splits(0).Columns(3).HeadingStyle:id=47,.parent=14"
               _StyleDefs(46)  =   "Splits(0).Columns(3).FooterStyle:id=48,.parent=15"
               _StyleDefs(47)  =   "Splits(0).Columns(3).EditorStyle:id=49,.parent=17"
               _StyleDefs(48)  =   "Splits(0).Columns(4).Style:id=54,.parent=13"
               _StyleDefs(49)  =   "Splits(0).Columns(4).HeadingStyle:id=51,.parent=14"
               _StyleDefs(50)  =   "Splits(0).Columns(4).FooterStyle:id=52,.parent=15"
               _StyleDefs(51)  =   "Splits(0).Columns(4).EditorStyle:id=53,.parent=17"
               _StyleDefs(52)  =   "Splits(0).Columns(5).Style:id=58,.parent=13"
               _StyleDefs(53)  =   "Splits(0).Columns(5).HeadingStyle:id=55,.parent=14"
               _StyleDefs(54)  =   "Splits(0).Columns(5).FooterStyle:id=56,.parent=15"
               _StyleDefs(55)  =   "Splits(0).Columns(5).EditorStyle:id=57,.parent=17"
               _StyleDefs(56)  =   "Splits(0).Columns(6).Style:id=62,.parent=13"
               _StyleDefs(57)  =   "Splits(0).Columns(6).HeadingStyle:id=59,.parent=14"
               _StyleDefs(58)  =   "Splits(0).Columns(6).FooterStyle:id=60,.parent=15"
               _StyleDefs(59)  =   "Splits(0).Columns(6).EditorStyle:id=61,.parent=17"
               _StyleDefs(60)  =   "Splits(0).Columns(7).Style:id=66,.parent=13"
               _StyleDefs(61)  =   "Splits(0).Columns(7).HeadingStyle:id=63,.parent=14"
               _StyleDefs(62)  =   "Splits(0).Columns(7).FooterStyle:id=64,.parent=15"
               _StyleDefs(63)  =   "Splits(0).Columns(7).EditorStyle:id=65,.parent=17"
               _StyleDefs(64)  =   "Splits(0).Columns(8).Style:id=70,.parent=13"
               _StyleDefs(65)  =   "Splits(0).Columns(8).HeadingStyle:id=67,.parent=14"
               _StyleDefs(66)  =   "Splits(0).Columns(8).FooterStyle:id=68,.parent=15"
               _StyleDefs(67)  =   "Splits(0).Columns(8).EditorStyle:id=69,.parent=17"
               _StyleDefs(68)  =   "Splits(0).Columns(9).Style:id=74,.parent=13"
               _StyleDefs(69)  =   "Splits(0).Columns(9).HeadingStyle:id=71,.parent=14"
               _StyleDefs(70)  =   "Splits(0).Columns(9).FooterStyle:id=72,.parent=15"
               _StyleDefs(71)  =   "Splits(0).Columns(9).EditorStyle:id=73,.parent=17"
               _StyleDefs(72)  =   "Named:id=33:Normal"
               _StyleDefs(73)  =   ":id=33,.parent=0"
               _StyleDefs(74)  =   "Named:id=34:Heading"
               _StyleDefs(75)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
               _StyleDefs(76)  =   ":id=34,.wraptext=-1"
               _StyleDefs(77)  =   "Named:id=35:Footing"
               _StyleDefs(78)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
               _StyleDefs(79)  =   "Named:id=36:Selected"
               _StyleDefs(80)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
               _StyleDefs(81)  =   "Named:id=37:Caption"
               _StyleDefs(82)  =   ":id=37,.parent=34,.alignment=2"
               _StyleDefs(83)  =   "Named:id=38:HighlightRow"
               _StyleDefs(84)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
               _StyleDefs(85)  =   "Named:id=39:EvenRow"
               _StyleDefs(86)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
               _StyleDefs(87)  =   "Named:id=40:OddRow"
               _StyleDefs(88)  =   ":id=40,.parent=33"
               _StyleDefs(89)  =   "Named:id=41:RecordSelector"
               _StyleDefs(90)  =   ":id=41,.parent=34"
               _StyleDefs(91)  =   "Named:id=42:FilterBar"
               _StyleDefs(92)  =   ":id=42,.parent=33"
            End
            Begin VB.Label Label12 
               AutoSize        =   -1  'True
               Caption         =   "Por Glosa"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H00800000&
               Height          =   225
               Left            =   2640
               TabIndex        =   49
               Top             =   1005
               Width           =   825
            End
            Begin VB.Label Label10 
               AutoSize        =   -1  'True
               Caption         =   "Por Voucher"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H00800000&
               Height          =   225
               Left            =   240
               TabIndex        =   48
               Top             =   1005
               Width           =   1065
            End
            Begin VB.Label Label9 
               AutoSize        =   -1  'True
               Caption         =   "Por Libro"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H00800000&
               Height          =   225
               Left            =   255
               TabIndex        =   47
               Top             =   630
               Width           =   780
            End
            Begin VB.Label Label11 
               Caption         =   "Desde"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H00800000&
               Height          =   255
               Left            =   -72930
               TabIndex        =   46
               Top             =   630
               Width           =   615
            End
            Begin VB.Label Label3 
               Caption         =   "Hasta"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H00800000&
               Height          =   255
               Left            =   -72885
               TabIndex        =   42
               Top             =   1080
               Width           =   615
            End
         End
         Begin TDBNumber6Ctl.TDBNumber tdbtAnio 
            Height          =   300
            Left            =   8865
            TabIndex        =   39
            Top             =   225
            Visible         =   0   'False
            Width           =   1995
            _Version        =   65536
            _ExtentX        =   3519
            _ExtentY        =   529
            Calculator      =   "frmManAsientosContables.frx":E856
            Caption         =   "frmManAsientosContables.frx":E876
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":E8DA
            Keys            =   "frmManAsientosContables.frx":E8F8
            Spin            =   "frmManAsientosContables.frx":E932
            AlignHorizontal =   0
            AlignVertical   =   0
            Appearance      =   1
            BackColor       =   -2147483643
            BorderStyle     =   1
            BtnPositioning  =   0
            ClipMode        =   0
            ClearAction     =   0
            DecimalPoint    =   "."
            DisplayFormat   =   "###0"
            EditMode        =   0
            Enabled         =   -1
            ErrorBeep       =   0
            ForeColor       =   -2147483640
            Format          =   "###0"
            HighlightText   =   0
            MarginBottom    =   1
            MarginLeft      =   1
            MarginRight     =   1
            MarginTop       =   1
            MaxValue        =   2100
            MinValue        =   1900
            MousePointer    =   0
            MoveOnLRKey     =   0
            NegativeColor   =   255
            OLEDragMode     =   0
            OLEDropMode     =   0
            ReadOnly        =   0
            Separator       =   ","
            ShowContextMenu =   1
            ValueVT         =   2752513
            Value           =   0
            MaxValueVT      =   1802698757
            MinValueVT      =   1769209861
         End
         Begin TrueOleDBGrid70.TDBGrid tdbgAsientos 
            Height          =   3375
            Left            =   135
            TabIndex        =   31
            Top             =   2100
            Width           =   10875
            _ExtentX        =   19182
            _ExtentY        =   5953
            _LayoutType     =   4
            _RowHeight      =   18
            _WasPersistedAsPixels=   0
            Columns(0)._VlistStyle=   0
            Columns(0)._MaxComboItems=   5
            Columns(0).Caption=   "Interno"
            Columns(0).DataField=   "Ase_cNummov"
            Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(1)._VlistStyle=   0
            Columns(1)._MaxComboItems=   5
            Columns(1).Caption=   "Año"
            Columns(1).DataField=   "PAN_CANIO"
            Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(2)._VlistStyle=   0
            Columns(2)._MaxComboItems=   5
            Columns(2).Caption=   "Mes"
            Columns(2).DataField=   "Per_cPeriodo"
            Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(3)._VlistStyle=   0
            Columns(3)._MaxComboItems=   5
            Columns(3).Caption=   "Fecha"
            Columns(3).DataField=   "Ase_dFecha"
            Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(4)._VlistStyle=   0
            Columns(4)._MaxComboItems=   5
            Columns(4).Caption=   "Lib."
            Columns(4).DataField=   "Lib_cTipoLibro"
            Columns(4)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(5)._VlistStyle=   0
            Columns(5)._MaxComboItems=   5
            Columns(5).Caption=   "Nombre"
            Columns(5).DataField=   "Lib_cDescripcion"
            Columns(5)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(6)._VlistStyle=   0
            Columns(6)._MaxComboItems=   5
            Columns(6).Caption=   "Voucher"
            Columns(6).DataField=   "Ase_nVoucher"
            Columns(6)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(7)._VlistStyle=   0
            Columns(7)._MaxComboItems=   5
            Columns(7).Caption=   "Glosa"
            Columns(7).DataField=   "Ase_cGlosa"
            Columns(7)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(8)._VlistStyle=   0
            Columns(8)._MaxComboItems=   5
            Columns(8).Caption=   "CodMoneda"
            Columns(8).DataField=   "Ase_cTipoMoneda"
            Columns(8)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(9)._VlistStyle=   0
            Columns(9)._MaxComboItems=   5
            Columns(9).Caption=   "Moneda"
            Columns(9).DataField=   "Mon_cNombreLargo"
            Columns(9)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(10)._VlistStyle=   0
            Columns(10)._MaxComboItems=   5
            Columns(10).Caption=   "TC"
            Columns(10).DataField=   "Ase_nTipoCambio"
            Columns(10).NumberFormat=   "External Editor"
            Columns(10).ExternalEditor=   "tdbtCambio"
            Columns(10).ExternalEditor.vt=   8
            Columns(10)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(11)._VlistStyle=   0
            Columns(11)._MaxComboItems=   5
            Columns(11).Caption=   "Estado"
            Columns(11).DataField=   "NomEstado"
            Columns(11)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(12)._VlistStyle=   16
            Columns(12)._MaxComboItems=   5
            Columns(12).ValueItems(0)._DefaultItem=   0
            Columns(12).ValueItems(0).Value=   "1"
            Columns(12).ValueItems(0).Value.vt=   8
            Columns(12).ValueItems(0).DisplayValue.CLSID=   "{0BE35204-8F91-11CE-9DE3-00AA004BB851}"
            Columns(12).ValueItems(0).DisplayValue(0)=   "bHQAADYDAABCTTYDAAAAAAAANgAAACgAAAAQAAAAEAAAAAEAGAAAAAAAAAMAAAAAAAAAAAAAAAAA"
            Columns(12).ValueItems(0).DisplayValue(1)=   "AAAAAADw7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(0).DisplayValue(2)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(0).DisplayValue(3)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+8AgADw"
            Columns(12).ValueItems(0).DisplayValue(4)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+8AgAAAgAAAgADw7+/w7+/w"
            Columns(12).ValueItems(0).DisplayValue(5)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+8AgAAAgAAAgAAAgADw7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(0).DisplayValue(6)=   "7+/w7+/w7+/w7+/w7+/w7+8AgAAAgAAAgAAAgAAAgAAAgADw7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(0).DisplayValue(7)=   "7+/w7+8AgAAAgAAAgADw7+/w7+8AgAAAgAAAgADw7+/w7+/w7+/w7+/w7+/w7+/w7+8AgAAAgADw"
            Columns(12).ValueItems(0).DisplayValue(8)=   "7+/w7+/w7+/w7+/w7+8AgAAAgAAAgADw7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(0).DisplayValue(9)=   "7+/w7+/w7+8AgAAAgADw7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(0).DisplayValue(10)=   "7+8AgAAAgADw7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+8AgAAA"
            Columns(12).ValueItems(0).DisplayValue(11)=   "gADw7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+8AgADw7+/w"
            Columns(12).ValueItems(0).DisplayValue(12)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(0).DisplayValue(13)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(0).DisplayValue(14)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+8="
            Columns(12).ValueItems(0).DisplayValue.vt=   9
            Columns(12).ValueItems(0)._PropDict=   "_DefaultItem,517,2"
            Columns(12).ValueItems(1)._DefaultItem=   0
            Columns(12).ValueItems(1).Value=   "0"
            Columns(12).ValueItems(1).Value.vt=   8
            Columns(12).ValueItems(1).DisplayValue.CLSID=   "{0BE35204-8F91-11CE-9DE3-00AA004BB851}"
            Columns(12).ValueItems(1).DisplayValue(0)=   "bHQAAMYDAABCTcYDAAAAAAAANgAAACgAAAAQAAAAEwAAAAEAGAAAAAAAkAMAAAAAAAAAAAAAAAAA"
            Columns(12).ValueItems(1).DisplayValue(1)=   "AAAAAADw7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(2)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(3)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(4)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(5)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(6)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(7)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(8)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(9)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(10)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(11)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(12)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(13)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(14)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(15)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(16)=   "7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w7+/w"
            Columns(12).ValueItems(1).DisplayValue(17)=   "7+/w7+8="
            Columns(12).ValueItems(1).DisplayValue.vt=   9
            Columns(12).ValueItems(1)._PropDict=   "_DefaultItem,517,2"
            Columns(12).ValueItems.Count=   2
            Columns(12).Caption=   "Manu."
            Columns(12).DataField=   "Ase_cCuadreManual"
            Columns(12)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(13)._VlistStyle=   0
            Columns(13)._MaxComboItems=   5
            Columns(13).Caption=   "NoEliminar"
            Columns(13).DataField=   "Ase_cElimSoft"
            Columns(13)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns.Count   =   14
            Splits(0)._UserFlags=   0
            Splits(0).ExtendRightColumn=   -1  'True
            Splits(0).Locked=   -1  'True
            Splits(0).MarqueeStyle=   3
            Splits(0).RecordSelectorWidth=   688
            Splits(0)._SavedRecordSelectors=   0   'False
            Splits(0).AllowColSelect=   0   'False
            Splits(0).DividerColor=   14215660
            Splits(0).SpringMode=   0   'False
            Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
            Splits(0)._ColumnProps(0)=   "Columns.Count=14"
            Splits(0)._ColumnProps(1)=   "Column(0).Width=2725"
            Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
            Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=2646"
            Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
            Splits(0)._ColumnProps(5)=   "Column(0).AllowSizing=0"
            Splits(0)._ColumnProps(6)=   "Column(0)._ColStyle=532"
            Splits(0)._ColumnProps(7)=   "Column(0).Visible=0"
            Splits(0)._ColumnProps(8)=   "Column(0).AllowFocus=0"
            Splits(0)._ColumnProps(9)=   "Column(0).Order=1"
            Splits(0)._ColumnProps(10)=   "Column(1).Width=2725"
            Splits(0)._ColumnProps(11)=   "Column(1).DividerColor=0"
            Splits(0)._ColumnProps(12)=   "Column(1)._WidthInPix=2646"
            Splits(0)._ColumnProps(13)=   "Column(1)._EditAlways=0"
            Splits(0)._ColumnProps(14)=   "Column(1).AllowSizing=0"
            Splits(0)._ColumnProps(15)=   "Column(1)._ColStyle=532"
            Splits(0)._ColumnProps(16)=   "Column(1).Visible=0"
            Splits(0)._ColumnProps(17)=   "Column(1).AllowFocus=0"
            Splits(0)._ColumnProps(18)=   "Column(1).Order=2"
            Splits(0)._ColumnProps(19)=   "Column(2).Width=847"
            Splits(0)._ColumnProps(20)=   "Column(2).DividerColor=0"
            Splits(0)._ColumnProps(21)=   "Column(2)._WidthInPix=767"
            Splits(0)._ColumnProps(22)=   "Column(2)._EditAlways=0"
            Splits(0)._ColumnProps(23)=   "Column(2).AllowSizing=0"
            Splits(0)._ColumnProps(24)=   "Column(2)._ColStyle=532"
            Splits(0)._ColumnProps(25)=   "Column(2).Visible=0"
            Splits(0)._ColumnProps(26)=   "Column(2).AllowFocus=0"
            Splits(0)._ColumnProps(27)=   "Column(2).Order=3"
            Splits(0)._ColumnProps(28)=   "Column(3).Width=1693"
            Splits(0)._ColumnProps(29)=   "Column(3).DividerColor=0"
            Splits(0)._ColumnProps(30)=   "Column(3)._WidthInPix=1614"
            Splits(0)._ColumnProps(31)=   "Column(3)._EditAlways=0"
            Splits(0)._ColumnProps(32)=   "Column(3).AllowSizing=0"
            Splits(0)._ColumnProps(33)=   "Column(3)._ColStyle=532"
            Splits(0)._ColumnProps(34)=   "Column(3).Order=4"
            Splits(0)._ColumnProps(35)=   "Column(4).Width=714"
            Splits(0)._ColumnProps(36)=   "Column(4).DividerColor=0"
            Splits(0)._ColumnProps(37)=   "Column(4)._WidthInPix=635"
            Splits(0)._ColumnProps(38)=   "Column(4)._EditAlways=0"
            Splits(0)._ColumnProps(39)=   "Column(4).AllowSizing=0"
            Splits(0)._ColumnProps(40)=   "Column(4)._ColStyle=532"
            Splits(0)._ColumnProps(41)=   "Column(4).Visible=0"
            Splits(0)._ColumnProps(42)=   "Column(4).AllowFocus=0"
            Splits(0)._ColumnProps(43)=   "Column(4).Order=5"
            Splits(0)._ColumnProps(44)=   "Column(5).Width=2143"
            Splits(0)._ColumnProps(45)=   "Column(5).DividerColor=0"
            Splits(0)._ColumnProps(46)=   "Column(5)._WidthInPix=2064"
            Splits(0)._ColumnProps(47)=   "Column(5)._EditAlways=0"
            Splits(0)._ColumnProps(48)=   "Column(5).AllowSizing=0"
            Splits(0)._ColumnProps(49)=   "Column(5)._ColStyle=532"
            Splits(0)._ColumnProps(50)=   "Column(5).Visible=0"
            Splits(0)._ColumnProps(51)=   "Column(5).AllowFocus=0"
            Splits(0)._ColumnProps(52)=   "Column(5).Order=6"
            Splits(0)._ColumnProps(53)=   "Column(6).Width=2355"
            Splits(0)._ColumnProps(54)=   "Column(6).DividerColor=0"
            Splits(0)._ColumnProps(55)=   "Column(6)._WidthInPix=2275"
            Splits(0)._ColumnProps(56)=   "Column(6)._EditAlways=0"
            Splits(0)._ColumnProps(57)=   "Column(6).AllowSizing=0"
            Splits(0)._ColumnProps(58)=   "Column(6)._ColStyle=529"
            Splits(0)._ColumnProps(59)=   "Column(6).Order=7"
            Splits(0)._ColumnProps(60)=   "Column(7).Width=6747"
            Splits(0)._ColumnProps(61)=   "Column(7).DividerColor=0"
            Splits(0)._ColumnProps(62)=   "Column(7)._WidthInPix=6668"
            Splits(0)._ColumnProps(63)=   "Column(7)._EditAlways=0"
            Splits(0)._ColumnProps(64)=   "Column(7)._ColStyle=532"
            Splits(0)._ColumnProps(65)=   "Column(7).Order=9"
            Splits(0)._ColumnProps(66)=   "Column(8).Width=1085"
            Splits(0)._ColumnProps(67)=   "Column(8).DividerColor=0"
            Splits(0)._ColumnProps(68)=   "Column(8)._WidthInPix=1005"
            Splits(0)._ColumnProps(69)=   "Column(8)._EditAlways=0"
            Splits(0)._ColumnProps(70)=   "Column(8).AllowSizing=0"
            Splits(0)._ColumnProps(71)=   "Column(8)._ColStyle=532"
            Splits(0)._ColumnProps(72)=   "Column(8).Visible=0"
            Splits(0)._ColumnProps(73)=   "Column(8).AllowFocus=0"
            Splits(0)._ColumnProps(74)=   "Column(8).Order=10"
            Splits(0)._ColumnProps(75)=   "Column(9).Width=2963"
            Splits(0)._ColumnProps(76)=   "Column(9).DividerColor=0"
            Splits(0)._ColumnProps(77)=   "Column(9)._WidthInPix=2884"
            Splits(0)._ColumnProps(78)=   "Column(9)._EditAlways=0"
            Splits(0)._ColumnProps(79)=   "Column(9)._ColStyle=532"
            Splits(0)._ColumnProps(80)=   "Column(9).Order=8"
            Splits(0)._ColumnProps(81)=   "Column(10).Width=926"
            Splits(0)._ColumnProps(82)=   "Column(10).DividerColor=0"
            Splits(0)._ColumnProps(83)=   "Column(10)._WidthInPix=847"
            Splits(0)._ColumnProps(84)=   "Column(10)._EditAlways=0"
            Splits(0)._ColumnProps(85)=   "Column(10).AllowSizing=0"
            Splits(0)._ColumnProps(86)=   "Column(10)._ColStyle=530"
            Splits(0)._ColumnProps(87)=   "Column(10).Visible=0"
            Splits(0)._ColumnProps(88)=   "Column(10).AllowFocus=0"
            Splits(0)._ColumnProps(89)=   "Column(10).Order=11"
            Splits(0)._ColumnProps(90)=   "Column(11).Width=2170"
            Splits(0)._ColumnProps(91)=   "Column(11).DividerColor=0"
            Splits(0)._ColumnProps(92)=   "Column(11)._WidthInPix=2090"
            Splits(0)._ColumnProps(93)=   "Column(11)._EditAlways=0"
            Splits(0)._ColumnProps(94)=   "Column(11).AllowSizing=0"
            Splits(0)._ColumnProps(95)=   "Column(11)._ColStyle=532"
            Splits(0)._ColumnProps(96)=   "Column(11).Visible=0"
            Splits(0)._ColumnProps(97)=   "Column(11).AllowFocus=0"
            Splits(0)._ColumnProps(98)=   "Column(11).Order=12"
            Splits(0)._ColumnProps(99)=   "Column(12).Width=635"
            Splits(0)._ColumnProps(100)=   "Column(12).DividerColor=0"
            Splits(0)._ColumnProps(101)=   "Column(12)._WidthInPix=556"
            Splits(0)._ColumnProps(102)=   "Column(12)._EditAlways=0"
            Splits(0)._ColumnProps(103)=   "Column(12).AllowSizing=0"
            Splits(0)._ColumnProps(104)=   "Column(12)._ColStyle=532"
            Splits(0)._ColumnProps(105)=   "Column(12).Visible=0"
            Splits(0)._ColumnProps(106)=   "Column(12).AllowFocus=0"
            Splits(0)._ColumnProps(107)=   "Column(12).Order=13"
            Splits(0)._ColumnProps(108)=   "Column(13).Width=2725"
            Splits(0)._ColumnProps(109)=   "Column(13).DividerColor=0"
            Splits(0)._ColumnProps(110)=   "Column(13)._WidthInPix=2646"
            Splits(0)._ColumnProps(111)=   "Column(13)._EditAlways=0"
            Splits(0)._ColumnProps(112)=   "Column(13).AllowSizing=0"
            Splits(0)._ColumnProps(113)=   "Column(13)._ColStyle=532"
            Splits(0)._ColumnProps(114)=   "Column(13).Visible=0"
            Splits(0)._ColumnProps(115)=   "Column(13).AllowFocus=0"
            Splits(0)._ColumnProps(116)=   "Column(13).Order=14"
            Splits.Count    =   1
            PrintInfos(0)._StateFlags=   3
            PrintInfos(0).Name=   "piInternal 0"
            PrintInfos(0).PageHeaderFont=   "Size=8.25,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
            PrintInfos(0).PageFooterFont=   "Size=8.25,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
            PrintInfos(0).PageHeaderHeight=   0
            PrintInfos(0).PageFooterHeight=   0
            PrintInfos.Count=   1
            AllowUpdate     =   0   'False
            DefColWidth     =   0
            HeadLines       =   1
            FootLines       =   1
            MultipleLines   =   0
            CellTipsWidth   =   0
            MultiSelect     =   0
            DeadAreaBackColor=   16777215
            RowDividerColor =   14215660
            RowSubDividerColor=   14215660
            DirectionAfterEnter=   1
            MaxRows         =   250000
            ViewColumnCaptionWidth=   0
            ViewColumnWidth =   0
            _PropDict       =   "_ExtentX,2003,3;_ExtentY,2004,3;_LayoutType,512,2;_RowHeight,16,3;_StyleDefs,513,0;_WasPersistedAsPixels,516,2"
            _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
            _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
            _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
            _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=192,.bold=0,.fontsize=825,.italic=0"
            _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
            _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bgcolor=&HFFFFFF&,.fgcolor=&H80000008&"
            _StyleDefs(7)   =   ":id=1,.bold=0,.fontsize=825,.italic=0,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(8)   =   ":id=1,.fontname=Arial"
            _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
            _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34,.alignment=2,.bgcolor=&HCA570B&"
            _StyleDefs(11)  =   ":id=2,.fgcolor=&HFFFFFF&,.bold=0,.fontsize=825,.italic=0,.underline=0"
            _StyleDefs(12)  =   ":id=2,.strikethrough=0,.charset=0"
            _StyleDefs(13)  =   ":id=2,.fontname=Arial"
            _StyleDefs(14)  =   "FooterStyle:id=3,.parent=1,.namedParent=35,.bold=0,.fontsize=825,.italic=0"
            _StyleDefs(15)  =   ":id=3,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(16)  =   ":id=3,.fontname=Arial"
            _StyleDefs(17)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(18)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
            _StyleDefs(19)  =   "EditorStyle:id=7,.parent=1"
            _StyleDefs(20)  =   "HighlightRowStyle:id=8,.parent=1"
            _StyleDefs(21)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
            _StyleDefs(22)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
            _StyleDefs(23)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
            _StyleDefs(24)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
            _StyleDefs(25)  =   "Splits(0).Style:id=13,.parent=1,.valignment=2,.bgcolor=&HFFFFFF&"
            _StyleDefs(26)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
            _StyleDefs(27)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
            _StyleDefs(28)  =   "Splits(0).FooterStyle:id=15,.parent=3"
            _StyleDefs(29)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
            _StyleDefs(30)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
            _StyleDefs(31)  =   "Splits(0).EditorStyle:id=17,.parent=7"
            _StyleDefs(32)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
            _StyleDefs(33)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
            _StyleDefs(34)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
            _StyleDefs(35)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
            _StyleDefs(36)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
            _StyleDefs(37)  =   "Splits(0).Columns(0).Style:id=74,.parent=13"
            _StyleDefs(38)  =   "Splits(0).Columns(0).HeadingStyle:id=71,.parent=14"
            _StyleDefs(39)  =   "Splits(0).Columns(0).FooterStyle:id=72,.parent=15"
            _StyleDefs(40)  =   "Splits(0).Columns(0).EditorStyle:id=73,.parent=17"
            _StyleDefs(41)  =   "Splits(0).Columns(1).Style:id=70,.parent=13"
            _StyleDefs(42)  =   "Splits(0).Columns(1).HeadingStyle:id=67,.parent=14"
            _StyleDefs(43)  =   "Splits(0).Columns(1).FooterStyle:id=68,.parent=15"
            _StyleDefs(44)  =   "Splits(0).Columns(1).EditorStyle:id=69,.parent=17"
            _StyleDefs(45)  =   "Splits(0).Columns(2).Style:id=54,.parent=13"
            _StyleDefs(46)  =   "Splits(0).Columns(2).HeadingStyle:id=51,.parent=14"
            _StyleDefs(47)  =   "Splits(0).Columns(2).FooterStyle:id=52,.parent=15"
            _StyleDefs(48)  =   "Splits(0).Columns(2).EditorStyle:id=53,.parent=17"
            _StyleDefs(49)  =   "Splits(0).Columns(3).Style:id=50,.parent=13"
            _StyleDefs(50)  =   "Splits(0).Columns(3).HeadingStyle:id=47,.parent=14"
            _StyleDefs(51)  =   "Splits(0).Columns(3).FooterStyle:id=48,.parent=15"
            _StyleDefs(52)  =   "Splits(0).Columns(3).EditorStyle:id=49,.parent=17"
            _StyleDefs(53)  =   "Splits(0).Columns(4).Style:id=46,.parent=13"
            _StyleDefs(54)  =   "Splits(0).Columns(4).HeadingStyle:id=43,.parent=14"
            _StyleDefs(55)  =   "Splits(0).Columns(4).FooterStyle:id=44,.parent=15"
            _StyleDefs(56)  =   "Splits(0).Columns(4).EditorStyle:id=45,.parent=17"
            _StyleDefs(57)  =   "Splits(0).Columns(5).Style:id=58,.parent=13"
            _StyleDefs(58)  =   "Splits(0).Columns(5).HeadingStyle:id=55,.parent=14"
            _StyleDefs(59)  =   "Splits(0).Columns(5).FooterStyle:id=56,.parent=15"
            _StyleDefs(60)  =   "Splits(0).Columns(5).EditorStyle:id=57,.parent=17"
            _StyleDefs(61)  =   "Splits(0).Columns(6).Style:id=28,.parent=13,.alignment=2"
            _StyleDefs(62)  =   "Splits(0).Columns(6).HeadingStyle:id=25,.parent=14"
            _StyleDefs(63)  =   "Splits(0).Columns(6).FooterStyle:id=26,.parent=15"
            _StyleDefs(64)  =   "Splits(0).Columns(6).EditorStyle:id=27,.parent=17"
            _StyleDefs(65)  =   "Splits(0).Columns(7).Style:id=78,.parent=13"
            _StyleDefs(66)  =   "Splits(0).Columns(7).HeadingStyle:id=75,.parent=14"
            _StyleDefs(67)  =   "Splits(0).Columns(7).FooterStyle:id=76,.parent=15"
            _StyleDefs(68)  =   "Splits(0).Columns(7).EditorStyle:id=77,.parent=17"
            _StyleDefs(69)  =   "Splits(0).Columns(8).Style:id=62,.parent=13"
            _StyleDefs(70)  =   "Splits(0).Columns(8).HeadingStyle:id=59,.parent=14"
            _StyleDefs(71)  =   "Splits(0).Columns(8).FooterStyle:id=60,.parent=15"
            _StyleDefs(72)  =   "Splits(0).Columns(8).EditorStyle:id=61,.parent=17"
            _StyleDefs(73)  =   "Splits(0).Columns(9).Style:id=66,.parent=13"
            _StyleDefs(74)  =   "Splits(0).Columns(9).HeadingStyle:id=63,.parent=14"
            _StyleDefs(75)  =   "Splits(0).Columns(9).FooterStyle:id=64,.parent=15"
            _StyleDefs(76)  =   "Splits(0).Columns(9).EditorStyle:id=65,.parent=17"
            _StyleDefs(77)  =   "Splits(0).Columns(10).Style:id=32,.parent=13,.alignment=1"
            _StyleDefs(78)  =   "Splits(0).Columns(10).HeadingStyle:id=29,.parent=14"
            _StyleDefs(79)  =   "Splits(0).Columns(10).FooterStyle:id=30,.parent=15"
            _StyleDefs(80)  =   "Splits(0).Columns(10).EditorStyle:id=31,.parent=17"
            _StyleDefs(81)  =   "Splits(0).Columns(11).Style:id=86,.parent=13"
            _StyleDefs(82)  =   "Splits(0).Columns(11).HeadingStyle:id=83,.parent=14"
            _StyleDefs(83)  =   "Splits(0).Columns(11).FooterStyle:id=84,.parent=15"
            _StyleDefs(84)  =   "Splits(0).Columns(11).EditorStyle:id=85,.parent=17"
            _StyleDefs(85)  =   "Splits(0).Columns(12).Style:id=82,.parent=13"
            _StyleDefs(86)  =   "Splits(0).Columns(12).HeadingStyle:id=79,.parent=14"
            _StyleDefs(87)  =   "Splits(0).Columns(12).FooterStyle:id=80,.parent=15"
            _StyleDefs(88)  =   "Splits(0).Columns(12).EditorStyle:id=81,.parent=17"
            _StyleDefs(89)  =   "Splits(0).Columns(13).Style:id=90,.parent=13"
            _StyleDefs(90)  =   "Splits(0).Columns(13).HeadingStyle:id=87,.parent=14"
            _StyleDefs(91)  =   "Splits(0).Columns(13).FooterStyle:id=88,.parent=15"
            _StyleDefs(92)  =   "Splits(0).Columns(13).EditorStyle:id=89,.parent=17"
            _StyleDefs(93)  =   "Named:id=33:Normal"
            _StyleDefs(94)  =   ":id=33,.parent=0"
            _StyleDefs(95)  =   "Named:id=34:Heading"
            _StyleDefs(96)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(97)  =   ":id=34,.wraptext=-1"
            _StyleDefs(98)  =   "Named:id=35:Footing"
            _StyleDefs(99)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(100) =   "Named:id=36:Selected"
            _StyleDefs(101) =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(102) =   "Named:id=37:Caption"
            _StyleDefs(103) =   ":id=37,.parent=34,.alignment=2"
            _StyleDefs(104) =   "Named:id=38:HighlightRow"
            _StyleDefs(105) =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(106) =   "Named:id=39:EvenRow"
            _StyleDefs(107) =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
            _StyleDefs(108) =   "Named:id=40:OddRow"
            _StyleDefs(109) =   ":id=40,.parent=33"
            _StyleDefs(110) =   "Named:id=41:RecordSelector"
            _StyleDefs(111) =   ":id=41,.parent=34"
            _StyleDefs(112) =   "Named:id=42:FilterBar"
            _StyleDefs(113) =   ":id=42,.parent=33"
         End
         Begin TrueOleDBList70.TDBCombo tdbcMes 
            Height          =   300
            Left            =   9000
            TabIndex        =   35
            Top             =   1170
            Width           =   1995
            _ExtentX        =   3519
            _ExtentY        =   529
            _LayoutType     =   4
            _RowHeight      =   -2147483647
            _WasPersistedAsPixels=   0
            _DropdownWidth  =   0
            Columns(0)._VlistStyle=   0
            Columns(0)._MaxComboItems=   5
            Columns(0).Caption=   "codigo"
            Columns(0).DataField=   ""
            Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(1)._VlistStyle=   0
            Columns(1)._MaxComboItems=   5
            Columns(1).Caption=   "descripcion"
            Columns(1).DataField=   ""
            Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns.Count   =   2
            Splits(0)._UserFlags=   0
            Splits(0).ExtendRightColumn=   -1  'True
            Splits(0).AllowRowSizing=   0   'False
            Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
            Splits(0)._ColumnProps(0)=   "Columns.Count=2"
            Splits(0)._ColumnProps(1)=   "Column(0).Width=661"
            Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
            Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=582"
            Splits(0)._ColumnProps(4)=   "Column(0)._VertColor=0"
            Splits(0)._ColumnProps(5)=   "Column(0)._EditAlways=0"
            Splits(0)._ColumnProps(6)=   "Column(0).Order=1"
            Splits(0)._ColumnProps(7)=   "Column(1).Width=688"
            Splits(0)._ColumnProps(8)=   "Column(1).DividerColor=0"
            Splits(0)._ColumnProps(9)=   "Column(1)._WidthInPix=609"
            Splits(0)._ColumnProps(10)=   "Column(1)._VertColor=0"
            Splits(0)._ColumnProps(11)=   "Column(1)._EditAlways=0"
            Splits(0)._ColumnProps(12)=   "Column(1).Order=2"
            Splits.Count    =   1
            Appearance      =   1
            BorderStyle     =   1
            ComboStyle      =   2
            AutoCompletion  =   0   'False
            LimitToList     =   0   'False
            ColumnHeaders   =   0   'False
            ColumnFooters   =   0   'False
            DataMode        =   5
            DefColWidth     =   0
            Enabled         =   -1  'True
            HeadLines       =   1
            FootLines       =   1
            RowDividerStyle =   1
            Caption         =   ""
            EditFont        =   "Size=6.75,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
            LayoutName      =   ""
            LayoutFileName  =   ""
            MultipleLines   =   0
            EmptyRows       =   -1  'True
            CellTips        =   0
            EditHeight      =   299.906
            AutoSize        =   -1  'True
            GapHeight       =   30.047
            ListField       =   "descripcion"
            BoundColumn     =   ""
            IntegralHeight  =   0   'False
            CellTipsWidth   =   0
            CellTipsDelay   =   1000
            AutoDropdown    =   0   'False
            RowTracking     =   -1  'True
            RightToLeft     =   0   'False
            RowMember       =   ""
            MouseIcon       =   0
            MouseIcon.vt    =   3
            MousePointer    =   0
            MatchEntryTimeout=   2000
            OLEDragMode     =   0
            OLEDropMode     =   0
            AnimateWindow   =   0
            AnimateWindowDirection=   0
            AnimateWindowTime=   200
            AnimateWindowClose=   0
            DropdownPosition=   0
            Locked          =   0   'False
            ScrollTrack     =   0   'False
            RowDividerColor =   12632256
            RowSubDividerColor=   12632256
            AddItemSeparator=   ";"
            _PropDict       =   $"frmManAsientosContables.frx":E95A
            _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
            _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
            _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
            _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=825,.italic=0"
            _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
            _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bgcolor=&H80000005&,.bold=0,.fontsize=675"
            _StyleDefs(7)   =   ":id=1,.italic=0,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(8)   =   ":id=1,.fontname=Arial"
            _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
            _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34"
            _StyleDefs(11)  =   "FooterStyle:id=3,.parent=1,.namedParent=35"
            _StyleDefs(12)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(13)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
            _StyleDefs(14)  =   "EditorStyle:id=7,.parent=1"
            _StyleDefs(15)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
            _StyleDefs(16)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
            _StyleDefs(17)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
            _StyleDefs(18)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
            _StyleDefs(19)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
            _StyleDefs(20)  =   "Splits(0).Style:id=13,.parent=1"
            _StyleDefs(21)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
            _StyleDefs(22)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
            _StyleDefs(23)  =   "Splits(0).FooterStyle:id=15,.parent=3"
            _StyleDefs(24)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
            _StyleDefs(25)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
            _StyleDefs(26)  =   "Splits(0).EditorStyle:id=17,.parent=7"
            _StyleDefs(27)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
            _StyleDefs(28)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
            _StyleDefs(29)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
            _StyleDefs(30)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
            _StyleDefs(31)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
            _StyleDefs(32)  =   "Splits(0).Columns(0).Style:id=28,.parent=13"
            _StyleDefs(33)  =   "Splits(0).Columns(0).HeadingStyle:id=25,.parent=14"
            _StyleDefs(34)  =   "Splits(0).Columns(0).FooterStyle:id=26,.parent=15"
            _StyleDefs(35)  =   "Splits(0).Columns(0).EditorStyle:id=27,.parent=17"
            _StyleDefs(36)  =   "Splits(0).Columns(1).Style:id=32,.parent=13"
            _StyleDefs(37)  =   "Splits(0).Columns(1).HeadingStyle:id=29,.parent=14"
            _StyleDefs(38)  =   "Splits(0).Columns(1).FooterStyle:id=30,.parent=15"
            _StyleDefs(39)  =   "Splits(0).Columns(1).EditorStyle:id=31,.parent=17"
            _StyleDefs(40)  =   "Named:id=33:Normal"
            _StyleDefs(41)  =   ":id=33,.parent=0"
            _StyleDefs(42)  =   "Named:id=34:Heading"
            _StyleDefs(43)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(44)  =   ":id=34,.wraptext=-1"
            _StyleDefs(45)  =   "Named:id=35:Footing"
            _StyleDefs(46)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(47)  =   "Named:id=36:Selected"
            _StyleDefs(48)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(49)  =   "Named:id=37:Caption"
            _StyleDefs(50)  =   ":id=37,.parent=34,.alignment=2"
            _StyleDefs(51)  =   "Named:id=38:HighlightRow"
            _StyleDefs(52)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(53)  =   "Named:id=39:EvenRow"
            _StyleDefs(54)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
            _StyleDefs(55)  =   "Named:id=40:OddRow"
            _StyleDefs(56)  =   ":id=40,.parent=33"
            _StyleDefs(57)  =   "Named:id=41:RecordSelector"
            _StyleDefs(58)  =   ":id=41,.parent=34"
            _StyleDefs(59)  =   "Named:id=42:FilterBar"
            _StyleDefs(60)  =   ":id=42,.parent=33"
         End
         Begin VB.Label lblEstadoMes 
            AutoSize        =   -1  'True
            Caption         =   "DESBLOQUEADO"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00C00000&
            Height          =   195
            Index           =   0
            Left            =   9000
            TabIndex        =   128
            Top             =   1575
            Visible         =   0   'False
            Width           =   1530
         End
         Begin VB.Label Label15 
            AutoSize        =   -1  'True
            Caption         =   "ESTADO:"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   195
            Left            =   7965
            TabIndex        =   127
            Top             =   1575
            Width           =   825
         End
         Begin VB.Label Label5 
            AutoSize        =   -1  'True
            Caption         =   "AÑO:"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   195
            Left            =   7920
            TabIndex        =   38
            Top             =   270
            Visible         =   0   'False
            Width           =   465
         End
         Begin VB.Label Label7 
            Caption         =   "PERIODO DE TRABAJO"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   -1  'True
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   315
            Left            =   8505
            TabIndex        =   37
            Top             =   765
            Width           =   2115
         End
         Begin VB.Label Label4 
            AutoSize        =   -1  'True
            Caption         =   "PERIODO:"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   195
            Left            =   7965
            TabIndex        =   36
            Top             =   1215
            Width           =   915
         End
         Begin VB.Label Label2 
            AutoSize        =   -1  'True
            Caption         =   "Filtrar Datos"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   225
            Index           =   6
            Left            =   135
            TabIndex        =   32
            Top             =   210
            Width           =   1035
         End
         Begin VB.Label lblEstadoMes 
            AutoSize        =   -1  'True
            Caption         =   "BLOQUEADO"
            BeginProperty Font 
               Name            =   "Verdana"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H000000FF&
            Height          =   195
            Index           =   1
            Left            =   9000
            TabIndex        =   129
            Top             =   1575
            Visible         =   0   'False
            Width           =   1155
         End
      End
      Begin VB.Frame fraCabecera 
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   720
         Left            =   45
         TabIndex        =   23
         Top             =   360
         Width           =   11355
         Begin VB.CommandButton cmdBuscarDatos 
            Height          =   300
            Left            =   7110
            Picture         =   "frmManAsientosContables.frx":E9E1
            Style           =   1  'Graphical
            TabIndex        =   136
            ToolTipText     =   " Buscar datos en detalle "
            Top             =   405
            Width           =   450
         End
         Begin VB.CommandButton Command2 
            Caption         =   "CO"
            Height          =   330
            Left            =   8715
            TabIndex        =   83
            Top             =   0
            Visible         =   0   'False
            Width           =   435
         End
         Begin TDBText6Ctl.TDBText tdbtObservaciones 
            Height          =   300
            Left            =   705
            TabIndex        =   4
            Tag             =   "enabled"
            Top             =   420
            Width           =   5910
            _Version        =   65536
            _ExtentX        =   10425
            _ExtentY        =   529
            Caption         =   "frmManAsientosContables.frx":EF6B
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":EFD7
            Key             =   "frmManAsientosContables.frx":EFF5
            BackColor       =   -2147483643
            EditMode        =   0
            ForeColor       =   -2147483640
            ReadOnly        =   0
            ShowContextMenu =   1
            MarginLeft      =   1
            MarginRight     =   1
            MarginTop       =   1
            MarginBottom    =   1
            Enabled         =   0
            MousePointer    =   0
            Appearance      =   1
            BorderStyle     =   1
            AlignHorizontal =   0
            AlignVertical   =   0
            MultiLine       =   0
            ScrollBars      =   0
            PasswordChar    =   ""
            AllowSpace      =   -1
            Format          =   "a"
            FormatMode      =   1
            AutoConvert     =   -1
            ErrorBeep       =   0
            MaxLength       =   100
            LengthAsByte    =   0
            Text            =   ""
            Furigana        =   0
            HighlightText   =   0
            IMEMode         =   0
            IMEStatus       =   0
            DropWndWidth    =   0
            DropWndHeight   =   0
            ScrollBarMode   =   0
            MoveOnLRKey     =   0
            OLEDragMode     =   0
            OLEDropMode     =   0
         End
         Begin VB.CommandButton cmdRepetirGlosa 
            Height          =   300
            Left            =   6615
            Picture         =   "frmManAsientosContables.frx":F037
            Style           =   1  'Graphical
            TabIndex        =   82
            ToolTipText     =   " Repetir glosa en todas la filas "
            Top             =   405
            Width           =   495
         End
         Begin TrueOleDBList70.TDBCombo tdbcMoneda 
            Height          =   300
            Left            =   9240
            TabIndex        =   3
            Tag             =   "_"
            Top             =   30
            Width           =   2070
            _ExtentX        =   3651
            _ExtentY        =   529
            _LayoutType     =   4
            _RowHeight      =   -2147483647
            _WasPersistedAsPixels=   0
            _DropdownWidth  =   0
            Columns(0)._VlistStyle=   0
            Columns(0)._MaxComboItems=   5
            Columns(0).DataField=   ""
            Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(1)._VlistStyle=   0
            Columns(1)._MaxComboItems=   5
            Columns(1).DataField=   ""
            Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(2)._VlistStyle=   0
            Columns(2)._MaxComboItems=   5
            Columns(2).DataField=   ""
            Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(3)._VlistStyle=   0
            Columns(3)._MaxComboItems=   5
            Columns(3).DataField=   ""
            Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(4)._VlistStyle=   0
            Columns(4)._MaxComboItems=   5
            Columns(4).DataField=   ""
            Columns(4)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns.Count   =   5
            Splits(0)._UserFlags=   0
            Splits(0).ExtendRightColumn=   -1  'True
            Splits(0).AllowRowSizing=   0   'False
            Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
            Splits(0)._ColumnProps(0)=   "Columns.Count=5"
            Splits(0)._ColumnProps(1)=   "Column(0).Width=609"
            Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
            Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=529"
            Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
            Splits(0)._ColumnProps(5)=   "Column(0).Visible=0"
            Splits(0)._ColumnProps(6)=   "Column(0).Order=1"
            Splits(0)._ColumnProps(7)=   "Column(1).Width=370"
            Splits(0)._ColumnProps(8)=   "Column(1).DividerColor=0"
            Splits(0)._ColumnProps(9)=   "Column(1)._WidthInPix=291"
            Splits(0)._ColumnProps(10)=   "Column(1)._EditAlways=0"
            Splits(0)._ColumnProps(11)=   "Column(1).Order=2"
            Splits(0)._ColumnProps(12)=   "Column(2).Width=847"
            Splits(0)._ColumnProps(13)=   "Column(2).DividerColor=0"
            Splits(0)._ColumnProps(14)=   "Column(2)._WidthInPix=767"
            Splits(0)._ColumnProps(15)=   "Column(2)._EditAlways=0"
            Splits(0)._ColumnProps(16)=   "Column(2).Visible=0"
            Splits(0)._ColumnProps(17)=   "Column(2).Order=3"
            Splits(0)._ColumnProps(18)=   "Column(3).Width=1376"
            Splits(0)._ColumnProps(19)=   "Column(3).DividerColor=0"
            Splits(0)._ColumnProps(20)=   "Column(3)._WidthInPix=1296"
            Splits(0)._ColumnProps(21)=   "Column(3)._EditAlways=0"
            Splits(0)._ColumnProps(22)=   "Column(3).Visible=0"
            Splits(0)._ColumnProps(23)=   "Column(3).Order=4"
            Splits(0)._ColumnProps(24)=   "Column(4).Width=2196"
            Splits(0)._ColumnProps(25)=   "Column(4).DividerColor=0"
            Splits(0)._ColumnProps(26)=   "Column(4)._WidthInPix=2117"
            Splits(0)._ColumnProps(27)=   "Column(4)._EditAlways=0"
            Splits(0)._ColumnProps(28)=   "Column(4).Visible=0"
            Splits(0)._ColumnProps(29)=   "Column(4).Order=5"
            Splits.Count    =   1
            Appearance      =   1
            BorderStyle     =   1
            ComboStyle      =   2
            AutoCompletion  =   0   'False
            LimitToList     =   0   'False
            ColumnHeaders   =   0   'False
            ColumnFooters   =   0   'False
            DataMode        =   4
            DefColWidth     =   0
            Enabled         =   0   'False
            HeadLines       =   1
            FootLines       =   1
            RowDividerStyle =   0
            Caption         =   ""
            EditFont        =   "Size=6.75,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
            LayoutName      =   ""
            LayoutFileName  =   ""
            MultipleLines   =   0
            EmptyRows       =   -1  'True
            CellTips        =   1
            EditHeight      =   299.906
            AutoSize        =   -1  'True
            GapHeight       =   30.047
            ListField       =   ""
            BoundColumn     =   ""
            IntegralHeight  =   0   'False
            CellTipsWidth   =   0
            CellTipsDelay   =   1000
            AutoDropdown    =   -1  'True
            RowTracking     =   -1  'True
            RightToLeft     =   0   'False
            RowMember       =   ""
            MouseIcon       =   0
            MouseIcon.vt    =   3
            MousePointer    =   0
            MatchEntryTimeout=   2000
            OLEDragMode     =   0
            OLEDropMode     =   0
            AnimateWindow   =   0
            AnimateWindowDirection=   0
            AnimateWindowTime=   200
            AnimateWindowClose=   0
            DropdownPosition=   0
            Locked          =   0   'False
            ScrollTrack     =   0   'False
            RowDividerColor =   12632256
            RowSubDividerColor=   12632256
            AddItemSeparator=   ";"
            _PropDict       =   $"frmManAsientosContables.frx":F5C1
            _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
            _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
            _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
            _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=825,.italic=0"
            _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
            _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bold=0,.fontsize=675,.italic=0"
            _StyleDefs(7)   =   ":id=1,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(8)   =   ":id=1,.fontname=Arial"
            _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
            _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34"
            _StyleDefs(11)  =   "FooterStyle:id=3,.parent=1,.namedParent=35"
            _StyleDefs(12)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(13)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
            _StyleDefs(14)  =   "EditorStyle:id=7,.parent=1"
            _StyleDefs(15)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
            _StyleDefs(16)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
            _StyleDefs(17)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
            _StyleDefs(18)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
            _StyleDefs(19)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
            _StyleDefs(20)  =   "Splits(0).Style:id=13,.parent=1"
            _StyleDefs(21)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
            _StyleDefs(22)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
            _StyleDefs(23)  =   "Splits(0).FooterStyle:id=15,.parent=3"
            _StyleDefs(24)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
            _StyleDefs(25)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
            _StyleDefs(26)  =   "Splits(0).EditorStyle:id=17,.parent=7"
            _StyleDefs(27)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
            _StyleDefs(28)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
            _StyleDefs(29)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
            _StyleDefs(30)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
            _StyleDefs(31)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
            _StyleDefs(32)  =   "Splits(0).Columns(0).Style:id=46,.parent=13"
            _StyleDefs(33)  =   "Splits(0).Columns(0).HeadingStyle:id=43,.parent=14"
            _StyleDefs(34)  =   "Splits(0).Columns(0).FooterStyle:id=44,.parent=15"
            _StyleDefs(35)  =   "Splits(0).Columns(0).EditorStyle:id=45,.parent=17"
            _StyleDefs(36)  =   "Splits(0).Columns(1).Style:id=50,.parent=13"
            _StyleDefs(37)  =   "Splits(0).Columns(1).HeadingStyle:id=47,.parent=14"
            _StyleDefs(38)  =   "Splits(0).Columns(1).FooterStyle:id=48,.parent=15"
            _StyleDefs(39)  =   "Splits(0).Columns(1).EditorStyle:id=49,.parent=17"
            _StyleDefs(40)  =   "Splits(0).Columns(2).Style:id=28,.parent=13"
            _StyleDefs(41)  =   "Splits(0).Columns(2).HeadingStyle:id=25,.parent=14"
            _StyleDefs(42)  =   "Splits(0).Columns(2).FooterStyle:id=26,.parent=15"
            _StyleDefs(43)  =   "Splits(0).Columns(2).EditorStyle:id=27,.parent=17"
            _StyleDefs(44)  =   "Splits(0).Columns(3).Style:id=32,.parent=13"
            _StyleDefs(45)  =   "Splits(0).Columns(3).HeadingStyle:id=29,.parent=14"
            _StyleDefs(46)  =   "Splits(0).Columns(3).FooterStyle:id=30,.parent=15"
            _StyleDefs(47)  =   "Splits(0).Columns(3).EditorStyle:id=31,.parent=17"
            _StyleDefs(48)  =   "Splits(0).Columns(4).Style:id=54,.parent=13"
            _StyleDefs(49)  =   "Splits(0).Columns(4).HeadingStyle:id=51,.parent=14"
            _StyleDefs(50)  =   "Splits(0).Columns(4).FooterStyle:id=52,.parent=15"
            _StyleDefs(51)  =   "Splits(0).Columns(4).EditorStyle:id=53,.parent=17"
            _StyleDefs(52)  =   "Named:id=33:Normal"
            _StyleDefs(53)  =   ":id=33,.parent=0"
            _StyleDefs(54)  =   "Named:id=34:Heading"
            _StyleDefs(55)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(56)  =   ":id=34,.wraptext=-1"
            _StyleDefs(57)  =   "Named:id=35:Footing"
            _StyleDefs(58)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(59)  =   "Named:id=36:Selected"
            _StyleDefs(60)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(61)  =   "Named:id=37:Caption"
            _StyleDefs(62)  =   ":id=37,.parent=34,.alignment=2"
            _StyleDefs(63)  =   "Named:id=38:HighlightRow"
            _StyleDefs(64)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(65)  =   "Named:id=39:EvenRow"
            _StyleDefs(66)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
            _StyleDefs(67)  =   "Named:id=40:OddRow"
            _StyleDefs(68)  =   ":id=40,.parent=33"
            _StyleDefs(69)  =   "Named:id=41:RecordSelector"
            _StyleDefs(70)  =   ":id=41,.parent=34"
            _StyleDefs(71)  =   "Named:id=42:FilterBar"
            _StyleDefs(72)  =   ":id=42,.parent=33"
         End
         Begin TDBText6Ctl.TDBText tdbtNumVoucher 
            Height          =   300
            Left            =   4455
            TabIndex        =   1
            Tag             =   "enabled"
            Top             =   30
            Width           =   1065
            _Version        =   65536
            _ExtentX        =   1879
            _ExtentY        =   529
            Caption         =   "frmManAsientosContables.frx":F648
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":F6B4
            Key             =   "frmManAsientosContables.frx":F6D2
            BackColor       =   16777215
            EditMode        =   0
            ForeColor       =   -2147483640
            ReadOnly        =   0
            ShowContextMenu =   1
            MarginLeft      =   1
            MarginRight     =   1
            MarginTop       =   1
            MarginBottom    =   1
            Enabled         =   0
            MousePointer    =   0
            Appearance      =   1
            BorderStyle     =   1
            AlignHorizontal =   1
            AlignVertical   =   2
            MultiLine       =   0
            ScrollBars      =   0
            PasswordChar    =   ""
            AllowSpace      =   -1
            Format          =   ""
            FormatMode      =   1
            AutoConvert     =   -1
            ErrorBeep       =   0
            MaxLength       =   10
            LengthAsByte    =   0
            Text            =   ""
            Furigana        =   0
            HighlightText   =   -1
            IMEMode         =   0
            IMEStatus       =   0
            DropWndWidth    =   0
            DropWndHeight   =   0
            ScrollBarMode   =   0
            MoveOnLRKey     =   0
            OLEDragMode     =   0
            OLEDropMode     =   0
         End
         Begin TDBNumber6Ctl.TDBNumber tdbnPorcIGV 
            Height          =   300
            Left            =   9555
            TabIndex        =   6
            Tag             =   "enabled"
            Top             =   960
            Width           =   675
            _Version        =   65536
            _ExtentX        =   1191
            _ExtentY        =   529
            Calculator      =   "frmManAsientosContables.frx":F706
            Caption         =   "frmManAsientosContables.frx":F726
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":F792
            Keys            =   "frmManAsientosContables.frx":F7B0
            Spin            =   "frmManAsientosContables.frx":F7EA
            AlignHorizontal =   1
            AlignVertical   =   0
            Appearance      =   1
            BackColor       =   -2147483643
            BorderStyle     =   1
            BtnPositioning  =   0
            ClipMode        =   0
            ClearAction     =   0
            DecimalPoint    =   "."
            DisplayFormat   =   "####0.00"
            EditMode        =   0
            Enabled         =   0
            ErrorBeep       =   0
            ForeColor       =   -2147483640
            Format          =   "####0.00"
            HighlightText   =   1
            MarginBottom    =   1
            MarginLeft      =   1
            MarginRight     =   1
            MarginTop       =   1
            MaxValue        =   99999
            MinValue        =   0
            MousePointer    =   0
            MoveOnLRKey     =   0
            NegativeColor   =   255
            OLEDragMode     =   0
            OLEDropMode     =   0
            ReadOnly        =   0
            Separator       =   ","
            ShowContextMenu =   1
            ValueVT         =   1
            Value           =   0
            MaxValueVT      =   1380909061
            MinValueVT      =   1162608645
         End
         Begin TrueOleDBList70.TDBCombo tdbcLibro 
            Height          =   300
            Left            =   705
            TabIndex        =   0
            Tag             =   "enabled"
            Top             =   30
            Width           =   2835
            _ExtentX        =   5001
            _ExtentY        =   529
            _LayoutType     =   4
            _RowHeight      =   -2147483647
            _WasPersistedAsPixels=   0
            _DropdownWidth  =   0
            Columns(0)._VlistStyle=   0
            Columns(0)._MaxComboItems=   5
            Columns(0).DataField=   ""
            Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(1)._VlistStyle=   0
            Columns(1)._MaxComboItems=   5
            Columns(1).DataField=   ""
            Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(2)._VlistStyle=   0
            Columns(2)._MaxComboItems=   5
            Columns(2).DataField=   ""
            Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(3)._VlistStyle=   0
            Columns(3)._MaxComboItems=   5
            Columns(3).DataField=   ""
            Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(4)._VlistStyle=   0
            Columns(4)._MaxComboItems=   5
            Columns(4).DataField=   ""
            Columns(4)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(5)._VlistStyle=   0
            Columns(5)._MaxComboItems=   5
            Columns(5).DataField=   ""
            Columns(5)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(6)._VlistStyle=   0
            Columns(6)._MaxComboItems=   5
            Columns(6).DataField=   ""
            Columns(6)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(7)._VlistStyle=   0
            Columns(7)._MaxComboItems=   5
            Columns(7).DataField=   ""
            Columns(7)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(8)._VlistStyle=   0
            Columns(8)._MaxComboItems=   5
            Columns(8).DataField=   ""
            Columns(8)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(9)._VlistStyle=   0
            Columns(9)._MaxComboItems=   5
            Columns(9).DataField=   ""
            Columns(9)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns.Count   =   10
            Splits(0)._UserFlags=   0
            Splits(0).ExtendRightColumn=   -1  'True
            Splits(0).AllowRowSizing=   0   'False
            Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
            Splits(0)._ColumnProps(0)=   "Columns.Count=10"
            Splits(0)._ColumnProps(1)=   "Column(0).Width=503"
            Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
            Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=423"
            Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
            Splits(0)._ColumnProps(5)=   "Column(0).Order=1"
            Splits(0)._ColumnProps(6)=   "Column(1).Width=847"
            Splits(0)._ColumnProps(7)=   "Column(1).DividerColor=0"
            Splits(0)._ColumnProps(8)=   "Column(1)._WidthInPix=767"
            Splits(0)._ColumnProps(9)=   "Column(1)._EditAlways=0"
            Splits(0)._ColumnProps(10)=   "Column(1).Order=2"
            Splits(0)._ColumnProps(11)=   "Column(2).Width=1138"
            Splits(0)._ColumnProps(12)=   "Column(2).DividerColor=0"
            Splits(0)._ColumnProps(13)=   "Column(2)._WidthInPix=1058"
            Splits(0)._ColumnProps(14)=   "Column(2)._EditAlways=0"
            Splits(0)._ColumnProps(15)=   "Column(2).Visible=0"
            Splits(0)._ColumnProps(16)=   "Column(2).Order=3"
            Splits(0)._ColumnProps(17)=   "Column(3).Width=2196"
            Splits(0)._ColumnProps(18)=   "Column(3).DividerColor=0"
            Splits(0)._ColumnProps(19)=   "Column(3)._WidthInPix=2117"
            Splits(0)._ColumnProps(20)=   "Column(3)._EditAlways=0"
            Splits(0)._ColumnProps(21)=   "Column(3).Visible=0"
            Splits(0)._ColumnProps(22)=   "Column(3).Order=4"
            Splits(0)._ColumnProps(23)=   "Column(4).Width=2196"
            Splits(0)._ColumnProps(24)=   "Column(4).DividerColor=0"
            Splits(0)._ColumnProps(25)=   "Column(4)._WidthInPix=2117"
            Splits(0)._ColumnProps(26)=   "Column(4)._EditAlways=0"
            Splits(0)._ColumnProps(27)=   "Column(4).Visible=0"
            Splits(0)._ColumnProps(28)=   "Column(4).Order=5"
            Splits(0)._ColumnProps(29)=   "Column(5).Width=2196"
            Splits(0)._ColumnProps(30)=   "Column(5).DividerColor=0"
            Splits(0)._ColumnProps(31)=   "Column(5)._WidthInPix=2117"
            Splits(0)._ColumnProps(32)=   "Column(5)._EditAlways=0"
            Splits(0)._ColumnProps(33)=   "Column(5).Visible=0"
            Splits(0)._ColumnProps(34)=   "Column(5).Order=6"
            Splits(0)._ColumnProps(35)=   "Column(6).Width=2196"
            Splits(0)._ColumnProps(36)=   "Column(6).DividerColor=0"
            Splits(0)._ColumnProps(37)=   "Column(6)._WidthInPix=2117"
            Splits(0)._ColumnProps(38)=   "Column(6)._EditAlways=0"
            Splits(0)._ColumnProps(39)=   "Column(6).Visible=0"
            Splits(0)._ColumnProps(40)=   "Column(6).Order=7"
            Splits(0)._ColumnProps(41)=   "Column(7).Width=2196"
            Splits(0)._ColumnProps(42)=   "Column(7).DividerColor=0"
            Splits(0)._ColumnProps(43)=   "Column(7)._WidthInPix=2117"
            Splits(0)._ColumnProps(44)=   "Column(7)._EditAlways=0"
            Splits(0)._ColumnProps(45)=   "Column(7).Visible=0"
            Splits(0)._ColumnProps(46)=   "Column(7).Order=8"
            Splits(0)._ColumnProps(47)=   "Column(8).Width=2196"
            Splits(0)._ColumnProps(48)=   "Column(8).DividerColor=0"
            Splits(0)._ColumnProps(49)=   "Column(8)._WidthInPix=2117"
            Splits(0)._ColumnProps(50)=   "Column(8)._EditAlways=0"
            Splits(0)._ColumnProps(51)=   "Column(8).Visible=0"
            Splits(0)._ColumnProps(52)=   "Column(8).Order=9"
            Splits(0)._ColumnProps(53)=   "Column(9).Width=2196"
            Splits(0)._ColumnProps(54)=   "Column(9).DividerColor=0"
            Splits(0)._ColumnProps(55)=   "Column(9)._WidthInPix=2117"
            Splits(0)._ColumnProps(56)=   "Column(9)._EditAlways=0"
            Splits(0)._ColumnProps(57)=   "Column(9).Visible=0"
            Splits(0)._ColumnProps(58)=   "Column(9).Order=10"
            Splits.Count    =   1
            Appearance      =   1
            BorderStyle     =   1
            ComboStyle      =   2
            AutoCompletion  =   0   'False
            LimitToList     =   0   'False
            ColumnHeaders   =   0   'False
            ColumnFooters   =   0   'False
            DataMode        =   5
            DefColWidth     =   0
            Enabled         =   0   'False
            HeadLines       =   1
            FootLines       =   1
            RowDividerStyle =   0
            Caption         =   ""
            EditFont        =   "Size=6.75,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
            LayoutName      =   ""
            LayoutFileName  =   ""
            MultipleLines   =   0
            EmptyRows       =   -1  'True
            CellTips        =   0
            EditHeight      =   299.906
            AutoSize        =   -1  'True
            GapHeight       =   30.047
            ListField       =   ""
            BoundColumn     =   ""
            IntegralHeight  =   0   'False
            CellTipsWidth   =   0
            CellTipsDelay   =   1000
            AutoDropdown    =   -1  'True
            RowTracking     =   -1  'True
            RightToLeft     =   0   'False
            RowMember       =   ""
            MouseIcon       =   0
            MouseIcon.vt    =   3
            MousePointer    =   0
            MatchEntryTimeout=   2000
            OLEDragMode     =   0
            OLEDropMode     =   0
            AnimateWindow   =   0
            AnimateWindowDirection=   0
            AnimateWindowTime=   200
            AnimateWindowClose=   0
            DropdownPosition=   0
            Locked          =   0   'False
            ScrollTrack     =   0   'False
            RowDividerColor =   12632256
            RowSubDividerColor=   12632256
            AddItemSeparator=   ";"
            _PropDict       =   $"frmManAsientosContables.frx":F812
            _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
            _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
            _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
            _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=825,.italic=0"
            _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
            _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bold=0,.fontsize=675,.italic=0"
            _StyleDefs(7)   =   ":id=1,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(8)   =   ":id=1,.fontname=Arial"
            _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
            _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34"
            _StyleDefs(11)  =   "FooterStyle:id=3,.parent=1,.namedParent=35"
            _StyleDefs(12)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(13)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
            _StyleDefs(14)  =   "EditorStyle:id=7,.parent=1"
            _StyleDefs(15)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
            _StyleDefs(16)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
            _StyleDefs(17)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
            _StyleDefs(18)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
            _StyleDefs(19)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
            _StyleDefs(20)  =   "Splits(0).Style:id=13,.parent=1"
            _StyleDefs(21)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
            _StyleDefs(22)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
            _StyleDefs(23)  =   "Splits(0).FooterStyle:id=15,.parent=3"
            _StyleDefs(24)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
            _StyleDefs(25)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
            _StyleDefs(26)  =   "Splits(0).EditorStyle:id=17,.parent=7"
            _StyleDefs(27)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
            _StyleDefs(28)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
            _StyleDefs(29)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
            _StyleDefs(30)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
            _StyleDefs(31)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
            _StyleDefs(32)  =   "Splits(0).Columns(0).Style:id=46,.parent=13"
            _StyleDefs(33)  =   "Splits(0).Columns(0).HeadingStyle:id=43,.parent=14"
            _StyleDefs(34)  =   "Splits(0).Columns(0).FooterStyle:id=44,.parent=15"
            _StyleDefs(35)  =   "Splits(0).Columns(0).EditorStyle:id=45,.parent=17"
            _StyleDefs(36)  =   "Splits(0).Columns(1).Style:id=28,.parent=13"
            _StyleDefs(37)  =   "Splits(0).Columns(1).HeadingStyle:id=25,.parent=14"
            _StyleDefs(38)  =   "Splits(0).Columns(1).FooterStyle:id=26,.parent=15"
            _StyleDefs(39)  =   "Splits(0).Columns(1).EditorStyle:id=27,.parent=17"
            _StyleDefs(40)  =   "Splits(0).Columns(2).Style:id=32,.parent=13"
            _StyleDefs(41)  =   "Splits(0).Columns(2).HeadingStyle:id=29,.parent=14"
            _StyleDefs(42)  =   "Splits(0).Columns(2).FooterStyle:id=30,.parent=15"
            _StyleDefs(43)  =   "Splits(0).Columns(2).EditorStyle:id=31,.parent=17"
            _StyleDefs(44)  =   "Splits(0).Columns(3).Style:id=50,.parent=13"
            _StyleDefs(45)  =   "Splits(0).Columns(3).HeadingStyle:id=47,.parent=14"
            _StyleDefs(46)  =   "Splits(0).Columns(3).FooterStyle:id=48,.parent=15"
            _StyleDefs(47)  =   "Splits(0).Columns(3).EditorStyle:id=49,.parent=17"
            _StyleDefs(48)  =   "Splits(0).Columns(4).Style:id=54,.parent=13"
            _StyleDefs(49)  =   "Splits(0).Columns(4).HeadingStyle:id=51,.parent=14"
            _StyleDefs(50)  =   "Splits(0).Columns(4).FooterStyle:id=52,.parent=15"
            _StyleDefs(51)  =   "Splits(0).Columns(4).EditorStyle:id=53,.parent=17"
            _StyleDefs(52)  =   "Splits(0).Columns(5).Style:id=58,.parent=13"
            _StyleDefs(53)  =   "Splits(0).Columns(5).HeadingStyle:id=55,.parent=14"
            _StyleDefs(54)  =   "Splits(0).Columns(5).FooterStyle:id=56,.parent=15"
            _StyleDefs(55)  =   "Splits(0).Columns(5).EditorStyle:id=57,.parent=17"
            _StyleDefs(56)  =   "Splits(0).Columns(6).Style:id=62,.parent=13"
            _StyleDefs(57)  =   "Splits(0).Columns(6).HeadingStyle:id=59,.parent=14"
            _StyleDefs(58)  =   "Splits(0).Columns(6).FooterStyle:id=60,.parent=15"
            _StyleDefs(59)  =   "Splits(0).Columns(6).EditorStyle:id=61,.parent=17"
            _StyleDefs(60)  =   "Splits(0).Columns(7).Style:id=66,.parent=13"
            _StyleDefs(61)  =   "Splits(0).Columns(7).HeadingStyle:id=63,.parent=14"
            _StyleDefs(62)  =   "Splits(0).Columns(7).FooterStyle:id=64,.parent=15"
            _StyleDefs(63)  =   "Splits(0).Columns(7).EditorStyle:id=65,.parent=17"
            _StyleDefs(64)  =   "Splits(0).Columns(8).Style:id=70,.parent=13"
            _StyleDefs(65)  =   "Splits(0).Columns(8).HeadingStyle:id=67,.parent=14"
            _StyleDefs(66)  =   "Splits(0).Columns(8).FooterStyle:id=68,.parent=15"
            _StyleDefs(67)  =   "Splits(0).Columns(8).EditorStyle:id=69,.parent=17"
            _StyleDefs(68)  =   "Splits(0).Columns(9).Style:id=74,.parent=13"
            _StyleDefs(69)  =   "Splits(0).Columns(9).HeadingStyle:id=71,.parent=14"
            _StyleDefs(70)  =   "Splits(0).Columns(9).FooterStyle:id=72,.parent=15"
            _StyleDefs(71)  =   "Splits(0).Columns(9).EditorStyle:id=73,.parent=17"
            _StyleDefs(72)  =   "Named:id=33:Normal"
            _StyleDefs(73)  =   ":id=33,.parent=0"
            _StyleDefs(74)  =   "Named:id=34:Heading"
            _StyleDefs(75)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(76)  =   ":id=34,.wraptext=-1"
            _StyleDefs(77)  =   "Named:id=35:Footing"
            _StyleDefs(78)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(79)  =   "Named:id=36:Selected"
            _StyleDefs(80)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(81)  =   "Named:id=37:Caption"
            _StyleDefs(82)  =   ":id=37,.parent=34,.alignment=2"
            _StyleDefs(83)  =   "Named:id=38:HighlightRow"
            _StyleDefs(84)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(85)  =   "Named:id=39:EvenRow"
            _StyleDefs(86)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
            _StyleDefs(87)  =   "Named:id=40:OddRow"
            _StyleDefs(88)  =   ":id=40,.parent=33"
            _StyleDefs(89)  =   "Named:id=41:RecordSelector"
            _StyleDefs(90)  =   ":id=41,.parent=34"
            _StyleDefs(91)  =   "Named:id=42:FilterBar"
            _StyleDefs(92)  =   ":id=42,.parent=33"
         End
         Begin TDBDate6Ctl.TDBDate dtpFecha 
            Height          =   300
            Left            =   6345
            TabIndex        =   2
            Tag             =   "enabled"
            Top             =   30
            Width           =   1245
            _Version        =   65536
            _ExtentX        =   2196
            _ExtentY        =   529
            Calendar        =   "frmManAsientosContables.frx":F899
            Caption         =   "frmManAsientosContables.frx":F99B
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DropDown        =   "frmManAsientosContables.frx":F9FF
            Keys            =   "frmManAsientosContables.frx":FA1D
            Spin            =   "frmManAsientosContables.frx":FA71
            AlignHorizontal =   0
            AlignVertical   =   0
            Appearance      =   1
            BackColor       =   -2147483643
            BorderStyle     =   1
            BtnPositioning  =   0
            ClipMode        =   0
            CursorPosition  =   0
            DataProperty    =   0
            DisplayFormat   =   "dd/mm/yyyy"
            EditMode        =   0
            Enabled         =   0
            ErrorBeep       =   0
            FirstMonth      =   1
            ForeColor       =   -2147483640
            Format          =   "dd/mm/yyyy"
            HighlightText   =   0
            IMEMode         =   3
            MarginBottom    =   1
            MarginLeft      =   1
            MarginRight     =   1
            MarginTop       =   1
            MaxDate         =   73415
            MinDate         =   2
            MousePointer    =   0
            MoveOnLRKey     =   0
            OLEDragMode     =   0
            OLEDropMode     =   0
            PromptChar      =   "_"
            ReadOnly        =   0
            ShowContextMenu =   1
            ShowLiterals    =   0
            TabAction       =   0
            Text            =   "03/08/2004"
            ValidateMode    =   0
            ValueVT         =   2010185735
            Value           =   38202
            CenturyMode     =   0
         End
         Begin TrueOleDBList70.TDBCombo tdbcTipoOperacion 
            Height          =   300
            Left            =   9570
            TabIndex        =   5
            Tag             =   "_"
            Top             =   945
            Width           =   2070
            _ExtentX        =   3651
            _ExtentY        =   529
            _LayoutType     =   4
            _RowHeight      =   -2147483647
            _WasPersistedAsPixels=   0
            _DropdownWidth  =   0
            Columns(0)._VlistStyle=   0
            Columns(0)._MaxComboItems=   5
            Columns(0).DataField=   ""
            Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(1)._VlistStyle=   0
            Columns(1)._MaxComboItems=   5
            Columns(1).DataField=   ""
            Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(2)._VlistStyle=   0
            Columns(2)._MaxComboItems=   5
            Columns(2).DataField=   ""
            Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns(3)._VlistStyle=   0
            Columns(3)._MaxComboItems=   5
            Columns(3).DataField=   ""
            Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
            Columns.Count   =   4
            Splits(0)._UserFlags=   0
            Splits(0).ExtendRightColumn=   -1  'True
            Splits(0).AllowRowSizing=   0   'False
            Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
            Splits(0)._ColumnProps(0)=   "Columns.Count=4"
            Splits(0)._ColumnProps(1)=   "Column(0).Width=609"
            Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
            Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=529"
            Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
            Splits(0)._ColumnProps(5)=   "Column(0).Visible=0"
            Splits(0)._ColumnProps(6)=   "Column(0).Order=1"
            Splits(0)._ColumnProps(7)=   "Column(1).Width=370"
            Splits(0)._ColumnProps(8)=   "Column(1).DividerColor=0"
            Splits(0)._ColumnProps(9)=   "Column(1)._WidthInPix=291"
            Splits(0)._ColumnProps(10)=   "Column(1)._EditAlways=0"
            Splits(0)._ColumnProps(11)=   "Column(1).Order=2"
            Splits(0)._ColumnProps(12)=   "Column(2).Width=847"
            Splits(0)._ColumnProps(13)=   "Column(2).DividerColor=0"
            Splits(0)._ColumnProps(14)=   "Column(2)._WidthInPix=767"
            Splits(0)._ColumnProps(15)=   "Column(2)._EditAlways=0"
            Splits(0)._ColumnProps(16)=   "Column(2).Visible=0"
            Splits(0)._ColumnProps(17)=   "Column(2).Order=3"
            Splits(0)._ColumnProps(18)=   "Column(3).Width=1376"
            Splits(0)._ColumnProps(19)=   "Column(3).DividerColor=0"
            Splits(0)._ColumnProps(20)=   "Column(3)._WidthInPix=1296"
            Splits(0)._ColumnProps(21)=   "Column(3)._EditAlways=0"
            Splits(0)._ColumnProps(22)=   "Column(3).Visible=0"
            Splits(0)._ColumnProps(23)=   "Column(3).Order=4"
            Splits.Count    =   1
            Appearance      =   1
            BorderStyle     =   1
            ComboStyle      =   2
            AutoCompletion  =   0   'False
            LimitToList     =   0   'False
            ColumnHeaders   =   0   'False
            ColumnFooters   =   0   'False
            DataMode        =   5
            DefColWidth     =   0
            Enabled         =   0   'False
            HeadLines       =   1
            FootLines       =   1
            RowDividerStyle =   0
            Caption         =   ""
            EditFont        =   "Size=6.75,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
            LayoutName      =   ""
            LayoutFileName  =   ""
            MultipleLines   =   0
            EmptyRows       =   -1  'True
            CellTips        =   0
            EditHeight      =   299.906
            AutoSize        =   -1  'True
            GapHeight       =   30.047
            ListField       =   ""
            BoundColumn     =   ""
            IntegralHeight  =   0   'False
            CellTipsWidth   =   0
            CellTipsDelay   =   1000
            AutoDropdown    =   -1  'True
            RowTracking     =   -1  'True
            RightToLeft     =   0   'False
            RowMember       =   ""
            MouseIcon       =   0
            MouseIcon.vt    =   3
            MousePointer    =   0
            MatchEntryTimeout=   2000
            OLEDragMode     =   0
            OLEDropMode     =   0
            AnimateWindow   =   0
            AnimateWindowDirection=   0
            AnimateWindowTime=   200
            AnimateWindowClose=   0
            DropdownPosition=   0
            Locked          =   0   'False
            ScrollTrack     =   0   'False
            RowDividerColor =   12632256
            RowSubDividerColor=   12632256
            AddItemSeparator=   ";"
            _PropDict       =   $"frmManAsientosContables.frx":FA99
            _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
            _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
            _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
            _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=825,.italic=0"
            _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
            _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bold=0,.fontsize=675,.italic=0"
            _StyleDefs(7)   =   ":id=1,.underline=0,.strikethrough=0,.charset=0"
            _StyleDefs(8)   =   ":id=1,.fontname=Arial"
            _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
            _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34"
            _StyleDefs(11)  =   "FooterStyle:id=3,.parent=1,.namedParent=35"
            _StyleDefs(12)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(13)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
            _StyleDefs(14)  =   "EditorStyle:id=7,.parent=1"
            _StyleDefs(15)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
            _StyleDefs(16)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
            _StyleDefs(17)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
            _StyleDefs(18)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
            _StyleDefs(19)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
            _StyleDefs(20)  =   "Splits(0).Style:id=13,.parent=1"
            _StyleDefs(21)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
            _StyleDefs(22)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
            _StyleDefs(23)  =   "Splits(0).FooterStyle:id=15,.parent=3"
            _StyleDefs(24)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
            _StyleDefs(25)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
            _StyleDefs(26)  =   "Splits(0).EditorStyle:id=17,.parent=7"
            _StyleDefs(27)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
            _StyleDefs(28)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
            _StyleDefs(29)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
            _StyleDefs(30)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
            _StyleDefs(31)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
            _StyleDefs(32)  =   "Splits(0).Columns(0).Style:id=46,.parent=13"
            _StyleDefs(33)  =   "Splits(0).Columns(0).HeadingStyle:id=43,.parent=14"
            _StyleDefs(34)  =   "Splits(0).Columns(0).FooterStyle:id=44,.parent=15"
            _StyleDefs(35)  =   "Splits(0).Columns(0).EditorStyle:id=45,.parent=17"
            _StyleDefs(36)  =   "Splits(0).Columns(1).Style:id=50,.parent=13"
            _StyleDefs(37)  =   "Splits(0).Columns(1).HeadingStyle:id=47,.parent=14"
            _StyleDefs(38)  =   "Splits(0).Columns(1).FooterStyle:id=48,.parent=15"
            _StyleDefs(39)  =   "Splits(0).Columns(1).EditorStyle:id=49,.parent=17"
            _StyleDefs(40)  =   "Splits(0).Columns(2).Style:id=28,.parent=13"
            _StyleDefs(41)  =   "Splits(0).Columns(2).HeadingStyle:id=25,.parent=14"
            _StyleDefs(42)  =   "Splits(0).Columns(2).FooterStyle:id=26,.parent=15"
            _StyleDefs(43)  =   "Splits(0).Columns(2).EditorStyle:id=27,.parent=17"
            _StyleDefs(44)  =   "Splits(0).Columns(3).Style:id=32,.parent=13"
            _StyleDefs(45)  =   "Splits(0).Columns(3).HeadingStyle:id=29,.parent=14"
            _StyleDefs(46)  =   "Splits(0).Columns(3).FooterStyle:id=30,.parent=15"
            _StyleDefs(47)  =   "Splits(0).Columns(3).EditorStyle:id=31,.parent=17"
            _StyleDefs(48)  =   "Named:id=33:Normal"
            _StyleDefs(49)  =   ":id=33,.parent=0"
            _StyleDefs(50)  =   "Named:id=34:Heading"
            _StyleDefs(51)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(52)  =   ":id=34,.wraptext=-1"
            _StyleDefs(53)  =   "Named:id=35:Footing"
            _StyleDefs(54)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
            _StyleDefs(55)  =   "Named:id=36:Selected"
            _StyleDefs(56)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(57)  =   "Named:id=37:Caption"
            _StyleDefs(58)  =   ":id=37,.parent=34,.alignment=2"
            _StyleDefs(59)  =   "Named:id=38:HighlightRow"
            _StyleDefs(60)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
            _StyleDefs(61)  =   "Named:id=39:EvenRow"
            _StyleDefs(62)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
            _StyleDefs(63)  =   "Named:id=40:OddRow"
            _StyleDefs(64)  =   ":id=40,.parent=33"
            _StyleDefs(65)  =   "Named:id=41:RecordSelector"
            _StyleDefs(66)  =   ":id=41,.parent=34"
            _StyleDefs(67)  =   "Named:id=42:FilterBar"
            _StyleDefs(68)  =   ":id=42,.parent=33"
         End
         Begin VB.Label Label1 
            AutoSize        =   -1  'True
            Caption         =   "Cuenta Corriente"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   225
            Index           =   6
            Left            =   8010
            TabIndex        =   51
            Top             =   990
            Width           =   1440
         End
         Begin VB.Label Label1 
            AutoSize        =   -1  'True
            Caption         =   "Glosa"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   225
            Index           =   3
            Left            =   45
            TabIndex        =   29
            Top             =   435
            Width           =   480
         End
         Begin VB.Label Label1 
            AutoSize        =   -1  'True
            Caption         =   "Voucher"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   225
            Index           =   2
            Left            =   3645
            TabIndex        =   28
            Top             =   75
            Width           =   720
         End
         Begin VB.Label Label1 
            AutoSize        =   -1  'True
            Caption         =   "Fecha"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   225
            Index           =   1
            Left            =   5715
            TabIndex        =   27
            Top             =   75
            Width           =   510
         End
         Begin VB.Label Label1 
            AutoSize        =   -1  'True
            Caption         =   "Libro"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   225
            Index           =   0
            Left            =   45
            TabIndex        =   26
            Top             =   75
            Width           =   435
         End
         Begin VB.Label Label1 
            AutoSize        =   -1  'True
            Caption         =   "Moneda"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   225
            Index           =   4
            Left            =   7680
            TabIndex        =   25
            Top             =   75
            Width           =   675
         End
         Begin VB.Label Label1 
            AutoSize        =   -1  'True
            Caption         =   "IGV ( % )"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00800000&
            Height          =   225
            Index           =   5
            Left            =   7725
            TabIndex        =   24
            Top             =   885
            Width           =   675
         End
      End
      Begin TrueOleDBGrid70.TDBGrid tdbgDetalle 
         Height          =   2565
         Left            =   45
         TabIndex        =   7
         Top             =   1125
         Width           =   12000
         _ExtentX        =   21167
         _ExtentY        =   4524
         _LayoutType     =   4
         _RowHeight      =   18
         _WasPersistedAsPixels=   0
         Columns(0)._VlistStyle=   0
         Columns(0)._MaxComboItems=   5
         Columns(0).Caption=   "Item"
         Columns(0).DataField=   ""
         Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(1)._VlistStyle=   0
         Columns(1)._MaxComboItems=   5
         Columns(1).Caption=   "Cuenta"
         Columns(1).DataField=   ""
         Columns(1).DataWidth=   12
         Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(2)._VlistStyle=   0
         Columns(2)._MaxComboItems=   5
         Columns(2).Caption=   "Nombre Cta"
         Columns(2).DataField=   ""
         Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(3)._VlistStyle=   0
         Columns(3)._MaxComboItems=   5
         Columns(3).Caption=   "Afecto"
         Columns(3).DataField=   ""
         Columns(3).DropDown=   "tdbdAfect"
         Columns(3).DropDown.vt=   8
         Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(4)._VlistStyle=   0
         Columns(4)._MaxComboItems=   5
         Columns(4).Caption=   "Codigo Entidad"
         Columns(4).DataField=   ""
         Columns(4).DataWidth=   5
         Columns(4)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(5)._VlistStyle=   16
         Columns(5)._MaxComboItems=   5
         Columns(5).ValueItems(0)._DefaultItem=   0
         Columns(5).ValueItems(0).Value=   "1"
         Columns(5).ValueItems(0).Value.vt=   8
         Columns(5).ValueItems(0).DisplayValue.CLSID=   "{0BE35204-8F91-11CE-9DE3-00AA004BB851}"
         Columns(5).ValueItems(0).DisplayValue(0)=   "bHQAADYDAABCTTYDAAAAAAAANgAAACgAAAAQAAAAEAAAAAEAGAAAAAAAAAMAAAAAAAAAAAAAAAAA"
         Columns(5).ValueItems(0).DisplayValue(1)=   "AAAAAADw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw"
         Columns(5).ValueItems(0).DisplayValue(2)=   "8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw"
         Columns(5).ValueItems(0).DisplayValue(3)=   "8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PAAgADw"
         Columns(5).ValueItems(0).DisplayValue(4)=   "8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PAAgAAAgAAAgADw8PDw8PDw"
         Columns(5).ValueItems(0).DisplayValue(5)=   "8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PAAgAAAgAAAgAAAgADw8PDw8PDw8PDw8PDw8PDw"
         Columns(5).ValueItems(0).DisplayValue(6)=   "8PDw8PDw8PDw8PDw8PDw8PAAgAAAgAAAgAAAgAAAgAAAgADw8PDw8PDw8PDw8PDw8PDw8PDw8PDw"
         Columns(5).ValueItems(0).DisplayValue(7)=   "8PDw8PAAgAAAgAAAgADw8PDw8PAAgAAAgAAAgADw8PDw8PDw8PDw8PDw8PDw8PDw8PAAgAAAgADw"
         Columns(5).ValueItems(0).DisplayValue(8)=   "8PDw8PDw8PDw8PDw8PAAgAAAgAAAgADw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw"
         Columns(5).ValueItems(0).DisplayValue(9)=   "8PDw8PDw8PAAgAAAgADw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw"
         Columns(5).ValueItems(0).DisplayValue(10)=   "8PAAgAAAgADw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PAAgAAA"
         Columns(5).ValueItems(0).DisplayValue(11)=   "gADw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PAAgADw8PDw"
         Columns(5).ValueItems(0).DisplayValue(12)=   "8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw"
         Columns(5).ValueItems(0).DisplayValue(13)=   "8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw"
         Columns(5).ValueItems(0).DisplayValue(14)=   "8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PA="
         Columns(5).ValueItems(0).DisplayValue.vt=   9
         Columns(5).ValueItems(0)._PropDict=   "_DefaultItem,517,2"
         Columns(5).ValueItems(1)._DefaultItem=   0
         Columns(5).ValueItems(1).Value=   "0"
         Columns(5).ValueItems(1).Value.vt=   8
         Columns(5).ValueItems(1).DisplayValue=   ""
         Columns(5).ValueItems(1).DisplayValue.vt=   8
         Columns(5).ValueItems(1)._PropDict=   "_DefaultItem,517,2"
         Columns(5).ValueItems.Count=   2
         Columns(5).Caption=   "CC"
         Columns(5).DataField=   ""
         Columns(5)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(6)._VlistStyle=   16
         Columns(6)._MaxComboItems=   5
         Columns(6).ValueItems(0)._DefaultItem=   0
         Columns(6).ValueItems(0).Value=   "1"
         Columns(6).ValueItems(0).Value.vt=   8
         Columns(6).ValueItems(0).DisplayValue.CLSID=   "{0BE35204-8F91-11CE-9DE3-00AA004BB851}"
         Columns(6).ValueItems(0).DisplayValue(0)=   "bHQAADYDAABCTTYDAAAAAAAANgAAACgAAAAQAAAAEAAAAAEAGAAAAAAAAAMAAAAAAAAAAAAAAAAA"
         Columns(6).ValueItems(0).DisplayValue(1)=   "AAAAAADw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw"
         Columns(6).ValueItems(0).DisplayValue(2)=   "8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw"
         Columns(6).ValueItems(0).DisplayValue(3)=   "8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PAAgADw"
         Columns(6).ValueItems(0).DisplayValue(4)=   "8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PAAgAAAgAAAgADw8PDw8PDw"
         Columns(6).ValueItems(0).DisplayValue(5)=   "8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PAAgAAAgAAAgAAAgADw8PDw8PDw8PDw8PDw8PDw"
         Columns(6).ValueItems(0).DisplayValue(6)=   "8PDw8PDw8PDw8PDw8PDw8PAAgAAAgAAAgAAAgAAAgAAAgADw8PDw8PDw8PDw8PDw8PDw8PDw8PDw"
         Columns(6).ValueItems(0).DisplayValue(7)=   "8PDw8PAAgAAAgAAAgADw8PDw8PAAgAAAgAAAgADw8PDw8PDw8PDw8PDw8PDw8PDw8PAAgAAAgADw"
         Columns(6).ValueItems(0).DisplayValue(8)=   "8PDw8PDw8PDw8PDw8PAAgAAAgAAAgADw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw"
         Columns(6).ValueItems(0).DisplayValue(9)=   "8PDw8PDw8PAAgAAAgADw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw"
         Columns(6).ValueItems(0).DisplayValue(10)=   "8PAAgAAAgADw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PAAgAAA"
         Columns(6).ValueItems(0).DisplayValue(11)=   "gADw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PAAgADw8PDw"
         Columns(6).ValueItems(0).DisplayValue(12)=   "8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw"
         Columns(6).ValueItems(0).DisplayValue(13)=   "8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw"
         Columns(6).ValueItems(0).DisplayValue(14)=   "8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PA="
         Columns(6).ValueItems(0).DisplayValue.vt=   9
         Columns(6).ValueItems(0)._PropDict=   "_DefaultItem,517,2"
         Columns(6).ValueItems(1)._DefaultItem=   0
         Columns(6).ValueItems(1).Value=   "0"
         Columns(6).ValueItems(1).Value.vt=   8
         Columns(6).ValueItems(1).DisplayValue=   ""
         Columns(6).ValueItems(1).DisplayValue.vt=   8
         Columns(6).ValueItems(1)._PropDict=   "_DefaultItem,517,2"
         Columns(6).ValueItems.Count=   2
         Columns(6).Caption=   "Prov"
         Columns(6).DataField=   ""
         Columns(6)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(7)._VlistStyle=   0
         Columns(7)._MaxComboItems=   5
         Columns(7).Caption=   "CCosto"
         Columns(7).DataField=   ""
         Columns(7).DataWidth=   6
         Columns(7)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(8)._VlistStyle=   0
         Columns(8)._MaxComboItems=   5
         Columns(8).Caption=   "TD"
         Columns(8).DataField=   ""
         Columns(8).DataWidth=   2
         Columns(8)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(9)._VlistStyle=   0
         Columns(9)._MaxComboItems=   5
         Columns(9).Caption=   "Serie "
         Columns(9).DataField=   ""
         Columns(9).DataWidth=   5
         Columns(9)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(10)._VlistStyle=   0
         Columns(10)._MaxComboItems=   5
         Columns(10).Caption=   "Numero"
         Columns(10).DataField=   ""
         Columns(10).DataWidth=   12
         Columns(10)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(11)._VlistStyle=   0
         Columns(11)._MaxComboItems=   5
         Columns(11).Caption=   "Fecha Doc"
         Columns(11).DataField=   ""
         Columns(11).EditMask=   "##/##/####"
         Columns(11).EditMaskUpdate=   -1  'True
         Columns(11).ExternalEditor=   "dtpFechaDoc"
         Columns(11).ExternalEditor.vt=   8
         Columns(11)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(12)._VlistStyle=   0
         Columns(12)._MaxComboItems=   5
         Columns(12).Caption=   "Fecha Vcto / Fecha Pago"
         Columns(12).DataField=   ""
         Columns(12).EditMask=   "##/##/####"
         Columns(12).EditMaskUpdate=   -1  'True
         Columns(12).ExternalEditor=   "dtpFechaDoc"
         Columns(12).ExternalEditor.vt=   8
         Columns(12)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(13)._VlistStyle=   0
         Columns(13)._MaxComboItems=   5
         Columns(13).Caption=   "Mon"
         Columns(13).DataField=   ""
         Columns(13).DropDown=   "tdbdMoneDet"
         Columns(13).DropDown.vt=   8
         Columns(13)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(14)._VlistStyle=   0
         Columns(14)._MaxComboItems=   5
         Columns(14).Caption=   "Cod Mone"
         Columns(14).DataField=   ""
         Columns(14)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(15)._VlistStyle=   0
         Columns(15)._MaxComboItems=   5
         Columns(15).Caption=   "Opera TC"
         Columns(15).DataField=   ""
         Columns(15).DropDown=   "tdbdOperaTC"
         Columns(15).DropDown.vt=   8
         Columns(15)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(16)._VlistStyle=   0
         Columns(16)._MaxComboItems=   5
         Columns(16).Caption=   "TC"
         Columns(16).DataField=   ""
         Columns(16).NumberFormat=   "External Editor"
         Columns(16).EditMaskUpdate=   -1  'True
         Columns(16).EditMaskRight=   -1  'True
         Columns(16).ExternalEditor=   "tdbtCambio"
         Columns(16).ExternalEditor.vt=   8
         Columns(16)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(17)._VlistStyle=   0
         Columns(17)._MaxComboItems=   5
         Columns(17).Caption=   "Debe M Nac."
         Columns(17).DataField=   ""
         Columns(17).NumberFormat=   "External Editor"
         Columns(17).ExternalEditor=   "tdbtMonto"
         Columns(17).ExternalEditor.vt=   8
         Columns(17)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(18)._VlistStyle=   0
         Columns(18)._MaxComboItems=   5
         Columns(18).Caption=   "Haber M Nac."
         Columns(18).DataField=   ""
         Columns(18).NumberFormat=   "External Editor"
         Columns(18).ExternalEditor=   "tdbtMonto"
         Columns(18).ExternalEditor.vt=   8
         Columns(18)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(19)._VlistStyle=   0
         Columns(19)._MaxComboItems=   5
         Columns(19).Caption=   "Debe M Ext."
         Columns(19).DataField=   ""
         Columns(19).NumberFormat=   "External Editor"
         Columns(19).ExternalEditor=   "tdbtMonto"
         Columns(19).ExternalEditor.vt=   8
         Columns(19)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(20)._VlistStyle=   0
         Columns(20)._MaxComboItems=   5
         Columns(20).Caption=   "Haber M Ext."
         Columns(20).DataField=   ""
         Columns(20).NumberFormat=   "External Editor"
         Columns(20).ExternalEditor=   "tdbtMonto"
         Columns(20).ExternalEditor.vt=   8
         Columns(20)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(21)._VlistStyle=   0
         Columns(21)._MaxComboItems=   5
         Columns(21).Caption=   "Inafecto"
         Columns(21).DataField=   ""
         Columns(21).NumberFormat=   "External Editor"
         Columns(21).ExternalEditor=   "tdbtMonto"
         Columns(21).ExternalEditor.vt=   8
         Columns(21)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(22)._VlistStyle=   0
         Columns(22)._MaxComboItems=   5
         Columns(22).Caption=   "Tipo Entidad"
         Columns(22).DataField=   ""
         Columns(22).DataWidth=   1
         Columns(22)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(23)._VlistStyle=   0
         Columns(23)._MaxComboItems=   5
         Columns(23).Caption=   "Nombre Entidad"
         Columns(23).DataField=   ""
         Columns(23)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(24)._VlistStyle=   0
         Columns(24)._MaxComboItems=   5
         Columns(24).Caption=   "Glosa"
         Columns(24).DataField=   ""
         Columns(24).DataWidth=   150
         Columns(24)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(25)._VlistStyle=   0
         Columns(25)._MaxComboItems=   5
         Columns(25).Caption=   "TD Ref"
         Columns(25).DataField=   ""
         Columns(25).DataWidth=   3
         Columns(25)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(26)._VlistStyle=   0
         Columns(26)._MaxComboItems=   5
         Columns(26).Caption=   "Serie Ref"
         Columns(26).DataField=   ""
         Columns(26).DataWidth=   5
         Columns(26)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(27)._VlistStyle=   0
         Columns(27)._MaxComboItems=   5
         Columns(27).Caption=   "Numero Ref"
         Columns(27).DataField=   ""
         Columns(27).DataWidth=   10
         Columns(27)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(28)._VlistStyle=   0
         Columns(28)._MaxComboItems=   5
         Columns(28).Caption=   "Fecha Doc Ref"
         Columns(28).DataField=   ""
         Columns(28).EditMask=   "##/##/####"
         Columns(28).EditMaskUpdate=   -1  'True
         Columns(28)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(29)._VlistStyle=   0
         Columns(29)._MaxComboItems=   5
         Columns(29).Caption=   "Adel IGV"
         Columns(29).DataField=   ""
         Columns(29).DataWidth=   1
         Columns(29).DropDown=   "tdbdFlgDetRet"
         Columns(29).DropDown.vt=   8
         Columns(29)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(30)._VlistStyle=   0
         Columns(30)._MaxComboItems=   5
         Columns(30).Caption=   "Numero Constancia"
         Columns(30).DataField=   ""
         Columns(30).DataWidth=   10
         Columns(30)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(31)._VlistStyle=   0
         Columns(31)._MaxComboItems=   5
         Columns(31).Caption=   "Fecha Deposito"
         Columns(31).DataField=   ""
         Columns(31).EditMask=   "##/##/##"
         Columns(31).EditMaskUpdate=   -1  'True
         Columns(31)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(32)._VlistStyle=   0
         Columns(32)._MaxComboItems=   5
         Columns(32).Caption=   "Destino"
         Columns(32).DataField=   ""
         Columns(32).DataWidth=   1
         Columns(32)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(33)._VlistStyle=   0
         Columns(33)._MaxComboItems=   5
         Columns(33).Caption=   "NroProvision"
         Columns(33).DataField=   ""
         Columns(33)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(34)._VlistStyle=   0
         Columns(34)._MaxComboItems=   5
         Columns(34).Caption=   "Fech Aux"
         Columns(34).DataField=   ""
         Columns(34)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(35)._VlistStyle=   0
         Columns(35)._MaxComboItems=   5
         Columns(35).Caption=   "Flg Mone"
         Columns(35).DataField=   ""
         Columns(35)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(36)._VlistStyle=   0
         Columns(36)._MaxComboItems=   5
         Columns(36).Caption=   "FlgConver"
         Columns(36).DataField=   ""
         Columns(36)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(37)._VlistStyle=   0
         Columns(37)._MaxComboItems=   5
         Columns(37).Caption=   "Flg Documento"
         Columns(37).DataField=   ""
         Columns(37)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(38)._VlistStyle=   0
         Columns(38)._MaxComboItems=   5
         Columns(38).Caption=   "PorceImpuesto"
         Columns(38).DataField=   ""
         Columns(38)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(39)._VlistStyle=   0
         Columns(39)._MaxComboItems=   5
         Columns(39).Caption=   "TipoEntidadCta"
         Columns(39).DataField=   ""
         Columns(39)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(40)._VlistStyle=   16
         Columns(40)._MaxComboItems=   5
         Columns(40).ValueItems(0)._DefaultItem=   0
         Columns(40).ValueItems(0).Value=   "C"
         Columns(40).ValueItems(0).Value.vt=   8
         Columns(40).ValueItems(0).DisplayValue.CLSID=   "{0BE35204-8F91-11CE-9DE3-00AA004BB851}"
         Columns(40).ValueItems(0).DisplayValue(0)=   "bHQAADYDAABCTTYDAAAAAAAANgAAACgAAAAQAAAAEAAAAAEAGAAAAAAAAAMAAAAAAAAAAAAAAAAA"
         Columns(40).ValueItems(0).DisplayValue(1)=   "AAAAAAD//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb/"
         Columns(40).ValueItems(0).DisplayValue(2)=   "/eaBf3VqaF3//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eZ2fm1dY1L/"
         Columns(40).ValueItems(0).DisplayValue(3)=   "/eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eZ5hHBkaln//eb//eb//eb/"
         Columns(40).ValueItems(0).DisplayValue(4)=   "/eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eZ+gHRcX1D//eb//eb//eb//eb//eb//eb/"
         Columns(40).ValueItems(0).DisplayValue(5)=   "/eb//eb//eb//eb//eb//eb//eb//eaAgnZcZVH//eb//eb//eb//eb//eb//eb//eb//eb//eb/"
         Columns(40).ValueItems(0).DisplayValue(6)=   "/eb//eb//eb//eb//eZ0f2tddVP//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb/"
         Columns(40).ValueItems(0).DisplayValue(7)=   "/eb//eZ7h3FFaTtLgUVEiUY/gkX//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eZ6g25G"
         Columns(40).ValueItems(0).DisplayValue(8)=   "eD44izY6rUAyrj4ejiowkTvR/9jZ/93//eb//eb//eb//eb//eb//eb//eZ6g25CdTkzkjEqsjIz"
         Columns(40).ValueItems(0).DisplayValue(9)=   "z0ImvjcnszYZlCYvlzg0iTnV/9nl/+bs/+3//eb//eb//eZ8gm9LdUA7kjgpsDIszTsmzzkWvykd"
         Columns(40).ValueItems(0).DisplayValue(10)=   "vS0xxkAosDMonTA3lD/N/9T//eb//eb//eZ6gG1Nd0I0izEttjYozzgk0jgQvSUYvis20UYpujYo"
         Columns(40).ValueItems(0).DisplayValue(11)=   "pDJMrlQvhTf//eb//eb//eZ5gm5LfEQtiywltjEu2EAw1UQbti8hrTIZlCYplDM2iztEfkjk/+f/"
         Columns(40).ValueItems(0).DisplayValue(12)=   "/eb//eb//eZ2e2xCcDw5kDoqqjM2xUYamishjy80j0DR/9jQ/9T//eb//eb//eb//eb//eb//eaF"
         Columns(40).ValueItems(0).DisplayValue(13)=   "gXxSbUtHg0Y2jjs3kEHV/9///eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eb/"
         Columns(40).ValueItems(0).DisplayValue(14)=   "/eb//eb//eb//eb//eb//eb//eb//eb//eb//eb//eY="
         Columns(40).ValueItems(0).DisplayValue.vt=   9
         Columns(40).ValueItems(0)._PropDict=   "_DefaultItem,517,2"
         Columns(40).ValueItems.Count=   1
         Columns(40).Caption=   "Es Pago/Cobro"
         Columns(40).DataField=   "Asd_cProvCanc"
         Columns(40)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(41)._VlistStyle=   0
         Columns(41)._MaxComboItems=   5
         Columns(41).Caption=   "Grupo"
         Columns(41).DataField=   ""
         Columns(41)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(42)._VlistStyle=   0
         Columns(42)._MaxComboItems=   5
         Columns(42).DataField=   ""
         Columns(42)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(43)._VlistStyle=   0
         Columns(43)._MaxComboItems=   5
         Columns(43).DataField=   ""
         Columns(43)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(44)._VlistStyle=   0
         Columns(44)._MaxComboItems=   5
         Columns(44).DataField=   ""
         Columns(44)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(45)._VlistStyle=   0
         Columns(45)._MaxComboItems=   5
         Columns(45).DataField=   ""
         Columns(45)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(46)._VlistStyle=   0
         Columns(46)._MaxComboItems=   5
         Columns(46).DataField=   ""
         Columns(46)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(47)._VlistStyle=   0
         Columns(47)._MaxComboItems=   5
         Columns(47).DataField=   ""
         Columns(47)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(48)._VlistStyle=   0
         Columns(48)._MaxComboItems=   5
         Columns(48).DataField=   ""
         Columns(48)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(49)._VlistStyle=   0
         Columns(49)._MaxComboItems=   5
         Columns(49).DataField=   ""
         Columns(49)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(50)._VlistStyle=   0
         Columns(50)._MaxComboItems=   5
         Columns(50).DataField=   ""
         Columns(50)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(51)._VlistStyle=   0
         Columns(51)._MaxComboItems=   5
         Columns(51).DataField=   ""
         Columns(51)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(52)._VlistStyle=   0
         Columns(52)._MaxComboItems=   5
         Columns(52).DataField=   ""
         Columns(52)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(53)._VlistStyle=   0
         Columns(53)._MaxComboItems=   5
         Columns(53).DataField=   ""
         Columns(53)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(54)._VlistStyle=   0
         Columns(54)._MaxComboItems=   5
         Columns(54).DataField=   ""
         Columns(54)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(55)._VlistStyle=   0
         Columns(55)._MaxComboItems=   5
         Columns(55).DataField=   ""
         Columns(55)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(56)._VlistStyle=   0
         Columns(56)._MaxComboItems=   5
         Columns(56).DataField=   ""
         Columns(56)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(57)._VlistStyle=   0
         Columns(57)._MaxComboItems=   5
         Columns(57).DataField=   ""
         Columns(57)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(58)._VlistStyle=   0
         Columns(58)._MaxComboItems=   5
         Columns(58).DataField=   ""
         Columns(58)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(59)._VlistStyle=   0
         Columns(59)._MaxComboItems=   5
         Columns(59).DataField=   ""
         Columns(59)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(60)._VlistStyle=   0
         Columns(60)._MaxComboItems=   5
         Columns(60).DataField=   ""
         Columns(60)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(61)._VlistStyle=   0
         Columns(61)._MaxComboItems=   5
         Columns(61).DataField=   ""
         Columns(61)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(62)._VlistStyle=   0
         Columns(62)._MaxComboItems=   5
         Columns(62).DataField=   ""
         Columns(62)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(63)._VlistStyle=   0
         Columns(63)._MaxComboItems=   5
         Columns(63).DataField=   ""
         Columns(63)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(64)._VlistStyle=   0
         Columns(64)._MaxComboItems=   5
         Columns(64).DataField=   ""
         Columns(64)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(65)._VlistStyle=   0
         Columns(65)._MaxComboItems=   5
         Columns(65).DataField=   ""
         Columns(65)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(66)._VlistStyle=   0
         Columns(66)._MaxComboItems=   5
         Columns(66).DataField=   ""
         Columns(66)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(67)._VlistStyle=   0
         Columns(67)._MaxComboItems=   5
         Columns(67).DataField=   ""
         Columns(67)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(68)._VlistStyle=   0
         Columns(68)._MaxComboItems=   5
         Columns(68).DataField=   ""
         Columns(68)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(69)._VlistStyle=   0
         Columns(69)._MaxComboItems=   5
         Columns(69).DataField=   ""
         Columns(69)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(70)._VlistStyle=   0
         Columns(70)._MaxComboItems=   5
         Columns(70).DataField=   ""
         Columns(70)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(71)._VlistStyle=   0
         Columns(71)._MaxComboItems=   5
         Columns(71).DataField=   ""
         Columns(71)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(72)._VlistStyle=   0
         Columns(72)._MaxComboItems=   5
         Columns(72).DataField=   ""
         Columns(72)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(73)._VlistStyle=   0
         Columns(73)._MaxComboItems=   5
         Columns(73).DataField=   ""
         Columns(73)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(74)._VlistStyle=   0
         Columns(74)._MaxComboItems=   5
         Columns(74).DataField=   ""
         Columns(74)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(75)._VlistStyle=   0
         Columns(75)._MaxComboItems=   5
         Columns(75).DataField=   ""
         Columns(75)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(76)._VlistStyle=   0
         Columns(76)._MaxComboItems=   5
         Columns(76).DataField=   ""
         Columns(76)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(77)._VlistStyle=   0
         Columns(77)._MaxComboItems=   5
         Columns(77).DataField=   ""
         Columns(77)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(78)._VlistStyle=   0
         Columns(78)._MaxComboItems=   5
         Columns(78).DataField=   ""
         Columns(78)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(79)._VlistStyle=   0
         Columns(79)._MaxComboItems=   5
         Columns(79).DataField=   ""
         Columns(79)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(80)._VlistStyle=   0
         Columns(80)._MaxComboItems=   5
         Columns(80).DataField=   ""
         Columns(80)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(81)._VlistStyle=   0
         Columns(81)._MaxComboItems=   5
         Columns(81).DataField=   ""
         Columns(81)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(82)._VlistStyle=   0
         Columns(82)._MaxComboItems=   5
         Columns(82).Caption=   "Cod Cpto"
         Columns(82).DataField=   ""
         Columns(82)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(83)._VlistStyle=   0
         Columns(83)._MaxComboItems=   5
         Columns(83).Caption=   "Glosa o Descripcion de la Operación para el Diario Simplificado"
         Columns(83).DataField=   ""
         Columns(83)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns.Count   =   84
         Splits(0)._UserFlags=   0
         Splits(0).Locked=   -1  'True
         Splits(0).ScrollGroup=   0
         Splits(0).Size  =   0
         Splits(0).Size.vt=   2
         Splits(0).AllowRowSizing=   0   'False
         Splits(0).RecordSelectorWidth=   688
         Splits(0)._SavedRecordSelectors=   0   'False
         Splits(0).AllowColSelect=   0   'False
         Splits(0).DividerColor=   16711680
         Splits(0).SpringMode=   0   'False
         Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
         Splits(0)._ColumnProps(0)=   "Columns.Count=84"
         Splits(0)._ColumnProps(1)=   "Column(0).Width=794"
         Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
         Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=714"
         Splits(0)._ColumnProps(4)=   "Column(0).AllowSizing=0"
         Splits(0)._ColumnProps(5)=   "Column(0)._ColStyle=532"
         Splits(0)._ColumnProps(6)=   "Column(0).Order=1"
         Splits(0)._ColumnProps(7)=   "Column(0)._FootDivider=0"
         Splits(0)._ColumnProps(8)=   "Column(1).Width=2037"
         Splits(0)._ColumnProps(9)=   "Column(1).DividerColor=0"
         Splits(0)._ColumnProps(10)=   "Column(1)._WidthInPix=1958"
         Splits(0)._ColumnProps(11)=   "Column(1)._ColStyle=532"
         Splits(0)._ColumnProps(12)=   "Column(1).Order=2"
         Splits(0)._ColumnProps(13)=   "Column(1)._FootDivider=0"
         Splits(0)._ColumnProps(14)=   "Column(2).Width=159"
         Splits(0)._ColumnProps(15)=   "Column(2).DividerColor=0"
         Splits(0)._ColumnProps(16)=   "Column(2)._WidthInPix=79"
         Splits(0)._ColumnProps(17)=   "Column(2).AllowSizing=0"
         Splits(0)._ColumnProps(18)=   "Column(2)._ColStyle=532"
         Splits(0)._ColumnProps(19)=   "Column(2).Visible=0"
         Splits(0)._ColumnProps(20)=   "Column(2).AllowFocus=0"
         Splits(0)._ColumnProps(21)=   "Column(2).Order=3"
         Splits(0)._ColumnProps(22)=   "Column(2)._FootDivider=0"
         Splits(0)._ColumnProps(23)=   "Column(3).Width=1111"
         Splits(0)._ColumnProps(24)=   "Column(3).DividerColor=0"
         Splits(0)._ColumnProps(25)=   "Column(3)._WidthInPix=1032"
         Splits(0)._ColumnProps(26)=   "Column(3).AllowSizing=0"
         Splits(0)._ColumnProps(27)=   "Column(3)._ColStyle=532"
         Splits(0)._ColumnProps(28)=   "Column(3).Visible=0"
         Splits(0)._ColumnProps(29)=   "Column(3).AllowFocus=0"
         Splits(0)._ColumnProps(30)=   "Column(3).Order=4"
         Splits(0)._ColumnProps(31)=   "Column(3)._FootDivider=0"
         Splits(0)._ColumnProps(32)=   "Column(4).Width=1111"
         Splits(0)._ColumnProps(33)=   "Column(4).DividerColor=0"
         Splits(0)._ColumnProps(34)=   "Column(4)._WidthInPix=1032"
         Splits(0)._ColumnProps(35)=   "Column(4).AllowSizing=0"
         Splits(0)._ColumnProps(36)=   "Column(4)._ColStyle=532"
         Splits(0)._ColumnProps(37)=   "Column(4).Order=5"
         Splits(0)._ColumnProps(38)=   "Column(4)._FootDivider=0"
         Splits(0)._ColumnProps(39)=   "Column(5).Width=661"
         Splits(0)._ColumnProps(40)=   "Column(5).DividerColor=0"
         Splits(0)._ColumnProps(41)=   "Column(5)._WidthInPix=582"
         Splits(0)._ColumnProps(42)=   "Column(5).AllowSizing=0"
         Splits(0)._ColumnProps(43)=   "Column(5)._ColStyle=529"
         Splits(0)._ColumnProps(44)=   "Column(5).Visible=0"
         Splits(0)._ColumnProps(45)=   "Column(5).AllowFocus=0"
         Splits(0)._ColumnProps(46)=   "Column(5).Order=6"
         Splits(0)._ColumnProps(47)=   "Column(5)._FootDivider=0"
         Splits(0)._ColumnProps(48)=   "Column(6).Width=714"
         Splits(0)._ColumnProps(49)=   "Column(6).DividerColor=0"
         Splits(0)._ColumnProps(50)=   "Column(6)._WidthInPix=635"
         Splits(0)._ColumnProps(51)=   "Column(6).AllowSizing=0"
         Splits(0)._ColumnProps(52)=   "Column(6)._ColStyle=529"
         Splits(0)._ColumnProps(53)=   "Column(6).Visible=0"
         Splits(0)._ColumnProps(54)=   "Column(6).AllowFocus=0"
         Splits(0)._ColumnProps(55)=   "Column(6).Order=7"
         Splits(0)._ColumnProps(56)=   "Column(6)._FootDivider=0"
         Splits(0)._ColumnProps(57)=   "Column(7).Width=1429"
         Splits(0)._ColumnProps(58)=   "Column(7).DividerColor=0"
         Splits(0)._ColumnProps(59)=   "Column(7)._WidthInPix=1349"
         Splits(0)._ColumnProps(60)=   "Column(7).AllowSizing=0"
         Splits(0)._ColumnProps(61)=   "Column(7)._ColStyle=532"
         Splits(0)._ColumnProps(62)=   "Column(7).Order=8"
         Splits(0)._ColumnProps(63)=   "Column(7)._FootDivider=0"
         Splits(0)._ColumnProps(64)=   "Column(8).Width=556"
         Splits(0)._ColumnProps(65)=   "Column(8).DividerColor=0"
         Splits(0)._ColumnProps(66)=   "Column(8)._WidthInPix=476"
         Splits(0)._ColumnProps(67)=   "Column(8).AllowSizing=0"
         Splits(0)._ColumnProps(68)=   "Column(8)._ColStyle=532"
         Splits(0)._ColumnProps(69)=   "Column(8).Order=9"
         Splits(0)._ColumnProps(70)=   "Column(8)._FootDivider=0"
         Splits(0)._ColumnProps(71)=   "Column(9).Width=926"
         Splits(0)._ColumnProps(72)=   "Column(9).DividerColor=0"
         Splits(0)._ColumnProps(73)=   "Column(9)._WidthInPix=847"
         Splits(0)._ColumnProps(74)=   "Column(9)._ColStyle=532"
         Splits(0)._ColumnProps(75)=   "Column(9).Order=10"
         Splits(0)._ColumnProps(76)=   "Column(9)._FootDivider=0"
         Splits(0)._ColumnProps(77)=   "Column(10).Width=2064"
         Splits(0)._ColumnProps(78)=   "Column(10).DividerColor=0"
         Splits(0)._ColumnProps(79)=   "Column(10)._WidthInPix=1984"
         Splits(0)._ColumnProps(80)=   "Column(10)._ColStyle=532"
         Splits(0)._ColumnProps(81)=   "Column(10).Order=11"
         Splits(0)._ColumnProps(82)=   "Column(10)._FootDivider=0"
         Splits(0)._ColumnProps(83)=   "Column(11).Width=1984"
         Splits(0)._ColumnProps(84)=   "Column(11).DividerColor=0"
         Splits(0)._ColumnProps(85)=   "Column(11)._WidthInPix=1905"
         Splits(0)._ColumnProps(86)=   "Column(11)._ColStyle=532"
         Splits(0)._ColumnProps(87)=   "Column(11).Order=12"
         Splits(0)._ColumnProps(88)=   "Column(11)._FootDivider=0"
         Splits(0)._ColumnProps(89)=   "Column(12).Width=2064"
         Splits(0)._ColumnProps(90)=   "Column(12).DividerColor=0"
         Splits(0)._ColumnProps(91)=   "Column(12)._WidthInPix=1984"
         Splits(0)._ColumnProps(92)=   "Column(12)._ColStyle=532"
         Splits(0)._ColumnProps(93)=   "Column(12).Order=13"
         Splits(0)._ColumnProps(94)=   "Column(12)._FootDivider=0"
         Splits(0)._ColumnProps(95)=   "Column(13).Width=953"
         Splits(0)._ColumnProps(96)=   "Column(13).DividerColor=0"
         Splits(0)._ColumnProps(97)=   "Column(13)._WidthInPix=873"
         Splits(0)._ColumnProps(98)=   "Column(13).AllowSizing=0"
         Splits(0)._ColumnProps(99)=   "Column(13)._ColStyle=532"
         Splits(0)._ColumnProps(100)=   "Column(13).Order=14"
         Splits(0)._ColumnProps(101)=   "Column(13).AutoDropDown=1"
         Splits(0)._ColumnProps(102)=   "Column(13).DropDownList=1"
         Splits(0)._ColumnProps(103)=   "Column(13)._FootDivider=0"
         Splits(0)._ColumnProps(104)=   "Column(14).Width=106"
         Splits(0)._ColumnProps(105)=   "Column(14).DividerColor=0"
         Splits(0)._ColumnProps(106)=   "Column(14)._WidthInPix=26"
         Splits(0)._ColumnProps(107)=   "Column(14).AllowSizing=0"
         Splits(0)._ColumnProps(108)=   "Column(14)._ColStyle=532"
         Splits(0)._ColumnProps(109)=   "Column(14).Visible=0"
         Splits(0)._ColumnProps(110)=   "Column(14).AllowFocus=0"
         Splits(0)._ColumnProps(111)=   "Column(14).Order=15"
         Splits(0)._ColumnProps(112)=   "Column(14)._FootDivider=0"
         Splits(0)._ColumnProps(113)=   "Column(15).Width=1138"
         Splits(0)._ColumnProps(114)=   "Column(15).DividerColor=0"
         Splits(0)._ColumnProps(115)=   "Column(15)._WidthInPix=1058"
         Splits(0)._ColumnProps(116)=   "Column(15).AllowSizing=0"
         Splits(0)._ColumnProps(117)=   "Column(15)._ColStyle=532"
         Splits(0)._ColumnProps(118)=   "Column(15).Order=16"
         Splits(0)._ColumnProps(119)=   "Column(15).AutoDropDown=1"
         Splits(0)._ColumnProps(120)=   "Column(15).DropDownList=1"
         Splits(0)._ColumnProps(121)=   "Column(15)._FootDivider=0"
         Splits(0)._ColumnProps(122)=   "Column(16).Width=847"
         Splits(0)._ColumnProps(123)=   "Column(16).DividerColor=0"
         Splits(0)._ColumnProps(124)=   "Column(16)._WidthInPix=767"
         Splits(0)._ColumnProps(125)=   "Column(16)._ColStyle=530"
         Splits(0)._ColumnProps(126)=   "Column(16).Order=17"
         Splits(0)._ColumnProps(127)=   "Column(17).Width=2090"
         Splits(0)._ColumnProps(128)=   "Column(17).DividerColor=0"
         Splits(0)._ColumnProps(129)=   "Column(17)._WidthInPix=2011"
         Splits(0)._ColumnProps(130)=   "Column(17)._ColStyle=530"
         Splits(0)._ColumnProps(131)=   "Column(17).Order=18"
         Splits(0)._ColumnProps(132)=   "Column(18).Width=2090"
         Splits(0)._ColumnProps(133)=   "Column(18).DividerColor=0"
         Splits(0)._ColumnProps(134)=   "Column(18)._WidthInPix=2011"
         Splits(0)._ColumnProps(135)=   "Column(18)._ColStyle=530"
         Splits(0)._ColumnProps(136)=   "Column(18).Order=19"
         Splits(0)._ColumnProps(137)=   "Column(19).Width=2064"
         Splits(0)._ColumnProps(138)=   "Column(19).DividerColor=0"
         Splits(0)._ColumnProps(139)=   "Column(19)._WidthInPix=1984"
         Splits(0)._ColumnProps(140)=   "Column(19)._ColStyle=530"
         Splits(0)._ColumnProps(141)=   "Column(19).Order=20"
         Splits(0)._ColumnProps(142)=   "Column(20).Width=1984"
         Splits(0)._ColumnProps(143)=   "Column(20).DividerColor=0"
         Splits(0)._ColumnProps(144)=   "Column(20)._WidthInPix=1905"
         Splits(0)._ColumnProps(145)=   "Column(20)._ColStyle=530"
         Splits(0)._ColumnProps(146)=   "Column(20).Order=21"
         Splits(0)._ColumnProps(147)=   "Column(21).Width=106"
         Splits(0)._ColumnProps(148)=   "Column(21).DividerColor=0"
         Splits(0)._ColumnProps(149)=   "Column(21)._WidthInPix=26"
         Splits(0)._ColumnProps(150)=   "Column(21).AllowSizing=0"
         Splits(0)._ColumnProps(151)=   "Column(21)._ColStyle=530"
         Splits(0)._ColumnProps(152)=   "Column(21).Visible=0"
         Splits(0)._ColumnProps(153)=   "Column(21).AllowFocus=0"
         Splits(0)._ColumnProps(154)=   "Column(21).Order=22"
         Splits(0)._ColumnProps(155)=   "Column(22).Width=79"
         Splits(0)._ColumnProps(156)=   "Column(22).DividerColor=0"
         Splits(0)._ColumnProps(157)=   "Column(22).AllowSizing=0"
         Splits(0)._ColumnProps(158)=   "Column(22)._ColStyle=532"
         Splits(0)._ColumnProps(159)=   "Column(22).Visible=0"
         Splits(0)._ColumnProps(160)=   "Column(22).AllowFocus=0"
         Splits(0)._ColumnProps(161)=   "Column(22).Order=23"
         Splits(0)._ColumnProps(162)=   "Column(23).Width=79"
         Splits(0)._ColumnProps(163)=   "Column(23).DividerColor=0"
         Splits(0)._ColumnProps(164)=   "Column(23).AllowSizing=0"
         Splits(0)._ColumnProps(165)=   "Column(23)._ColStyle=532"
         Splits(0)._ColumnProps(166)=   "Column(23).Visible=0"
         Splits(0)._ColumnProps(167)=   "Column(23).AllowFocus=0"
         Splits(0)._ColumnProps(168)=   "Column(23).Order=24"
         Splits(0)._ColumnProps(169)=   "Column(24).Width=79"
         Splits(0)._ColumnProps(170)=   "Column(24).DividerColor=0"
         Splits(0)._ColumnProps(171)=   "Column(24).AllowSizing=0"
         Splits(0)._ColumnProps(172)=   "Column(24)._ColStyle=532"
         Splits(0)._ColumnProps(173)=   "Column(24).Visible=0"
         Splits(0)._ColumnProps(174)=   "Column(24).AllowFocus=0"
         Splits(0)._ColumnProps(175)=   "Column(24).Order=25"
         Splits(0)._ColumnProps(176)=   "Column(25).Width=79"
         Splits(0)._ColumnProps(177)=   "Column(25).DividerColor=0"
         Splits(0)._ColumnProps(178)=   "Column(25).AllowSizing=0"
         Splits(0)._ColumnProps(179)=   "Column(25)._ColStyle=532"
         Splits(0)._ColumnProps(180)=   "Column(25).Visible=0"
         Splits(0)._ColumnProps(181)=   "Column(25).AllowFocus=0"
         Splits(0)._ColumnProps(182)=   "Column(25).Order=26"
         Splits(0)._ColumnProps(183)=   "Column(26).Width=3307"
         Splits(0)._ColumnProps(184)=   "Column(26).DividerColor=0"
         Splits(0)._ColumnProps(185)=   "Column(26)._WidthInPix=3228"
         Splits(0)._ColumnProps(186)=   "Column(26).AllowSizing=0"
         Splits(0)._ColumnProps(187)=   "Column(26)._ColStyle=532"
         Splits(0)._ColumnProps(188)=   "Column(26).Visible=0"
         Splits(0)._ColumnProps(189)=   "Column(26).AllowFocus=0"
         Splits(0)._ColumnProps(190)=   "Column(26).Order=27"
         Splits(0)._ColumnProps(191)=   "Column(27).Width=556"
         Splits(0)._ColumnProps(192)=   "Column(27).DividerColor=0"
         Splits(0)._ColumnProps(193)=   "Column(27)._WidthInPix=476"
         Splits(0)._ColumnProps(194)=   "Column(27).AllowSizing=0"
         Splits(0)._ColumnProps(195)=   "Column(27)._ColStyle=532"
         Splits(0)._ColumnProps(196)=   "Column(27).Visible=0"
         Splits(0)._ColumnProps(197)=   "Column(27).AllowFocus=0"
         Splits(0)._ColumnProps(198)=   "Column(27).Order=28"
         Splits(0)._ColumnProps(199)=   "Column(28).Width=767"
         Splits(0)._ColumnProps(200)=   "Column(28).DividerColor=0"
         Splits(0)._ColumnProps(201)=   "Column(28)._WidthInPix=688"
         Splits(0)._ColumnProps(202)=   "Column(28).AllowSizing=0"
         Splits(0)._ColumnProps(203)=   "Column(28)._ColStyle=532"
         Splits(0)._ColumnProps(204)=   "Column(28).Visible=0"
         Splits(0)._ColumnProps(205)=   "Column(28).AllowFocus=0"
         Splits(0)._ColumnProps(206)=   "Column(28).Order=29"
         Splits(0)._ColumnProps(207)=   "Column(29).Width=3122"
         Splits(0)._ColumnProps(208)=   "Column(29).DividerColor=0"
         Splits(0)._ColumnProps(209)=   "Column(29)._WidthInPix=3043"
         Splits(0)._ColumnProps(210)=   "Column(29).AllowSizing=0"
         Splits(0)._ColumnProps(211)=   "Column(29)._ColStyle=532"
         Splits(0)._ColumnProps(212)=   "Column(29).Visible=0"
         Splits(0)._ColumnProps(213)=   "Column(29).AllowFocus=0"
         Splits(0)._ColumnProps(214)=   "Column(29).Order=30"
         Splits(0)._ColumnProps(215)=   "Column(29).AutoDropDown=1"
         Splits(0)._ColumnProps(216)=   "Column(29).AutoCompletion=1"
         Splits(0)._ColumnProps(217)=   "Column(30).Width=2275"
         Splits(0)._ColumnProps(218)=   "Column(30).DividerColor=0"
         Splits(0)._ColumnProps(219)=   "Column(30)._WidthInPix=2196"
         Splits(0)._ColumnProps(220)=   "Column(30).AllowSizing=0"
         Splits(0)._ColumnProps(221)=   "Column(30)._ColStyle=532"
         Splits(0)._ColumnProps(222)=   "Column(30).Visible=0"
         Splits(0)._ColumnProps(223)=   "Column(30).AllowFocus=0"
         Splits(0)._ColumnProps(224)=   "Column(30).Order=31"
         Splits(0)._ColumnProps(225)=   "Column(31).Width=1588"
         Splits(0)._ColumnProps(226)=   "Column(31).DividerColor=0"
         Splits(0)._ColumnProps(227)=   "Column(31)._WidthInPix=1508"
         Splits(0)._ColumnProps(228)=   "Column(31).AllowSizing=0"
         Splits(0)._ColumnProps(229)=   "Column(31)._ColStyle=532"
         Splits(0)._ColumnProps(230)=   "Column(31).Visible=0"
         Splits(0)._ColumnProps(231)=   "Column(31).AllowFocus=0"
         Splits(0)._ColumnProps(232)=   "Column(31).Order=32"
         Splits(0)._ColumnProps(233)=   "Column(32).Width=2725"
         Splits(0)._ColumnProps(234)=   "Column(32).DividerColor=0"
         Splits(0)._ColumnProps(235)=   "Column(32)._WidthInPix=2646"
         Splits(0)._ColumnProps(236)=   "Column(32).AllowSizing=0"
         Splits(0)._ColumnProps(237)=   "Column(32)._ColStyle=532"
         Splits(0)._ColumnProps(238)=   "Column(32).Visible=0"
         Splits(0)._ColumnProps(239)=   "Column(32).AllowFocus=0"
         Splits(0)._ColumnProps(240)=   "Column(32).Order=33"
         Splits(0)._ColumnProps(241)=   "Column(33).Width=2725"
         Splits(0)._ColumnProps(242)=   "Column(33).DividerColor=0"
         Splits(0)._ColumnProps(243)=   "Column(33)._WidthInPix=2646"
         Splits(0)._ColumnProps(244)=   "Column(33).AllowSizing=0"
         Splits(0)._ColumnProps(245)=   "Column(33)._ColStyle=8724"
         Splits(0)._ColumnProps(246)=   "Column(33).Visible=0"
         Splits(0)._ColumnProps(247)=   "Column(33).AllowFocus=0"
         Splits(0)._ColumnProps(248)=   "Column(33).Order=34"
         Splits(0)._ColumnProps(249)=   "Column(34).Width=2725"
         Splits(0)._ColumnProps(250)=   "Column(34).DividerColor=0"
         Splits(0)._ColumnProps(251)=   "Column(34)._WidthInPix=2646"
         Splits(0)._ColumnProps(252)=   "Column(34).AllowSizing=0"
         Splits(0)._ColumnProps(253)=   "Column(34)._ColStyle=532"
         Splits(0)._ColumnProps(254)=   "Column(34).Visible=0"
         Splits(0)._ColumnProps(255)=   "Column(34).AllowFocus=0"
         Splits(0)._ColumnProps(256)=   "Column(34).Order=35"
         Splits(0)._ColumnProps(257)=   "Column(35).Width=2725"
         Splits(0)._ColumnProps(258)=   "Column(35).DividerColor=0"
         Splits(0)._ColumnProps(259)=   "Column(35)._WidthInPix=2646"
         Splits(0)._ColumnProps(260)=   "Column(35).AllowSizing=0"
         Splits(0)._ColumnProps(261)=   "Column(35)._ColStyle=532"
         Splits(0)._ColumnProps(262)=   "Column(35).Visible=0"
         Splits(0)._ColumnProps(263)=   "Column(35).AllowFocus=0"
         Splits(0)._ColumnProps(264)=   "Column(35).Order=36"
         Splits(0)._ColumnProps(265)=   "Column(36).Width=2725"
         Splits(0)._ColumnProps(266)=   "Column(36).DividerColor=0"
         Splits(0)._ColumnProps(267)=   "Column(36)._WidthInPix=2646"
         Splits(0)._ColumnProps(268)=   "Column(36).AllowSizing=0"
         Splits(0)._ColumnProps(269)=   "Column(36)._ColStyle=532"
         Splits(0)._ColumnProps(270)=   "Column(36).Visible=0"
         Splits(0)._ColumnProps(271)=   "Column(36).AllowFocus=0"
         Splits(0)._ColumnProps(272)=   "Column(36).Order=37"
         Splits(0)._ColumnProps(273)=   "Column(37).Width=2725"
         Splits(0)._ColumnProps(274)=   "Column(37).DividerColor=0"
         Splits(0)._ColumnProps(275)=   "Column(37)._WidthInPix=2646"
         Splits(0)._ColumnProps(276)=   "Column(37).AllowSizing=0"
         Splits(0)._ColumnProps(277)=   "Column(37)._ColStyle=532"
         Splits(0)._ColumnProps(278)=   "Column(37).Visible=0"
         Splits(0)._ColumnProps(279)=   "Column(37).AllowFocus=0"
         Splits(0)._ColumnProps(280)=   "Column(37).Order=38"
         Splits(0)._ColumnProps(281)=   "Column(38).Width=2725"
         Splits(0)._ColumnProps(282)=   "Column(38).DividerColor=0"
         Splits(0)._ColumnProps(283)=   "Column(38)._WidthInPix=2646"
         Splits(0)._ColumnProps(284)=   "Column(38).AllowSizing=0"
         Splits(0)._ColumnProps(285)=   "Column(38)._ColStyle=532"
         Splits(0)._ColumnProps(286)=   "Column(38).Visible=0"
         Splits(0)._ColumnProps(287)=   "Column(38).AllowFocus=0"
         Splits(0)._ColumnProps(288)=   "Column(38).Order=39"
         Splits(0)._ColumnProps(289)=   "Column(39).Width=2725"
         Splits(0)._ColumnProps(290)=   "Column(39).DividerColor=0"
         Splits(0)._ColumnProps(291)=   "Column(39)._WidthInPix=2646"
         Splits(0)._ColumnProps(292)=   "Column(39).AllowSizing=0"
         Splits(0)._ColumnProps(293)=   "Column(39)._ColStyle=532"
         Splits(0)._ColumnProps(294)=   "Column(39).Visible=0"
         Splits(0)._ColumnProps(295)=   "Column(39).AllowFocus=0"
         Splits(0)._ColumnProps(296)=   "Column(39).Order=40"
         Splits(0)._ColumnProps(297)=   "Column(40).Width=1667"
         Splits(0)._ColumnProps(298)=   "Column(40).DividerColor=0"
         Splits(0)._ColumnProps(299)=   "Column(40)._WidthInPix=1588"
         Splits(0)._ColumnProps(300)=   "Column(40).AllowSizing=0"
         Splits(0)._ColumnProps(301)=   "Column(40)._ColStyle=8721"
         Splits(0)._ColumnProps(302)=   "Column(40).Order=41"
         Splits(0)._ColumnProps(303)=   "Column(40)._FootDivider=0"
         Splits(0)._ColumnProps(304)=   "Column(41).Width=953"
         Splits(0)._ColumnProps(305)=   "Column(41).DividerColor=0"
         Splits(0)._ColumnProps(306)=   "Column(41)._WidthInPix=873"
         Splits(0)._ColumnProps(307)=   "Column(41).AllowSizing=0"
         Splits(0)._ColumnProps(308)=   "Column(41)._ColStyle=8721"
         Splits(0)._ColumnProps(309)=   "Column(41).AllowFocus=0"
         Splits(0)._ColumnProps(310)=   "Column(41).Order=42"
         Splits(0)._ColumnProps(311)=   "Column(41).Merge=1"
         Splits(0)._ColumnProps(312)=   "Column(42).Width=2725"
         Splits(0)._ColumnProps(313)=   "Column(42).DividerColor=0"
         Splits(0)._ColumnProps(314)=   "Column(42)._WidthInPix=2646"
         Splits(0)._ColumnProps(315)=   "Column(42).AllowSizing=0"
         Splits(0)._ColumnProps(316)=   "Column(42)._ColStyle=532"
         Splits(0)._ColumnProps(317)=   "Column(42).Visible=0"
         Splits(0)._ColumnProps(318)=   "Column(42).AllowFocus=0"
         Splits(0)._ColumnProps(319)=   "Column(42).Order=43"
         Splits(0)._ColumnProps(320)=   "Column(43).Width=2725"
         Splits(0)._ColumnProps(321)=   "Column(43).DividerColor=0"
         Splits(0)._ColumnProps(322)=   "Column(43)._WidthInPix=2646"
         Splits(0)._ColumnProps(323)=   "Column(43).AllowSizing=0"
         Splits(0)._ColumnProps(324)=   "Column(43)._ColStyle=532"
         Splits(0)._ColumnProps(325)=   "Column(43).Visible=0"
         Splits(0)._ColumnProps(326)=   "Column(43).AllowFocus=0"
         Splits(0)._ColumnProps(327)=   "Column(43).Order=44"
         Splits(0)._ColumnProps(328)=   "Column(44).Width=2725"
         Splits(0)._ColumnProps(329)=   "Column(44).DividerColor=0"
         Splits(0)._ColumnProps(330)=   "Column(44)._WidthInPix=2646"
         Splits(0)._ColumnProps(331)=   "Column(44).AllowSizing=0"
         Splits(0)._ColumnProps(332)=   "Column(44)._ColStyle=532"
         Splits(0)._ColumnProps(333)=   "Column(44).Visible=0"
         Splits(0)._ColumnProps(334)=   "Column(44).AllowFocus=0"
         Splits(0)._ColumnProps(335)=   "Column(44).Order=45"
         Splits(0)._ColumnProps(336)=   "Column(45).Width=2725"
         Splits(0)._ColumnProps(337)=   "Column(45).DividerColor=0"
         Splits(0)._ColumnProps(338)=   "Column(45)._WidthInPix=2646"
         Splits(0)._ColumnProps(339)=   "Column(45).AllowSizing=0"
         Splits(0)._ColumnProps(340)=   "Column(45)._ColStyle=532"
         Splits(0)._ColumnProps(341)=   "Column(45).Visible=0"
         Splits(0)._ColumnProps(342)=   "Column(45).AllowFocus=0"
         Splits(0)._ColumnProps(343)=   "Column(45).Order=46"
         Splits(0)._ColumnProps(344)=   "Column(46).Width=2725"
         Splits(0)._ColumnProps(345)=   "Column(46).DividerColor=0"
         Splits(0)._ColumnProps(346)=   "Column(46)._WidthInPix=2646"
         Splits(0)._ColumnProps(347)=   "Column(46).AllowSizing=0"
         Splits(0)._ColumnProps(348)=   "Column(46)._ColStyle=532"
         Splits(0)._ColumnProps(349)=   "Column(46).Visible=0"
         Splits(0)._ColumnProps(350)=   "Column(46).AllowFocus=0"
         Splits(0)._ColumnProps(351)=   "Column(46).Order=47"
         Splits(0)._ColumnProps(352)=   "Column(47).Width=2725"
         Splits(0)._ColumnProps(353)=   "Column(47).DividerColor=0"
         Splits(0)._ColumnProps(354)=   "Column(47)._WidthInPix=2646"
         Splits(0)._ColumnProps(355)=   "Column(47).AllowSizing=0"
         Splits(0)._ColumnProps(356)=   "Column(47)._ColStyle=532"
         Splits(0)._ColumnProps(357)=   "Column(47).Visible=0"
         Splits(0)._ColumnProps(358)=   "Column(47).AllowFocus=0"
         Splits(0)._ColumnProps(359)=   "Column(47).Order=48"
         Splits(0)._ColumnProps(360)=   "Column(48).Width=2725"
         Splits(0)._ColumnProps(361)=   "Column(48).DividerColor=0"
         Splits(0)._ColumnProps(362)=   "Column(48)._WidthInPix=2646"
         Splits(0)._ColumnProps(363)=   "Column(48).AllowSizing=0"
         Splits(0)._ColumnProps(364)=   "Column(48)._ColStyle=532"
         Splits(0)._ColumnProps(365)=   "Column(48).Visible=0"
         Splits(0)._ColumnProps(366)=   "Column(48).AllowFocus=0"
         Splits(0)._ColumnProps(367)=   "Column(48).Order=49"
         Splits(0)._ColumnProps(368)=   "Column(49).Width=2725"
         Splits(0)._ColumnProps(369)=   "Column(49).DividerColor=0"
         Splits(0)._ColumnProps(370)=   "Column(49)._WidthInPix=2646"
         Splits(0)._ColumnProps(371)=   "Column(49).AllowSizing=0"
         Splits(0)._ColumnProps(372)=   "Column(49)._ColStyle=532"
         Splits(0)._ColumnProps(373)=   "Column(49).Visible=0"
         Splits(0)._ColumnProps(374)=   "Column(49).AllowFocus=0"
         Splits(0)._ColumnProps(375)=   "Column(49).Order=50"
         Splits(0)._ColumnProps(376)=   "Column(50).Width=2725"
         Splits(0)._ColumnProps(377)=   "Column(50).DividerColor=0"
         Splits(0)._ColumnProps(378)=   "Column(50)._WidthInPix=2646"
         Splits(0)._ColumnProps(379)=   "Column(50).AllowSizing=0"
         Splits(0)._ColumnProps(380)=   "Column(50)._ColStyle=532"
         Splits(0)._ColumnProps(381)=   "Column(50).Visible=0"
         Splits(0)._ColumnProps(382)=   "Column(50).AllowFocus=0"
         Splits(0)._ColumnProps(383)=   "Column(50).Order=51"
         Splits(0)._ColumnProps(384)=   "Column(51).Width=2725"
         Splits(0)._ColumnProps(385)=   "Column(51).DividerColor=0"
         Splits(0)._ColumnProps(386)=   "Column(51)._WidthInPix=2646"
         Splits(0)._ColumnProps(387)=   "Column(51).AllowSizing=0"
         Splits(0)._ColumnProps(388)=   "Column(51)._ColStyle=532"
         Splits(0)._ColumnProps(389)=   "Column(51).Visible=0"
         Splits(0)._ColumnProps(390)=   "Column(51).AllowFocus=0"
         Splits(0)._ColumnProps(391)=   "Column(51).Order=52"
         Splits(0)._ColumnProps(392)=   "Column(52).Width=2725"
         Splits(0)._ColumnProps(393)=   "Column(52).DividerColor=0"
         Splits(0)._ColumnProps(394)=   "Column(52)._WidthInPix=2646"
         Splits(0)._ColumnProps(395)=   "Column(52).AllowSizing=0"
         Splits(0)._ColumnProps(396)=   "Column(52)._ColStyle=532"
         Splits(0)._ColumnProps(397)=   "Column(52).Visible=0"
         Splits(0)._ColumnProps(398)=   "Column(52).AllowFocus=0"
         Splits(0)._ColumnProps(399)=   "Column(52).Order=53"
         Splits(0)._ColumnProps(400)=   "Column(53).Width=2725"
         Splits(0)._ColumnProps(401)=   "Column(53).DividerColor=0"
         Splits(0)._ColumnProps(402)=   "Column(53)._WidthInPix=2646"
         Splits(0)._ColumnProps(403)=   "Column(53).AllowSizing=0"
         Splits(0)._ColumnProps(404)=   "Column(53)._ColStyle=532"
         Splits(0)._ColumnProps(405)=   "Column(53).Visible=0"
         Splits(0)._ColumnProps(406)=   "Column(53).AllowFocus=0"
         Splits(0)._ColumnProps(407)=   "Column(53).Order=54"
         Splits(0)._ColumnProps(408)=   "Column(54).Width=2725"
         Splits(0)._ColumnProps(409)=   "Column(54).DividerColor=0"
         Splits(0)._ColumnProps(410)=   "Column(54)._WidthInPix=2646"
         Splits(0)._ColumnProps(411)=   "Column(54).AllowSizing=0"
         Splits(0)._ColumnProps(412)=   "Column(54)._ColStyle=532"
         Splits(0)._ColumnProps(413)=   "Column(54).Visible=0"
         Splits(0)._ColumnProps(414)=   "Column(54).AllowFocus=0"
         Splits(0)._ColumnProps(415)=   "Column(54).Order=55"
         Splits(0)._ColumnProps(416)=   "Column(55).Width=2725"
         Splits(0)._ColumnProps(417)=   "Column(55).DividerColor=0"
         Splits(0)._ColumnProps(418)=   "Column(55)._WidthInPix=2646"
         Splits(0)._ColumnProps(419)=   "Column(55).AllowSizing=0"
         Splits(0)._ColumnProps(420)=   "Column(55)._ColStyle=532"
         Splits(0)._ColumnProps(421)=   "Column(55).Visible=0"
         Splits(0)._ColumnProps(422)=   "Column(55).AllowFocus=0"
         Splits(0)._ColumnProps(423)=   "Column(55).Order=56"
         Splits(0)._ColumnProps(424)=   "Column(56).Width=2725"
         Splits(0)._ColumnProps(425)=   "Column(56).DividerColor=0"
         Splits(0)._ColumnProps(426)=   "Column(56)._WidthInPix=2646"
         Splits(0)._ColumnProps(427)=   "Column(56).AllowSizing=0"
         Splits(0)._ColumnProps(428)=   "Column(56)._ColStyle=532"
         Splits(0)._ColumnProps(429)=   "Column(56).Visible=0"
         Splits(0)._ColumnProps(430)=   "Column(56).AllowFocus=0"
         Splits(0)._ColumnProps(431)=   "Column(56).Order=57"
         Splits(0)._ColumnProps(432)=   "Column(57).Width=2725"
         Splits(0)._ColumnProps(433)=   "Column(57).DividerColor=0"
         Splits(0)._ColumnProps(434)=   "Column(57)._WidthInPix=2646"
         Splits(0)._ColumnProps(435)=   "Column(57).AllowSizing=0"
         Splits(0)._ColumnProps(436)=   "Column(57)._ColStyle=532"
         Splits(0)._ColumnProps(437)=   "Column(57).Visible=0"
         Splits(0)._ColumnProps(438)=   "Column(57).AllowFocus=0"
         Splits(0)._ColumnProps(439)=   "Column(57).Order=58"
         Splits(0)._ColumnProps(440)=   "Column(58).Width=2725"
         Splits(0)._ColumnProps(441)=   "Column(58).DividerColor=0"
         Splits(0)._ColumnProps(442)=   "Column(58)._WidthInPix=2646"
         Splits(0)._ColumnProps(443)=   "Column(58).AllowSizing=0"
         Splits(0)._ColumnProps(444)=   "Column(58)._ColStyle=532"
         Splits(0)._ColumnProps(445)=   "Column(58).Visible=0"
         Splits(0)._ColumnProps(446)=   "Column(58).AllowFocus=0"
         Splits(0)._ColumnProps(447)=   "Column(58).Order=59"
         Splits(0)._ColumnProps(448)=   "Column(59).Width=2725"
         Splits(0)._ColumnProps(449)=   "Column(59).DividerColor=0"
         Splits(0)._ColumnProps(450)=   "Column(59)._WidthInPix=2646"
         Splits(0)._ColumnProps(451)=   "Column(59).AllowSizing=0"
         Splits(0)._ColumnProps(452)=   "Column(59)._ColStyle=532"
         Splits(0)._ColumnProps(453)=   "Column(59).Visible=0"
         Splits(0)._ColumnProps(454)=   "Column(59).AllowFocus=0"
         Splits(0)._ColumnProps(455)=   "Column(59).Order=60"
         Splits(0)._ColumnProps(456)=   "Column(60).Width=2725"
         Splits(0)._ColumnProps(457)=   "Column(60).DividerColor=0"
         Splits(0)._ColumnProps(458)=   "Column(60)._WidthInPix=2646"
         Splits(0)._ColumnProps(459)=   "Column(60).AllowSizing=0"
         Splits(0)._ColumnProps(460)=   "Column(60)._ColStyle=532"
         Splits(0)._ColumnProps(461)=   "Column(60).Visible=0"
         Splits(0)._ColumnProps(462)=   "Column(60).AllowFocus=0"
         Splits(0)._ColumnProps(463)=   "Column(60).Order=61"
         Splits(0)._ColumnProps(464)=   "Column(61).Width=2725"
         Splits(0)._ColumnProps(465)=   "Column(61).DividerColor=0"
         Splits(0)._ColumnProps(466)=   "Column(61)._WidthInPix=2646"
         Splits(0)._ColumnProps(467)=   "Column(61).AllowSizing=0"
         Splits(0)._ColumnProps(468)=   "Column(61)._ColStyle=532"
         Splits(0)._ColumnProps(469)=   "Column(61).Visible=0"
         Splits(0)._ColumnProps(470)=   "Column(61).AllowFocus=0"
         Splits(0)._ColumnProps(471)=   "Column(61).Order=62"
         Splits(0)._ColumnProps(472)=   "Column(62).Width=2725"
         Splits(0)._ColumnProps(473)=   "Column(62).DividerColor=0"
         Splits(0)._ColumnProps(474)=   "Column(62)._WidthInPix=2646"
         Splits(0)._ColumnProps(475)=   "Column(62).AllowSizing=0"
         Splits(0)._ColumnProps(476)=   "Column(62)._ColStyle=532"
         Splits(0)._ColumnProps(477)=   "Column(62).Visible=0"
         Splits(0)._ColumnProps(478)=   "Column(62).AllowFocus=0"
         Splits(0)._ColumnProps(479)=   "Column(62).Order=63"
         Splits(0)._ColumnProps(480)=   "Column(63).Width=2725"
         Splits(0)._ColumnProps(481)=   "Column(63).DividerColor=0"
         Splits(0)._ColumnProps(482)=   "Column(63)._WidthInPix=2646"
         Splits(0)._ColumnProps(483)=   "Column(63).AllowSizing=0"
         Splits(0)._ColumnProps(484)=   "Column(63)._ColStyle=532"
         Splits(0)._ColumnProps(485)=   "Column(63).Visible=0"
         Splits(0)._ColumnProps(486)=   "Column(63).AllowFocus=0"
         Splits(0)._ColumnProps(487)=   "Column(63).Order=64"
         Splits(0)._ColumnProps(488)=   "Column(64).Width=2725"
         Splits(0)._ColumnProps(489)=   "Column(64).DividerColor=0"
         Splits(0)._ColumnProps(490)=   "Column(64)._WidthInPix=2646"
         Splits(0)._ColumnProps(491)=   "Column(64).AllowSizing=0"
         Splits(0)._ColumnProps(492)=   "Column(64)._ColStyle=532"
         Splits(0)._ColumnProps(493)=   "Column(64).Visible=0"
         Splits(0)._ColumnProps(494)=   "Column(64).AllowFocus=0"
         Splits(0)._ColumnProps(495)=   "Column(64).Order=65"
         Splits(0)._ColumnProps(496)=   "Column(65).Width=2725"
         Splits(0)._ColumnProps(497)=   "Column(65).DividerColor=0"
         Splits(0)._ColumnProps(498)=   "Column(65)._WidthInPix=2646"
         Splits(0)._ColumnProps(499)=   "Column(65).AllowSizing=0"
         Splits(0)._ColumnProps(500)=   "Column(65)._ColStyle=532"
         Splits(0)._ColumnProps(501)=   "Column(65).Visible=0"
         Splits(0)._ColumnProps(502)=   "Column(65).AllowFocus=0"
         Splits(0)._ColumnProps(503)=   "Column(65).Order=66"
         Splits(0)._ColumnProps(504)=   "Column(66).Width=2725"
         Splits(0)._ColumnProps(505)=   "Column(66).DividerColor=0"
         Splits(0)._ColumnProps(506)=   "Column(66)._WidthInPix=2646"
         Splits(0)._ColumnProps(507)=   "Column(66).AllowSizing=0"
         Splits(0)._ColumnProps(508)=   "Column(66)._ColStyle=532"
         Splits(0)._ColumnProps(509)=   "Column(66).Visible=0"
         Splits(0)._ColumnProps(510)=   "Column(66).AllowFocus=0"
         Splits(0)._ColumnProps(511)=   "Column(66).Order=67"
         Splits(0)._ColumnProps(512)=   "Column(67).Width=2725"
         Splits(0)._ColumnProps(513)=   "Column(67).DividerColor=0"
         Splits(0)._ColumnProps(514)=   "Column(67)._WidthInPix=2646"
         Splits(0)._ColumnProps(515)=   "Column(67).AllowSizing=0"
         Splits(0)._ColumnProps(516)=   "Column(67)._ColStyle=532"
         Splits(0)._ColumnProps(517)=   "Column(67).Visible=0"
         Splits(0)._ColumnProps(518)=   "Column(67).AllowFocus=0"
         Splits(0)._ColumnProps(519)=   "Column(67).Order=68"
         Splits(0)._ColumnProps(520)=   "Column(68).Width=2725"
         Splits(0)._ColumnProps(521)=   "Column(68).DividerColor=0"
         Splits(0)._ColumnProps(522)=   "Column(68)._WidthInPix=2646"
         Splits(0)._ColumnProps(523)=   "Column(68).AllowSizing=0"
         Splits(0)._ColumnProps(524)=   "Column(68)._ColStyle=532"
         Splits(0)._ColumnProps(525)=   "Column(68).Visible=0"
         Splits(0)._ColumnProps(526)=   "Column(68).AllowFocus=0"
         Splits(0)._ColumnProps(527)=   "Column(68).Order=69"
         Splits(0)._ColumnProps(528)=   "Column(69).Width=2725"
         Splits(0)._ColumnProps(529)=   "Column(69).DividerColor=0"
         Splits(0)._ColumnProps(530)=   "Column(69)._WidthInPix=2646"
         Splits(0)._ColumnProps(531)=   "Column(69).AllowSizing=0"
         Splits(0)._ColumnProps(532)=   "Column(69)._ColStyle=532"
         Splits(0)._ColumnProps(533)=   "Column(69).Visible=0"
         Splits(0)._ColumnProps(534)=   "Column(69).AllowFocus=0"
         Splits(0)._ColumnProps(535)=   "Column(69).Order=70"
         Splits(0)._ColumnProps(536)=   "Column(70).Width=2725"
         Splits(0)._ColumnProps(537)=   "Column(70).DividerColor=0"
         Splits(0)._ColumnProps(538)=   "Column(70)._WidthInPix=2646"
         Splits(0)._ColumnProps(539)=   "Column(70).AllowSizing=0"
         Splits(0)._ColumnProps(540)=   "Column(70)._ColStyle=532"
         Splits(0)._ColumnProps(541)=   "Column(70).Visible=0"
         Splits(0)._ColumnProps(542)=   "Column(70).AllowFocus=0"
         Splits(0)._ColumnProps(543)=   "Column(70).Order=71"
         Splits(0)._ColumnProps(544)=   "Column(71).Width=2725"
         Splits(0)._ColumnProps(545)=   "Column(71).DividerColor=0"
         Splits(0)._ColumnProps(546)=   "Column(71)._WidthInPix=2646"
         Splits(0)._ColumnProps(547)=   "Column(71).AllowSizing=0"
         Splits(0)._ColumnProps(548)=   "Column(71)._ColStyle=532"
         Splits(0)._ColumnProps(549)=   "Column(71).Visible=0"
         Splits(0)._ColumnProps(550)=   "Column(71).AllowFocus=0"
         Splits(0)._ColumnProps(551)=   "Column(71).Order=72"
         Splits(0)._ColumnProps(552)=   "Column(72).Width=2725"
         Splits(0)._ColumnProps(553)=   "Column(72).DividerColor=0"
         Splits(0)._ColumnProps(554)=   "Column(72)._WidthInPix=2646"
         Splits(0)._ColumnProps(555)=   "Column(72).AllowSizing=0"
         Splits(0)._ColumnProps(556)=   "Column(72)._ColStyle=532"
         Splits(0)._ColumnProps(557)=   "Column(72).Visible=0"
         Splits(0)._ColumnProps(558)=   "Column(72).AllowFocus=0"
         Splits(0)._ColumnProps(559)=   "Column(72).Order=73"
         Splits(0)._ColumnProps(560)=   "Column(73).Width=2725"
         Splits(0)._ColumnProps(561)=   "Column(73).DividerColor=0"
         Splits(0)._ColumnProps(562)=   "Column(73)._WidthInPix=2646"
         Splits(0)._ColumnProps(563)=   "Column(73).AllowSizing=0"
         Splits(0)._ColumnProps(564)=   "Column(73)._ColStyle=532"
         Splits(0)._ColumnProps(565)=   "Column(73).Visible=0"
         Splits(0)._ColumnProps(566)=   "Column(73).AllowFocus=0"
         Splits(0)._ColumnProps(567)=   "Column(73).Order=74"
         Splits(0)._ColumnProps(568)=   "Column(74).Width=2725"
         Splits(0)._ColumnProps(569)=   "Column(74).DividerColor=0"
         Splits(0)._ColumnProps(570)=   "Column(74)._WidthInPix=2646"
         Splits(0)._ColumnProps(571)=   "Column(74).AllowSizing=0"
         Splits(0)._ColumnProps(572)=   "Column(74)._ColStyle=532"
         Splits(0)._ColumnProps(573)=   "Column(74).Visible=0"
         Splits(0)._ColumnProps(574)=   "Column(74).AllowFocus=0"
         Splits(0)._ColumnProps(575)=   "Column(74).Order=75"
         Splits(0)._ColumnProps(576)=   "Column(75).Width=2725"
         Splits(0)._ColumnProps(577)=   "Column(75).DividerColor=0"
         Splits(0)._ColumnProps(578)=   "Column(75)._WidthInPix=2646"
         Splits(0)._ColumnProps(579)=   "Column(75).AllowSizing=0"
         Splits(0)._ColumnProps(580)=   "Column(75)._ColStyle=532"
         Splits(0)._ColumnProps(581)=   "Column(75).Visible=0"
         Splits(0)._ColumnProps(582)=   "Column(75).AllowFocus=0"
         Splits(0)._ColumnProps(583)=   "Column(75).Order=76"
         Splits(0)._ColumnProps(584)=   "Column(76).Width=2725"
         Splits(0)._ColumnProps(585)=   "Column(76).DividerColor=0"
         Splits(0)._ColumnProps(586)=   "Column(76)._WidthInPix=2646"
         Splits(0)._ColumnProps(587)=   "Column(76).AllowSizing=0"
         Splits(0)._ColumnProps(588)=   "Column(76)._ColStyle=532"
         Splits(0)._ColumnProps(589)=   "Column(76).Visible=0"
         Splits(0)._ColumnProps(590)=   "Column(76).AllowFocus=0"
         Splits(0)._ColumnProps(591)=   "Column(76).Order=77"
         Splits(0)._ColumnProps(592)=   "Column(77).Width=2725"
         Splits(0)._ColumnProps(593)=   "Column(77).DividerColor=0"
         Splits(0)._ColumnProps(594)=   "Column(77)._WidthInPix=2646"
         Splits(0)._ColumnProps(595)=   "Column(77).AllowSizing=0"
         Splits(0)._ColumnProps(596)=   "Column(77)._ColStyle=532"
         Splits(0)._ColumnProps(597)=   "Column(77).Visible=0"
         Splits(0)._ColumnProps(598)=   "Column(77).AllowFocus=0"
         Splits(0)._ColumnProps(599)=   "Column(77).Order=78"
         Splits(0)._ColumnProps(600)=   "Column(78).Width=2725"
         Splits(0)._ColumnProps(601)=   "Column(78).DividerColor=0"
         Splits(0)._ColumnProps(602)=   "Column(78)._WidthInPix=2646"
         Splits(0)._ColumnProps(603)=   "Column(78).AllowSizing=0"
         Splits(0)._ColumnProps(604)=   "Column(78)._ColStyle=532"
         Splits(0)._ColumnProps(605)=   "Column(78).Visible=0"
         Splits(0)._ColumnProps(606)=   "Column(78).AllowFocus=0"
         Splits(0)._ColumnProps(607)=   "Column(78).Order=79"
         Splits(0)._ColumnProps(608)=   "Column(79).Width=2725"
         Splits(0)._ColumnProps(609)=   "Column(79).DividerColor=0"
         Splits(0)._ColumnProps(610)=   "Column(79)._WidthInPix=2646"
         Splits(0)._ColumnProps(611)=   "Column(79).AllowSizing=0"
         Splits(0)._ColumnProps(612)=   "Column(79)._ColStyle=532"
         Splits(0)._ColumnProps(613)=   "Column(79).Visible=0"
         Splits(0)._ColumnProps(614)=   "Column(79).AllowFocus=0"
         Splits(0)._ColumnProps(615)=   "Column(79).Order=80"
         Splits(0)._ColumnProps(616)=   "Column(80).Width=2725"
         Splits(0)._ColumnProps(617)=   "Column(80).DividerColor=0"
         Splits(0)._ColumnProps(618)=   "Column(80)._WidthInPix=2646"
         Splits(0)._ColumnProps(619)=   "Column(80).AllowSizing=0"
         Splits(0)._ColumnProps(620)=   "Column(80)._ColStyle=532"
         Splits(0)._ColumnProps(621)=   "Column(80).Visible=0"
         Splits(0)._ColumnProps(622)=   "Column(80).AllowFocus=0"
         Splits(0)._ColumnProps(623)=   "Column(80).Order=81"
         Splits(0)._ColumnProps(624)=   "Column(81).Width=2725"
         Splits(0)._ColumnProps(625)=   "Column(81).DividerColor=0"
         Splits(0)._ColumnProps(626)=   "Column(81)._WidthInPix=2646"
         Splits(0)._ColumnProps(627)=   "Column(81).AllowSizing=0"
         Splits(0)._ColumnProps(628)=   "Column(81)._ColStyle=532"
         Splits(0)._ColumnProps(629)=   "Column(81).Visible=0"
         Splits(0)._ColumnProps(630)=   "Column(81).AllowFocus=0"
         Splits(0)._ColumnProps(631)=   "Column(81).Order=82"
         Splits(0)._ColumnProps(632)=   "Column(82).Width=873"
         Splits(0)._ColumnProps(633)=   "Column(82).DividerColor=0"
         Splits(0)._ColumnProps(634)=   "Column(82)._WidthInPix=794"
         Splits(0)._ColumnProps(635)=   "Column(82).AllowSizing=0"
         Splits(0)._ColumnProps(636)=   "Column(82)._ColStyle=532"
         Splits(0)._ColumnProps(637)=   "Column(82).Visible=0"
         Splits(0)._ColumnProps(638)=   "Column(82).AllowFocus=0"
         Splits(0)._ColumnProps(639)=   "Column(82).Order=83"
         Splits(0)._ColumnProps(640)=   "Column(83).Width=8546"
         Splits(0)._ColumnProps(641)=   "Column(83).DividerColor=0"
         Splits(0)._ColumnProps(642)=   "Column(83)._WidthInPix=8467"
         Splits(0)._ColumnProps(643)=   "Column(83).AllowSizing=0"
         Splits(0)._ColumnProps(644)=   "Column(83)._ColStyle=532"
         Splits(0)._ColumnProps(645)=   "Column(83).Visible=0"
         Splits(0)._ColumnProps(646)=   "Column(83).AllowFocus=0"
         Splits(0)._ColumnProps(647)=   "Column(83).Order=84"
         Splits(0)._ColumnProps(648)=   "Column(83).Merge=1"
         Splits.Count    =   1
         PrintInfos(0)._StateFlags=   3
         PrintInfos(0).Name=   "piInternal 0"
         PrintInfos(0).PageHeaderFont=   "Size=8.25,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
         PrintInfos(0).PageFooterFont=   "Size=8.25,Charset=0,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=Arial"
         PrintInfos(0).PageHeaderHeight=   0
         PrintInfos(0).PageFooterHeight=   0
         PrintInfos.Count=   1
         ColumnFooters   =   -1  'True
         DataMode        =   4
         DefColWidth     =   0
         HeadLines       =   2
         FootLines       =   1
         Caption         =   "DETALLE"
         WrapCellPointer =   -1  'True
         MultipleLines   =   0
         CellTips        =   2
         CellTipsWidth   =   0
         DeadAreaBackColor=   16777215
         RowDividerColor =   14215660
         RowSubDividerColor=   14215660
         DirectionAfterEnter=   1
         MaxRows         =   250000
         ViewColumnCaptionWidth=   0
         ViewColumnWidth =   0
         _PropDict       =   "_ExtentX,2003,3;_ExtentY,2004,3;_LayoutType,512,2;_RowHeight,16,3;_StyleDefs,513,0;_WasPersistedAsPixels,516,2"
         _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
         _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
         _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
         _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=255,.bold=0,.fontsize=825,.italic=0"
         _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(5)   =   ":id=0,.fontname=MS Sans Serif"
         _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bgcolor=&HEFD8C2&,.bold=0,.fontsize=825"
         _StyleDefs(7)   =   ":id=1,.italic=0,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(8)   =   ":id=1,.fontname=Arial"
         _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
         _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34,.alignment=2,.bgcolor=&HCA570B&"
         _StyleDefs(11)  =   ":id=2,.fgcolor=&HFFFFFF&,.bold=0,.fontsize=825,.italic=0,.underline=0"
         _StyleDefs(12)  =   ":id=2,.strikethrough=0,.charset=0"
         _StyleDefs(13)  =   ":id=2,.fontname=Arial"
         _StyleDefs(14)  =   "FooterStyle:id=3,.parent=1,.namedParent=35,.bgcolor=&HFCCFAB&,.bold=0"
         _StyleDefs(15)  =   ":id=3,.fontsize=825,.italic=0,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(16)  =   ":id=3,.fontname=Arial"
         _StyleDefs(17)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
         _StyleDefs(18)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36,.fgcolor=&HFFFFFF&"
         _StyleDefs(19)  =   "EditorStyle:id=7,.parent=1,.bgcolor=&HFFFFFF&"
         _StyleDefs(20)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
         _StyleDefs(21)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
         _StyleDefs(22)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
         _StyleDefs(23)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
         _StyleDefs(24)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
         _StyleDefs(25)  =   "Splits(0).Style:id=13,.parent=1,.valignment=2,.bgcolor=&HFFFFFF&"
         _StyleDefs(26)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
         _StyleDefs(27)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
         _StyleDefs(28)  =   "Splits(0).FooterStyle:id=15,.parent=3"
         _StyleDefs(29)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
         _StyleDefs(30)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
         _StyleDefs(31)  =   "Splits(0).EditorStyle:id=17,.parent=7"
         _StyleDefs(32)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
         _StyleDefs(33)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
         _StyleDefs(34)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
         _StyleDefs(35)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
         _StyleDefs(36)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
         _StyleDefs(37)  =   "Splits(0).Columns(0).Style:id=74,.parent=13,.bgcolor=&HFFFFFF&,.bold=0"
         _StyleDefs(38)  =   ":id=74,.fontsize=825,.italic=0,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(39)  =   ":id=74,.fontname=Arial"
         _StyleDefs(40)  =   "Splits(0).Columns(0).HeadingStyle:id=71,.parent=14"
         _StyleDefs(41)  =   "Splits(0).Columns(0).FooterStyle:id=72,.parent=15,.bgcolor=&HFCCFAB&,.bold=0"
         _StyleDefs(42)  =   ":id=72,.fontsize=825,.italic=0,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(43)  =   ":id=72,.fontname=Arial"
         _StyleDefs(44)  =   "Splits(0).Columns(0).EditorStyle:id=73,.parent=17"
         _StyleDefs(45)  =   "Splits(0).Columns(1).Style:id=70,.parent=13,.bold=0,.fontsize=825,.italic=0"
         _StyleDefs(46)  =   ":id=70,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(47)  =   ":id=70,.fontname=Arial"
         _StyleDefs(48)  =   "Splits(0).Columns(1).HeadingStyle:id=67,.parent=14"
         _StyleDefs(49)  =   "Splits(0).Columns(1).FooterStyle:id=68,.parent=15,.bgcolor=&HFCCFAB&"
         _StyleDefs(50)  =   "Splits(0).Columns(1).EditorStyle:id=69,.parent=17"
         _StyleDefs(51)  =   "Splits(0).Columns(2).Style:id=66,.parent=13"
         _StyleDefs(52)  =   "Splits(0).Columns(2).HeadingStyle:id=63,.parent=14"
         _StyleDefs(53)  =   "Splits(0).Columns(2).FooterStyle:id=64,.parent=15"
         _StyleDefs(54)  =   "Splits(0).Columns(2).EditorStyle:id=65,.parent=17"
         _StyleDefs(55)  =   "Splits(0).Columns(3).Style:id=146,.parent=13"
         _StyleDefs(56)  =   "Splits(0).Columns(3).HeadingStyle:id=143,.parent=14"
         _StyleDefs(57)  =   "Splits(0).Columns(3).FooterStyle:id=144,.parent=15"
         _StyleDefs(58)  =   "Splits(0).Columns(3).EditorStyle:id=145,.parent=17"
         _StyleDefs(59)  =   "Splits(0).Columns(4).Style:id=86,.parent=13"
         _StyleDefs(60)  =   "Splits(0).Columns(4).HeadingStyle:id=83,.parent=14"
         _StyleDefs(61)  =   "Splits(0).Columns(4).FooterStyle:id=84,.parent=15"
         _StyleDefs(62)  =   "Splits(0).Columns(4).EditorStyle:id=85,.parent=17"
         _StyleDefs(63)  =   "Splits(0).Columns(5).Style:id=174,.parent=13,.alignment=2"
         _StyleDefs(64)  =   "Splits(0).Columns(5).HeadingStyle:id=171,.parent=14"
         _StyleDefs(65)  =   "Splits(0).Columns(5).FooterStyle:id=172,.parent=15"
         _StyleDefs(66)  =   "Splits(0).Columns(5).EditorStyle:id=173,.parent=17"
         _StyleDefs(67)  =   "Splits(0).Columns(6).Style:id=178,.parent=13,.alignment=2"
         _StyleDefs(68)  =   "Splits(0).Columns(6).HeadingStyle:id=175,.parent=14"
         _StyleDefs(69)  =   "Splits(0).Columns(6).FooterStyle:id=176,.parent=15"
         _StyleDefs(70)  =   "Splits(0).Columns(6).EditorStyle:id=177,.parent=17"
         _StyleDefs(71)  =   "Splits(0).Columns(7).Style:id=28,.parent=13"
         _StyleDefs(72)  =   "Splits(0).Columns(7).HeadingStyle:id=25,.parent=14"
         _StyleDefs(73)  =   "Splits(0).Columns(7).FooterStyle:id=26,.parent=15"
         _StyleDefs(74)  =   "Splits(0).Columns(7).EditorStyle:id=27,.parent=17"
         _StyleDefs(75)  =   "Splits(0).Columns(8).Style:id=94,.parent=13"
         _StyleDefs(76)  =   "Splits(0).Columns(8).HeadingStyle:id=91,.parent=14"
         _StyleDefs(77)  =   "Splits(0).Columns(8).FooterStyle:id=92,.parent=15"
         _StyleDefs(78)  =   "Splits(0).Columns(8).EditorStyle:id=93,.parent=17"
         _StyleDefs(79)  =   "Splits(0).Columns(9).Style:id=98,.parent=13,.bold=0,.fontsize=825,.italic=0"
         _StyleDefs(80)  =   ":id=98,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(81)  =   ":id=98,.fontname=Arial"
         _StyleDefs(82)  =   "Splits(0).Columns(9).HeadingStyle:id=95,.parent=14"
         _StyleDefs(83)  =   "Splits(0).Columns(9).FooterStyle:id=96,.parent=15"
         _StyleDefs(84)  =   "Splits(0).Columns(9).EditorStyle:id=97,.parent=17"
         _StyleDefs(85)  =   "Splits(0).Columns(10).Style:id=102,.parent=13"
         _StyleDefs(86)  =   "Splits(0).Columns(10).HeadingStyle:id=99,.parent=14"
         _StyleDefs(87)  =   "Splits(0).Columns(10).FooterStyle:id=100,.parent=15"
         _StyleDefs(88)  =   "Splits(0).Columns(10).EditorStyle:id=101,.parent=17"
         _StyleDefs(89)  =   "Splits(0).Columns(11).Style:id=126,.parent=13"
         _StyleDefs(90)  =   "Splits(0).Columns(11).HeadingStyle:id=123,.parent=14"
         _StyleDefs(91)  =   "Splits(0).Columns(11).FooterStyle:id=124,.parent=15"
         _StyleDefs(92)  =   "Splits(0).Columns(11).EditorStyle:id=125,.parent=17"
         _StyleDefs(93)  =   "Splits(0).Columns(12).Style:id=150,.parent=13"
         _StyleDefs(94)  =   "Splits(0).Columns(12).HeadingStyle:id=147,.parent=14"
         _StyleDefs(95)  =   "Splits(0).Columns(12).FooterStyle:id=148,.parent=15"
         _StyleDefs(96)  =   "Splits(0).Columns(12).EditorStyle:id=149,.parent=17"
         _StyleDefs(97)  =   "Splits(0).Columns(13).Style:id=158,.parent=13"
         _StyleDefs(98)  =   "Splits(0).Columns(13).HeadingStyle:id=155,.parent=14"
         _StyleDefs(99)  =   "Splits(0).Columns(13).FooterStyle:id=156,.parent=15"
         _StyleDefs(100) =   "Splits(0).Columns(13).EditorStyle:id=157,.parent=17"
         _StyleDefs(101) =   "Splits(0).Columns(14).Style:id=162,.parent=13"
         _StyleDefs(102) =   "Splits(0).Columns(14).HeadingStyle:id=159,.parent=14"
         _StyleDefs(103) =   "Splits(0).Columns(14).FooterStyle:id=160,.parent=15"
         _StyleDefs(104) =   "Splits(0).Columns(14).EditorStyle:id=161,.parent=17"
         _StyleDefs(105) =   "Splits(0).Columns(15).Style:id=154,.parent=13"
         _StyleDefs(106) =   "Splits(0).Columns(15).HeadingStyle:id=151,.parent=14"
         _StyleDefs(107) =   "Splits(0).Columns(15).FooterStyle:id=152,.parent=15"
         _StyleDefs(108) =   "Splits(0).Columns(15).EditorStyle:id=153,.parent=17"
         _StyleDefs(109) =   "Splits(0).Columns(16).Style:id=78,.parent=13,.alignment=1"
         _StyleDefs(110) =   "Splits(0).Columns(16).HeadingStyle:id=75,.parent=14"
         _StyleDefs(111) =   "Splits(0).Columns(16).FooterStyle:id=76,.parent=15"
         _StyleDefs(112) =   "Splits(0).Columns(16).EditorStyle:id=77,.parent=17"
         _StyleDefs(113) =   "Splits(0).Columns(17).Style:id=58,.parent=13,.alignment=1,.bgcolor=&HFFFFFF&"
         _StyleDefs(114) =   "Splits(0).Columns(17).HeadingStyle:id=55,.parent=14"
         _StyleDefs(115) =   "Splits(0).Columns(17).FooterStyle:id=56,.parent=15,.bgcolor=&HFFFFFF&"
         _StyleDefs(116) =   "Splits(0).Columns(17).EditorStyle:id=57,.parent=17"
         _StyleDefs(117) =   "Splits(0).Columns(18).Style:id=54,.parent=13,.alignment=1,.bgcolor=&HFFFFFF&"
         _StyleDefs(118) =   "Splits(0).Columns(18).HeadingStyle:id=51,.parent=14"
         _StyleDefs(119) =   "Splits(0).Columns(18).FooterStyle:id=52,.parent=15,.bgcolor=&HFFFFFF&"
         _StyleDefs(120) =   "Splits(0).Columns(18).EditorStyle:id=53,.parent=17"
         _StyleDefs(121) =   "Splits(0).Columns(19).Style:id=82,.parent=13,.alignment=1,.bgcolor=&HFFFFFF&"
         _StyleDefs(122) =   "Splits(0).Columns(19).HeadingStyle:id=79,.parent=14"
         _StyleDefs(123) =   "Splits(0).Columns(19).FooterStyle:id=80,.parent=15,.bgcolor=&HFFFFFF&"
         _StyleDefs(124) =   "Splits(0).Columns(19).EditorStyle:id=81,.parent=17"
         _StyleDefs(125) =   "Splits(0).Columns(20).Style:id=50,.parent=13,.alignment=1,.bgcolor=&HFFFFFF&"
         _StyleDefs(126) =   "Splits(0).Columns(20).HeadingStyle:id=47,.parent=14"
         _StyleDefs(127) =   "Splits(0).Columns(20).FooterStyle:id=48,.parent=15,.bgcolor=&HFFFFFF&"
         _StyleDefs(128) =   "Splits(0).Columns(20).EditorStyle:id=49,.parent=17"
         _StyleDefs(129) =   "Splits(0).Columns(21).Style:id=46,.parent=13,.alignment=1"
         _StyleDefs(130) =   "Splits(0).Columns(21).HeadingStyle:id=43,.parent=14"
         _StyleDefs(131) =   "Splits(0).Columns(21).FooterStyle:id=44,.parent=15"
         _StyleDefs(132) =   "Splits(0).Columns(21).EditorStyle:id=45,.parent=17"
         _StyleDefs(133) =   "Splits(0).Columns(22).Style:id=32,.parent=13"
         _StyleDefs(134) =   "Splits(0).Columns(22).HeadingStyle:id=29,.parent=14"
         _StyleDefs(135) =   "Splits(0).Columns(22).FooterStyle:id=30,.parent=15"
         _StyleDefs(136) =   "Splits(0).Columns(22).EditorStyle:id=31,.parent=17"
         _StyleDefs(137) =   "Splits(0).Columns(23).Style:id=90,.parent=13"
         _StyleDefs(138) =   "Splits(0).Columns(23).HeadingStyle:id=87,.parent=14"
         _StyleDefs(139) =   "Splits(0).Columns(23).FooterStyle:id=88,.parent=15"
         _StyleDefs(140) =   "Splits(0).Columns(23).EditorStyle:id=89,.parent=17"
         _StyleDefs(141) =   "Splits(0).Columns(24).Style:id=62,.parent=13"
         _StyleDefs(142) =   "Splits(0).Columns(24).HeadingStyle:id=59,.parent=14"
         _StyleDefs(143) =   "Splits(0).Columns(24).FooterStyle:id=60,.parent=15"
         _StyleDefs(144) =   "Splits(0).Columns(24).EditorStyle:id=61,.parent=17"
         _StyleDefs(145) =   "Splits(0).Columns(25).Style:id=106,.parent=13"
         _StyleDefs(146) =   "Splits(0).Columns(25).HeadingStyle:id=103,.parent=14"
         _StyleDefs(147) =   "Splits(0).Columns(25).FooterStyle:id=104,.parent=15"
         _StyleDefs(148) =   "Splits(0).Columns(25).EditorStyle:id=105,.parent=17"
         _StyleDefs(149) =   "Splits(0).Columns(26).Style:id=110,.parent=13"
         _StyleDefs(150) =   "Splits(0).Columns(26).HeadingStyle:id=107,.parent=14"
         _StyleDefs(151) =   "Splits(0).Columns(26).FooterStyle:id=108,.parent=15"
         _StyleDefs(152) =   "Splits(0).Columns(26).EditorStyle:id=109,.parent=17"
         _StyleDefs(153) =   "Splits(0).Columns(27).Style:id=114,.parent=13"
         _StyleDefs(154) =   "Splits(0).Columns(27).HeadingStyle:id=111,.parent=14"
         _StyleDefs(155) =   "Splits(0).Columns(27).FooterStyle:id=112,.parent=15"
         _StyleDefs(156) =   "Splits(0).Columns(27).EditorStyle:id=113,.parent=17"
         _StyleDefs(157) =   "Splits(0).Columns(28).Style:id=130,.parent=13"
         _StyleDefs(158) =   "Splits(0).Columns(28).HeadingStyle:id=127,.parent=14"
         _StyleDefs(159) =   "Splits(0).Columns(28).FooterStyle:id=128,.parent=15"
         _StyleDefs(160) =   "Splits(0).Columns(28).EditorStyle:id=129,.parent=17"
         _StyleDefs(161) =   "Splits(0).Columns(29).Style:id=134,.parent=13"
         _StyleDefs(162) =   "Splits(0).Columns(29).HeadingStyle:id=131,.parent=14"
         _StyleDefs(163) =   "Splits(0).Columns(29).FooterStyle:id=132,.parent=15"
         _StyleDefs(164) =   "Splits(0).Columns(29).EditorStyle:id=133,.parent=17"
         _StyleDefs(165) =   "Splits(0).Columns(30).Style:id=122,.parent=13"
         _StyleDefs(166) =   "Splits(0).Columns(30).HeadingStyle:id=119,.parent=14"
         _StyleDefs(167) =   "Splits(0).Columns(30).FooterStyle:id=120,.parent=15"
         _StyleDefs(168) =   "Splits(0).Columns(30).EditorStyle:id=121,.parent=17"
         _StyleDefs(169) =   "Splits(0).Columns(31).Style:id=118,.parent=13"
         _StyleDefs(170) =   "Splits(0).Columns(31).HeadingStyle:id=115,.parent=14"
         _StyleDefs(171) =   "Splits(0).Columns(31).FooterStyle:id=116,.parent=15"
         _StyleDefs(172) =   "Splits(0).Columns(31).EditorStyle:id=117,.parent=17"
         _StyleDefs(173) =   "Splits(0).Columns(32).Style:id=138,.parent=13"
         _StyleDefs(174) =   "Splits(0).Columns(32).HeadingStyle:id=135,.parent=14"
         _StyleDefs(175) =   "Splits(0).Columns(32).FooterStyle:id=136,.parent=15"
         _StyleDefs(176) =   "Splits(0).Columns(32).EditorStyle:id=137,.parent=17"
         _StyleDefs(177) =   "Splits(0).Columns(33).Style:id=142,.parent=13,.locked=-1"
         _StyleDefs(178) =   "Splits(0).Columns(33).HeadingStyle:id=139,.parent=14"
         _StyleDefs(179) =   "Splits(0).Columns(33).FooterStyle:id=140,.parent=15"
         _StyleDefs(180) =   "Splits(0).Columns(33).EditorStyle:id=141,.parent=17"
         _StyleDefs(181) =   "Splits(0).Columns(34).Style:id=166,.parent=13"
         _StyleDefs(182) =   "Splits(0).Columns(34).HeadingStyle:id=163,.parent=14"
         _StyleDefs(183) =   "Splits(0).Columns(34).FooterStyle:id=164,.parent=15"
         _StyleDefs(184) =   "Splits(0).Columns(34).EditorStyle:id=165,.parent=17"
         _StyleDefs(185) =   "Splits(0).Columns(35).Style:id=170,.parent=13"
         _StyleDefs(186) =   "Splits(0).Columns(35).HeadingStyle:id=167,.parent=14"
         _StyleDefs(187) =   "Splits(0).Columns(35).FooterStyle:id=168,.parent=15"
         _StyleDefs(188) =   "Splits(0).Columns(35).EditorStyle:id=169,.parent=17"
         _StyleDefs(189) =   "Splits(0).Columns(36).Style:id=182,.parent=13"
         _StyleDefs(190) =   "Splits(0).Columns(36).HeadingStyle:id=179,.parent=14"
         _StyleDefs(191) =   "Splits(0).Columns(36).FooterStyle:id=180,.parent=15"
         _StyleDefs(192) =   "Splits(0).Columns(36).EditorStyle:id=181,.parent=17"
         _StyleDefs(193) =   "Splits(0).Columns(37).Style:id=186,.parent=13"
         _StyleDefs(194) =   "Splits(0).Columns(37).HeadingStyle:id=183,.parent=14"
         _StyleDefs(195) =   "Splits(0).Columns(37).FooterStyle:id=184,.parent=15"
         _StyleDefs(196) =   "Splits(0).Columns(37).EditorStyle:id=185,.parent=17"
         _StyleDefs(197) =   "Splits(0).Columns(38).Style:id=190,.parent=13"
         _StyleDefs(198) =   "Splits(0).Columns(38).HeadingStyle:id=187,.parent=14"
         _StyleDefs(199) =   "Splits(0).Columns(38).FooterStyle:id=188,.parent=15"
         _StyleDefs(200) =   "Splits(0).Columns(38).EditorStyle:id=189,.parent=17"
         _StyleDefs(201) =   "Splits(0).Columns(39).Style:id=194,.parent=13"
         _StyleDefs(202) =   "Splits(0).Columns(39).HeadingStyle:id=191,.parent=14"
         _StyleDefs(203) =   "Splits(0).Columns(39).FooterStyle:id=192,.parent=15"
         _StyleDefs(204) =   "Splits(0).Columns(39).EditorStyle:id=193,.parent=17"
         _StyleDefs(205) =   "Splits(0).Columns(40).Style:id=198,.parent=13,.alignment=2,.bgcolor=&HFFFDE6&"
         _StyleDefs(206) =   ":id=198,.locked=-1"
         _StyleDefs(207) =   "Splits(0).Columns(40).HeadingStyle:id=195,.parent=14"
         _StyleDefs(208) =   "Splits(0).Columns(40).FooterStyle:id=196,.parent=15"
         _StyleDefs(209) =   "Splits(0).Columns(40).EditorStyle:id=197,.parent=17"
         _StyleDefs(210) =   "Splits(0).Columns(41).Style:id=202,.parent=13,.alignment=2,.bgcolor=&HFFFDE6&"
         _StyleDefs(211) =   ":id=202,.fgcolor=&HA00000&,.locked=-1,.bold=-1,.fontsize=825,.italic=0"
         _StyleDefs(212) =   ":id=202,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(213) =   ":id=202,.fontname=Arial"
         _StyleDefs(214) =   "Splits(0).Columns(41).HeadingStyle:id=199,.parent=14"
         _StyleDefs(215) =   "Splits(0).Columns(41).FooterStyle:id=200,.parent=15"
         _StyleDefs(216) =   "Splits(0).Columns(41).EditorStyle:id=201,.parent=17"
         _StyleDefs(217) =   "Splits(0).Columns(42).Style:id=362,.parent=13"
         _StyleDefs(218) =   "Splits(0).Columns(42).HeadingStyle:id=359,.parent=14"
         _StyleDefs(219) =   "Splits(0).Columns(42).FooterStyle:id=360,.parent=15"
         _StyleDefs(220) =   "Splits(0).Columns(42).EditorStyle:id=361,.parent=17"
         _StyleDefs(221) =   "Splits(0).Columns(43).Style:id=358,.parent=13"
         _StyleDefs(222) =   "Splits(0).Columns(43).HeadingStyle:id=355,.parent=14"
         _StyleDefs(223) =   "Splits(0).Columns(43).FooterStyle:id=356,.parent=15"
         _StyleDefs(224) =   "Splits(0).Columns(43).EditorStyle:id=357,.parent=17"
         _StyleDefs(225) =   "Splits(0).Columns(44).Style:id=354,.parent=13"
         _StyleDefs(226) =   "Splits(0).Columns(44).HeadingStyle:id=351,.parent=14"
         _StyleDefs(227) =   "Splits(0).Columns(44).FooterStyle:id=352,.parent=15"
         _StyleDefs(228) =   "Splits(0).Columns(44).EditorStyle:id=353,.parent=17"
         _StyleDefs(229) =   "Splits(0).Columns(45).Style:id=350,.parent=13"
         _StyleDefs(230) =   "Splits(0).Columns(45).HeadingStyle:id=347,.parent=14"
         _StyleDefs(231) =   "Splits(0).Columns(45).FooterStyle:id=348,.parent=15"
         _StyleDefs(232) =   "Splits(0).Columns(45).EditorStyle:id=349,.parent=17"
         _StyleDefs(233) =   "Splits(0).Columns(46).Style:id=346,.parent=13"
         _StyleDefs(234) =   "Splits(0).Columns(46).HeadingStyle:id=343,.parent=14"
         _StyleDefs(235) =   "Splits(0).Columns(46).FooterStyle:id=344,.parent=15"
         _StyleDefs(236) =   "Splits(0).Columns(46).EditorStyle:id=345,.parent=17"
         _StyleDefs(237) =   "Splits(0).Columns(47).Style:id=342,.parent=13"
         _StyleDefs(238) =   "Splits(0).Columns(47).HeadingStyle:id=339,.parent=14"
         _StyleDefs(239) =   "Splits(0).Columns(47).FooterStyle:id=340,.parent=15"
         _StyleDefs(240) =   "Splits(0).Columns(47).EditorStyle:id=341,.parent=17"
         _StyleDefs(241) =   "Splits(0).Columns(48).Style:id=338,.parent=13"
         _StyleDefs(242) =   "Splits(0).Columns(48).HeadingStyle:id=335,.parent=14"
         _StyleDefs(243) =   "Splits(0).Columns(48).FooterStyle:id=336,.parent=15"
         _StyleDefs(244) =   "Splits(0).Columns(48).EditorStyle:id=337,.parent=17"
         _StyleDefs(245) =   "Splits(0).Columns(49).Style:id=334,.parent=13"
         _StyleDefs(246) =   "Splits(0).Columns(49).HeadingStyle:id=331,.parent=14"
         _StyleDefs(247) =   "Splits(0).Columns(49).FooterStyle:id=332,.parent=15"
         _StyleDefs(248) =   "Splits(0).Columns(49).EditorStyle:id=333,.parent=17"
         _StyleDefs(249) =   "Splits(0).Columns(50).Style:id=330,.parent=13"
         _StyleDefs(250) =   "Splits(0).Columns(50).HeadingStyle:id=327,.parent=14"
         _StyleDefs(251) =   "Splits(0).Columns(50).FooterStyle:id=328,.parent=15"
         _StyleDefs(252) =   "Splits(0).Columns(50).EditorStyle:id=329,.parent=17"
         _StyleDefs(253) =   "Splits(0).Columns(51).Style:id=326,.parent=13"
         _StyleDefs(254) =   "Splits(0).Columns(51).HeadingStyle:id=323,.parent=14"
         _StyleDefs(255) =   "Splits(0).Columns(51).FooterStyle:id=324,.parent=15"
         _StyleDefs(256) =   "Splits(0).Columns(51).EditorStyle:id=325,.parent=17"
         _StyleDefs(257) =   "Splits(0).Columns(52).Style:id=322,.parent=13"
         _StyleDefs(258) =   "Splits(0).Columns(52).HeadingStyle:id=319,.parent=14"
         _StyleDefs(259) =   "Splits(0).Columns(52).FooterStyle:id=320,.parent=15"
         _StyleDefs(260) =   "Splits(0).Columns(52).EditorStyle:id=321,.parent=17"
         _StyleDefs(261) =   "Splits(0).Columns(53).Style:id=318,.parent=13"
         _StyleDefs(262) =   "Splits(0).Columns(53).HeadingStyle:id=315,.parent=14"
         _StyleDefs(263) =   "Splits(0).Columns(53).FooterStyle:id=316,.parent=15"
         _StyleDefs(264) =   "Splits(0).Columns(53).EditorStyle:id=317,.parent=17"
         _StyleDefs(265) =   "Splits(0).Columns(54).Style:id=314,.parent=13"
         _StyleDefs(266) =   "Splits(0).Columns(54).HeadingStyle:id=311,.parent=14"
         _StyleDefs(267) =   "Splits(0).Columns(54).FooterStyle:id=312,.parent=15"
         _StyleDefs(268) =   "Splits(0).Columns(54).EditorStyle:id=313,.parent=17"
         _StyleDefs(269) =   "Splits(0).Columns(55).Style:id=310,.parent=13"
         _StyleDefs(270) =   "Splits(0).Columns(55).HeadingStyle:id=307,.parent=14"
         _StyleDefs(271) =   "Splits(0).Columns(55).FooterStyle:id=308,.parent=15"
         _StyleDefs(272) =   "Splits(0).Columns(55).EditorStyle:id=309,.parent=17"
         _StyleDefs(273) =   "Splits(0).Columns(56).Style:id=306,.parent=13"
         _StyleDefs(274) =   "Splits(0).Columns(56).HeadingStyle:id=303,.parent=14"
         _StyleDefs(275) =   "Splits(0).Columns(56).FooterStyle:id=304,.parent=15"
         _StyleDefs(276) =   "Splits(0).Columns(56).EditorStyle:id=305,.parent=17"
         _StyleDefs(277) =   "Splits(0).Columns(57).Style:id=302,.parent=13"
         _StyleDefs(278) =   "Splits(0).Columns(57).HeadingStyle:id=299,.parent=14"
         _StyleDefs(279) =   "Splits(0).Columns(57).FooterStyle:id=300,.parent=15"
         _StyleDefs(280) =   "Splits(0).Columns(57).EditorStyle:id=301,.parent=17"
         _StyleDefs(281) =   "Splits(0).Columns(58).Style:id=298,.parent=13"
         _StyleDefs(282) =   "Splits(0).Columns(58).HeadingStyle:id=295,.parent=14"
         _StyleDefs(283) =   "Splits(0).Columns(58).FooterStyle:id=296,.parent=15"
         _StyleDefs(284) =   "Splits(0).Columns(58).EditorStyle:id=297,.parent=17"
         _StyleDefs(285) =   "Splits(0).Columns(59).Style:id=294,.parent=13"
         _StyleDefs(286) =   "Splits(0).Columns(59).HeadingStyle:id=291,.parent=14"
         _StyleDefs(287) =   "Splits(0).Columns(59).FooterStyle:id=292,.parent=15"
         _StyleDefs(288) =   "Splits(0).Columns(59).EditorStyle:id=293,.parent=17"
         _StyleDefs(289) =   "Splits(0).Columns(60).Style:id=290,.parent=13"
         _StyleDefs(290) =   "Splits(0).Columns(60).HeadingStyle:id=287,.parent=14"
         _StyleDefs(291) =   "Splits(0).Columns(60).FooterStyle:id=288,.parent=15"
         _StyleDefs(292) =   "Splits(0).Columns(60).EditorStyle:id=289,.parent=17"
         _StyleDefs(293) =   "Splits(0).Columns(61).Style:id=286,.parent=13"
         _StyleDefs(294) =   "Splits(0).Columns(61).HeadingStyle:id=283,.parent=14"
         _StyleDefs(295) =   "Splits(0).Columns(61).FooterStyle:id=284,.parent=15"
         _StyleDefs(296) =   "Splits(0).Columns(61).EditorStyle:id=285,.parent=17"
         _StyleDefs(297) =   "Splits(0).Columns(62).Style:id=282,.parent=13"
         _StyleDefs(298) =   "Splits(0).Columns(62).HeadingStyle:id=279,.parent=14"
         _StyleDefs(299) =   "Splits(0).Columns(62).FooterStyle:id=280,.parent=15"
         _StyleDefs(300) =   "Splits(0).Columns(62).EditorStyle:id=281,.parent=17"
         _StyleDefs(301) =   "Splits(0).Columns(63).Style:id=278,.parent=13"
         _StyleDefs(302) =   "Splits(0).Columns(63).HeadingStyle:id=275,.parent=14"
         _StyleDefs(303) =   "Splits(0).Columns(63).FooterStyle:id=276,.parent=15"
         _StyleDefs(304) =   "Splits(0).Columns(63).EditorStyle:id=277,.parent=17"
         _StyleDefs(305) =   "Splits(0).Columns(64).Style:id=274,.parent=13"
         _StyleDefs(306) =   "Splits(0).Columns(64).HeadingStyle:id=271,.parent=14"
         _StyleDefs(307) =   "Splits(0).Columns(64).FooterStyle:id=272,.parent=15"
         _StyleDefs(308) =   "Splits(0).Columns(64).EditorStyle:id=273,.parent=17"
         _StyleDefs(309) =   "Splits(0).Columns(65).Style:id=270,.parent=13"
         _StyleDefs(310) =   "Splits(0).Columns(65).HeadingStyle:id=267,.parent=14"
         _StyleDefs(311) =   "Splits(0).Columns(65).FooterStyle:id=268,.parent=15"
         _StyleDefs(312) =   "Splits(0).Columns(65).EditorStyle:id=269,.parent=17"
         _StyleDefs(313) =   "Splits(0).Columns(66).Style:id=266,.parent=13"
         _StyleDefs(314) =   "Splits(0).Columns(66).HeadingStyle:id=263,.parent=14"
         _StyleDefs(315) =   "Splits(0).Columns(66).FooterStyle:id=264,.parent=15"
         _StyleDefs(316) =   "Splits(0).Columns(66).EditorStyle:id=265,.parent=17"
         _StyleDefs(317) =   "Splits(0).Columns(67).Style:id=262,.parent=13"
         _StyleDefs(318) =   "Splits(0).Columns(67).HeadingStyle:id=259,.parent=14"
         _StyleDefs(319) =   "Splits(0).Columns(67).FooterStyle:id=260,.parent=15"
         _StyleDefs(320) =   "Splits(0).Columns(67).EditorStyle:id=261,.parent=17"
         _StyleDefs(321) =   "Splits(0).Columns(68).Style:id=258,.parent=13"
         _StyleDefs(322) =   "Splits(0).Columns(68).HeadingStyle:id=255,.parent=14"
         _StyleDefs(323) =   "Splits(0).Columns(68).FooterStyle:id=256,.parent=15"
         _StyleDefs(324) =   "Splits(0).Columns(68).EditorStyle:id=257,.parent=17"
         _StyleDefs(325) =   "Splits(0).Columns(69).Style:id=254,.parent=13"
         _StyleDefs(326) =   "Splits(0).Columns(69).HeadingStyle:id=251,.parent=14"
         _StyleDefs(327) =   "Splits(0).Columns(69).FooterStyle:id=252,.parent=15"
         _StyleDefs(328) =   "Splits(0).Columns(69).EditorStyle:id=253,.parent=17"
         _StyleDefs(329) =   "Splits(0).Columns(70).Style:id=250,.parent=13"
         _StyleDefs(330) =   "Splits(0).Columns(70).HeadingStyle:id=247,.parent=14"
         _StyleDefs(331) =   "Splits(0).Columns(70).FooterStyle:id=248,.parent=15"
         _StyleDefs(332) =   "Splits(0).Columns(70).EditorStyle:id=249,.parent=17"
         _StyleDefs(333) =   "Splits(0).Columns(71).Style:id=246,.parent=13"
         _StyleDefs(334) =   "Splits(0).Columns(71).HeadingStyle:id=243,.parent=14"
         _StyleDefs(335) =   "Splits(0).Columns(71).FooterStyle:id=244,.parent=15"
         _StyleDefs(336) =   "Splits(0).Columns(71).EditorStyle:id=245,.parent=17"
         _StyleDefs(337) =   "Splits(0).Columns(72).Style:id=242,.parent=13"
         _StyleDefs(338) =   "Splits(0).Columns(72).HeadingStyle:id=239,.parent=14"
         _StyleDefs(339) =   "Splits(0).Columns(72).FooterStyle:id=240,.parent=15"
         _StyleDefs(340) =   "Splits(0).Columns(72).EditorStyle:id=241,.parent=17"
         _StyleDefs(341) =   "Splits(0).Columns(73).Style:id=238,.parent=13"
         _StyleDefs(342) =   "Splits(0).Columns(73).HeadingStyle:id=235,.parent=14"
         _StyleDefs(343) =   "Splits(0).Columns(73).FooterStyle:id=236,.parent=15"
         _StyleDefs(344) =   "Splits(0).Columns(73).EditorStyle:id=237,.parent=17"
         _StyleDefs(345) =   "Splits(0).Columns(74).Style:id=234,.parent=13"
         _StyleDefs(346) =   "Splits(0).Columns(74).HeadingStyle:id=231,.parent=14"
         _StyleDefs(347) =   "Splits(0).Columns(74).FooterStyle:id=232,.parent=15"
         _StyleDefs(348) =   "Splits(0).Columns(74).EditorStyle:id=233,.parent=17"
         _StyleDefs(349) =   "Splits(0).Columns(75).Style:id=230,.parent=13"
         _StyleDefs(350) =   "Splits(0).Columns(75).HeadingStyle:id=227,.parent=14"
         _StyleDefs(351) =   "Splits(0).Columns(75).FooterStyle:id=228,.parent=15"
         _StyleDefs(352) =   "Splits(0).Columns(75).EditorStyle:id=229,.parent=17"
         _StyleDefs(353) =   "Splits(0).Columns(76).Style:id=226,.parent=13"
         _StyleDefs(354) =   "Splits(0).Columns(76).HeadingStyle:id=223,.parent=14"
         _StyleDefs(355) =   "Splits(0).Columns(76).FooterStyle:id=224,.parent=15"
         _StyleDefs(356) =   "Splits(0).Columns(76).EditorStyle:id=225,.parent=17"
         _StyleDefs(357) =   "Splits(0).Columns(77).Style:id=222,.parent=13"
         _StyleDefs(358) =   "Splits(0).Columns(77).HeadingStyle:id=219,.parent=14"
         _StyleDefs(359) =   "Splits(0).Columns(77).FooterStyle:id=220,.parent=15"
         _StyleDefs(360) =   "Splits(0).Columns(77).EditorStyle:id=221,.parent=17"
         _StyleDefs(361) =   "Splits(0).Columns(78).Style:id=218,.parent=13"
         _StyleDefs(362) =   "Splits(0).Columns(78).HeadingStyle:id=215,.parent=14"
         _StyleDefs(363) =   "Splits(0).Columns(78).FooterStyle:id=216,.parent=15"
         _StyleDefs(364) =   "Splits(0).Columns(78).EditorStyle:id=217,.parent=17"
         _StyleDefs(365) =   "Splits(0).Columns(79).Style:id=370,.parent=13"
         _StyleDefs(366) =   "Splits(0).Columns(79).HeadingStyle:id=367,.parent=14"
         _StyleDefs(367) =   "Splits(0).Columns(79).FooterStyle:id=368,.parent=15"
         _StyleDefs(368) =   "Splits(0).Columns(79).EditorStyle:id=369,.parent=17"
         _StyleDefs(369) =   "Splits(0).Columns(80).Style:id=366,.parent=13"
         _StyleDefs(370) =   "Splits(0).Columns(80).HeadingStyle:id=363,.parent=14"
         _StyleDefs(371) =   "Splits(0).Columns(80).FooterStyle:id=364,.parent=15"
         _StyleDefs(372) =   "Splits(0).Columns(80).EditorStyle:id=365,.parent=17"
         _StyleDefs(373) =   "Splits(0).Columns(81).Style:id=214,.parent=13"
         _StyleDefs(374) =   "Splits(0).Columns(81).HeadingStyle:id=211,.parent=14"
         _StyleDefs(375) =   "Splits(0).Columns(81).FooterStyle:id=212,.parent=15"
         _StyleDefs(376) =   "Splits(0).Columns(81).EditorStyle:id=213,.parent=17"
         _StyleDefs(377) =   "Splits(0).Columns(82).Style:id=206,.parent=13,.bgcolor=&HFFFDE6&"
         _StyleDefs(378) =   "Splits(0).Columns(82).HeadingStyle:id=203,.parent=14"
         _StyleDefs(379) =   "Splits(0).Columns(82).FooterStyle:id=204,.parent=15"
         _StyleDefs(380) =   "Splits(0).Columns(82).EditorStyle:id=205,.parent=17"
         _StyleDefs(381) =   "Splits(0).Columns(83).Style:id=210,.parent=13,.bgcolor=&HFFFDE6&"
         _StyleDefs(382) =   ":id=210,.fgcolor=&H8000&,.bold=-1,.fontsize=825,.italic=0,.underline=0"
         _StyleDefs(383) =   ":id=210,.strikethrough=0,.charset=0"
         _StyleDefs(384) =   ":id=210,.fontname=Arial"
         _StyleDefs(385) =   "Splits(0).Columns(83).HeadingStyle:id=207,.parent=14"
         _StyleDefs(386) =   "Splits(0).Columns(83).FooterStyle:id=208,.parent=15"
         _StyleDefs(387) =   "Splits(0).Columns(83).EditorStyle:id=209,.parent=17"
         _StyleDefs(388) =   "Named:id=33:Normal"
         _StyleDefs(389) =   ":id=33,.parent=0,.bgcolor=&H80000005&"
         _StyleDefs(390) =   "Named:id=34:Heading"
         _StyleDefs(391) =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
         _StyleDefs(392) =   ":id=34,.wraptext=-1"
         _StyleDefs(393) =   "Named:id=35:Footing"
         _StyleDefs(394) =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
         _StyleDefs(395) =   "Named:id=36:Selected"
         _StyleDefs(396) =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
         _StyleDefs(397) =   "Named:id=37:Caption"
         _StyleDefs(398) =   ":id=37,.parent=34,.alignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
         _StyleDefs(399) =   "Named:id=38:HighlightRow"
         _StyleDefs(400) =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
         _StyleDefs(401) =   "Named:id=39:EvenRow"
         _StyleDefs(402) =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
         _StyleDefs(403) =   "Named:id=40:OddRow"
         _StyleDefs(404) =   ":id=40,.parent=33"
         _StyleDefs(405) =   "Named:id=41:RecordSelector"
         _StyleDefs(406) =   ":id=41,.parent=34"
         _StyleDefs(407) =   "Named:id=42:FilterBar"
         _StyleDefs(408) =   ":id=42,.parent=33"
         _StyleDefs(409) =   "Named:id=0:"
         _StyleDefs(410) =   ":id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
         _StyleDefs(411) =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
         _StyleDefs(412) =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
         _StyleDefs(413) =   ":id=0,.borderColor=&H80000005&,.borderType=255,.bold=0,.fontsize=825,.italic=0"
         _StyleDefs(414) =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(415) =   ":id=0,.fontname=MS Sans Serif"
      End
      Begin TrueOleDBGrid70.TDBDropDown tdbdOperaTC 
         Height          =   975
         Left            =   8040
         TabIndex        =   52
         Top             =   1800
         Visible         =   0   'False
         Width           =   2895
         _ExtentX        =   5106
         _ExtentY        =   1720
         _LayoutType     =   4
         _RowHeight      =   -2147483647
         _WasPersistedAsPixels=   0
         Columns(0)._VlistStyle=   0
         Columns(0)._MaxComboItems=   5
         Columns(0).Caption=   "Tipo"
         Columns(0).DataField=   "Tab_cCodigo"
         Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(1)._VlistStyle=   0
         Columns(1)._MaxComboItems=   5
         Columns(1).Caption=   "Descripcion"
         Columns(1).DataField=   "Tab_cDescripCampo"
         Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns.Count   =   2
         Splits(0)._UserFlags=   0
         Splits(0).ExtendRightColumn=   -1  'True
         Splits(0).MarqueeStyle=   3
         Splits(0).AllowRowSizing=   0   'False
         Splits(0).RecordSelectors=   0   'False
         Splits(0).RecordSelectorWidth=   688
         Splits(0)._SavedRecordSelectors=   0   'False
         Splits(0).DividerColor=   14215660
         Splits(0).SpringMode=   0   'False
         Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
         Splits(0)._ColumnProps(0)=   "Columns.Count=2"
         Splits(0)._ColumnProps(1)=   "Column(0).Width=820"
         Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
         Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=741"
         Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
         Splits(0)._ColumnProps(5)=   "Column(0).Order=1"
         Splits(0)._ColumnProps(6)=   "Column(1).Width=1482"
         Splits(0)._ColumnProps(7)=   "Column(1).DividerColor=0"
         Splits(0)._ColumnProps(8)=   "Column(1)._WidthInPix=1402"
         Splits(0)._ColumnProps(9)=   "Column(1)._EditAlways=0"
         Splits(0)._ColumnProps(10)=   "Column(1).Order=2"
         Splits.Count    =   1
         AllowRowSizing  =   0   'False
         Appearance      =   1
         BorderStyle     =   1
         ColumnHeaders   =   -1  'True
         DataMode        =   0
         DefColWidth     =   0
         Enabled         =   -1  'True
         HeadLines       =   1
         RowDividerStyle =   2
         LayoutName      =   ""
         LayoutFileName  =   ""
         LayoutURL       =   ""
         EmptyRows       =   0   'False
         ListField       =   ""
         DataField       =   ""
         IntegralHeight  =   0   'False
         FetchRowStyle   =   0   'False
         AlternatingRowStyle=   0   'False
         DataMember      =   ""
         ColumnFooters   =   0   'False
         FootLines       =   1
         DeadAreaBackColor=   14215660
         ValueTranslate  =   0   'False
         RowDividerColor =   14215660
         RowSubDividerColor=   14215660
         _PropDict       =   "_ExtentX,2003,3;_ExtentY,2004,3;_LayoutType,512,2;_RowHeight,16,3;_StyleDefs,513,0;_WasPersistedAsPixels,516,2"
         _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
         _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
         _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
         _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=101,.bold=0,.fontsize=825,.italic=0"
         _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(5)   =   ":id=0,.fontname=Arial"
         _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bgcolor=&HF1EFEB&,.bold=0,.fontsize=825"
         _StyleDefs(7)   =   ":id=1,.italic=0,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(8)   =   ":id=1,.fontname=Arial"
         _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
         _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34,.bgcolor=&HCA570B&"
         _StyleDefs(11)  =   ":id=2,.fgcolor=&HFFFFFF&,.bold=0,.fontsize=825,.italic=0,.underline=0"
         _StyleDefs(12)  =   ":id=2,.strikethrough=0,.charset=0"
         _StyleDefs(13)  =   ":id=2,.fontname=Arial"
         _StyleDefs(14)  =   "FooterStyle:id=3,.parent=1,.namedParent=35,.bold=0,.fontsize=825,.italic=0"
         _StyleDefs(15)  =   ":id=3,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(16)  =   ":id=3,.fontname=Arial"
         _StyleDefs(17)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
         _StyleDefs(18)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
         _StyleDefs(19)  =   "EditorStyle:id=7,.parent=1"
         _StyleDefs(20)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
         _StyleDefs(21)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
         _StyleDefs(22)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
         _StyleDefs(23)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
         _StyleDefs(24)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
         _StyleDefs(25)  =   "Splits(0).Style:id=13,.parent=1"
         _StyleDefs(26)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
         _StyleDefs(27)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
         _StyleDefs(28)  =   "Splits(0).FooterStyle:id=15,.parent=3"
         _StyleDefs(29)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
         _StyleDefs(30)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
         _StyleDefs(31)  =   "Splits(0).EditorStyle:id=17,.parent=7"
         _StyleDefs(32)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
         _StyleDefs(33)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
         _StyleDefs(34)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
         _StyleDefs(35)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
         _StyleDefs(36)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
         _StyleDefs(37)  =   "Splits(0).Columns(0).Style:id=28,.parent=13"
         _StyleDefs(38)  =   "Splits(0).Columns(0).HeadingStyle:id=25,.parent=14"
         _StyleDefs(39)  =   "Splits(0).Columns(0).FooterStyle:id=26,.parent=15"
         _StyleDefs(40)  =   "Splits(0).Columns(0).EditorStyle:id=27,.parent=17"
         _StyleDefs(41)  =   "Splits(0).Columns(1).Style:id=32,.parent=13"
         _StyleDefs(42)  =   "Splits(0).Columns(1).HeadingStyle:id=29,.parent=14"
         _StyleDefs(43)  =   "Splits(0).Columns(1).FooterStyle:id=30,.parent=15"
         _StyleDefs(44)  =   "Splits(0).Columns(1).EditorStyle:id=31,.parent=17"
         _StyleDefs(45)  =   "Named:id=33:Normal"
         _StyleDefs(46)  =   ":id=33,.parent=0"
         _StyleDefs(47)  =   "Named:id=34:Heading"
         _StyleDefs(48)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
         _StyleDefs(49)  =   ":id=34,.wraptext=-1"
         _StyleDefs(50)  =   "Named:id=35:Footing"
         _StyleDefs(51)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
         _StyleDefs(52)  =   "Named:id=36:Selected"
         _StyleDefs(53)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
         _StyleDefs(54)  =   "Named:id=37:Caption"
         _StyleDefs(55)  =   ":id=37,.parent=34,.alignment=2"
         _StyleDefs(56)  =   "Named:id=38:HighlightRow"
         _StyleDefs(57)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
         _StyleDefs(58)  =   "Named:id=39:EvenRow"
         _StyleDefs(59)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
         _StyleDefs(60)  =   "Named:id=40:OddRow"
         _StyleDefs(61)  =   ":id=40,.parent=33"
         _StyleDefs(62)  =   "Named:id=41:RecordSelector"
         _StyleDefs(63)  =   ":id=41,.parent=34"
         _StyleDefs(64)  =   "Named:id=42:FilterBar"
         _StyleDefs(65)  =   ":id=42,.parent=33"
      End
      Begin TrueOleDBGrid70.TDBDropDown tdbdMoneDet 
         Height          =   975
         Left            =   225
         TabIndex        =   77
         Top             =   2205
         Visible         =   0   'False
         Width           =   2895
         _ExtentX        =   5106
         _ExtentY        =   1720
         _LayoutType     =   4
         _RowHeight      =   -2147483647
         _WasPersistedAsPixels=   0
         Columns(0)._VlistStyle=   0
         Columns(0)._MaxComboItems=   5
         Columns(0).Caption=   "Abrev."
         Columns(0).DataField=   "Mon_cNombreCorto"
         Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(1)._VlistStyle=   0
         Columns(1)._MaxComboItems=   5
         Columns(1).Caption=   "Codigo"
         Columns(1).DataField=   "Mon_cCodigo"
         Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(2)._VlistStyle=   0
         Columns(2)._MaxComboItems=   5
         Columns(2).Caption=   "Mon_cMNac"
         Columns(2).DataField=   "Mon_cMNac"
         Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns(3)._VlistStyle=   0
         Columns(3)._MaxComboItems=   5
         Columns(3).Caption=   "Descripción"
         Columns(3).DataField=   "Mon_cNombreLargo"
         Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
         Columns.Count   =   4
         Splits(0)._UserFlags=   0
         Splits(0).ExtendRightColumn=   -1  'True
         Splits(0).MarqueeStyle=   3
         Splits(0).AllowRowSizing=   0   'False
         Splits(0).RecordSelectors=   0   'False
         Splits(0).RecordSelectorWidth=   688
         Splits(0)._SavedRecordSelectors=   0   'False
         Splits(0).DividerColor=   14215660
         Splits(0).SpringMode=   0   'False
         Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
         Splits(0)._ColumnProps(0)=   "Columns.Count=4"
         Splits(0)._ColumnProps(1)=   "Column(0).Width=1482"
         Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
         Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=1402"
         Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
         Splits(0)._ColumnProps(5)=   "Column(0).Order=1"
         Splits(0)._ColumnProps(6)=   "Column(1).Width=1191"
         Splits(0)._ColumnProps(7)=   "Column(1).DividerColor=0"
         Splits(0)._ColumnProps(8)=   "Column(1)._WidthInPix=1111"
         Splits(0)._ColumnProps(9)=   "Column(1)._EditAlways=0"
         Splits(0)._ColumnProps(10)=   "Column(1).Visible=0"
         Splits(0)._ColumnProps(11)=   "Column(1).Order=2"
         Splits(0)._ColumnProps(12)=   "Column(2).Width=2725"
         Splits(0)._ColumnProps(13)=   "Column(2).DividerColor=0"
         Splits(0)._ColumnProps(14)=   "Column(2)._WidthInPix=2646"
         Splits(0)._ColumnProps(15)=   "Column(2)._EditAlways=0"
         Splits(0)._ColumnProps(16)=   "Column(2).Visible=0"
         Splits(0)._ColumnProps(17)=   "Column(2).Order=3"
         Splits(0)._ColumnProps(18)=   "Column(3).Width=2725"
         Splits(0)._ColumnProps(19)=   "Column(3).DividerColor=0"
         Splits(0)._ColumnProps(20)=   "Column(3)._WidthInPix=2646"
         Splits(0)._ColumnProps(21)=   "Column(3)._EditAlways=0"
         Splits(0)._ColumnProps(22)=   "Column(3).Order=4"
         Splits.Count    =   1
         AllowRowSizing  =   0   'False
         Appearance      =   1
         BorderStyle     =   1
         ColumnHeaders   =   -1  'True
         DataMode        =   0
         DefColWidth     =   0
         Enabled         =   -1  'True
         HeadLines       =   1
         RowDividerStyle =   2
         LayoutName      =   ""
         LayoutFileName  =   ""
         LayoutURL       =   ""
         EmptyRows       =   0   'False
         ListField       =   ""
         DataField       =   ""
         IntegralHeight  =   0   'False
         FetchRowStyle   =   0   'False
         AlternatingRowStyle=   0   'False
         DataMember      =   ""
         ColumnFooters   =   0   'False
         FootLines       =   1
         DeadAreaBackColor=   14215660
         ValueTranslate  =   0   'False
         RowDividerColor =   14215660
         RowSubDividerColor=   14215660
         _PropDict       =   "_ExtentX,2003,3;_ExtentY,2004,3;_LayoutType,512,2;_RowHeight,16,3;_StyleDefs,513,0;_WasPersistedAsPixels,516,2"
         _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
         _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
         _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
         _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=101,.bold=0,.fontsize=825,.italic=0"
         _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(5)   =   ":id=0,.fontname=Arial"
         _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bgcolor=&HF1EFEB&,.bold=0,.fontsize=825"
         _StyleDefs(7)   =   ":id=1,.italic=0,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(8)   =   ":id=1,.fontname=Arial"
         _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
         _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34,.bgcolor=&HCA570B&"
         _StyleDefs(11)  =   ":id=2,.fgcolor=&HFFFFFF&,.bold=0,.fontsize=825,.italic=0,.underline=0"
         _StyleDefs(12)  =   ":id=2,.strikethrough=0,.charset=0"
         _StyleDefs(13)  =   ":id=2,.fontname=Arial"
         _StyleDefs(14)  =   "FooterStyle:id=3,.parent=1,.namedParent=35,.bold=0,.fontsize=825,.italic=0"
         _StyleDefs(15)  =   ":id=3,.underline=0,.strikethrough=0,.charset=0"
         _StyleDefs(16)  =   ":id=3,.fontname=Arial"
         _StyleDefs(17)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
         _StyleDefs(18)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
         _StyleDefs(19)  =   "EditorStyle:id=7,.parent=1"
         _StyleDefs(20)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
         _StyleDefs(21)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
         _StyleDefs(22)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
         _StyleDefs(23)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
         _StyleDefs(24)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
         _StyleDefs(25)  =   "Splits(0).Style:id=13,.parent=1"
         _StyleDefs(26)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
         _StyleDefs(27)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
         _StyleDefs(28)  =   "Splits(0).FooterStyle:id=15,.parent=3"
         _StyleDefs(29)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
         _StyleDefs(30)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
         _StyleDefs(31)  =   "Splits(0).EditorStyle:id=17,.parent=7"
         _StyleDefs(32)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
         _StyleDefs(33)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
         _StyleDefs(34)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
         _StyleDefs(35)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
         _StyleDefs(36)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
         _StyleDefs(37)  =   "Splits(0).Columns(0).Style:id=28,.parent=13"
         _StyleDefs(38)  =   "Splits(0).Columns(0).HeadingStyle:id=25,.parent=14"
         _StyleDefs(39)  =   "Splits(0).Columns(0).FooterStyle:id=26,.parent=15"
         _StyleDefs(40)  =   "Splits(0).Columns(0).EditorStyle:id=27,.parent=17"
         _StyleDefs(41)  =   "Splits(0).Columns(1).Style:id=32,.parent=13"
         _StyleDefs(42)  =   "Splits(0).Columns(1).HeadingStyle:id=29,.parent=14"
         _StyleDefs(43)  =   "Splits(0).Columns(1).FooterStyle:id=30,.parent=15"
         _StyleDefs(44)  =   "Splits(0).Columns(1).EditorStyle:id=31,.parent=17"
         _StyleDefs(45)  =   "Splits(0).Columns(2).Style:id=46,.parent=13"
         _StyleDefs(46)  =   "Splits(0).Columns(2).HeadingStyle:id=43,.parent=14"
         _StyleDefs(47)  =   "Splits(0).Columns(2).FooterStyle:id=44,.parent=15"
         _StyleDefs(48)  =   "Splits(0).Columns(2).EditorStyle:id=45,.parent=17"
         _StyleDefs(49)  =   "Splits(0).Columns(3).Style:id=50,.parent=13"
         _StyleDefs(50)  =   "Splits(0).Columns(3).HeadingStyle:id=47,.parent=14"
         _StyleDefs(51)  =   "Splits(0).Columns(3).FooterStyle:id=48,.parent=15"
         _StyleDefs(52)  =   "Splits(0).Columns(3).EditorStyle:id=49,.parent=17"
         _StyleDefs(53)  =   "Named:id=33:Normal"
         _StyleDefs(54)  =   ":id=33,.parent=0"
         _StyleDefs(55)  =   "Named:id=34:Heading"
         _StyleDefs(56)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
         _StyleDefs(57)  =   ":id=34,.wraptext=-1"
         _StyleDefs(58)  =   "Named:id=35:Footing"
         _StyleDefs(59)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
         _StyleDefs(60)  =   "Named:id=36:Selected"
         _StyleDefs(61)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
         _StyleDefs(62)  =   "Named:id=37:Caption"
         _StyleDefs(63)  =   ":id=37,.parent=34,.alignment=2"
         _StyleDefs(64)  =   "Named:id=38:HighlightRow"
         _StyleDefs(65)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
         _StyleDefs(66)  =   "Named:id=39:EvenRow"
         _StyleDefs(67)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
         _StyleDefs(68)  =   "Named:id=40:OddRow"
         _StyleDefs(69)  =   ":id=40,.parent=33"
         _StyleDefs(70)  =   "Named:id=41:RecordSelector"
         _StyleDefs(71)  =   ":id=41,.parent=34"
         _StyleDefs(72)  =   "Named:id=42:FilterBar"
         _StyleDefs(73)  =   ":id=42,.parent=33"
      End
   End
   Begin MSAdodcLib.Adodc rsArreglo 
      Height          =   750
      Left            =   6240
      Top             =   870
      Visible         =   0   'False
      Width           =   1500
      _ExtentX        =   2646
      _ExtentY        =   1323
      ConnectMode     =   0
      CursorLocation  =   3
      IsolationLevel  =   -1
      ConnectionTimeout=   15
      CommandTimeout  =   30
      CursorType      =   3
      LockType        =   3
      CommandType     =   8
      CursorOptions   =   0
      CacheSize       =   50
      MaxRecords      =   0
      BOFAction       =   0
      EOFAction       =   0
      ConnectStringType=   1
      Appearance      =   1
      BackColor       =   -2147483643
      ForeColor       =   -2147483640
      Orientation     =   0
      Enabled         =   -1
      Connect         =   ""
      OLEDBString     =   ""
      OLEDBFile       =   ""
      DataSourceName  =   ""
      OtherAttributes =   ""
      UserName        =   ""
      Password        =   ""
      RecordSource    =   ""
      Caption         =   "Adodc1"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      _Version        =   393216
   End
   Begin VB.Label lblEstado 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H00000000&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H0000FFFF&
      Height          =   300
      Left            =   9360
      TabIndex        =   146
      Top             =   45
      Width           =   2115
   End
   Begin VB.Label lblCalculoManual 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H000000FF&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "CALCULO MANUAL"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H0000FFFF&
      Height          =   300
      Left            =   7425
      TabIndex        =   145
      Top             =   45
      Visible         =   0   'False
      Width           =   1935
   End
End
Attribute VB_Name = "frmManAsientosContables"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False

'--------------------------------------------------------------------------------
'    Component  : frmManAsientosContables
'    Project    : Contabilidad
'
'    Description: Formulario de mantenimiento de asientos contables
'--------------------------------------------------------------------------------

Option Explicit

Dim lArrMoneda As New XArrayDB      ' *** arreglo para las monedas
Dim lArrMonedaAdic As New XArrayDB  ' *** arreglo para las monedas adicionales
Dim lArrBaseImp As New XArrayDB
Dim lArrTipoDoc As New XArrayDB

Dim lArrDetalle As XArrayDB         ' *** arreglo para el grid de detalle
Dim lArrDetalleTemp As XArrayDB     ' *** arreglo para el grid de detalle
Dim lArrDetalleElim As XArrayDB     ' *** arreglo para el grid de detalle

'-------------------------------------------------------------------------------------------------


Dim Activado As Boolean
Dim lArrMnt() As Variant
Dim sTipoCambioDefecto As String    ' *** Tipo de CAmbio por defecto
Dim sw As Boolean ' *** Sw que permite que no Actualice la Variable Gsperiodo cuando pase por el combo y este Cargando el frm
Dim gTerminaCargarNuevo As Boolean
'-------------------------------------------------------------------------------------------------
Dim cn As ADODB.Connection

Dim lrsAsientos As ADODB.Recordset
Dim lrsOperaTC As ADODB.Recordset
Dim lrsTipoMone As ADODB.Recordset
Dim lrsCtasxLibro As ADODB.Recordset
Dim lrsOpxCta As ADODB.Recordset
Dim lrsProcesos As ADODB.Recordset
Dim lrsDocBolVta As ADODB.Recordset
'-------------------------------------------------------------------------------------------------
Dim lItem As Double                ' *** controla la cantidad de los items
Dim lControl As String              ' *** variable para la ayuda del control
Dim lArrCab() As Variant            ' *** Arreglo para la cabecera del asiento
Dim lArrDet() As Variant            ' *** Arreglo para el detalle del asiento
Dim gsDatosCuenta(12) As String
Dim gsCodConceptoDefecto As String
Dim gsDesConceptoDefecto As String
'-------------------------------------------------------------------------------------------------
Dim lNumInterno As String           ' *** variable para el numero interno del asiento
Dim datosLlenos As Boolean          ' *** Variable para cargar combos
Dim nTotalProvDSoles As Double
Dim nTotalProvHSoles As Double
Dim nTotalProvDDolar As Double
Dim nTotalProvHDolar As Double

Dim nTotalBaseImoponibleDSoles As Double
Dim nTotalBaseImoponibleHSoles As Double
Dim nTotalBaseImoponibleDDolar As Double
Dim nTotalBaseImoponibleHDolar As Double
Dim lsCfgBaseImpo As String, lsCfgCtasCance As String
Dim lnOpcion As Integer, lsTituOpcion As String
'-------------------------------------------------------------------------------------------------
Dim nColAsd_nItem As Integer
Dim nColPla_cCuentaContable As Integer
Dim nColPla_cNombreCuenta As Integer
Dim nColAsd_cGlosa As Integer
Dim nColAsd_nDebeSoles As Integer
Dim nColAsd_nDebeMonExt As Integer
Dim nColAsd_nHaberSoles As Integer
Dim nColAsd_nHaberMonExt As Integer
Dim nColAsd_nMontoInafecto As Integer
Dim nCol_cFlgDetRet As Integer
Dim nColCos_cCodigo As Integer
Dim nColTen_cTipoEntidad As Integer
Dim nColEnt_cCodEntidad As Integer
Dim nColEnt_cPersona As Integer
Dim nColAsd_cTipoDoc As Integer
Dim nColAsd_cSerieDoc As Integer
Dim nColAsd_cNumDoc As Integer
Dim nColAsd_dFecDoc As Integer
Dim nColAsd_dFecVen As Integer
Dim nColAsd_cOperaTC As Integer
Dim nColAsd_nTipoCambio As Integer
Dim nColAsd_cTipoDocRef As Integer
Dim nColAsd_cSerieDocRef As Integer
Dim nColAsd_cNumDocRef As Integer
Dim nColAsd_dFecDocRef As Integer
Dim nColPla_cTipoAfect As Integer
Dim nColAsd_cNumSpot As Integer
Dim nColAsd_dFechaSpot As Integer
Dim nColAsd_cDestino As Integer
Dim nColAsd_nCorre As Integer
Dim nColAsd_dFecDocAux As Integer
Dim nColAsd_cTipoMoneda As Integer
Dim nColAsd_cNomMoneda As Integer
Dim nCol_cFlgMonNac As Integer
Dim nCol_cFlgCCosto As Integer
Dim nCol_cFlgProv As Integer
Dim nColAsd_cMonedaCalculo As Integer
Dim nColPla_cDocumento As Integer
Dim nColTra_cCodigo As Integer
Dim nColAsd_cFormaPago As Integer
Dim nColAsd_cBaseImp As Integer
Dim nColPla_cDetraccion As Integer
Dim nColPla_cRetencion As Integer
Dim nColPla_cPercepcion As Integer
Dim nColPla_cNCND As Integer
Dim lBolActivado As Boolean
Dim nCol_nPorceImp As Integer
Dim nCol_cTipoEntiCta As Integer
Dim nColAsd_cNomCC  As Integer
Dim nColAsd_cNomEnt  As Integer
Dim nColAsd_Cancelado As Integer
Dim nColAsd_cNomTD As Integer
Dim nColAsd_nSaldoProv As Integer
Dim nColAsd_nSaldoExtProv As Integer
Dim nColAsd_cMonAdic As Integer
Dim nColAsd_cImpAdic As Integer
Dim nColAsd_cGuardado As Integer
Dim nColAsd_cProvCanc As Integer
Dim nColAsd_cModif As Integer
Dim nColAsd_cDetOtros As Integer
Dim nColAsd_cDetalle As Integer
Dim nColAsd_cDetNac As Integer
Dim nColAsd_cDetExt As Integer
Dim nColAsd_cDetProv As Integer
Dim nColAsd_cDetCorrel As Integer
Dim nColAsd_cDetProvCanc As Integer
Dim nColAsd_cEntTipSerNum As Integer
Dim nColAsd_cCtaPagCob As Integer
Dim nColAsd_cComprobante As Integer
Dim nColAsd_cProceso As Integer
Dim nColAsd_cEcpOperacion As Integer
Dim nColAsd_cRegAux As Integer
Dim nColAsd_cRegAuxDet As Integer
Dim nColAsd_cManual As Integer
Dim nColAsd_cCanc As Integer
Dim nColAsd_cGrupo As Integer

Dim nColAsd_nNacional As Integer
Dim nColAsd_nExtranjera As Integer

Dim nColAsd_cXCtaEntTipSerNumFijo As Integer
Dim nColAsd_cXImportes As Integer
Dim nColAsd_cXOtrosVal As Integer
Dim nColAsd_nTCAlmacenado  As Integer

Dim nColAsd_nImporteEditado As Integer
Dim nColAsd_cCodConcepto As Integer
Dim nColAsd_cDesConcepto As Integer
'-------------------------------------------------------------------------------------------------
Dim CuentaActiva As String
Dim CuentaMensajes As Integer
Dim strSalida As Boolean 'para el lostfocus q valida si la glosa esta llena de la cabecera del voucher
Dim gsDatosCabecera As String

Dim gsUltimaCuenta As String
Dim gsUltimoCC As String
Dim gsUltimaEnt As String
Dim gsUltimoTD As String
Dim gsUltimaGlosa As String
Dim gsUltimoLibro As String
Dim gsUltimaFcha As String

Dim gsPeriodoAnterior As String
Dim gsKeyCode As Integer
Dim gsSalirControl As Boolean 'PARA EL CONTROL TDBNUMBER QUE ESTA ASOCIADA A LA GRILLA DEL DETALLE
Dim gsActualizaTC As Boolean
Dim gsCorrelProv As Double
Dim gsEliminoFila As Boolean
Dim gsBaseimp As String
Dim gsGrupoMemoria As String

Dim gsColumna As Integer
Dim gsGrupo As String
Dim gsMensaje As String
Dim gsDocProvisionado As Boolean
Dim gsDocEnDetalle As Boolean
Dim gsKeyControl As Boolean
Dim gsMonedaGuardada As String
Dim gsDocSinSaldo As Boolean
Dim gsColumnaInicialPress As Integer
Dim gsFlagBotonBarra As Boolean
Dim gsFlagKeydownDet As Boolean
Dim gsKeyAscii As Integer
Dim gsMesesAnteriores As Integer
Dim gsSaltoControl As Integer

Dim NUM_FILAS As Long
Dim NUM_FILAS_ELIM As Long

Dim SWEdit As Boolean


'-------------------------------------------------------------------------------------------------
Const gsColorGrilla = &H8000000F
Const gsColorGrillaMoneda = &H80000013
Const gsColorBCSel = &HFFC0C0
Const gsColorFCSel = &H0&
Const gsColorBCGenerada = &HFFFFC0
Const gsColorFCGenerada = &H800000
Const gsNumMaxKeyDown = 40
Const NUM_COLUMNAS = 83
Dim sSql As String
Dim rstDestinos As ADODB.Recordset

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       AsignaColDeta
' Description:       Procedimiento de asignacion de valores a las variables de columnas de la grilla de detalle
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub AsignaColDeta()

    nColAsd_nItem = 0
    nColPla_cCuentaContable = 1
    nColPla_cNombreCuenta = 2
    nColPla_cTipoAfect = 3
    nColEnt_cCodEntidad = 4
    nCol_cFlgCCosto = 5
    nCol_cFlgProv = 6
    nColCos_cCodigo = 7
    nColAsd_cTipoDoc = 8
    nColAsd_cSerieDoc = 9
    nColAsd_cNumDoc = 10
    nColAsd_dFecDoc = 11
    nColAsd_dFecVen = 12
    nColAsd_cNomMoneda = 13
    nColAsd_cTipoMoneda = 14
    nColAsd_cOperaTC = 15
    nColAsd_nTipoCambio = 16
    nColAsd_nDebeSoles = 17
    nColAsd_nHaberSoles = 18
    nColAsd_nDebeMonExt = 19
    nColAsd_nHaberMonExt = 20
    nColAsd_nMontoInafecto = 21
    nColTen_cTipoEntidad = 22
    nColEnt_cPersona = 23
    nColAsd_cGlosa = 24
    nColAsd_cTipoDocRef = 25
    nColAsd_cSerieDocRef = 26
    nColAsd_cNumDocRef = 27
    nColAsd_dFecDocRef = 28
    nCol_cFlgDetRet = 29
    nColAsd_cNumSpot = 30
    nColAsd_dFechaSpot = 31
    nColAsd_cDestino = 32
    nColAsd_nCorre = 33
    nColAsd_dFecDocAux = 34
    nCol_cFlgMonNac = 35
    nColAsd_cMonedaCalculo = 36
    nColPla_cDocumento = 37
    nCol_nPorceImp = 38
    nCol_cTipoEntiCta = 39
    '-------------------
    nColAsd_cCanc = 40
    nColAsd_cGrupo = 41
    
    nColTra_cCodigo = 78
    nColAsd_cFormaPago = 79
    '-------------------
    nColAsd_cBaseImp = 42
    nColPla_cDetraccion = 43
    nColPla_cRetencion = 44
    nColPla_cPercepcion = 45
    nColPla_cNCND = 46
    nColAsd_cNomCC = 47
    nColAsd_cNomEnt = 48
    nColAsd_cMonAdic = 49
    nColAsd_cImpAdic = 50
    nColAsd_Cancelado = 51
    nColAsd_cGuardado = 52
    nColAsd_nSaldoProv = 53
    nColAsd_nSaldoExtProv = 54
    nColAsd_cProvCanc = 55
    nColAsd_cNomTD = 56
    nColAsd_cModif = 57
    nColAsd_cDetalle = 58
    nColAsd_cDetNac = 59
    nColAsd_cDetExt = 60
    nColAsd_cDetCorrel = 61
    nColAsd_cDetProvCanc = 62
    nColAsd_cDetOtros = 63
    nColAsd_cEntTipSerNum = 64
    nColAsd_cDetProv = 65
    nColAsd_cCtaPagCob = 66
    nColAsd_cComprobante = 67
    nColAsd_cProceso = 68
    nColAsd_cEcpOperacion = 69
    nColAsd_cRegAux = 70
    nColAsd_cRegAuxDet = 71
    nColAsd_cManual = 72
    nColAsd_cXCtaEntTipSerNumFijo = 73
    nColAsd_cXImportes = 74
    nColAsd_cXOtrosVal = 75
    nColAsd_nNacional = 76
    nColAsd_nExtranjera = 77
    nColAsd_nTCAlmacenado = 80
    
    nColAsd_nImporteEditado = 81
    
    nColAsd_cCodConcepto = 82
    nColAsd_cDesConcepto = 83
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Grupo
' Description:       Propiedad de asignacion de grupo
'
' Parameters :       Grupo (String)
'--------------------------------------------------------------------------------
Public Property Let Grupo(ByVal Grupo As String)
     gsGrupo = Grupo
End Property

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenarDatosCabecera
' Description:       Procedimientode asignacion a la variable que tiene los datos de la cabecera del voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub LlenarDatosCabecera()
    gsDatosCabecera = CE(dtpFecha.Value) & CE(tdbcMoneda.BoundText) & CE(tdbtObservaciones.Text) & CE(tdbnPorcIGV.Text) & CE(tdbcTipoOperacion.BoundText)
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscarDatosCabecera
' Description:       Funcion de retorno de los datos de cabecera del voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function BuscarDatosCabecera() As String
    BuscarDatosCabecera = CE(dtpFecha.Value) & CE(tdbcMoneda.BoundText) & CE(tdbtObservaciones.Text) & CE(tdbnPorcIGV.Text) & CE(tdbcTipoOperacion.BoundText)
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       UpdateGrilla
' Description:       Procedimiento de actualizacion de grilla
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub UpdateGrilla()
    On Error Resume Next
    DoEvents
    tdbgDetalle.Update
    DoEvents
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       RefreshGrilla
' Description:       Procedimiento de refresh de grilla
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub RefreshGrilla()
    On Error Resume Next
    DoEvents
    tdbgDetalle.Refresh
    DoEvents
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       VariaMonNac
' Description:       Funcion que retorna si los importes de moneda nacional han variado
'
' Parameters :       nItem (Integer)
'                    Calcular (Boolean = False)
'--------------------------------------------------------------------------------
Private Function VariaMonNac(nItem As Integer, Optional Calcular As Boolean = False) As Boolean
    On Error GoTo serror
    With lArrDetalle
        If NE(.Value(nItem, nColAsd_nDebeSoles)) + NE(.Value(nItem, nColAsd_nHaberSoles)) <> NE(.Value(nItem, nColAsd_nNacional)) Or _
           NE(tdbgDetalle.Columns(nColAsd_nTipoCambio)) <> lArrDetalle(nItem, nColAsd_nTCAlmacenado) Or _
           Calcular = True Then
           VariaMonNac = True
        Else
            VariaMonNac = False
        End If
    End With
    
    Exit Function
serror:
    VariaMonNac = True
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       VariaMonExt
' Description:       Funcion que retorna si los importes de moneda extranjera han variado
'
' Parameters :       nItem (Integer)
'                    Calcular (Boolean = False)
'--------------------------------------------------------------------------------
Private Function VariaMonExt(nItem As Integer, Optional Calcular As Boolean = False) As Boolean
    On Error GoTo serror
    With lArrDetalle
        If NE(.Value(nItem, nColAsd_nDebeMonExt)) + NE(.Value(nItem, nColAsd_nHaberMonExt)) <> NE(.Value(nItem, nColAsd_nExtranjera)) Or _
           NE(tdbgDetalle.Columns(nColAsd_nTipoCambio)) <> lArrDetalle(nItem, nColAsd_nTCAlmacenado) Or _
           Calcular = True Then
            VariaMonExt = True
        Else
            VariaMonExt = False
        End If
    End With
    
    Exit Function
serror:
    VariaMonExt = True
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CalculaMonExt
' Description:       Procedimiento que calcula el importe de la moneda extranjera
'
' Parameters :       Calcular (Boolean = False)
'--------------------------------------------------------------------------------
Private Sub CalculaMonExt(Optional Calcular As Boolean = False)

On Error GoTo serror
    If CheckCuadraCompMan.Value = vbChecked Then Exit Sub
    With tdbgDetalle
        If VariaMonNac(.Bookmark, Calcular) Then
            .Columns(nColAsd_nDebeMonExt) = Redondear(NE(.Columns(nColAsd_nDebeSoles)) / NE(.Columns(nColAsd_nTipoCambio)), 2)
            .Columns(nColAsd_nHaberMonExt) = Redondear(NE(.Columns(nColAsd_nHaberSoles)) / NE(.Columns(nColAsd_nTipoCambio)), 2)
            
            lArrDetalle(.Bookmark, nColAsd_nExtranjera) = NE(.Columns(nColAsd_nDebeMonExt)) + NE(.Columns(nColAsd_nHaberMonExt))
        Else
            If NE(.Columns(nColAsd_nDebeSoles)) <> 0 Then
                .Columns(nColAsd_nDebeMonExt) = NE(lArrDetalle(.Bookmark, nColAsd_nExtranjera))
                .Columns(nColAsd_nHaberMonExt) = "0.00"
            Else
                .Columns(nColAsd_nDebeMonExt) = "0.00"
                .Columns(nColAsd_nHaberMonExt) = NE(lArrDetalle(.Bookmark, nColAsd_nExtranjera))
            End If

        End If
    End With

serror:
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CalculaMonNac
' Description:       Procedimiento que calcula el importe de la moneda nacional
'
' Parameters :       Calcular (Boolean = False)
'--------------------------------------------------------------------------------
Private Sub CalculaMonNac(Optional Calcular As Boolean = False)

    On Error GoTo serror
    If CheckCuadraCompMan.Value = vbChecked Then Exit Sub
    
    With tdbgDetalle
        If VariaMonExt(.Bookmark, Calcular) Then
            .Columns(nColAsd_nDebeSoles) = Redondear(NE(.Columns(nColAsd_nDebeMonExt)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
            .Columns(nColAsd_nHaberSoles) = Redondear(NE(.Columns(nColAsd_nHaberMonExt)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
            
            lArrDetalle(.Bookmark, nColAsd_nNacional) = NE(.Columns(nColAsd_nDebeSoles)) + NE(.Columns(nColAsd_nHaberSoles))
        Else
            If NE(.Columns(nColAsd_nDebeMonExt)) <> 0 Then
                .Columns(nColAsd_nDebeSoles) = NE(lArrDetalle(.Bookmark, nColAsd_nNacional))
                .Columns(nColAsd_nHaberSoles) = "0.00"
            Else
                .Columns(nColAsd_nDebeSoles) = "0.00"
                .Columns(nColAsd_nHaberSoles) = NE(lArrDetalle(.Bookmark, nColAsd_nNacional))
            End If
        End If
    End With
    
serror:
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaValoresDatos
' Description:       Funcion que retorna los valores del array temporal
'
' Parameters :       nfila (Integer)
'                    sTipo (TipoDato)
'--------------------------------------------------------------------------------
Private Function BuscaValoresDatos(nfila As Integer, sTipo As TipoDato) As String
    Dim Resultado As String
    Dim Pos As Integer
    Dim PosFin As Integer
    Dim cadena As String
    On Error GoTo serror
    cadena = CE(lArrDetalleTemp(nfila, nColAsd_cXCtaEntTipSerNumFijo)) & " X0 "
    Resultado = ""
    
    Pos = InStr(1, cadena, "X" & sTipo & " ")
    If Pos > 0 Then
        PosFin = Pos
        If Pos > 0 Then PosFin = InStr(Pos + 1, cadena, "X")
        Resultado = Mid(cadena, Pos + 2, PosFin - (Pos + 2))
    End If
    
    BuscaValoresDatos = CE(Resultado)
    Exit Function
serror:
    BuscaValoresDatos = ""
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaValoresImportes
' Description:       Funcion que retorna los importes del array temporal
'
' Parameters :       nfila (Integer)
'                    sTipo (TipoImporte)
'--------------------------------------------------------------------------------
Private Function BuscaValoresImportes(nfila As Integer, sTipo As TipoImporte) As Double
    Dim Resultado As String
    Dim Pos As Integer
    Dim PosFin As Integer
    Dim cadena As String
    On Error GoTo serror
    cadena = CE(lArrDetalleTemp(nfila, nColAsd_cXImportes)) & " X0 "
    Resultado = ""
    
    Pos = InStr(1, cadena, "X" & sTipo & " ")
    If Pos > 0 Then
        PosFin = Pos
        If Pos > 0 Then PosFin = InStr(Pos + 1, cadena, "X")
        Resultado = Mid(cadena, Pos + 2, PosFin - (Pos + 2))
    End If
    
    BuscaValoresImportes = NE(Resultado)
    Exit Function
serror:
    BuscaValoresImportes = ""
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaValoresOtros
' Description:       Funcion que retorna los otros valores del array temporal
'
' Parameters :       nfila (Integer)
'                    sTipo (TipoOtros)
'--------------------------------------------------------------------------------
Private Function BuscaValoresOtros(nfila As Integer, sTipo As TipoOtros) As String
    Dim Resultado As String
    Dim Pos As Integer
    Dim PosFin As Integer
    Dim cadena As String
    On Error GoTo serror
    cadena = CE(lArrDetalleTemp(nfila, nColAsd_cXOtrosVal)) & " X0 "
    Resultado = ""
    
    Pos = InStr(1, cadena, "X" & sTipo & " ")
    If Pos > 0 Then
        PosFin = Pos
        If Pos > 0 Then PosFin = InStr(Pos + 1, cadena, "X")
        Resultado = Mid(cadena, Pos + 2, PosFin - (Pos + 2))
    End If
    
    BuscaValoresOtros = CE(Resultado)
    Exit Function
serror:
    BuscaValoresOtros = ""
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CargaValoresAlmacenados
' Description:       Funcion que asigna al array los valores asignados del array temporal
'
' Parameters :       nPos (Integer)
'--------------------------------------------------------------------------------
Private Function CargaValoresAlmacenados(nPos As Integer) As Boolean
    If lArrDetalle Is Nothing Then
       Exit Function
    End If
    
    On Error GoTo serror
    Dim iFila As Integer
    iFila = tdbgDetalle.Bookmark
    
    lArrDetalle(iFila, nColPla_cCuentaContable) = BuscaValoresDatos(nPos, TipoDato.X_CUENTA)
    lArrDetalle(iFila, nCol_cTipoEntiCta) = BuscaValoresDatos(nPos, TipoDato.X_CODIGO)
    lArrDetalle(iFila, nColEnt_cCodEntidad) = BuscaValoresDatos(nPos, TipoDato.X_ENTIDAD)
    lArrDetalle(iFila, nColAsd_cTipoDoc) = BuscaValoresDatos(nPos, TipoDato.X_TIPO)
    lArrDetalle(iFila, nColAsd_cSerieDoc) = BuscaValoresDatos(nPos, TipoDato.X_SERIE)
    lArrDetalle(iFila, nColAsd_cNumDoc) = BuscaValoresDatos(nPos, TipoDato.X_NUMERO)
    
    lArrDetalle(iFila, nColAsd_nDebeSoles) = BuscaValoresImportes(nPos, TipoImporte.X_NACD)
    lArrDetalle(iFila, nColAsd_nHaberSoles) = BuscaValoresImportes(nPos, TipoImporte.X_NACH)
    lArrDetalle(iFila, nColAsd_nDebeMonExt) = BuscaValoresImportes(nPos, TipoImporte.X_EXTD)
    lArrDetalle(iFila, nColAsd_nHaberMonExt) = BuscaValoresImportes(nPos, TipoImporte.X_EXTH)
    lArrDetalle(iFila, nColAsd_nTipoCambio) = BuscaValoresImportes(nPos, TipoImporte.X_TC)
    lArrDetalle(iFila, nColAsd_cManual) = BuscaValoresImportes(nPos, TipoImporte.X_FLAM)
    lArrDetalle(iFila, nColAsd_nCorre) = BuscaValoresImportes(nPos, TipoImporte.X_CORR)
    lArrDetalle(iFila, nColAsd_nSaldoProv) = NE(lArrDetalle(iFila, nColAsd_nDebeSoles)) + NE(lArrDetalle(iFila, nColAsd_nHaberSoles))
    lArrDetalle(iFila, nColAsd_nSaldoExtProv) = NE(lArrDetalle(iFila, nColAsd_nDebeMonExt)) + NE(lArrDetalle(iFila, nColAsd_nHaberMonExt))
    
    lArrDetalle(iFila, nColAsd_dFecDoc) = BuscaValoresOtros(nPos, TipoOtros.X_FD)
    lArrDetalle(iFila, nColAsd_dFecVen) = BuscaValoresOtros(nPos, TipoOtros.X_FV)
    lArrDetalle(iFila, nColCos_cCodigo) = BuscaValoresOtros(nPos, TipoOtros.X_CC)
    lArrDetalle(iFila, nColAsd_cNomMoneda) = BuscaValoresOtros(nPos, TipoOtros.X_MO)
    lArrDetalle(iFila, nColAsd_cOperaTC) = BuscaValoresOtros(nPos, TipoOtros.X_OP)
    lArrDetalle(iFila, nColAsd_cTipoMoneda) = BuscaValoresOtros(nPos, TipoOtros.X_TM)
    lArrDetalle(iFila, nColAsd_cMonedaCalculo) = BuscaValoresOtros(nPos, TipoOtros.X_MC)
    lArrDetalle(iFila, nColAsd_cProvCanc) = BuscaValoresOtros(nPos, TipoOtros.X_PC)
    lArrDetalle(iFila, nColAsd_cEcpOperacion) = BuscaValoresOtros(nPos, TipoOtros.X_DH)
    lArrDetalle(iFila, nCol_cFlgMonNac) = BuscaValoresOtros(nPos, TipoOtros.X_FM)
    
    lArrDetalle(iFila, nColAsd_nNacional) = NE(lArrDetalle(iFila, nColAsd_nDebeSoles)) + NE(lArrDetalle(iFila, nColAsd_nHaberSoles))
    lArrDetalle(iFila, nColAsd_nExtranjera) = NE(lArrDetalle(iFila, nColAsd_nDebeMonExt)) + NE(lArrDetalle(iFila, nColAsd_nHaberMonExt))
    Exit Function
    
serror:
    'Mensajes "ERROR"

End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaDatosDoc
' Description:       Funcion que retorna los datos del documento del array temporal
'
' Parameters :       nfila (Integer)
'--------------------------------------------------------------------------------
Private Function BuscaDatosDoc(nfila As Long) As Integer
    Dim CadenaOrigen As String
    Dim i As Integer
    On Error GoTo serror
    BuscaDatosDoc = -1
    
    If CE(lArrDetalle(nfila, nColEnt_cCodEntidad)) = "" Or _
       CE(lArrDetalle(nfila, nColPla_cCuentaContable)) = "" Or _
       CE(lArrDetalle(nfila, nColAsd_cTipoDoc)) = "" Or _
       CE(lArrDetalle(nfila, nColAsd_cSerieDoc)) = "" Or _
       CE(lArrDetalle(nfila, nColAsd_cNumDoc)) = "" Then
       
       Exit Function
    End If

    CadenaOrigen = RetornaCtaEntTipSerNum(nfila)
    
    For i = 0 To lItem - 1
        If CadenaOrigen = CE(lArrDetalleTemp(i, nColAsd_cXCtaEntTipSerNumFijo)) Then
            BuscaDatosDoc = i
            Exit For
        End If
    Next i
    Exit Function
    
serror:
    BuscaDatosDoc = -1
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       RetornaCtaEntTipSerNum
' Description:       Funcion que retorna la llave principal de la linea del voucher
'
' Parameters :       nfila (Integer)
'--------------------------------------------------------------------------------
Private Function RetornaCtaEntTipSerNum(nfila As Long) As String
    Dim Resultado As String
    On Error GoTo serror
    Resultado = "X" & TipoDato.X_CUENTA & " " & CE(lArrDetalle(nfila, nColPla_cCuentaContable)) & " " & _
                "X" & TipoDato.X_CODIGO & " " & CE(lArrDetalle(nfila, nCol_cTipoEntiCta)) & " " & _
                "X" & TipoDato.X_ENTIDAD & " " & CE(lArrDetalle(nfila, nColEnt_cCodEntidad)) & " " & _
                "X" & TipoDato.X_TIPO & " " & CE(lArrDetalle(nfila, nColAsd_cTipoDoc)) & " " & _
                "X" & TipoDato.X_SERIE & " " & CE(lArrDetalle(nfila, nColAsd_cSerieDoc)) & " " & _
                "X" & TipoDato.X_NUMERO & " " & CE(lArrDetalle(nfila, nColAsd_cNumDoc))
                
    RetornaCtaEntTipSerNum = CE(Resultado)
        
    Exit Function
serror:
    RetornaCtaEntTipSerNum = ""
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       RetornaImportes
' Description:       Funcion que retorna los importes de la linea del detalle del voucher
'
' Parameters :       nfila (Integer)
'--------------------------------------------------------------------------------
Private Function RetornaImportes(nfila As Long) As String
    Dim Resultado As String
    On Error GoTo serror
    Resultado = "X" & TipoImporte.X_NACD & " " & NE(lArrDetalle(nfila, nColAsd_nDebeSoles)) & " " & _
                "X" & TipoImporte.X_NACH & " " & NE(lArrDetalle(nfila, nColAsd_nHaberSoles)) & " " & _
                "X" & TipoImporte.X_EXTD & " " & NE(lArrDetalle(nfila, nColAsd_nDebeMonExt)) & " " & _
                "X" & TipoImporte.X_EXTH & " " & NE(lArrDetalle(nfila, nColAsd_nHaberMonExt)) & " " & _
                "X" & TipoImporte.X_TC & " " & NE(lArrDetalle(nfila, nColAsd_nTipoCambio)) & " " & _
                "X" & TipoImporte.X_FLAM & " " & NE(lArrDetalle(nfila, nColAsd_cManual)) & " " & _
                "X" & TipoImporte.X_CORR & " " & NE(lArrDetalle(nfila, nColAsd_nCorre))
                
    RetornaImportes = CE(Resultado)
    Exit Function
serror:
    RetornaImportes = ""
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       RetornaOtros
' Description:       Funcion que retorna los valores de otros de la linea del voucher
'
' Parameters :       nfila (Integer)
'--------------------------------------------------------------------------------
Private Function RetornaOtros(nfila As Long) As String
    Dim Resultado As String
    On Error GoTo serror
    Resultado = "X" & TipoOtros.X_CC & " " & CE(lArrDetalle(nfila, nColCos_cCodigo)) & " " & _
                "X" & TipoOtros.X_FD & " " & CE(lArrDetalle(nfila, nColAsd_dFecDoc)) & " " & _
                "X" & TipoOtros.X_FV & " " & CE(lArrDetalle(nfila, nColAsd_dFecVen)) & " " & _
                "X" & TipoOtros.X_MO & " " & CE(lArrDetalle(nfila, nColAsd_cNomMoneda)) & " " & _
                "X" & TipoOtros.X_OP & " " & CE(lArrDetalle(nfila, nColAsd_cOperaTC)) & " " & _
                "X" & TipoOtros.X_TM & " " & CE(lArrDetalle(nfila, nColAsd_cTipoMoneda)) & " " & _
                "X" & TipoOtros.X_MC & " " & CE(lArrDetalle(nfila, nColAsd_cMonedaCalculo)) & " " & _
                "X" & TipoOtros.X_PC & " " & CE(lArrDetalle(nfila, nColAsd_cProvCanc)) & " " & _
                "X" & TipoOtros.X_DH & " " & CE(lArrDetalle(nfila, nColAsd_cEcpOperacion)) & " " & _
                "X" & TipoOtros.X_FM & " " & CE(lArrDetalle(nfila, nCol_cFlgMonNac))
                
                
    RetornaOtros = CE(Resultado)
    Exit Function
serror:
    RetornaOtros = ""

End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CalculaIGV
' Description:       Procedimiento que calcula el IGV del voucher segun sus bases imponibles
'
' Parameters :
'--------------------------------------------------------------------------------
Sub CalculaIGV()

    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    Dim i As Integer, nFil As Integer
    nTotalProvHSoles = 0
    nTotalProvDSoles = 0
    nTotalBaseImoponibleDSoles = 0
    nTotalBaseImoponibleHSoles = 0
    
    With tdbgDetalle
         If NE(tdbnPorcIGV.Value) > 0 Then
               nFil = DevuelveFilaCpto(lsCfgBaseImpo, .Bookmark)
               If nFil > -1 Then
                  .Columns(nCol_nPorceImp) = NE(.Columns(nCol_nPorceImp))
                  .Columns(nColAsd_nTipoCambio) = NE(.Columns(nColAsd_nTipoCambio))
                   
                  lArrDetalle.Value(.Bookmark, nColAsd_cModif) = 1
                  
                  .Columns(nColAsd_nDebeSoles) = 0
                  .Columns(nColAsd_nHaberSoles) = 0
                  .Columns(nColAsd_nDebeMonExt) = 0
                  .Columns(nColAsd_nHaberMonExt) = 0
                  
                  If .Columns(nCol_cFlgMonNac) = "1" Then   ' *** Moneda Nacional
                     
                     If tdbnPorcIGV.Value = 0 Then
                        tdbnPorcIGV.Value = fIgv()
                     End If
                     If nTotalProvDSoles + nTotalProvHSoles > 0 Then
                            If .Col = nColAsd_nDebeSoles Then
                               .Columns(nColAsd_nDebeSoles) = Redondear(nTotalProvHSoles * (tdbnPorcIGV.Value / 100) / (tdbnPorcIGV.Value / 100 + 1), 2)
                            End If
                            
                            If .Col = nColAsd_nHaberSoles Then
                               .Columns(nColAsd_nHaberSoles) = Redondear(nTotalProvDSoles * (tdbnPorcIGV.Value / 100) / (tdbnPorcIGV.Value / 100 + 1), 2)
                            End If
                     Else
                            If .Col = nColAsd_nDebeSoles Then
                               .Columns(nColAsd_nDebeSoles) = Redondear(nTotalBaseImoponibleDSoles * (tdbnPorcIGV.Value / 100), 2)
                            End If
                            
                            If .Col = nColAsd_nHaberSoles Then
                               .Columns(nColAsd_nHaberSoles) = Redondear(nTotalBaseImoponibleHSoles * (tdbnPorcIGV.Value / 100), 2)
                            End If
                     End If
                     
                     If NE(.Columns(nColAsd_nTipoCambio)) <> 0 Then
                        .Columns(nColAsd_nDebeMonExt) = Redondear(NE(.Columns(nColAsd_nDebeSoles)) / NE(.Columns(nColAsd_nTipoCambio)), 2)
                        .Columns(nColAsd_nHaberMonExt) = Redondear(NE(.Columns(nColAsd_nHaberSoles)) / NE(.Columns(nColAsd_nTipoCambio)), 2)
                     End If

                  Else ' *** Moneda Extranjera
                     
                     If nTotalProvDDolar + nTotalProvHDolar > 0 Then
                            If .Col = nColAsd_nDebeMonExt Then
                               .Columns(nColAsd_nDebeMonExt) = Redondear(nTotalProvHDolar * (tdbnPorcIGV.Value / 100) / (tdbnPorcIGV.Value / 100 + 1), 2)
                            End If
                            
                            If .Col = nColAsd_nHaberMonExt Then
                               .Columns(nColAsd_nHaberMonExt) = Redondear(nTotalProvDDolar * (tdbnPorcIGV.Value / 100) / (tdbnPorcIGV.Value / 100 + 1), 2)
                            End If
                     Else
                            If .Col = nColAsd_nDebeMonExt Then
                               .Columns(nColAsd_nDebeMonExt) = Redondear(nTotalBaseImoponibleDDolar * (tdbnPorcIGV.Value / 100), 2)
                            End If
                            
                            If .Col = nColAsd_nHaberMonExt Then
                               .Columns(nColAsd_nHaberMonExt) = Redondear(nTotalBaseImoponibleHDolar * (tdbnPorcIGV.Value / 100), 2)
                            End If
                     End If
                     
                     .Columns(nColAsd_nDebeSoles) = Redondear(NE(.Columns(nColAsd_nDebeMonExt)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
                     .Columns(nColAsd_nHaberSoles) = Redondear(NE(.Columns(nColAsd_nHaberMonExt)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
                  
                  End If
                  
                  tdbgDetalle.RefreshRow
               End If
            End If
            Call SumarTotales
    End With
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       OpcionModificar
' Description:       Procedimiento que se ejecuta si se ha modificado el voucher
'
' Parameters :       op (Boolean)
'--------------------------------------------------------------------------------
Sub OpcionModificar(op As Boolean)
    'cabecera
    tdbcLibro.Enabled = False
    
    'detalle
    Activar tdbtGlosa, op
    
    Activar tdbtTipDocRef, op
    Activar tdbtSerDocRef, op
    Activar tdbtNroDocRef, op
    Activar dtpFecDocRef, op
    
    'chkInafecto.Enabled = op
    CheckCuadraCompMan.Enabled = op
    
    Activar tdbcBaseImponible, op
    
    Activar tdbcPagoIGV, op
    Activar dtpFecDeposito, op
    Activar tdbtNroConsta, op
    
    'botones de commando
    cmdEliminaItem.Enabled = op
    cmdCancelaciones.Enabled = op
    cmdTipoAsiento.Enabled = op
    cmdGenerarDifCambio.Enabled = op
    cmdCrearEntidad.Enabled = op

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ActualizaInterface
' Description:  `    Procedimiento que activa los campos complementarios del voucher (parte inferior)
'
' Parameters :       op (Boolean)

'--------------------------------------------------------------------------------
Sub ActualizaInterface(op As Boolean)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    Activar tdbtTipDocRef, op
    Activar tdbtSerDocRef, op
    Activar tdbtNroDocRef, op
    Activar dtpFecDocRef, op
    Activar tdbtNroConsta, op
    Activar dtpFecDeposito, op
    
    If op = False Then
       tdbcPagoIGV.BoundText = ""
    Else
        
        If lArrDetalle(tdbgDetalle.Bookmark, nColPla_cDetraccion) = "1" Or lArrDetalle(tdbgDetalle.Bookmark, nColPla_cRetencion) = "1" Or lArrDetalle(tdbgDetalle.Bookmark, nColPla_cPercepcion) Then
           Activar tdbcPagoIGV, True
        Else
            Activar tdbcPagoIGV, False
        End If
    End If
    
End Sub


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenaComboTipoOperacion
' Description:       Procedimiento que llena el tipo de operacion de los tipos de cambio
'
' Parameters :       Letra (String)
'--------------------------------------------------------------------------------
Private Sub LlenaComboTipoOperacion(Letra As String)
    Dim sqlcombos As String
    
    If gintBiMoneda = 1 Then
        sqlcombos = "SELECT t.Tab_cCodigo, t.Tab_cDescripCampo FROM dbo.TABLA T " & _
                    "WHERE T.Emp_cCodigo = '" & gsEmpresa & "' AND T.Tab_cTabla = '026' AND t.Tab_cCodigo <> 'SCV'"
    Else
        
        If Letra = "N" Then  ' Si se ha seleccionado soles
    
            sqlcombos = "SELECT Tab_cCodigo, Tab_cDescripCampo FROM TABLA " & _
                        "WHERE Emp_cCodigo =  '" & gsEmpresa & "' AND Tab_cTabla = '026' AND (Tab_cCodigo  ='SCV' OR Tab_cCodigo  ='OTR'  ) ORDER BY Tab_cCodigo"
        
        Else  ' Si se ha seleccionado dolares
        
            sqlcombos = "SELECT Tab_cCodigo, Tab_cDescripCampo FROM TABLA " & _
                        "WHERE Emp_cCodigo =  '" & gsEmpresa & "' AND Tab_cTabla = '026' AND Tab_cCodigo  <>'SCV'  ORDER BY TAB_NLONGITUD"
        End If
        
    End If
    
    Call LlenarRecordSet(sqlcombos, lrsOperaTC)
    Set Me.tdbdOperaTC.DataSource = lrsOperaTC
End Sub


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       DevuelveFilaImpuesto
' Description:       Funcion que retorna la fila de la cuenta de impuesto
'
' Parameters :       nfila (Integer)
'--------------------------------------------------------------------------------
Private Function DevuelveFilaImpuesto(nfila As Integer) As Integer

    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If

    Dim i As Integer
    
    DevuelveFilaImpuesto = -1
    
    For i = 0 To lItem - 1
        If i <> nfila Then
           If lArrDetalle.Value(i, nCol_nPorceImp) = "" Then lArrDetalle.Value(i, nCol_nPorceImp) = 0
           If lArrDetalle.Value(i, nColAsd_nDebeSoles) = "" Then lArrDetalle.Value(i, nColAsd_nDebeSoles) = 0
           If lArrDetalle.Value(i, nColAsd_nHaberSoles) = "" Then lArrDetalle.Value(i, nColAsd_nHaberSoles) = 0
           If lArrDetalle.Value(i, nColAsd_nDebeMonExt) = "" Then lArrDetalle.Value(i, nColAsd_nDebeMonExt) = 0
           If lArrDetalle.Value(i, nColAsd_nHaberMonExt) = "" Then lArrDetalle.Value(i, nColAsd_nHaberMonExt) = 0
           
           If lArrDetalle.Value(i, nColAsd_nDebeSoles) = 0 And lArrDetalle.Value(i, nColAsd_nHaberSoles) = 0 And _
              lArrDetalle.Value(i, nColAsd_nDebeMonExt) = 0 And lArrDetalle.Value(i, nColAsd_nHaberMonExt) = 0 And _
              lArrDetalle.Value(i, nCol_nPorceImp) <> 0 Then
              DevuelveFilaImpuesto = i
              Exit Function
           End If
           
        End If
    Next
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaCuenta
' Description:       Funcion que busca la cuenta en el recordset de cuentas po libro
'
' Parameters :       Cuenta (String)
'                    rs (ADODB.Recordset)
'--------------------------------------------------------------------------------
Private Function BuscaCuenta(ByVal Cuenta As String, ByRef rs As ADODB.Recordset) As Boolean
    Dim Encontro As Boolean
    Encontro = False
    rs.MoveFirst
    Do While Not rs.EOF
       If CE(rs("Pla_cCuentaContable")) = CE(Cuenta) Then
            Encontro = True
            Exit Do
       End If
       rs.MoveNext
    Loop
    BuscaCuenta = Encontro
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       DevuelveFilaCpto
' Description:       Funcion que calcula el total de las bases imponibles y retorna la fila donde se encuentra
'
' Parameters :       cClave (String)
'                    nfila (Integer)
'--------------------------------------------------------------------------------
Private Function DevuelveFilaCpto(cClave As String, nfila As Integer) As Integer
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If

    Dim clDatos As New clsMantoTablas
    Dim rsArreglo As ADODB.Recordset
    Dim arrDatos() As Variant
    Dim sqlver As String
    Dim i As Integer
    Dim Cuenta As String
    
    nTotalBaseImoponibleDDolar = 0
    nTotalBaseImoponibleDSoles = 0
    nTotalBaseImoponibleHSoles = 0
    nTotalBaseImoponibleHDolar = 0
    
    nTotalProvDSoles = 0
    nTotalProvHSoles = 0
    nTotalProvDDolar = 0
    nTotalProvHDolar = 0
    
    DevuelveFilaCpto = -1
    If Len(Trim(cClave)) = 0 Then Exit Function
    
    sqlver = "spCn_ConsultaCuentasLibro 'SEL_CTAS_LIB','" & gsEmpresa & "','" & gsAnio & "','" & cClave & "',''"
    arrDatos = Array(sqlver)
    Set rsArreglo = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
    If Not rsArreglo Is Nothing Then
        '******* CALCULA EL MONTO TOTAL DE LAS CUENTAS CON AFECTO ***********
            If BuscaCuenta(CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)), rsArreglo) Then
                'For i = 0 To nFila - 1 ' nFila : Numero de la fila actual
                For i = 0 To NumeroFilas - 1 ' nFila : Numero de la fila actual
                
                    If (BuscaCuentaEnConfigOP(lArrDetalle.Value(i, nColPla_cCuentaContable), "009") = True Or _
                       BuscaCuentaEnConfigOP(lArrDetalle.Value(i, nColPla_cCuentaContable), "010") = True) And _
                       CE(lArrDetalle(i, nColAsd_cBaseImp)) = "" Then
                            
                           nTotalProvDSoles = nTotalProvDSoles + lArrDetalle.Value(i, nColAsd_nDebeSoles)
                           nTotalProvHSoles = nTotalProvHSoles + lArrDetalle.Value(i, nColAsd_nHaberSoles)
                           nTotalProvDDolar = nTotalProvDDolar + lArrDetalle.Value(i, nColAsd_nDebeMonExt)
                           nTotalProvHDolar = nTotalProvHDolar + lArrDetalle.Value(i, nColAsd_nHaberMonExt)
                           
                           Exit For
                    End If
                    
                    If NE(lArrDetalle.Value(i, nColAsd_nMontoInafecto)) <> 1 And lArrDetalle.Value(i, nColAsd_cDestino) <> "1" Then

                           nTotalBaseImoponibleDSoles = nTotalBaseImoponibleDSoles + lArrDetalle.Value(i, nColAsd_nDebeSoles)
                           nTotalBaseImoponibleHSoles = nTotalBaseImoponibleHSoles + lArrDetalle.Value(i, nColAsd_nHaberSoles)
                           nTotalBaseImoponibleDDolar = nTotalBaseImoponibleDDolar + lArrDetalle.Value(i, nColAsd_nDebeMonExt)
                           nTotalBaseImoponibleHDolar = nTotalBaseImoponibleHDolar + lArrDetalle.Value(i, nColAsd_nHaberMonExt)
                        
                        If tdbcLibro.BoundText = lsLibroCom And CE(lArrDetalle.Value(i, nColAsd_cBaseImp)) <> "" And lArrDetalle(i, nColAsd_cBaseImp) <> "017" And lArrDetalle(i, nColAsd_cBaseImp) <> "021" Then
                            lArrDetalle.Value(nfila, nColAsd_cBaseImp) = lArrDetalle.Value(i, nColAsd_cBaseImp)
                        End If
                    End If
                Next i
                DevuelveFilaCpto = i
            End If
        '********************************************************************
    End If
    Call CerrarRecordSet(rsArreglo)
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CheckCuadraCompMan_Click
' Description:       Evento que se ejecuta alhacer clic en cuadrar voucher manual
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub CheckCuadraCompMan_Click()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

'    PintaCajasTextNumerico
    If CheckCuadraCompMan.Value = vbChecked Then
        lblCalculoManual.Visible = True
    Else
        lblCalculoManual.Visible = False
    End If
    
    tdbgDetalle.Refresh
    
    pSetFocus tdbgDetalle
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       chkRegAux_MouseUp
' Description:       Evento que se ejecuta al hacer clic en el check de registros auxiliares
'
' Parameters :       Button (Integer)
'                    Shift (Integer)
'                    X (Single)
'                    Y (Single)
'--------------------------------------------------------------------------------
Private Sub chkRegAux_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)

    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cRegAux) = ChkRegAux.Value
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    
    pSetFocus tdbgDetalle
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       cmdBuscar_Click
' Description:       Evento que se ejecuta al hacer clic en el boton de buscar datos segun los campos ingresados
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub cmdBuscar_Click()
    On Error GoTo serror
    cmdBuscar.Enabled = False
    DoEvents
    
    Dim i As Integer
    Dim nIni As Integer
    Dim nFin As Integer
    Dim cCuenta As String
    Dim cTD As String
    Dim cSerie As String
    Dim cNumero As String
    Dim cEntidad As String
    
    cCuenta = ""
    cEntidad = ""
    cTD = ""
    cSerie = ""
    cNumero = ""
    
    If tdbtBusCuenta.Text <> "" Then cCuenta = UCase(tdbtBusCuenta.Text)
    If tdbtBusCodEnt.Text <> "" Then cEntidad = UCase(tdbtBusCodEnt.Text)
    If tdbtBusTD.Text <> "" Then cTD = UCase(tdbtBusTD.Text)
    If tdbtBusSerieDoc.Text <> "" Then cSerie = UCase(tdbtBusSerieDoc.Text)
    If tdbtBusNumero.Text <> "" Then cNumero = UCase(tdbtBusNumero.Text)
    
    If cCuenta & cEntidad & cTD & cSerie & cNumero = "" Then
        Mensajes "Minimo debe ingresar un dato de busqueda"
        pSetFocus tdbtBusCuenta
        Exit Sub
    End If
    
    nIni = tdbgDetalle.Bookmark + 1
    If nIni < 0 Then nIni = 0
    
    nFin = NumeroFilas
    If tdbgDetalle.Bookmark = nFin Then nIni = 0
    
    For i = nIni To nFin - 1
        If IIf(cEntidad = "", "", UCase(CE(lArrDetalle(i, nColEnt_cCodEntidad)))) = cEntidad And _
           IIf(cCuenta = "", "", UCase(CE(lArrDetalle(i, nColPla_cCuentaContable)))) = cCuenta And _
           IIf(cTD = "", "", UCase(CE(lArrDetalle(i, nColAsd_cTipoDoc)))) = cTD And _
           IIf(cSerie = "", "", UCase(CE(lArrDetalle(i, nColAsd_cSerieDoc)))) = cSerie And _
           IIf(cNumero = "", "", UCase(CE(lArrDetalle(i, nColAsd_cNumDoc)))) = cNumero Then
           
           tdbgDetalle.Bookmark = i
           tdbgDetalle.MarqueeStyle = dbgSolidCellBorder
           
           cmdBuscar.Enabled = True
           tdbgDetalle.Col = nColAsd_cNumDoc
           Exit Sub
        End If
    Next
    
    If Mensajes("No se encontraron filas con los datos de busqueda ingresada" & Salto(1) & "Desea regresar al inicio de la fila", vbYesNo + vbQuestion) = vbYes Then
        tdbgDetalle.Bookmark = 0
        tdbgDetalle.MarqueeStyle = dbgSolidCellBorder
    End If
    
    cmdBuscar.Enabled = True
    Exit Sub
serror:
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       cmdBuscarDatos_Click
' Description:       Evento que se ejecuta al hacer clic en el boton de buscar datos
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub cmdBuscarDatos_Click()
    On Error Resume Next
    fraBusqueda.Visible = True
    tdbtBusCodEnt.Text = ""
    tdbtBusCuenta.Text = ""
    tdbtBusNumero.Text = ""
    tdbtBusSerieDoc.Text = ""
    tdbtBusTD.Text = ""
    
    Activar tdbtBusTD, True
    Activar tdbtBusSerieDoc, True
    Activar tdbtBusNumero, True
    
    pSetFocus tdbtBusCuenta
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       cmdCancelaciones_Click
' Description:       Evento que se ejecuta al hacer clic en el boton de cancelaciones
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub cmdCancelaciones_Click()

    cmdCancelaciones.Enabled = False
    Screen.MousePointer = vbHourglass
    DoEvents
    
    Dim Cuenta As String, Entidad As String, Serie As String, Numero As String, TipoEntidad As String
    
    Cuenta = CE(tdbgDetalle.Columns(nColPla_cCuentaContable))
    Entidad = CE(tdbgDetalle.Columns(nColEnt_cCodEntidad))
    Serie = CE(tdbgDetalle.Columns(nColAsd_cSerieDoc))
    Numero = CE(tdbgDetalle.Columns(nColAsd_cNumDoc))
    
    lsCfgCtasCance = ""
    
    Dim cLibroCaja As String
    cLibroCaja = ""
    
    If lsLibroCajEgr = lsLibroCajIng Then cLibroCaja = lsLibroCajEgr
    
    If tdbcLibro.BoundText = lsLibroVen Or (tdbcTipoOperacion.BoundText = "I") Then
       lsCfgCtasCance = "009"
    ElseIf tdbcLibro.BoundText = lsLibroCom Or (tdbcTipoOperacion.BoundText = "E") Then
       lsCfgCtasCance = "010"
    ElseIf tdbcTipoOperacion.BoundText = "M" Then
       lsCfgCtasCance = "MIX"
    End If
    
    If (tdbcLibro.BoundText = lsLibroCajIng Or tdbcLibro.BoundText = lsLibroCajEgr) And cLibroCaja = "" Then
       lsCfgCtasCance = "MIX"
    End If
    
    If lsCfgCtasCance = "" Then
    lsCfgCtasCance = "MIX"
    End If
    
    Dim rstTipoEntidad As ADODB.Recordset
    
    Set rstTipoEntidad = New ADODB.Recordset
    
    If Cuenta <> "" Then
     ConectarAdvance
'     a = "SELECT IsNUll(Ten_cTipoEntidad,'') FROM CNM_PLAN_CTA WHERE Emp_cCodigo = '" & gsEmpresa & "' AND Pan_cAnio = '" & gsAnio & "'" & _
'                  " AND Pla_cCuentaContable = '" & Cuenta & "'"
                  
      rstTipoEntidad.Open "SELECT IsNUll(Ten_cTipoEntidad,'') FROM CNM_PLAN_CTA WHERE Emp_cCodigo = '" & gsEmpresa & "' AND Pan_cAnio = '" & gsAnio & "'" & _
                  " AND Pla_cCuentaContable = '" & Cuenta & "'", gcnSistemaAdv, adOpenDynamic, adLockOptimistic
      If rstTipoEntidad.State <> 0 Then TipoEntidad = rstTipoEntidad.Fields(0)
     Desconectar
    
     Set rstTipoEntidad = Nothing
    End If
    
    If lsCfgCtasCance <> "" Then
        cmdCancelaciones.Enabled = False
        Call LlamaBuscar(frmBusProvisiones, "Provisiones", lControl, "Provisiones", Me, tdbcMes.BoundText, lsCfgCtasCance, Cuenta, Entidad, Serie, Numero, , , TipoEntidad)
    Else
        Mensajes "Seleccione una operación de Cuenta Corriente", vbInformation
        Screen.MousePointer = vbNormal
        pSetFocus tdbcTipoOperacion
    End If
    ' ***
    cmdCancelaciones.Enabled = True
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       cmdCancelarBusqueda_Click
' Description:       Evento que se ejecuta al hacer clic en el boton para ocultar frame de busqueda
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub cmdCancelarBusqueda_Click()
    fraBusqueda.Visible = False
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       cmdChequeVoucher_Click
' Description:       Evento que se ejecuta al hacer clic en el boton para imprimir el voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub cmdChequeVoucher_Click()
    Me.Enabled = False
    
    frmRepChequeVoucher.Show
    frmRepChequeVoucher.tdbcMes.BoundText = Me.tdbcMes.BoundText
    frmRepChequeVoucher.tdbcLibro.BoundText = Me.tdbgAsientos.Columns(4).Value
    frmRepChequeVoucher.tdbtVoucherIni = CE(Me.tdbgAsientos.Columns(6).Value)
    frmRepChequeVoucher.tdbtVoucherFin = CE(Me.tdbgAsientos.Columns(6).Value)
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       cmdCrearEntidad_Click
' Description:       Evento que se ejecuta al hacer clic en el boton de crear entidades
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub cmdCrearEntidad_Click()
    ' *** Llamar al formulario de entidad; para registrarlo
    Dim Valor As String
    cmdCrearEntidad.Enabled = False
    DoEvents
    Screen.MousePointer = vbHourglass
    
    If tdbgDetalle.Splits(0).Locked = False Then
        If tdbgDetalle.Col = nColEnt_cCodEntidad And tdbgDetalle.Columns(nColAsd_nItem).Value <> "" Then
            Valor = tdbgDetalle.Columns(nColTen_cTipoEntidad).Value
            
            Me.Enabled = False
            frmManEntidades.Show
            frmManEntidades.asiento = True
            frmManEntidades.ManNuevo
            pSetFocus frmManEntidades

            DoEvents
            
            frmManEntidades.LlenaCombosTipoPerDocu
            
            DoEvents

        Else
            If tdbgDetalle.Columns(nColAsd_nItem).Value = "" Then Mensajes "Primero ingrese los datos de la fila seleccionada", vbOKOnly + vbInformation
            If tdbgDetalle.Col <> nColEnt_cCodEntidad Then Mensajes "Haga clic con el cursor del mouse en la celda de entidad"
        End If
    End If
    Screen.MousePointer = vbNormal
    cmdCrearEntidad.Enabled = True
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       cmdEliminaItem_Click
' Description:       Evento que se ejecuta al hacer clic en el boton de eliminar fila del detalle
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub cmdEliminaItem_Click()
    Dim iFilas As Integer
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    Dim Result As Long, i As Integer
    cmdEliminaItem.Enabled = False
    DoEvents
    With tdbgDetalle
         If .Columns(nColAsd_cDestino) = "1" Or lnOpcion = 2 Then
            UpdateGrilla
            
            Mensajes "No se puede eliminar un registro automatico...", vbInformation
            RefreshGrilla
            cmdEliminaItem.Enabled = True
            Exit Sub
         End If
         
         If lArrDetalle(tdbgDetalle.Bookmark, nColAsd_Cancelado) = "1" Or lnOpcion = 2 Then
            UpdateGrilla
            
            Mensajes "No se puede eliminar una provision que tiene cancelaciones...", vbInformation
            RefreshGrilla
            cmdEliminaItem.Enabled = True
            Exit Sub
         End If
         
         If lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cRegAuxDet) = "1" Or lnOpcion = 2 Then
            UpdateGrilla
            
            Mensajes "No se puede eliminar una provision que tiene registros auxiliares...", vbInformation
            RefreshGrilla
            cmdEliminaItem.Enabled = True
            Exit Sub
         End If
                  
         If CE(.Columns(nColAsd_nItem)) <> "" Or _
            CE(.Columns(nColAsd_dFecDoc)) <> "" Or _
            CE(.Columns(nColAsd_cOperaTC)) <> "" Or _
            CE(.Columns(nColPla_cCuentaContable)) <> "" Or _
            CE(.Columns(nColAsd_nTipoCambio)) <> "" Then
    
    '------------------------------------------
    '  AGREGA FILAS EN TEMPORAL
                If lnOpcion = 1 Then
                    i = NumeroFilasEliminadas
    
                    If i >= NUM_FILAS_ELIM Then
                        UpdateGrilla
    
                        Mensajes "El Buffer de eliminacion está lleno" & Salto(1) & "Para seguir eliminando primero grabe el voucher", vbInformation
    
                        cmdEliminaItem.Enabled = True
                        Exit Sub
                    End If
                   AgregaFilaEliminada .Bookmark
                End If
    '------------------------------------------
            
            .Columns(nColAsd_dFecDoc) = ""
            .Columns(nColCos_cCodigo) = ""
            .Columns(nColAsd_nTipoCambio) = ""
            .Columns(nColAsd_cOperaTC) = ""
            .Columns(nColAsd_cNomMoneda) = ""

            UpdateGrilla

            'If CE(.Columns(nColAsd_nItem)) <> "" Then
               gsEliminoFila = False
               EliminaFilaDetalle 1
               tdbgDetalle.ScrollBars = dbgBoth
            'End If
            
            .Col = nColPla_cCuentaContable
            .HighlightRowStyle = ""
            On Error Resume Next
            .SelBookmarks.Remove 0
            
            tdbgDetalle.RefreshRow
            
            Call SumarTotales
            DoEvents
            iFilas = NumeroFilas
            .Bookmark = iFilas
            
            If iFilas = 0 Then iFilas = 1
            lItem = iFilas
            
            On Error Resume Next
            For i = 0 To lItem
                If CE(lArrDetalle(i, nColPla_cCuentaContable)) = "" Then
                   lArrDetalle(i, nColAsd_cGuardado) = ""
                End If
            Next i
            
            .Col = nColPla_cCuentaContable
            
            pSetFocus tdbgDetalle
            
            gsUltimaCuenta = ""
            gsUltimoCC = ""
            gsUltimaEnt = ""
            gsUltimoTD = ""
            
         Else
            UpdateGrilla
            Mensajes "Seleccione correctamente la fila que desea borrar...", vbInformation
         End If
    End With

    cmdEliminaItem.Enabled = True
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       AgregaFilaEliminada
' Description:       Procedimiento que agrega la fila eliminada que se almacena en el temporal
'
' Parameters :       Fila (Integer)
'--------------------------------------------------------------------------------
Private Sub AgregaFilaEliminada(Fila As Integer)
    If lArrDetalleElim Is Nothing Then
        Exit Sub
    End If

    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    Dim i As Integer
    Dim FilaElim As Integer
    
    FilaElim = NumeroFilasEliminadas
    
    For i = 0 To NUM_COLUMNAS - 1
        lArrDetalleElim(FilaElim, i) = lArrDetalle(Fila, i)
    Next i
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       cmdEliminarVouchers_Click
' Description:       Evento que se ejecuta al hacer clic en el boton deeliminar vouchers
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub cmdEliminarVouchers_Click()

    If CierreMes(NE(tdbgAsientos.Columns(2).Value), tdbcLibroCab.BoundText) = True Then
        Mensajes "Mes cerrado: No se puede eliminar los vouchers"
        Exit Sub
    End If
        
    Me.Enabled = False
    
    frmEliminarVoucher.Show
    frmEliminarVoucher.tdbcMes.BoundText = Me.tdbcMes.BoundText
    frmEliminarVoucher.tdbcLibro.BoundText = Me.tdbgAsientos.Columns(4).Value
    frmEliminarVoucher.tdbtVoucherIni = ""
    frmEliminarVoucher.tdbtVoucherFin = ""
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       cmdGenerarDifCambio_Click
' Description:       Evento que se ejecuta al hacer clic en el boton de generacion de diferencia decambio
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub cmdGenerarDifCambio_Click()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    If tdbnDiferenciaME.Value = 0 And tdbnDiferenciaMN.Value = 0 Then
        'Mensajes "No hay diferencia de cambio"
        Exit Sub
    End If

'    If tdbnDiferenciaME.Value = 0 And tdbnDiferenciaMN.Value <> 0 Then
'
'    Else
'        'Mensajes "No hay diferencia de cambio"
'        Exit Sub
'    End If

    cmdGenerarDifCambio.Enabled = False
    DoEvents
    lItem = NumeroFilas
    
    Dim i As Integer
    
    For i = 0 To lItem - 1
        If lArrDetalle(i, nColAsd_cMonedaCalculo) = 1 Then
            Mensajes "Ya se genero automaticamente una cuenta de diferencia de cambio " & Salto(1) & "Elimínela y vuelva a verificar", vbOKOnly + vbInformation
            cmdGenerarDifCambio.Enabled = True
            Exit Sub
        End If
    Next
    
    'tdbgDetalle.Bookmark = lItem
    'DoEvents
    
    If lItem > 0 Then
        ' *** Convertir los montos a su moneda original
        If Not VerificandoTipoCambio Then
            cmdGenerarDifCambio.Enabled = True
            Exit Sub
        End If
        Call SumarTotales
        
        'Validando el cuadre de las columnas por la moneda del voucher
        ' Si es Moneda Nacional el voucher, en el detalle se valida el total en MN
        If tdbcMoneda.Columns(2) = "1" Then
           If tdbgDetalle.Columns(nColAsd_nDebeSoles).FooterText <> tdbgDetalle.Columns(nColAsd_nHaberSoles).FooterText Then
              UpdateGrilla
                
              Mensajes "El debe y el haber no cuadra. Verificar...", vbInformation
              cmdGenerarDifCambio.Enabled = True
              Exit Sub
           End If
        Else
           If tdbgDetalle.Columns(nColAsd_nDebeMonExt).FooterText <> tdbgDetalle.Columns(nColAsd_nHaberMonExt).FooterText Then
              UpdateGrilla
           
              Mensajes "El debe y el haber no cuadra. Verificar...", vbInformation
              
              RefreshGrilla
              pSetFocus tdbgDetalle
              cmdGenerarDifCambio.Enabled = True
              Exit Sub
           End If
        End If
        
        ' *** Verificar q cuadre el debe con el haber
        If (tdbgDetalle.Columns(nColAsd_nDebeSoles).FooterText <> tdbgDetalle.Columns(nColAsd_nHaberSoles).FooterText) Or _
           (tdbgDetalle.Columns(nColAsd_nDebeMonExt).FooterText <> tdbgDetalle.Columns(nColAsd_nHaberMonExt).FooterText) Then
            
            'Call GeneraRedondeo
            Call GenerarDifCambio
            DoEvents
            tdbgDetalle.Bookmark = NumeroFilas
            Call SumarTotales
            
            RefreshGrilla
            DoEvents
            
            RefreshGrilla
            pSetFocus tdbgDetalle
        End If
    End If
    cmdGenerarDifCambio.Enabled = True
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ListarDetalle
' Description:       Procedimiento de listado o refresh deldetalle del voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Public Sub ListarDetalle()
    Call cmdListar_Click
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       cmdListar_Click
' Description:       Evento que se ejecuta al hacer clic en el boton listar o refresh deldetalle del voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub cmdListar_Click()
    tdbcMes_ItemChange
    FiltrarRecordSet
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       cmdMostrar_Click
' Description:       Evento que se ejecuta al hacer clic en el boton refresh segun las fechas ingresadas
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub cmdMostrar_Click()
    If Format(dtpDesde, "yyyyMMdd") > Format(dtpHasta, "yyyyMMdd") Then
        MsgBox "La fecha Desde debe ser menor a la fecha Hasta", vbInformation + vbOKOnly, "Aviso..."
        Exit Sub
    Else
        If chkDesde.Value = 1 Then Call CargaTabla("fechas")
        FiltrarRecordSet
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       cmdRepetirGlosa_Click
' Description:       Evento que se ejecuta al hacer clic en el boton replicar glosa
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub cmdRepetirGlosa_Click()
    Dim Filas As Integer
    Filas = NumeroFilas
    If Filas > 0 Then
        If MsgBox("Desea actualizar todas las glosas del detalle", vbQuestion + vbYesNo) = vbYes Then
            gsUltimaGlosa = tdbtObservaciones
            ActualizaGlosas Filas
        End If
    End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       cmdTipoAsiento_Click
' Description:       Evento que se ejecuta al hacer clci en el boton asiento tipo
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub cmdTipoAsiento_Click()
    ' *** Abre un formulario de ayuda para jalar datos de las provisiones pendientes
    cmdTipoAsiento.Enabled = False
    Screen.MousePointer = vbHourglass
    DoEvents
    If ExisteTipoAsi(Me.tdbcLibro.BoundText) = True Then
       'UpdateGrilla
       tdbgDetalle.RefreshRow
       Set frmBusTipoAsiento.VarRst = lrsDocBolVta
       
       Call LlamaBuscar(frmBusTipoAsiento, "TipoAsiento", lControl, Me.tdbcLibro.BoundText, _
       Me, tdbcMes.BoundText, lsTipOperaLib, , , , , , Format(dtpFecha.Value, "dd/MM/yyyy"), , _
       IIf(Me.tdbcLibro.BoundText = lsLibroCom, True, False))
       
       On Error Resume Next
       frmBusTipoAsiento.dtpFecha.MinDate = "01/01/1000"
       frmBusTipoAsiento.dtpFecha.MaxDate = "31/12/2500"
       Dim Mes As String
       Mes = gsPeriodo
       If Mes = "00" Then Mes = "01"
       If Mes > "12" Then Mes = "12"
       
'       frmBusTipoAsiento.dtpFecha = dtpFecha
'       frmBusTipoAsiento.dtpFecha.MinDate = "01/01/" & gsAnio
'       frmBusTipoAsiento.dtpFecha.MaxDate = UltimoDiaMes(Mes, gsAnio)
       frmBusTipoAsiento.tdbtGlosa = tdbtObservaciones
       
       If tdbcMoneda.BoundText <> gsMonedaNac Then
          frmBusTipoAsiento.fraTC.Visible = True
          frmBusTipoAsiento.fraAsientoTipo.Height = 6600
          frmBusTipoAsiento.cmdSalir.Top = 6000
          frmBusTipoAsiento.cmdInsertar.Top = 6000
          frmBusTipoAsiento.cmdCrearEntidad.Top = 6000
          frmBusTipoAsiento.Height = 6900
       Else
          frmBusTipoAsiento.fraTC.Visible = False
          frmBusTipoAsiento.fraAsientoTipo.Height = 5500
          frmBusTipoAsiento.cmdInsertar.Top = 5000
          frmBusTipoAsiento.cmdCrearEntidad.Top = 5000
          frmBusTipoAsiento.cmdSalir.Top = 5000
          frmBusTipoAsiento.Height = 5800
          
       End If
       
       Call frmBusTipoAsiento.CargaTC
       
    Else
       Mensajes "No existe asientos predefinidos para este tipo de libro", vbInformation
    End If
    ' ***
    cmdTipoAsiento.Enabled = True
    Screen.MousePointer = vbNormal
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Command1_Click
' Description:       Evento que se ejecuta al cambiar el periodo
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub Command1_Click()
    tdbcMes_ItemChange
    FiltrarRecordSet
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       cmdCambioLibro_Click
' Description:       Evento que se ejecuta al presionar el boton de cambio de libro
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub cmdCambioLibro_Click()
    'Frame3.Top = 2880
    'Frame3.Left = 1800
    If CierreMes(CE(tdbgAsientos.Columns(2).Value), tdbcLibroCab.BoundText) = True Then
        Mensajes "Mes cerrado: No se puede cambiar de libro"
        Exit Sub
    End If
    
    Text1.Text = CE(tdbgAsientos.Columns(5).Value)
    Text2.Text = CE(tdbgAsientos.Columns(6).Value)
    
    Text3.Text = ""
    'Text1.Enabled = False
    'Text2.Enabled = False
    sstAsientos.Enabled = False
    Frame3.Visible = True
    pSetFocus tdbcLibro_cambio
    
    On Error Resume Next
    Dim sqlcombos As String
    
    '----------------------------------------------------------------------
    ' llenando combo de Libros DE CAMBIO DE LIBRO
    sqlcombos = "spSg_GrabaUsuarios 'SEL_ALL_EMP_LIBCAM', '" & gsUsuario & "', '', '', '', '', '', '" & gsEmpresa & "','','" & gsSOFT & "','" & gsAnio & "',''"
    
    LlenarComboAddItem tdbcLibro_cambio, sqlcombos
        
    DoEvents
    tdbcLibro_cambio.BoundText = "" 'tdbcLibroCab.BoundText
    tdbcLibro_cambio.ReBind
    DoEvents
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Command2_Click
' Description:       Evento que se ejecuta al hacer clic en el boton CO para actualizar el estado modificado al detalle (Desabilitado)
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub Command2_Click()
 Dim i As Integer
 For i = 0 To NUM_FILAS
 
    lArrDetalle(i, nColAsd_cModif) = 1
 Next i
 
 Mensajes "Terminado", vbOKOnly + vbInformation
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ValidaCampos
' Description:       Funcion de validacion de la cabecera del voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function ValidaCampos() As Boolean
    ValidaCampos = False
    If CE(Text1.Text) = "" Then Mensajes "Seleccione el tipo de libro inicial": pSetFocus Text1: Exit Function
    If CE(Text2.Text) = "" Then Mensajes "Ingrese el numero de voucher inicial a cambiar": pSetFocus Text2: Exit Function
    If CE(tdbcLibro_cambio.Text) = "" Then Mensajes "Seleccione el nuevo tipo de libro a cambiar": pSetFocus tdbcLibro_cambio: Exit Function
    If CE(Text3.Text) = "" Then Mensajes "Ingrese el nuevo numero de voucher a cambiar": pSetFocus Text3: Exit Function
    If Len(Text3.Text) < 10 Then Mensajes "Debe llenar los 10 digitos del correlativo del voucher": pSetFocus Text3: Exit Function
    If IsNumeric(CE(Text3.Text)) = False Then Mensajes "El numero de voucher debe ser numerico": pSetFocus Text3: Exit Function
    
    Dim cLibro As String
    cLibro = Left(CE(Text3.Text), 2)
   
    If cLibro <> tdbcLibro_cambio.BoundText Then Mensajes "Los dos primeros digitos del correlativo debe ser " & tdbcLibro_cambio.BoundText & Salto(1) & " por ser codigo del libro seleccionado": pSetFocus Text3: Exit Function
    
    Dim cMes As String
    cMes = CE(Mid(Text3.Text, 3, 2))
    If cLibro = lsLibroApe And cMes <> "00" Then Mensajes "El mes (Tercer y cuarto digito) debe ser 00 por ser un libro de apertura": pSetFocus Text3: Exit Function
    If cLibro <> lsLibroApe And Not (cMes >= "01" And cMes <= "14") Then Mensajes "El tercer y el cuarto dígito del correlativo es el mes, digite uno valido" & Salto(1) & "Ejemplo: 01 (Enero) , 02 (Febrero) ..., 12 (Diciembre)": pSetFocus Text3: Exit Function
        
    ValidaCampos = True
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Command3_Click
' Description:       Evento que se ejecuta al boton deaceptar cambio de libro
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub Command3_Click()
    If ValidaCampos = False Then Exit Sub
    If ExisteVoucher(Text3.Text) = True Then Exit Sub
        
    Command3.Enabled = False
    DoEvents
    
    If MsgBox("Esta seguro que desea cambiar:" & Salto(1) & "Del Libro " & Text1.Text & " - " & Text2.Text & Salto(1) & "Al  Libro " & tdbcLibro_cambio.Text & " - " & Text3.Text & "", vbQuestion + vbYesNo) = vbYes Then
        Dim cn As ADODB.Connection
        Dim cMes As String
        
        Set cn = New ADODB.Connection
        cn.ConnectionString = gsCadenaConexion
        cn.Open
        
            cMes = Mid(Text3.Text, 3, 2)
            
            cn.Execute ("Update CNC_ASIENTO_VOUCHER SET per_cperiodo='" & cMes & "', Lib_cTipoLibro = '" & tdbcLibro_cambio.BoundText & "', Ase_nVoucher = '" & Text3.Text & "'" _
            + " WHERE     (Ase_cDeleted <> '*') AND (Ase_nVoucher = '" & Text2.Text & "') AND (Ase_cNummov = '" & tdbgAsientos.Columns(0).Value & "')")
            
            cn.Execute ("Update CND_ASIENTO_VOUCHER SET per_cperiodo='" & cMes & "', Lib_cTipoLibro = '" & tdbcLibro_cambio.BoundText & "', Ase_nVoucher = '" & Text3.Text & "'" _
            + " WHERE     (Asd_cDeleted <> '*') AND (Ase_nVoucher = '" & Text2.Text & "') AND (Ase_cNummov = '" & tdbgAsientos.Columns(0).Value & "')")
            
            cn.Execute ("Update CND_ASIENTO_PROV SET per_cperiodo='" & cMes & "', Lib_cTipoLibro = '" & tdbcLibro_cambio.BoundText & "', Ase_nVoucher = '" & Text3.Text & "'" _
            + " WHERE     (Ase_nVoucher = '" & Text2.Text & "') AND (Ase_cNummov = '" & tdbgAsientos.Columns(0).Value & "')")
            Call CargaTabla("periodo")
        cn.Close
        Set cn = Nothing
        
        sstAsientos.Enabled = True
        Frame3.Visible = False
    End If

    Command3.Enabled = True
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ExisteVoucher
' Description:       Funcion de validacion de existencia de codigo devoucher
'
' Parameters :       cVoucher (String)
'--------------------------------------------------------------------------------
Private Function ExisteVoucher(cVoucher As String) As Boolean
    On Error GoTo serror
    
    Dim Resultado As String
    Dim sql As String
    Resultado = ""
   
   sql = "SELECT per_cperiodo " & _
   "FROM cnd_asiento_voucher WITH(READUNCOMMITTED) " & _
   "WHERE emp_ccodigo = '" & gsEmpresa & "' and Pan_cAnio = '" & gsAnio & "' AND Per_cPeriodo = '" & gsPeriodo & "' AND Lib_cTipoLibro = '" & _
   Trim(tdbcLibro_cambio.BoundText) & "' AND ase_nvoucher='" & cVoucher & "' and asd_cdeleted<>'*'"

    Resultado = fRetornaValor(sql)
    
    If Resultado = "" Then
        ExisteVoucher = False
    Else
        ExisteVoucher = True
        Mensajes "No se puede cambiar de libro, el voucher con correlativo " & cVoucher & " ya existe en el mes de " & NombreMes(Resultado)
    End If
        
    Exit Function
serror:
    ExisteVoucher = True
    
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Command4_Click
' Description:       Evento que se ejecuta al hacer clic en el boton cancelar cambio de libro
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub Command4_Click()
    sstAsientos.Enabled = True
    Frame3.Visible = False
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       dtpFecDeposito_GotFocus
' Description:       Evento que se ejecuta al recibir el enfoque en la fecha de deposito
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub dtpFecDeposito_GotFocus()
    pVerificaIngCuenta
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       dtpFecDeposito_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en la fecha del deposito
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub dtpFecDeposito_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyF4 Then
        KeyCode = 0
        Exit Sub
    End If
    
    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then
       KeyCode = 0
    End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       dtpFecDeposito_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en la fecha del deposito
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub dtpFecDeposito_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Or KeyAscii = vbKeyTab Then
        pSaltoColGrid dtpFecDeposito.TabIndex
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       dtpFecDeposito_LostFocus
' Description:       Evento que se ejecuta al salir del enfoque de la fecha del deposito
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub dtpFecDeposito_LostFocus()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_dFechaSpot) = dtpFecDeposito.Value
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    fechaDepo = IIf(IsNull(dtpFecDeposito.Value), "__/__/____", dtpFecDeposito.Value)
    tdbgDetalle.RefreshRow
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       dtpFecDeposito_Validate
' Description:       Evento que se ejecuta al validar la fecha de deposito
'
' Parameters :       Cancel (Boolean)
'--------------------------------------------------------------------------------
Private Sub dtpFecDeposito_Validate(Cancel As Boolean)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_dFechaSpot) = dtpFecDeposito.Value
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    
    tdbgDetalle.RefreshRow
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       dtpFecDocRef_GotFocus
' Description:       Evento que se ejecuta al recibir el enfoque en la fecha dedocumento de referencia
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub dtpFecDocRef_GotFocus()
    pVerificaIngCuenta
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       dtpFecDocRef_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en la fecha de deposito de referencia
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub dtpFecDocRef_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyF4 Then
        KeyCode = 0
        Exit Sub
    End If
    
    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then
       KeyCode = 0
    End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       dtpFecDocRef_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en la fecha de documento de referencia
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub dtpFecDocRef_KeyPress(KeyAscii As Integer)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    If KeyAscii = 13 Or KeyAscii = vbKeyTab Then
        
        lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_dFecDocRef) = dtpFecDocRef.Value
        lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
     
        tdbgDetalle.RefreshRow
        
        If tdbtMonedaAdic.Enabled And tdbcLibro.BoundText = lsLibroVen Then
            tdbtMonedaAdic.SetFocus
        Else
            tdbgDetalle.SetFocus
        End If
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       dtpFecDocRef_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque en la fecha de documento referencia
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub dtpFecDocRef_LostFocus()
Dim fecdoc As Date

fecdoc = IIf(tdbgDetalle.Columns(nColAsd_dFecDoc) = "", tdbgDetalle.Columns(nColAsd_dFecDoc) = "__/__/____", Format(tdbgDetalle.Columns(nColAsd_dFecDoc), "DD/MM/YYYY"))
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    If dtpFecDocRef.Value > fecdoc And tdbtTipDocRef.Text <> "50" Then
        Mensajes "¡La fecha del documento de referencia no puede ser mayor a la fecha del documento origen!", vbExclamation
        dtpFecDocRef.Value = Null
        dtpFecDocRef.SetFocus
        Exit Sub
    End If

    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_dFecDocRef) = dtpFecDocRef.Value
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    fechDocRef = IIf(IsNull(dtpFecDocRef.Value), "__/__/____", dtpFecDocRef.Value)
    tdbgDetalle.RefreshRow
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       VerificaProvCanc
' Description:       Funcion que verifica si es una Provision o Cancelacion
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function VerificaProvCanc() As Boolean
    On Error GoTo serror
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        VerificaProvCanc = False
        Exit Function
    End If
    
    Dim i As Integer
    Dim entro As Boolean
    
    entro = False
    Dim iFila As Integer
    iFila = NumeroFilas
    
    For i = 0 To iFila - 1
        If CE(lArrDetalle(i, nColAsd_cProvCanc)) <> "P" And CE(lArrDetalle(i, nColAsd_cBaseImp)) = "" And CE(lArrDetalle(i, nCol_cFlgProv)) = "1" And CE(lArrDetalle(i, nColPla_cDocumento)) = "1" And CE(lArrDetalle(i, nCol_cTipoEntiCta)) <> "" Then
            lArrDetalle(i, nColAsd_cProvCanc) = "P"
            lArrDetalle(i, nColAsd_cModif) = 1
            entro = True
            Exit For
        End If
    Next i

    VerificaProvCanc = entro
    Exit Function
serror:
    VerificaProvCanc = False
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ValidaFechaVoucher
' Description:       Funcion que valida la fecha del voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function ValidaFechaVoucher() As Boolean
        
        Dim Mes As String
        
        If IsNull(dtpFecha.Value) Or CE(dtpFecha.Value) = "" Then
           UpdateGrilla
           Mensajes "Ingrese la fecha del voucher", vbInformation
           dtpFecha.Value = ""
           pSetFocus dtpFecha
           ValidaFechaVoucher = False
           Exit Function
        End If
        
        If IsDate(dtpFecha.Value) = False Then
            
            UpdateGrilla
            Mensajes "La fecha del voucher no es valida", vbOKOnly + vbInformation
            dtpFecha.Value = ""
            pSetFocus dtpFecha
            ValidaFechaVoucher = False
            Exit Function
        End If
        
        Mes = Right("00" & Month(dtpFecha.Value), 2)
        
'        If gsPeriodo = "00" And Mes > "01" Then
'            UpdateGrilla
'
'            Mensajes "El mes ingresado no pertenece al periodo actual del sistema, " & NombreMes(tdbcMes.BoundText), vbOKOnly + vbInformation
'            dtpFecha.Value = ""
'            pSetFocus dtpFecha
'            ValidaFechaVoucher = False
'            Exit Function
'        End If
        

        
        If tdbcMes.BoundText > "00" And tdbcMes.BoundText < "13" And Mes <> tdbcMes.BoundText Then
            UpdateGrilla
            
            Mensajes "El mes ingresado no pertenece al periodo actual del sistema, " & NombreMes(tdbcMes.BoundText), vbOKOnly + vbInformation
            dtpFecha.Value = ""
            pSetFocus dtpFecha
            ValidaFechaVoucher = False
            Exit Function
        End If
            
        
        If Year(dtpFecha) <> gsAnio Then
            UpdateGrilla
            
            Mensajes "Fecha seleccionada no corresponde al año de trabajo", vbInformation
            dtpFecha.Value = ""
            pSetFocus dtpFecha
            ValidaFechaVoucher = False
            Exit Function
        End If
        
        ValidaFechaVoucher = True
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       dtpFecDocRef_Validate
' Description:       Evento que se ejecuta al validar la fecha de documento de referencia
'
' Parameters :       Cancel (Boolean)
'--------------------------------------------------------------------------------
Private Sub dtpFecDocRef_Validate(Cancel As Boolean)

    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
        
        lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_dFecDocRef) = dtpFecDocRef.Value
        lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
        
        tdbgDetalle.RefreshRow
    
        pSaltoColGrid dtpFecDocRef.TabIndex

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       dtpFecha_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en la fecha del voucher
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub dtpFecha_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyF4 Then
        KeyCode = 0
        Exit Sub
    End If
    
    If KeyCode = vbKeyDown Or KeyCode = vbKeyUp Then
        KeyCode = 0
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       dtpFecha_KeyPress
' Description:       Evento que se ejecuta al presioar una teclaen la fecha del voucher
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub dtpFecha_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Then
        pSendKeys "{TAB}"
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       dtpFecha_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque en la fecha del voucher
'
' Parameters :
'--------------------------------------------------------------------------------

Private Sub dtpFecha_LostFocus()

    If ValidaFechaVoucher = False Then
        pSetFocus dtpFecha
        Exit Sub
    End If
    
    gsKeyCodePress = False
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CargaTabla
' Description:       Procedimiento que llena la lista de vouchers en un mes seleccionado
'
' Parameters :       Tipo (String)
'--------------------------------------------------------------------------------
Private Sub CargaTabla(Tipo As String)
    Dim sqlSp As String
    Dim clDatos As clsMantoTablas
    Dim arrDatos() As Variant
    
    Set clDatos = New clsMantoTablas
    
    On Error Resume Next
    
    If Not lrsAsientos Is Nothing Then
        If lrsAsientos.State = 1 Then lrsAsientos.Close
        Set lrsAsientos.DataSource = Nothing
    End If
    
    Set lrsAsientos = Nothing
    
    tdbgAsientos.DataSource = lrsAsientos
    tdbgAsientos.ReBind
    
    If Tipo = "fechas" Then
       sqlSp = "spCn_ConsultaAsientos 'SEL_ALLCAB', '', '" & gsEmpresa & _
               "', '" & gsAnio & "', '', '" & tdbcLibroCab.BoundText & "', '', '" & dtpDesde & "', '" & dtpHasta & "', '', ''"
    Else
       sqlSp = "spCn_ConsultaAsientos 'SEL_ALLCABPER', '', '" & gsEmpresa & _
               "', '" & gsAnio & "', '" & tdbcMes.BoundText & "', '" & tdbcLibroCab.BoundText & "', '', '" & dtpDesde & "', '" & dtpHasta & "', '', ''"
    End If
    arrDatos = Array(sqlSp)
    
    'CerrarRecordSet (lrsAsientos)
    Set lrsAsientos = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
    If Not lrsAsientos Is Nothing Then
       If Not (lrsAsientos.BOF And lrsAsientos.EOF) Then
        lrsAsientos.Sort = "Per_cPeriodo, Lib_cTipoLibro, Ase_nVoucher"
        tdbgAsientos.DataSource = lrsAsientos
        tdbgAsientos.ReBind

       End If
    End If
    
    Set clDatos = Nothing
End Sub

Private Sub dtpFechaDoc_Change()
    Dim i As Integer
    i = 0
End Sub

Private Sub dtpFechaDoc_CloseUp(Cancel As Boolean, Value As Date, Escape As Boolean)
    Dim i As Boolean
    i = Cancel
End Sub

Private Sub dtpFechaDoc_DropOpen(NoDefault As Boolean)
    Dim i As Integer
    i = 0
End Sub

Private Sub dtpFechaDoc_InvalidValue(Restore As Boolean)
    Dim i As Integer
    i = 0
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       dtpFechaDoc_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en la fecha del documento
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------

Private Sub dtpFechaDoc_KeyDown(KeyCode As Integer, Shift As Integer)
    gsFlagKeydownDet = False
    
    If KeyCode = vbKeyDown Or KeyCode = vbKeyUp Then
        KeyCode = 0
    End If
    
End Sub

Private Sub dtpFechaDoc_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Then
        pSetFocus tdbgDetalle
        Call UpdateGrilla
        tdbgDetalle.EditActive = True
    End If
End Sub

Private Sub dtpFechaDoc_Validate(Cancel As Boolean)
    Dim i As Boolean
    i = Cancel
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Form_Activate
' Description:       Evento que se ejecuta al activarse el formulario
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub Form_Activate()
    Dim Mes As String
    tdbgDetalle.MarqueeStyle = dbgSolidCellBorder
      
'      If gintBiMoneda = 1 Then tdbgDetalle.EditActive = True
      
      If Activado Then Exit Sub
      tdbgAsientos.Columns(12).Visible = False
      tdbgAsientos.Columns(2).Alignment = dbgCenter
      tdbgAsientos.Columns(3).Alignment = dbgCenter
      tdbgAsientos.Columns(4).Alignment = dbgCenter
      tdbgAsientos.Columns(12).Alignment = dbgCenter
      
      If Len(Trim(gsPeriodo)) = 0 Then
          tdbcMes.BoundText = Format(Month(Date), "00")
          sw = False
      Else
          Mes = gsPeriodo
          If Mes = "00" Then Mes = "01"
          If Mes > "12" Then Mes = "12"
          
          tdbcMes.BoundText = Mes
          ConfigurarControlFecha
              
          If Mes <> "00" Then
             dtpHasta = UltimoDiaMes(Mes, gsAnio)
             dtpDesde = "01/" + Mes + "/" + gsAnio
          End If
      End If
      sw = False
      SWEdit = False
      Activado = False
      
      If Not lBolActivado Then
         'Carga las cuentas por Diferencia de Cambio
         If Len(Trim(CuentaCfgAuto("SEL_GAN"))) = 0 Then
            Mensajes "No se tiene definido la Cuenta Ganancia por Diferencia de Cambio", vbInformation
            DesactivaBarraHerramientas False
            
            Exit Sub
         End If
         If Len(Trim(CuentaCfgAuto("SEL_PER"))) = 0 Then
            Mensajes "No se tiene definido la Cuenta Perdida por Diferencia de Cambio", vbInformation
            DesactivaBarraHerramientas False
            
            Exit Sub
         End If
         
         pSetFocus tdbgAsientos
         lBolActivado = True
      End If
      dtpFechaDoc.Enabled = True
    Activado = True
    
    DoEvents
    
    If VerificaLibros = False Then
        DesactivaBarraHerramientas False
        Unload Me: Exit Sub
    End If
    
     If CargaTipoDoc = False Then
        Mensajes "Ingrese los tipos de documentos en el sistema", vbOKOnly + vbInformation
        DesactivaBarraHerramientas False
        Unload Me: Exit Sub
     End If
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       DesactivaBarraHerramientas
' Description:       Procedimiento que activa o desactiva la barra de herramientas segun el parametro
'
' Parameters :       Valor (Boolean)
'--------------------------------------------------------------------------------
Private Sub DesactivaBarraHerramientas(Valor As Boolean)
    tbrOpciones.Buttons(1).Enabled = Valor
    tbrOpciones.Buttons(2).Enabled = Valor
    tbrOpciones.Buttons(3).Enabled = Valor
    tbrOpciones.Buttons(4).Enabled = Valor
    tbrOpciones.Buttons(5).Enabled = Valor
    tbrOpciones.Buttons(6).Enabled = Valor
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Form_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el formulario
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
    If gsFlagBotonBarra = True Then Exit Sub
    Dim respuesta As String
    Select Case KeyCode
            Case vbKeyEscape:
                If Me.sstAsientos.TabEnabled(1) = False Then ' *** Grabar
                    respuesta = MsgBox("Esta seguro que desea salir del formulario actual", vbYesNo + vbQuestion + vbDefaultButton2, "Confirmar Salir")
                    If respuesta = vbYes Then Unload Me
                Else
                    respuesta = MsgBox("Desea cancelar la siguiente operación", vbYesNo + vbQuestion + vbDefaultButton2, "Confirmar Cancelar")
                    If respuesta = vbYes Then Call Cancelar
                End If
            
            Case vbKeyF2:
                        If tbrOpciones.Enabled = False Then Exit Sub
                        If tbrOpciones.Buttons(1).Enabled = False Then Exit Sub
                        tbrOpciones_ButtonClick tbrOpciones.Buttons(1)
            
            Case vbKeyF3
                        If tbrOpciones.Enabled = False Then Exit Sub
                        If tbrOpciones.Buttons(2).Enabled = False Then Exit Sub
                        tbrOpciones_ButtonClick tbrOpciones.Buttons(2)
                            
            Case vbKeyF4
                        If tbrOpciones.Enabled = False Then Exit Sub
                        If tbrOpciones.Buttons(3).Enabled = False Then Exit Sub
                        tbrOpciones_ButtonClick tbrOpciones.Buttons(3)
                            
            Case vbKeyF5
                        If tbrOpciones.Enabled = False Then Exit Sub
                        If tbrOpciones.Buttons(4).Enabled = False Then Exit Sub
                        tbrOpciones_ButtonClick tbrOpciones.Buttons(4)
                            
            Case vbKeyF6
                        If tbrOpciones.Enabled = False Then Exit Sub
                        If tbrOpciones.Buttons(5).Enabled = False Then Exit Sub
                        tbrOpciones_ButtonClick tbrOpciones.Buttons(5)
                            
            Case vbKeyF7
                        If tbrOpciones.Enabled = False Then Exit Sub
                        If tbrOpciones.Buttons(6).Enabled = False Then Exit Sub
                        tbrOpciones_ButtonClick tbrOpciones.Buttons(6)
                            
            Case vbKeyF8
                        If tbrOpciones.Buttons(3).Enabled Then
                            gsFlagBotonBarra = True
                            DoEvents
                            cmdTipoAsiento_Click
                            DoEvents
                            gsFlagBotonBarra = False
                        End If
    End Select
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       PintaCeldas
' Description:       Procedimiento que activa o desactiva el pintado de la grilla por columnas
'
' Parameters :       Valor (Boolean)
'--------------------------------------------------------------------------------
Private Sub PintaCeldas(Valor As Boolean)
    tdbgDetalle.Columns(nColAsd_nItem).FetchStyle = Valor
    tdbgDetalle.Columns(nColEnt_cCodEntidad).FetchStyle = Valor
    tdbgDetalle.Columns(nColCos_cCodigo).FetchStyle = Valor
    tdbgDetalle.Columns(nColAsd_cSerieDoc).FetchStyle = Valor
    tdbgDetalle.Columns(nColAsd_cNumDoc).FetchStyle = Valor
    tdbgDetalle.Columns(nColAsd_cTipoDoc).FetchStyle = Valor
    tdbgDetalle.Columns(nColAsd_nDebeSoles).FetchStyle = Valor
    tdbgDetalle.Columns(nColAsd_nDebeMonExt).FetchStyle = Valor
    tdbgDetalle.Columns(nColAsd_nHaberSoles).FetchStyle = Valor
    tdbgDetalle.Columns(nColAsd_nHaberMonExt).FetchStyle = Valor
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       VerificaLibros
' Description:       Funcion que verifica la configuracion de parametros tenga los codigos de libros llenos
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function VerificaLibros() As Boolean
    VerificaLibros = True
    pCargaCfgLibro
    DoEvents
        
       If lsLibroCom = "" Then VerificaLibros = False
       If lsLibroVen = "" Then VerificaLibros = False
       If lsLibroCierre = "" Then VerificaLibros = False
       If lsLibroDiario = "" Then VerificaLibros = False
       If lsLibroDif = "" Then VerificaLibros = False
       If lsLibroCajIng = "" Then VerificaLibros = False
       If lsLibroCajEgr = "" Then VerificaLibros = False
    
    If VerificaLibros = False Then
        Mensajes "Configure todos los codigos de libros en Configuración -> Parametros Iniciales", vbOKOnly + vbInformation
        Exit Function
    End If

End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CargaTipoDoc
' Description:       Funcion que carga los tipos de documento
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function CargaTipoDoc() As Boolean
    Dim sqlver  As String
    Dim registros  As Integer
    
    sqlver = "select TDO_CCODIGO, TDO_CNOMBRELARGO, TDO_CNOMBRECORTO from dbo.CNT_TIPODOC where emp_ccodigo= '" & gsEmpresa & "'"
    registros = LlenarArreglo(lArrTipoDoc, sqlver)
    
    If registros > 0 Then
        CargaTipoDoc = True
    Else
        CargaTipoDoc = False
    End If

End Function


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Form_Load
' Description:       Evento que se ejecuta al iniciar el formulario
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub Form_Load()
     
     lblEstado.Visible = False
     gsFlagBotonBarra = False
     SWEdit = False

     Set lArrDetalle = New XArrayDB
     Set lArrDetalleElim = New XArrayDB
     Set lArrDetalleTemp = New XArrayDB
     Set lrsCtasxLibro = New ADODB.Recordset
     Set lrsDocBolVta = New ADODB.Recordset
     Set lrsOpxCta = New ADODB.Recordset
     
     If pCargaCfgLibro = False Then Unload Me: Exit Sub
     
     Call LlenaRsTDBolVenta
     DoEvents
     
    'If VerificaLibros = True Then
        strSalida = False
        Me.Height = 6990
        Me.Width = 11800
                
        tdbgDetalle.FetchRowStyle = True
        
        gsInicioVoucher = True
    
        gsKeyCodePress = False
        
        Call Centrar_form(Me)
        
        lItem = 0
      
        gsMesesAnteriores = NE(BuscaConfigAnual("Cfl_cMesCompras"))
        sstAsientos.Tab = 0
        
        Call AsignaColDeta
        
        Call LlenaComboMesApeAddItem(tdbcMes)
        
        DoEvents
        
        sw = True
        If Len(Trim(gsPeriodo)) = 0 Then
           'tdbcMes.BoundText = Format(Month(Date), "00")
           sw = False
        Else
           tdbcMes.BoundText = gsPeriodo   'Format(Month(gsPeriodo), "00")
        End If
        
        Call LlenaComboLibrosCabecera
        Call LlenaComboMedioPago
        DoEvents
        'Call CargaTabla("periodo")
        tdbgDetalle.Columns(nColAsd_cGlosa).FooterText = "TOTALES"
        tdbgDetalle.Columns(nColAsd_nDebeSoles).FooterText = "0.00"
        tdbgDetalle.Columns(nColAsd_nHaberSoles).FooterText = "0.00"
        tdbgDetalle.Columns(nColAsd_nDebeMonExt).FooterText = "0.00"
        tdbgDetalle.Columns(nColAsd_nHaberMonExt).FooterText = "0.00"
        tdbtAnio = gsAnio
        
        ' ***
        lsTituOpcion = "Registro de Asientos Contables"
        Me.Caption = lsTituOpcion
        lnOpcion = 0
        
        sstAsientos.TabEnabled(1) = False

        datosLlenos = False
        lBolActivado = False
         
        tdbgDetalle.Columns(0).AllowFocus = False
        
        
        '***************************************
        ' ACTIVA LAS CASILLAS PARA SER PINTADAS
        Call PintaCeldas(True)
        '***************************************

        SeteaBarraHerramientas Me.tbrOpciones, gsGrupo
        
        tdbgDetalle.ScrollBars = dbgBoth
        
        tdbgDetalle.MarqueeStyle = dbgSolidCellBorder

        SSTab1.Tab = 1
        
        
    Call frmMDIConta.TabForm_CrearN(NE(Me.hwnd))
    Me.WindowState = vbMaximized
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenaComboLibrosCabecera
' Description:       Procedimiento que llena los libros coontables segun el usuario logueado
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub LlenaComboLibrosCabecera()
    Dim sqlcombos  As String
   
    sqlcombos = "spSg_GrabaUsuarios 'SEL_ALL_EMP_LIBLOGEO', '" & gsUsuario & "', '', '', '', '', '', '" & gsEmpresa & "','','" & gsSOFT & "','" & gsAnio & "',''"
    LlenarComboAddItem tdbcLibroCab, sqlcombos
    
    tdbcLibroCab.Enabled = True
    tdbcLibroCab.BoundText = tdbcLibroCab.Columns(0).Value
     
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Form_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque el formulario
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub Form_LostFocus()
    Call RefreshGrilla
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Form_Resize
' Description:       Evento que se ejecuta al cambiar el tamaño el formulario
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub Form_Resize()
    If Me.WindowState <> vbMinimized Then
        On Error GoTo serror
        
        Call Centrar_Objeto(Frame3, Me)
        Call Centrar_Objeto(fraBusqueda, Me)
        
        sstAsientos.Width = Me.Width - 300
        tdbgAsientos.Width = Me.Width - 700
        fraLista.Width = Me.Width - 500
        
        fraCabecera.Width = Me.Width - 400
        
        sstAsientos.Height = Me.Height - 950
        fraLista.Height = Me.Height - 1500
        tdbgAsientos.Height = fraLista.Height - 2300
        
        tdbgDetalle.Width = Me.Width - 400
        Line1.X2 = Me.Width - 270
        fra01.Width = tdbgDetalle.Width - 5
        fra02.Width = fra01.Width
        fra03.Width = fra01.Width
        
        tdbgDetalle.Height = sstAsientos.Height - 3550
        fra01.Top = sstAsientos.Height - 2450
        fra02.Top = sstAsientos.Height - 2000
        fra03.Top = sstAsientos.Height - 950
        
        If Me.WindowState = vbMaximized Then
            Me.lblEstado.Left = Me.Width - lblEstado.Width - 300
            Me.lblCalculoManual.Left = lblEstado.Left - lblCalculoManual.Width
        Else
            Me.lblEstado.Left = 9285
            Me.lblCalculoManual.Left = 7350
        End If
        
        'tdbgDetalle.ScrollBars = dbgNone
        'tdbgDetalle.ScrollBars = dbgAutomatic
    End If
    
    Exit Sub
    
serror:

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Form_Unload
' Description:       Evento que se ejecuta al salir del formulario
'
' Parameters :       Cancel (Integer)
'--------------------------------------------------------------------------------
Private Sub Form_Unload(Cancel As Integer)
    If gsEliminoFila = False Then
        If MsgBox("Desea salir del mantenimiento de voucher", vbYesNo + vbQuestion, "Aviso...") = vbYes Then
            Set lArrDetalle = Nothing
            Set lArrMoneda = Nothing
            
            Set lArrMonedaAdic = Nothing
            Set lArrBaseImp = Nothing
            Set lArrDetalleElim = Nothing
            Set lArrDetalleTemp = Nothing
            
            Call CerrarRecordSet(lrsAsientos)
            Call CerrarRecordSet(lrsOperaTC)
            Call CerrarRecordSet(lrsTipoMone)
            Call CerrarRecordSet(lrsCtasxLibro)
            Call CerrarRecordSet(lrsDocBolVta)
            Call CerrarRecordSet(lrsOpxCta)
            
            gsInicioVoucher = False
            
            Set frmManAsientosContables = Nothing
            
            Call frmMDIConta.TabForm_CerrarN(NE(Me.hwnd))
            
        Else
            tbrOpciones.Buttons(7).Enabled = True
            Cancel = 1
        End If
    Else
        tbrOpciones.Buttons(7).Enabled = True
        Cancel = 1
    End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenarComboTipoMoneda
' Description:       Procedimiento que llena los tipos
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub LlenarComboTipoMoneda()

    Dim sqlcombos  As String
    ' *** Llenando el tipo de Moneda
    sqlcombos = "SELECT Mon_cCodigo, Mon_cNombreLargo, Mon_cMNac, Mon_cMExt, Mon_cNombreCorto From CNT_TIPO_MONEDA " & _
                "WHERE Emp_cCodigo = '" & gsEmpresa & "' AND (Mon_cMNac = '1' or Mon_cMExt = '1')  " & _
                "ORDER BY Mon_cMNac desc,  Mon_cMExt desc, Mon_cNombreCorto"
                
    ComboArreglo lArrMoneda, tdbcMoneda, sqlcombos
    
    Call BuscarMonedaNacional
    
    ' *** Llenando el tipo de Moneda
    sqlcombos = "SELECT Mon_cCodigo, Mon_cNombreLargo, Mon_cMNac, Mon_cMExt, Mon_cNombreCorto From CNT_TIPO_MONEDA " & _
                "WHERE Emp_cCodigo = '" & gsEmpresa & "' AND Mon_cMNac <> '1' and Mon_cMExt <> '1' " & _
                "ORDER BY Mon_cNombreLargo"
    ComboArregloMonAdic lArrMonedaAdic, tdbcMonedaAdic, sqlcombos
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenarCombos
' Description:       Procedimiento que llenalos combos del formulario de mantenimiento
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub LlenarCombos()
    Dim sqlcombos As String
    '--------------------------------------------------------------------
    ' llenando combo de Libros

    sqlcombos = "spSg_GrabaUsuarios 'SEL_ALL_EMP_LIBLOGEO', '" & gsUsuario & "', '', '', '', '', '', '" & gsEmpresa & "','','" & gsSOFT & "','" & gsAnio & "',''"
    
    LlenarComboAddItem tdbcLibro, sqlcombos
    '--------------------------------------------------------------------
    ' Cargar datos de Tipo de Operación de TC
    If gintBiMoneda = 1 Then
        sqlcombos = "SELECT t.Tab_cCodigo, t.Tab_cDescripCampo FROM dbo.TABLA T " & _
                    "WHERE T.Emp_cCodigo = '" & gsEmpresa & "' AND T.Tab_cTabla = '026' AND t.Tab_cCodigo <> 'SCV'"
    Else
        sqlcombos = "SELECT Tab_cCodigo, Tab_cDescripCampo FROM TABLA " & _
                "WHERE Emp_cCodigo =  '" & gsEmpresa & "' AND Tab_cTabla = '026' ORDER BY TAB_NLONGITUD "
    End If
    
                
    Call LlenarRecordSet(sqlcombos, lrsOperaTC)
    Set Me.tdbdOperaTC.DataSource = lrsOperaTC
    '--------------------------------------------------------------------
    ' Cargar datos de Tipo de Moneda
    sqlcombos = "SELECT Mon_cNombreCorto, Mon_cCodigo, Mon_cMNac, Mon_cMExt, Mon_cNombreLargo From CNT_TIPO_MONEDA " & _
                "WHERE Emp_cCodigo = '" & gsEmpresa & "' and (Mon_cMNac='1' or Mon_cMExt='1') " & _
                "ORDER BY Mon_cMNac desc,  Mon_cMExt desc, Mon_cNombreCorto"
    Call LlenarRecordSet(sqlcombos, lrsTipoMone)
    Set tdbdMoneDet.DataSource = lrsTipoMone
    '--------------------------------------------------------------------
    ' *** Cargando información en la Base imponible
    Call LlenaComboBaseImponible
    '--------------------------------------------------------------------
    ' Cargar datos de Procesos
    sqlcombos = "SELECT Tab_cCodigo, Tab_cDescripCampo FROM TABLA " & _
                "WHERE Emp_cCodigo =  '" & gsEmpresa & "' AND Tab_cTabla = '068' ORDER BY Tab_cCodigo "
    LlenarComboAddItem tdbcProceso, sqlcombos, True
    
    If tdbcProceso.ListCount = 1 And tdbcProceso.Columns(1) = "" Then
       tdbcProceso.Locked = True
    Else
       tdbcProceso.Locked = False
    End If
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenaIngresoEgreso
' Description:       Procedimiento que llena el combo de ingreso o egreso segun el libro seleccionado
'
' Parameters :       Libro (String)
'--------------------------------------------------------------------------------
Private Sub LlenaIngresoEgreso(Libro As String)
    tdbcTipoOperacion.Clear
    
    If Libro = lsLibroDiario Then
        tdbcTipoOperacion.AddItem "" & ";" & ""
        tdbcTipoOperacion.AddItem "M" & ";" & "APLICACIONES"
        tdbcTipoOperacion.AddItem "I" & ";" & "CUENTAS X COBRAR"
        tdbcTipoOperacion.AddItem "E" & ";" & "CUENTAS X PAGAR"
        tdbcTipoOperacion.Bookmark = 0
        tdbcTipoOperacion.ListField = "column1"
        tdbcTipoOperacion.BoundColumn = "column0"
    
    ElseIf Libro = lsLibroCajIng Or Libro = lsLibroCajEgr Then
        tdbcTipoOperacion.AddItem "I" & ";" & "INGRESO"
        tdbcTipoOperacion.AddItem "E" & ";" & "EGRESO"
        tdbcTipoOperacion.Bookmark = 0
        tdbcTipoOperacion.ListField = "column1"
        tdbcTipoOperacion.BoundColumn = "column0"
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenaComboBaseImponible
' Description:       Procedimiento que llena la base imponible
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub LlenaComboBaseImponible()
    Dim Libro As String

    If lnOpcion = 2 Then
        Libro = Left(Me.tdbgAsientos.Columns(6), 2)
    Else
        Libro = tdbcLibro.BoundText
    End If

    Call LlenaComboBaseImponiblePublico(tdbcBaseImponible, Libro)
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscarMonedaNacional
' Description:       Procedimiento que setea la moneda nacional
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub BuscarMonedaNacional()
    Dim posicion As Integer, nCont As Integer
    
    On Local Error GoTo ErrorEjecucion
    posicion = BuscaValorArr(lArrMoneda, "1", 2)
    If posicion = -1 Then
        tdbcMoneda.Bookmark = lArrMoneda.Count(1) - 1
    Else
        tdbcMoneda.Bookmark = posicion
    End If
    
    Exit Sub
ErrorEjecucion:
    Mensajes Str(Err.Number) & " " & Err.Description, vbInformation
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ImgCerrar_Click
' Description:       Evento que seejecuta al
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub ImgCerrar_Click()
Command4_Click
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ImgCerrarBusqueda_Click
' Description:       Evento que seejecuta al cambiar el nombre de la entidad
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub ImgCerrarBusqueda_Click()
    Call cmdCancelarBusqueda_Click
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       lblNomEnti_Change
' Description:       Evento que seejecuta al cambiar el nombre de la entidad
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub lblNomEnti_Change()
    If CE(lblNomEnti) = "" Then
        lblEntidad.Caption = ""
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       SSTab1_Click
' Description:       Evento que seejecuta al hacer clic en el tab de listado de vouchers
'
' Parameters :       PreviousTab (Integer)
'--------------------------------------------------------------------------------
Private Sub SSTab1_Click(PreviousTab As Integer)
    If PreviousTab = 0 Then
        'pSetFocus tdbtLibroCod
    Else
        pSetFocus dtpDesde
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaCuentaEnConfigOP
' Description:       Procedimiento quebusca la cuenta en la configuracion de operaciones segun el codigo de operacion
'
' Parameters :       Cuenta (String)
'                    Codigo (String)
'--------------------------------------------------------------------------------
Private Function BuscaCuentaEnConfigOP(Cuenta As String, Codigo As String) As Boolean
    Dim sqlver  As String, valorDato As String
    sqlver = "SELECT Cod_cValorParam FROM CND_CONFIG_OPERA " & _
             "WHERE Emp_cCodigo='" & gsEmpresa & "' and pan_cAnio='" & gsAnio & "' and  " & _
             "cop_ccodigo='" & Codigo & "' and " & _
             "Cod_cValorParam like '" & Left(CE(Cuenta), 2) & "%'"
    valorDato = ExtraeDescripcion(sqlver)
    If valorDato <> "" Then
        BuscaCuentaEnConfigOP = True
    Else
        BuscaCuentaEnConfigOP = False
    End If

End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcBaseImponible_KeyDown
' Description:       Evento que seejecuta al presionar una tecla en el combo de base imponible
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcBaseImponible_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyF4 Then
        KeyCode = 0
        Exit Sub
    End If
    
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    If KeyCode = 13 Then
        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cBaseImp) = tdbcBaseImponible.BoundText
        tdbgDetalle.Col = BuscaCeldaActiva(nColPla_cCuentaContable)
        
        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
        
        'UpdateGrilla
        'DoEvents
        tdbgDetalle.RefreshRow
        
        pSetFocus tdbgDetalle
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaPoliza
' Description:       Funcion que determina hay un documento de tipo poliza
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function BuscaPoliza() As Boolean
    Dim i As Integer
    Dim entro As Boolean
    
    entro = False
    Dim iFila As Integer
    iFila = NumeroFilas
    
    For i = 0 To iFila - 1
        If CE(lArrDetalle(i, nColAsd_cTipoDoc)) = "30" Then
            entro = True
            Exit For
        End If
    Next i

    BuscaPoliza = entro
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcBaseImponible_SelChange
' Description:       Evento que seejecuta al cambiar la base imponible
'
' Parameters :       Cancel (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcBaseImponible_SelChange(Cancel As Integer)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    Dim Codigo As String, sqlver  As String
    Dim HONORARIOS  As String
    
    Codigo = CE(tdbcBaseImponible.Columns(0))
    gsBaseimp = CE(tdbcBaseImponible.Columns(0))
    
    EstadoOri = ""
    
    If Codigo = "" Then
        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cBaseImp) = ""
        
        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    Else
        
        If Codigo <> "999" And Codigo <> "998" And Codigo <> "997" Then   'inafecto y exonerada
            
            If tdbcLibro.BoundText = lsLibroCom And Codigo = "" Then
                Codigo = "006"
            End If
            
            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nMontoInafecto) = 0
            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 102
            
        Else
            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nMontoInafecto) = 1
            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
            
        End If
        
        If tdbcLibro.BoundText = lsLibroCom Then
            If BuscaBasesImponiblesEnDetalle = False Then
               Dim i As Integer
               Dim sPla_cCuentaContable As String
               Dim sPla_cCuentaContableDet As String
               
               sPla_cCuentaContable = Left(CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)), 2)
               
               If (sPla_cCuentaContable <> "42" Or sPla_cCuentaContable <> "48") And Codigo >= "006" And Codigo <= "008" Then
                    For i = 0 To lItem - 1
                        sPla_cCuentaContableDet = Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2)
                        If (sPla_cCuentaContableDet <> "42" Or sPla_cCuentaContableDet <> "48") Then
                           lArrDetalle(i, nColAsd_cBaseImp) = Codigo
                           lArrDetalle(i, nColAsd_cModif) = 1
                        Else
                           lArrDetalle(i, nColAsd_cBaseImp) = ""
                           lArrDetalle(i, nColAsd_cModif) = 1
                        End If
                    Next i
               Else
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cBaseImp) = Codigo
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
                    
                    If (tdbgDetalle.Columns(42).Value = "024" Or tdbgDetalle.Columns(42).Value = "999" Or tdbgDetalle.Columns(42).Value = "042") And (Year(tdbgDetalle.Columns(nColAsd_dFecDoc)) = Year(dtpFecha.Text) And _
                        Month(tdbgDetalle.Columns(nColAsd_dFecDoc)) = Month(dtpFecha.Text)) And tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "01" Then
                        EstadoOri = "0"
                    ElseIf tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "02" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "03" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "10" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "15" _
                           Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "16" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "17" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "18" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "19" _
                           Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "21" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "22" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "44" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "45" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "46" Then
                       EstadoOri = "0"
                    End If
                         
               End If
            Else
               lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cBaseImp) = Codigo
               lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
            End If
        Else
            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cBaseImp) = Codigo
            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
        End If
        
        Cancel = 0
    End If
    
    tdbcBaseImponible.BoundText = Codigo
    
    tdbgDetalle.RefreshRow

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaBasesImponiblesEnDetalle
' Description:       Funcion que busca la base imponible en el detalle
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function BuscaBasesImponiblesEnDetalle() As Boolean
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If

    Dim Cont As Integer
    Dim i As Integer
    Cont = 0
    BuscaBasesImponiblesEnDetalle = False
    
    For i = 0 To lItem - 1
        If (CE(lArrDetalle(i, nColAsd_cBaseImp)) = "006" Or _
           CE(lArrDetalle(i, nColAsd_cBaseImp)) = "007" Or _
           CE(lArrDetalle(i, nColAsd_cBaseImp)) = "008") And Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2) <> "40" Then
           
           Cont = Cont + 1
           
        End If
    Next i
    
    If Cont > 1 Then BuscaBasesImponiblesEnDetalle = True
    
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcLibro_cambio_KeyDown
' Description:       Evento que seejecuta al presionar una tecla en el combo de cambio de libro
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcLibro_cambio_KeyDown(KeyCode As Integer, Shift As Integer)

    If KeyCode = vbKeyF4 Then
        KeyCode = 0
        Exit Sub
    End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcLibro_cambio_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el cambio de libro
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcLibro_cambio_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Then
        pSetFocus Text3
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcLibro_cambio_SelChange
' Description:       Evento que se ejecuta al cambiar la seleccion en el combo de cambio de libro
'
' Parameters :       Cancel (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcLibro_cambio_SelChange(Cancel As Integer)
    Text3.Text = numeroVoucher("VOUCHER", gsAnio, tdbcMes.BoundText, tdbcLibro_cambio.BoundText)
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcLibro_ItemChange
' Description:       Evento que se ejecuta al cambiar el item del tipo de libro
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbcLibro_ItemChange()

    If lnOpcion = 2 Then Exit Sub
    
    If LlenaCuentasPorLibro(tdbcLibro.BoundText) = False Then
        'Mensajes "No hay cuentas configuradas para este libro, verificar...", vbOKOnly + vbInformation
        'pSetFocus tdbcLibro
        'Exit Sub
    End If
    
    Call LlenaIngresoEgreso(tdbcLibro.BoundText)
    
    Activar tdbtGlosa, True
    Activar tdbtTipDocRef, False
    Activar tdbtSerDocRef, False
    Activar tdbtNroDocRef, False
    Activar dtpFecDocRef, False
    Activar tdbtNroConsta, False
    Activar dtpFecDeposito, False
    
    tdbgDetalle.Columns(3).Visible = False
    
    '------ Condiciona los libros que tengan provisión de docs y pago/cobranza de docs --------
'''''''    cmdCancelaciones.Enabled = True
    cmdCancelaciones.Enabled = False
    
    'pCargaCfgLibro
    
    lsTipOperaLib = ""
    lsCfgBaseImpo = ""
    lsCfgCtasCance = ""
    
    tdbgDetalle.Columns(nColAsd_cGrupo).Visible = True
    'tdbgDetalle.Columns(nColAsd_cDesConcepto).Visible = gsDiarioSimplificado
    
    Select Case tdbcLibro.BoundText
           Case lsLibroCom
                lsCfgBaseImpo = "004" 'PARA LAS CUENTAS DEL IGV AL PRESIONAR F9
                tdbgDetalle.Columns(nColAsd_cGrupo).Visible = False
           Case lsLibroVen
                lsCfgBaseImpo = "004" 'PARA LAS CUENTAS DEL IGV AL PRESIONAR F9
                tdbgDetalle.Columns(nColAsd_cGrupo).Visible = False
            Case lsLibroApe
                tdbgDetalle.Columns(nColAsd_cGrupo).Visible = False
           Case lsLibroHon
                lsCfgBaseImpo = "004" 'PARA LAS CUENTAS DEL IGV AL PRESIONAR F9
           Case lsLibroCajIng
                lsTipOperaLib = "C"
                If lnOpcion = 0 Then tdbcTipoOperacion.BoundText = "I"
                cmdCancelaciones.Enabled = True
           Case lsLibroCajEgr
                lsTipOperaLib = "C"
                If lnOpcion = 0 Then tdbcTipoOperacion.BoundText = "E"
                cmdCancelaciones.Enabled = True
           Case lsLibroDiario
                lsTipOperaLib = "C"
                If lnOpcion = 0 Then tdbcTipoOperacion.BoundText = "E"
                cmdCancelaciones.Enabled = True
'            Case Else
'                cmdCancelaciones.Enabled = True
           
    End Select
    '-------- Habilita el IGV SOLO SI ES LIBRO DE COMPRAS O VENTAS-----------
    tdbnPorcIGV.Value = 0
    Label1(5).Visible = False 'LABEL DEL IGV
    tdbnPorcIGV.Visible = False 'COMBO DEL IGV
    '-----------------------------------------------------------------------'
    If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Then
       Label1(5).Visible = True
       tdbnPorcIGV.Visible = True
       tdbnPorcIGV.Value = fIgv()

    End If
    
    If tdbcLibro.BoundText = lsLibroCom Then
        lblComp.Visible = True
        tdbtComprobante.Visible = True
        lblValorEmb.Visible = False
        tdbtMonedaAdic.Visible = False
        pctValorEmB.Visible = False
    ElseIf tdbcLibro.BoundText = lsLibroVen Then
        lblValorEmb.Visible = True
        tdbtMonedaAdic.Visible = True
        pctValorEmB.Visible = True
    Else
        lblComp.Visible = False
        tdbtComprobante.Visible = False
    End If
    
    '-------- Habilita la operación del libro caja --------
    Call VisualizaTipoOperacionCaja
    
    '-------- Habilita ActualizaCamposPagoIVG  --------
    
    Call ActualizaCamposPagoIVG(tdbcTipoOperacion.Visible)
    
    '------ SI ES DE TIPO LIBRO CAJA INGRESOS O CAJA EGRESOS ---------
'    If lsTipOperaLib = "C" Or tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Then

''''''PPK
''''''    If lsTipOperaLib = "C" Then
'lsCfgCtasCance = "MIX"
       cmdCancelaciones.Enabled = True
''''''    Else
''''''       cmdCancelaciones.Enabled = False
''''''    End If
    
    '------ SI ES DE TIPO LIBRO COMPRAS O VENTAS ---------
    If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Then
       cmdTipoAsiento.Enabled = True
       
       'tdbgDetalle.Columns(40).Visible = True
       'tdbgDetalle.Columns(41).Visible = True
    Else
       cmdTipoAsiento.Enabled = False
       
       'tdbgDetalle.Columns(40).Visible = True
       'tdbgDetalle.Columns(41).Visible = True
       
    End If
    
    '------ CARGA COMBO DE BASE IMPONIBLE ---------
    Call LlenaComboBaseImponible
    
    '------ VARIABLES PARA EL DIARIO SIMPLIFICADO ---------
    If gsDiarioSimplificado = 1 Then
        Call BuscaConceptosValores(tdbcLibro.BoundText, gsCodConceptoDefecto, gsDesConceptoDefecto)
    Else
        gsCodConceptoDefecto = ""
        gsDesConceptoDefecto = ""
    End If
    
    DoEvents
    '-----------------------------------------------------------------
    tdbtNumVoucher = numeroVoucher("VOUCHER", gsAnio, tdbcMes.BoundText, tdbcLibro.BoundText)
    '-----------------------------------------------------------------
    
    If gsUltimoLibro = tdbcLibro.BoundText And tdbtObservaciones.Text = "" Then
        tdbtObservaciones.Text = gsUltimaGlosa
    End If
    
    
    If tdbcLibro.Enabled Then
       DoEvents
       pSetFocus tdbcLibro
       DoEvents
    End If
    
    '-----------------------------------------------------------------
    dtpFecha.Value = BuscaUltimaFecha(tdbcLibro.BoundText)
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       VisualizaTipoOperacionCaja
' Description:       Procedimiento que muestra u oculta el combo de tipo de operacion de caja
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub VisualizaTipoOperacionCaja()
    '-------- Habilita la operación del libro caja --------
    tdbcTipoOperacion.Visible = (Len(CE(lsLibroCajIng)) > 0 And lsLibroCajIng = lsLibroCajEgr And tdbcLibro.BoundText = lsLibroCajIng)
    
    If tdbcTipoOperacion.Visible = True Or tdbcLibro.BoundText = lsLibroDiario Then
        tdbcTipoOperacion.BoundText = "E"
        Label1(6).Visible = True 'LABEL CUENTA CORRIENTE
        tdbcTipoOperacion.Visible = True
       
    Else
        
        tdbcTipoOperacion.BoundText = ""
        Label1(6).Visible = False 'LABEL CUENTA CORRIENTE
    
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcLibro_KeyUp
' Description:       Evento que se ejecuta al presionar una tecla en el tipo de libro
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcLibro_KeyUp(KeyCode As Integer, Shift As Integer)

    TimerKey.Enabled = False
    gsKeyCodePress = False
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       OcultaComboBase
' Description:       Procedimiento que muestra u oculta el combo de base imponible
'
' Parameters :       Valor (Boolean)
'--------------------------------------------------------------------------------
Private Function OcultaComboBase(Valor As Boolean)

    tdbcBaseImponible.Visible = Valor
    lblBaseImponible.Visible = Valor
    
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcLibro_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque en el combo del libro
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbcLibro_LostFocus()
    
       If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Or tdbcLibro.BoundText = lsLibroDiario Then
          OcultaComboBase True
       Else
          OcultaComboBase False
       End If
       
    DoEvents
    If tdbcLibro.BoundText <> lsLibroApe And tdbcMes.BoundText = "00" Then
        Mensajes "Solo se pueden crear asientos de tipo LIBRO APERTURA para este periodo"
        tdbcLibro.BoundText = lsLibroApe
        pSetFocus tdbcLibro
        Exit Sub
    End If
    
    If tdbcLibro.BoundText = lsLibroApe And tdbcMes.BoundText <> "00" Then
        Mensajes "No se pueden crear asientos de tipo LIBRO APERTURA para este periodo"
        tdbcLibro.BoundText = lsLibroDiario
        pSetFocus tdbcLibro
        Exit Sub
    End If
       
       
    gsKeyCodePress = False
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ConfigurarControlFecha
' Description:       Procedimiento que setea los controles de fecha
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub ConfigurarControlFecha()
    If Val(tdbcMes.BoundText) > 0 And Val(tdbcMes.BoundText) < 13 Then
        dtpDesde.Enabled = True
        dtpHasta.Enabled = True

        dtpHasta.MinDate = "01/01/1900"
        dtpHasta.MaxDate = "01/01/2100"
        
        dtpDesde.MinDate = "01/01/1900"
        dtpDesde.MaxDate = "01/01/2100"
        
        If Val(tdbcMes.BoundText) > Val(gsPeriodoAnterior) Then
            dtpHasta.MaxDate = UltimoDiaMes(tdbcMes.BoundText, gsAnio)
            dtpHasta.MinDate = "01/" + tdbcMes.BoundText + "/" + gsAnio
            
            dtpDesde.MaxDate = UltimoDiaMes(tdbcMes.BoundText, gsAnio)
            dtpDesde.MinDate = "01/" + tdbcMes.BoundText + "/" + gsAnio
        Else
            dtpHasta.MinDate = "01/" + tdbcMes.BoundText + "/" + gsAnio
            dtpHasta.MaxDate = UltimoDiaMes(tdbcMes.BoundText, gsAnio)
            
            dtpDesde.MinDate = "01/" + tdbcMes.BoundText + "/" + gsAnio
            dtpDesde.MaxDate = UltimoDiaMes(tdbcMes.BoundText, gsAnio)
        End If
    
        gsPeriodoAnterior = tdbcMes.BoundText
    Else
        dtpDesde.Enabled = False
        dtpHasta.Enabled = False
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcLibroCab_ItemChange
' Description:       Evento que se ejecuta al cambiar el libro en la cabecera del voucher cuando es nuevo
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbcLibroCab_ItemChange()
   
    CargaTabla ("periodo")
    Call FiltrarRecordSet
    Call MuestraDesBloqueo(tdbcMes.BoundText)
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       MuestraDesBloqueo
' Description:       Procedimiento que cambia la descripcion de bloqueo segun el mes de parametro
'
' Parameters :       cMes (String)
'--------------------------------------------------------------------------------
Private Sub MuestraDesBloqueo(cMes As String)

    If CierreMes(cMes, tdbcLibroCab.BoundText) Then
        lblEstadoMes(0).Visible = False
        lblEstadoMes(1).Visible = True
    Else
        lblEstadoMes(0).Visible = True
        lblEstadoMes(1).Visible = False
    End If
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcMes_ItemChange
' Description:       Evento que se ejecuta al cambiar el mes
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbcMes_ItemChange()
    Dim VarMes As String
    Dim sqlMes As String
    
    ConfigurarControlFecha
    
    If tdbcMes.BoundText > "00" And tdbcMes.BoundText < "13" Then
        VarMes = "01/" + tdbcMes.BoundText + "/" + gsAnio
        dtpHasta = UltimoDiaMes(tdbcMes.BoundText, gsAnio)
        dtpDesde = VarMes
        chkDesde.Value = 1
    ElseIf tdbcMes.BoundText = "00" Then
        chkDesde.Value = 0
    ElseIf tdbcMes.BoundText >= "13" Then
        chkDesde.Value = 0
    End If
    
    CargaTabla ("periodo")
    Call FiltrarRecordSet
    If sw = False Then
        If gsPeriodo = "" Then
            tdbcMes.BoundText = Format(Month(Date), "00")
         End If
        gsPeriodo = tdbcMes.BoundText
        
        GrabaPeriodoActivo
    End If
    
    If Activado = True Then
        Call MuestraDesBloqueo(tdbcMes.BoundText)
        DoEvents
    End If

    frmMDIConta.stbMdi.Panels(2).Text = NombreMes(gsPeriodo) & " DEL " & gsAnio & "  "
    gsMesSistema = gsPeriodo
    DoEvents
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcMes_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el combo del mes
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcMes_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    pSetFocus tdbgAsientos
End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcMoneda_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque en el combo de moneda
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbcMoneda_LostFocus()
    gsKeyCodePress = False
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcMonedaAdic_ItemChange
' Description:       Evento que se ejecuta al cambiar la moneda adicional
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbcMonedaAdic_ItemChange()
    If tdbcMonedaAdic.BoundText = "" Then
        tdbtMonedaAdic.Value = 0
    Else
        pSetFocus tdbtMonedaAdic
    End If
End Sub

'Private Sub tdbcOperaTC_KeyDown(KeyCode As Integer, Shift As Integer)
'    If KeyCode = 13 Then pSendKeys "{TAB}"
'End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcMonedaAdic_KeyDown
' Description:       Evento que se ejecuta al presionar una teclaen la moneda adicional
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcMonedaAdic_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyF4 Then
        KeyCode = 0
        Exit Sub
    End If
    
    If KeyCode = 13 Then
       pSetFocus tdbtMonedaAdic
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcPagoIGV_GotFocus
' Description:       Evento que se ejecuta al recibir el enfoque en el combo del pago de IGV
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbcPagoIGV_GotFocus()
    pVerificaIngCuenta
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Activar
' Description:       Procedimiento que activa el control del parametro
'
' Parameters :       Control (Object)
'                    Valor (Boolean)
'--------------------------------------------------------------------------------
Private Sub Activar(ByRef Control As Object, Valor As Boolean)
    If lnOpcion = 2 Then 'SI ES CONSULTA DE VOUCHER
        Control.Enabled = False
        
        Control.BackColor = gsColorActivado
        
    Else
        Control.Enabled = Valor
        
            If Valor = True Then
                Control.BackColor = gsColorActivado
            Else
                Control.BackColor = gsColorDesactivado
            End If
        
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CargaTipoTransacciones
' Description:       Llena el combo de tipo de transacciones
'
' Parameters :       CodigoTabla (String)
'--------------------------------------------------------------------------------
Private Sub CargaTipoTransacciones(CodigoTabla As String)
    Dim sqlcombos  As String
    sqlcombos = "select Tab_cCodigo, Tab_cDescripCampo " & _
                "from TABLA where  Tab_cTabla='" & CodigoTabla & "' and Emp_cCodigo='" & gsEmpresa & "' " & _
                "order by Tab_cDescripCampo "

    ComboArregloBaseImp lArrBaseImp, tdbcTipoTx, sqlcombos
    
    tdbcTipoTx.BoundText = lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cFormaPago)
    
    Activar tdbcTipoTx, True

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ActualizaCamposPagoIVG
' Description:       Procedimiento que activa o desactiva los campos de referencia del detalle del voucher
'
' Parameters :       Valor (Boolean)
'--------------------------------------------------------------------------------
Private Sub ActualizaCamposPagoIVG(Valor As Boolean)

    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
        
    On Error Resume Next
    
    If lItem < tdbgDetalle.Bookmark Then
       Exit Sub
    End If
    
    '----------------- Retenciones y Percepciones -------------------'
    If tdbcPagoIGV.BoundText = "R" Or tdbcPagoIGV.BoundText = "P" Then
        
        Activar tdbtNroConsta, False
        Activar tdbtTipDocRef, True
        Activar tdbtSerDocRef, True
        Activar tdbtNroDocRef, True
        Activar dtpFecDocRef, True
        Activar dtpFecDeposito, False
        Activar tdbcTipoTx, True
        
        
        If Valor = False Then
            tdbtNroConsta.Text = ""
            dtpFecDeposito.Text = ""
        
            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumSpot) = ""
            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFechaSpot) = ""
            
        End If

        
        If tdbcPagoIGV.BoundText = "P" Then
            CargaTipoTransacciones "044"
            lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgDetRet) = "P"
        End If
        If tdbcPagoIGV.BoundText = "R" Then
            CargaTipoTransacciones "045"
            lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgDetRet) = "R"
        End If
       
    Else
        '-------- Detracciones ------------'
        If tdbcPagoIGV.BoundText = "D" Then
        
            If tdbcLibro.BoundText = lsLibroCom Then
                lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgDetRet) = "D"
            End If
            
            tdbcTipoTx.Clear
            
            Activar tdbtNroConsta, True
            Activar tdbtTipDocRef, True
            Activar tdbtSerDocRef, True
            Activar tdbtNroDocRef, True
            Activar dtpFecDocRef, True
            Activar dtpFecDeposito, True
            Activar tdbcTipoTx, False
            
            
'            If Valor = True Then
'
'                tdbtTipDocRef.Text = ""
'                tdbtSerDocRef.Text = ""
'                tdbtNroDocRef.Text = ""
'                dtpFecDocRef.Text = ""
'
'                dtpFecDeposito.Text = ""
'                tdbtNroConsta.Text = ""
'
'
'                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDocRef) = ""
'                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cSerieDocRef) = ""
'                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumDocRef) = ""
'                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecDocRef) = ""
'
'
'                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumSpot) = ""
'                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFechaSpot) = ""
'
'
'            End If
            
        Else
            '-------- Ninguno ----------'
            If lnOpcion <> 2 Then
                Activar tdbtNroConsta, False
                Activar tdbtTipDocRef, False
                Activar tdbtSerDocRef, False
                Activar tdbtNroDocRef, False
                Activar dtpFecDocRef, False
                Activar dtpFecDeposito, False
                Activar tdbcTipoTx, False
                DoEvents
                
                If Valor = True Then
                    tdbtTipDocRef.Text = ""
                    tdbtSerDocRef.Text = ""
                    tdbtNroDocRef.Text = ""
                    dtpFecDocRef.Text = ""
                    dtpFecDeposito.Text = ""
                    tdbtNroConsta.Text = ""
                    tdbcTipoTx.BoundText = ""
                

                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDocRef) = ""
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cSerieDocRef) = ""
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumDocRef) = ""
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecDocRef) = ""
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFechaSpot) = ""
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumSpot) = ""
                    
                    lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgDetRet) = ""
                    

                End If
            End If
        End If

    End If
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcPagoIGV_ItemChange
' Description:       Evento que se ejecuta al cambiarel item en el pago del IGV
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbcPagoIGV_ItemChange()
    If Me.tdbcPagoIGV.BoundText <> "" Then
    Activar tdbtNroConsta, True
    Activar dtpFecDeposito, True
'ActualizaCamposPagoIVG False 'False = solo limpia las cajas de texto
        
        lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgDetRet) = tdbcPagoIGV.BoundText
        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cFormaPago) = tdbcTipoTx.BoundText
        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
        
        RefreshGrilla
    'Else
    '    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cFormaPago) = tdbcTipoTx.BoundText
    '    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    
    End If
    'lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    'lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgDetRet) = tdbcPagoIGV.BoundText
    'UpdateGrilla
    'DoEvents
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcPagoIGV_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el pago del IGV
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcPagoIGV_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyF4 Then
        KeyCode = 0
        Exit Sub
    End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcPagoIGV_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el pago del IGV
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcPagoIGV_KeyPress(KeyAscii As Integer)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    If KeyAscii = 13 Or KeyAscii = vbKeyTab Then
        
        lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgDetRet) = tdbcPagoIGV.BoundText
        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cFormaPago) = tdbcTipoTx.BoundText
        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
        

        ActualizaCamposPagoIVG True 'True= limpia las cajas de texto y la matriz de la grilla
        ActivaCamposDocumRef
        pSaltoColGrid tdbcPagoIGV.TabIndex


        'UpdateGrilla
        'DoEvents
        tdbgDetalle.RefreshRow

    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcPagoIGV_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque el pago del IGV
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbcPagoIGV_LostFocus()


    tdbcPagoIGV_KeyPress (13)
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcProceso_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el combro de procesos
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcProceso_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyF4 Then
        KeyCode = 0
        Exit Sub
    End If
    
    If gsKeyCode = 0 Then KeyCode = 0
    
    If KeyCode = 13 Then
    
       tdbgDetalle.EditActive = True
       tdbgDetalle.Col = BuscaCeldaActiva(tdbgDetalle.Col)
       'tdbgDetalle.Row = 0
       pSetFocus tdbgDetalle
       RefreshGrilla
       'On Error Resume Next
       'tdbgDetalle.Bookmark = 0
    End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcProceso_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque el combo de procesos
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbcProceso_LostFocus()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cProceso) = tdbcProceso.BoundText
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    
    tdbgDetalle.RefreshRow
    DoEvents
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcProceso_SelChange
' Description:       Evento que se ejecuta al cambiar la seleccion en el combo de procesos
'
' Parameters :       Cancel (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcProceso_SelChange(Cancel As Integer)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cProceso) = tdbcProceso.BoundText
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    
    tdbgDetalle.RefreshRow
    DoEvents
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcTipoOperacion_ItemChange
' Description:       Evento que se ejecuta al camiar el item en el tipo de operacion (Caja)
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbcTipoOperacion_ItemChange()
    If tdbcTipoOperacion.BoundText = "I" Then
       lsCfgCtasCance = "009"
       
    ElseIf tdbcTipoOperacion.BoundText = "E" Then
       lsCfgCtasCance = "010"
       
    ElseIf tdbcTipoOperacion.BoundText = "M" Then
       lsCfgCtasCance = "MIX"
       
    End If
    
    gsKeyCodePress = False
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcTipoOperacion_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el combo de tipo de operacion
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcTipoOperacion_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyF4 Then
        KeyCode = 0
        Exit Sub
    End If
    
    If KeyCode = 13 Then
       tdbgDetalle.EditActive = True
       tdbgDetalle.Col = nColPla_cCuentaContable
       'tdbgDetalle.Row = 0
       pSetFocus tdbgDetalle
       RefreshGrilla
       On Error Resume Next
       'tdbgDetalle.Bookmark = 0
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcTipoPago_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el tipo de pago
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcTipoPago_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyF4 Then
        KeyCode = 0
        Exit Sub
    End If
    
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    If KeyCode = 13 Then
        lArrDetalle(tdbgDetalle.Bookmark, nColTra_cCodigo) = tdbcTipoPago.BoundText
        tdbgDetalle.Col = BuscaCeldaActiva(gsColumna)
        
        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
        
        tdbgDetalle.RefreshRow
        
        pSetFocus tdbgDetalle
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcTipoPago_SelChange
' Description:       Evento que se ejecuta al cambiar la selecciona en el tipo de pago
'
' Parameters :       Cancel (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcTipoPago_SelChange(Cancel As Integer)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    lArrDetalle(tdbgDetalle.Bookmark, nColTra_cCodigo) = tdbcTipoPago.BoundText
    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    
    tdbgDetalle.RefreshRow

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcTipoTx_KeyDown
' Description:       Evento que se ejecuta al presioanr una tecla en el tipo de transaccion
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcTipoTx_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyF4 Then
        KeyCode = 0
        Exit Sub
    End If
    
    If KeyCode = 13 Then
        pSaltoColGrid tdbcTipoTx.TabIndex
    End If
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcTipoTx_LostFocus
' Description:       Evento que se ejecuta al perder el elfoque el tipo de transaccion
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbcTipoTx_LostFocus()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    lArrDetalle.Value(Me.tdbgDetalle.Bookmark, nColAsd_cFormaPago) = tdbcTipoTx.BoundText
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    
    'UpdateGrilla
    'DoEvents
    tdbgDetalle.RefreshRow

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcTipoTx_SelChange
' Description:       Evento que se ejecuta al cambiar la selaccion en el tipo de transaccion
'
' Parameters :       Cancel (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcTipoTx_SelChange(Cancel As Integer)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cFormaPago) = tdbcTipoTx.BoundText
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    
'    UpdateGrilla
 '   DoEvents
     tdbgDetalle.RefreshRow
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbdMoneDet_DropDownClose
' Description:       Evento que se ejecuta al cerrar la lista del combo de la moneda en el detalle de voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbdMoneDet_DropDownClose()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    gsFlagKeydownDet = False

    Dim Moneda As String
    Dim MonedaNom As String
    tdbgDetalle.Columns(nColAsd_nTipoCambio) = "0.000"
    On Error Resume Next
    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nTipoCambio) = 0
    
    DoEvents
    Moneda = CE(tdbdMoneDet.Columns(1).Value)
    MonedaNom = CE(tdbdMoneDet.Columns(0).Value)
    
    If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Then
        If Moneda <> tdbcMoneda.BoundText Then
            Moneda = tdbcMoneda.BoundText
            MonedaNom = tdbcMoneda.Columns(4)
        End If
    End If
    
    If Moneda <> gsMonedaNac And tdbgDetalle.Columns(nColAsd_cOperaTC) = "SCV" Then
        tdbgDetalle.Columns(nColAsd_cOperaTC) = "VEP"
    End If
    
    tdbgDetalle.Columns(nColAsd_cNomMoneda) = MonedaNom
    
    tdbgDetalle.Columns(nColAsd_cTipoMoneda) = Moneda
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cTipoMoneda) = Moneda
    
    If Moneda = gsMonedaNac Then
        tdbgDetalle.Columns(nCol_cFlgMonNac) = 1
    Else
        tdbgDetalle.Columns(nCol_cFlgMonNac) = 0
    End If
    
    
    'If tdbcLibro.BoundText = lsLibroCierre Or
    If (gintBiMoneda = 0 And tdbgDetalle.Columns(nColAsd_cNomMoneda) = gsMonedaNacAbrev) Then
        tdbgDetalle.Columns(nColAsd_cOperaTC) = "SCV"
        tdbgDetalle.Columns(nColAsd_cNomMoneda).Value = gsMonedaNacAbrev
        
        tdbgDetalle.Columns(nColAsd_cTipoMoneda).Value = gsMonedaNac
        lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cTipoMoneda) = gsMonedaNac
        
        tdbgDetalle.Columns(nCol_cFlgMonNac).Value = "1"
        tdbgDetalle.Columns(nColAsd_nTipoCambio) = "0.000"
        tdbgDetalle.Columns(nColAsd_nDebeMonExt) = "0.000"
        tdbgDetalle.Columns(nColAsd_nHaberMonExt) = "0.000"
        
        DoEvents
        
    End If
    RefreshGrilla
    
    DoEvents

    tdbgDetalle.Col = BuscaCeldaActiva(nColAsd_cNomMoneda)
    
    pSetFocus tdbgDetalle
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbdOperaTC_DropDownClose
' Description:       Evento que se ejecuta al  cerrar el combo de tipo de operacion
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbdOperaTC_DropDownClose()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    gsFlagKeydownDet = False
    
    Dim Moneda As String
    Dim MonedaNom As String
    Dim OperaNom As String
    DoEvents
    
   ' tdbgDetalle.Columns(nColAsd_nTipoCambio) = "0.000"
    On Error Resume Next
    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nTipoCambio) = 0
    
    Moneda = tdbgDetalle.Columns(nColAsd_cTipoMoneda)
    
    OperaNom = tdbdOperaTC.Columns(0).Value
    
    If OperaNom = "SCV" Then
        tdbgDetalle.Columns(nColAsd_nTipoCambio) = "0.000"
        tdbgDetalle.Columns(nColAsd_nDebeMonExt) = "0.000"
        tdbgDetalle.Columns(nColAsd_nHaberMonExt) = "0.000"
        DoEvents
        tdbgDetalle.RefreshRow
        DoEvents
    End If
    
    
    If Moneda <> gsMonedaNac And OperaNom = "SCV" Then
        OperaNom = "VEP"
    End If
    
    
    tdbgDetalle.Columns(nColAsd_cOperaTC) = OperaNom
    
    'If tdbcLibro.BoundText = lsLibroCierre Or
    If (gintBiMoneda = 0 And tdbgDetalle.Columns(nColAsd_cNomMoneda).Value = gsMonedaNacAbrev) Then
        OperaNom = "SCV"
        tdbgDetalle.Columns(nColAsd_cOperaTC) = "SCV"
        tdbgDetalle.Columns(nColAsd_cNomMoneda).Value = gsMonedaNacAbrev
        tdbgDetalle.Columns(nColAsd_cTipoMoneda).Value = gsMonedaNac
        tdbgDetalle.Columns(nCol_cFlgMonNac).Value = "1"
    End If
    
    DoEvents
    If OperaNom <> "SCV" Then
        Dim TC As Double
        TC = TipoCambio(tdbgDetalle.Columns(nColAsd_dFecDoc).Text, OperaNom)
        If TC < 0 Then TC = 0
        tdbtCambio.Value = TC
        tdbgDetalle.Columns(nColAsd_nTipoCambio).Value = TC
        
        Call CalculaMonNac(True)
        'tdbgDetalle.Columns(nColAsd_nDebeSoles) = Redondear(NE(tdbgDetalle.Columns(nColAsd_nDebeMonExt)) * TC, 2)
        'tdbgDetalle.Columns(nColAsd_nHaberSoles) = Redondear(NE(tdbgDetalle.Columns(nColAsd_nHaberMonExt)) * TC, 2)
        
    Else
        tdbgDetalle.Columns(nColAsd_nTipoCambio).Value = "0.000"
        tdbgDetalle.Columns(nColAsd_nDebeMonExt) = "0.00"
        tdbgDetalle.Columns(nColAsd_nHaberMonExt) = "0.00"
        
    End If
    
    DoEvents
    
    tdbgDetalle.Col = BuscaCeldaActiva(nColAsd_cOperaTC)
    tdbgDetalle.RefetchRow
    pSetFocus tdbgDetalle
    DoEvents
    pSaltoColGridActivo nColAsd_cOperaTC
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgAsientos_DblClick
' Description:       Evento que se ejecuta al hacer doble clic en la grilla de lista de voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbgAsientos_DblClick()
    VerDatos
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tbrOpciones_ButtonClick
' Description:       Evento que se ejecuta al hacer clic en el toolbar del mantenimiento de voucher
'
' Parameters :       Button (MSComctlLib.Button)
'--------------------------------------------------------------------------------
Private Sub tbrOpciones_ButtonClick(ByVal Button As MSComctlLib.Button)
    Dim respuesta As String
    
    If tbrOpciones.Enabled = False Then Exit Sub
    If tbrOpciones.Buttons(Button.Index).Enabled = False Then Exit Sub
    
    If Button.Index = 1 Then 'si es nuevo solo validar libro
        If tdbcLibroCab.BoundText <> lsLibroApe And tdbcMes.BoundText = "00" Then
            Mensajes "Solo se pueden crear asientos de tipo LIBRO APERTURA para este periodo"
            tdbcLibroCab.BoundText = lsLibroApe
            Unload Me
            Exit Sub
        End If
        
        If tdbcLibroCab.BoundText = lsLibroApe And tdbcMes.BoundText <> "00" Then
            Mensajes "No se pueden crear asientos de tipo LIBRO APERTURA para este periodo"
            tdbcLibroCab.BoundText = lsLibroDiario
            tbrOpciones.Buttons(1).Enabled = True
            Exit Sub
        End If
    End If
    
    gsActualizaTC = False
    tbrOpciones.Buttons(Button.Index).Enabled = False
    
    Call InicializaBookmark
    
    Select Case Button.Index
            
        Case 1:
                tbrOpciones.Enabled = False
                DoEvents
                ManNuevo
                DoEvents
                tbrOpciones.Enabled = True
                Screen.MousePointer = vbNormal
        Case 2:
                
                tbrOpciones.Enabled = False
                DoEvents
                VerDatos
                DoEvents
                tbrOpciones.Enabled = True
                Screen.MousePointer = vbNormal
        Case 3:
        
                tbrOpciones.Enabled = False
                DoEvents
                If lnOpcion <> 2 Then
                    Grabar
                End If
                DoEvents
                tbrOpciones.Enabled = True
                Screen.MousePointer = vbNormal
                SeteaBarraHerramientas Me.tbrOpciones, gsGrupo
        Case 4:
                tbrOpciones.Enabled = False
                DoEvents
                pProcAnularBorrar 2
                DoEvents
                tbrOpciones.Enabled = True
                Screen.MousePointer = vbNormal
                tbrOpciones.Buttons(Button.Index).Enabled = True
        Case 5:
                tbrOpciones.Enabled = False
                DoEvents
                Editar
                DoEvents
                tbrOpciones.Enabled = True
                Screen.MousePointer = vbNormal
        Case 6:
                tbrOpciones.Enabled = False
                DoEvents
                Imprimir
                DoEvents
                tbrOpciones.Enabled = True
                Screen.MousePointer = vbNormal
                
                tbrOpciones.Buttons(Button.Index).Enabled = True
        Case 7
            If sstAsientos.TabEnabled(1) = False Then ' *** Grabar
                'respuesta = MsgBox("Esta seguro que desea salir del formulario actual", vbYesNo + vbQuestion, "Confirmar Salir")
                 EstadoOri = ""
                 EstadoDes = ""
                Unload Me
            Else
                respuesta = MsgBox("Desea cancelar la siguiente operación", vbYesNo + vbQuestion, "Confirmar Cancelar")
                If respuesta = vbYes Then
                     EstadoOri = ""
                     EstadoDes = ""
                    tbrOpciones.Buttons(Button.Index).Enabled = True
                    Call Cancelar
                    
                    SeteaBarraHerramientas Me.tbrOpciones, gsGrupo
                    Exit Sub
                Else
                    tbrOpciones.Buttons(Button.Index).Enabled = True
                End If
            End If
    End Select
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       InicializaBookmark
' Description:       Procedimiento queinicializa el bookmark de la grilla del detalle
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub InicializaBookmark()
    On Error Resume Next
    tdbgDetalle.Bookmark = 0
End Sub
'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       TieneCancelacion
' Description:       Funcion que indica si el documento ingresado tiene cancelacion
'
' Parameters :       emp (String)
'                    Anio (String)
'                    per (String)
'                    lib (String)
'                    vou (String)
'                    num (String)
'                    Cuenta (String = "")
'                    tipoEnt (String = "")
'                    codEnt (String = "")
'                    Tipodoc (String = "")
'                    SerieDoc (String = "")
'                    NumDoc (String = "")
'--------------------------------------------------------------------------------
Public Function TieneCancelacion(emp As String, Anio As String, per As String, lib As String, vou As String, _
                                 num As String, Optional Cuenta As String = "", Optional tipoEnt As String = "", _
                                 Optional codEnt As String = "", Optional Tipodoc As String = "", _
                                 Optional SerieDoc As String = "", Optional NumDoc As String = "") As String
    Dim rsArreglo As ADODB.Recordset
    Dim clDatos As New clsMantoTablas
    Dim arrDatos() As Variant
    Dim sqlCan As String
    
    On Error GoTo serror
    TieneCancelacion = ""
    
    sqlCan = "spCn_ConsultaProvisionesDoc 'BUSCA_CANC_DOC', '" & emp & "','" & Anio & "', '" & _
    codEnt & "', '' , '" & Tipodoc & "', '" & SerieDoc & "', '" & NumDoc & "', '" & _
    Cuenta & "', '" & tipoEnt & "',  '', '" & vou & "'"
    
    ' *** Si es mayor a 0 entonces es True
    arrDatos = Array(sqlCan)
    Set rsArreglo = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
    If Not rsArreglo Is Nothing Then
        If CE(rsArreglo.Fields("Ase_nVoucher")) <> "" Then
            TieneCancelacion = CE(rsArreglo.Fields("Ase_nVoucher"))
        End If
    End If
    
    If tdbcLibroCab.BoundText = lsLibroDif Then
        TieneCancelacion = ""
    End If
    
    Set clDatos = Nothing
    Call CerrarRecordSet(rsArreglo)
    
    Exit Function
serror:
    TieneCancelacion = "ERROR"
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       TieneRegAuxiliares
' Description:       Funcion que retorna si el voucher tiene registros auxiliares
'
' Parameters :       emp (String)
'                    Anio (String)
'                    per (String)
'                    lib (String)
'                    num (String)
'                    Voucher (String)
'--------------------------------------------------------------------------------
Public Function TieneRegAuxiliares(emp As String, Anio As String, per As String, lib As String, num As String, Voucher As String) As Boolean
    Dim rsArreglo As ADODB.Recordset
    Dim clDatos As New clsMantoTablas
    Dim arrDatos() As Variant
    Dim sqlCan As String
    
    TieneRegAuxiliares = False
    sqlCan = "select * from CNT_REG_BOLETAS " & _
             "WHERE Emp_cCodigo= '" & emp & "' AND Pan_cAnio= '" & Anio & "' " & _
             "AND Per_cPeriodo = '" & per & "' " & _
             " " & _
             "AND Ase_nVoucher = '" & num & "' "
    
    ' *** Si es mayor a 0 entonces es True
    arrDatos = Array(sqlCan)
    Set rsArreglo = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
    If rsArreglo Is Nothing Then Exit Function
    If rsArreglo.State = adStateClosed Then Exit Function
    If CE(rsArreglo(0)) <> "" Then TieneRegAuxiliares = True
    Set clDatos = Nothing
    Call CerrarRecordSet(rsArreglo)
    
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       pProcAnularBorrar
' Description:       Procedimiento de eliminacion del voucher
'
' Parameters :       nOpcion (Integer)
'--------------------------------------------------------------------------------
Public Sub pProcAnularBorrar(nOpcion As Integer)
    ' Valor -->  1 : Anular   2 : Eliminar ;
    ' *** Eliminar los datos; segun el q esta seleccionado
    Dim respuesta As String, sMsg As String
    Dim Pos As Long, sNroMov As String
        
    If nOpcion = 1 Then
        'se elimina la opcion : anular voucher
        Exit Sub
    End If
    
    With tdbgAsientos
        If .Columns(1).Value <> "" Then
            
            ' *** Validar q mes no haya sido cerrado
            If CierreMes(tdbgAsientos.Columns(2).Value, tdbcLibroCab.BoundText) = True Then
                .Refresh
                DoEvents
            
                Mensajes "Mes seleccionado ya fue cerrado. No se puede eliminar asiento.", vbInformation
                Exit Sub
            End If
            
            ' *** Preguntar si hay provisiones con cancelaciones mayor a 0. Si hay no eliminar
            If TieneCancelacion(gsEmpresa, .Columns(1).Value, .Columns(2).Value, _
            .Columns(4).Value, .Columns(6).Value, .Columns(0).Value) <> "" Then
                If nOpcion = 1 Then
                .Refresh
                DoEvents
                
                    Mensajes "No se puede Anular el Registro. " & Salto(2) & _
                             "HAY PROVISIONES con pagos registrados, en este asiento. " & Chr(13) & _
                             "Eliminar los pagos y volver a intentar...", vbInformation
                             
                    Exit Sub
                Else
                
                .Refresh
                DoEvents
                
                    Mensajes "No se puede Eliminar el Registro. " & Salto(2) & _
                             "HAY PROVISIONES con pagos registrados, en este asiento. " & Chr(13) & _
                             "Eliminar los pagos y volver a intentar...", vbInformation
                             
                    Exit Sub
                End If
            End If
            
            Dim entro As Boolean
            entro = False
            ' *** Preguntar si tiene registros auxiliares
            If TieneRegAuxiliares(gsEmpresa, .Columns(1).Value, .Columns(2).Value, .Columns(4).Value, .Columns(6).Value, .Columns(6).Value) = True Then
                If nOpcion = 1 Then
                .Refresh
                DoEvents
                
                    Mensajes "No se puede Anular el Registro. " & Salto(2) & _
                             "El voucher tiene REGISTROS AUXILIARES dependientes. " & Chr(13) & _
                             "Elimine los registros auxiliares y vuelva a intentar...", vbInformation
                    Exit Sub
                Else
                
                    .Refresh
                    DoEvents
                
                    If MsgBox("Desea eliminar el voucher y sus dependencias en .." & Salto(2) & "REGISTROS AUXILIARES , desea continuar ...", vbYesNo + vbQuestion) = vbYes Then
                             
                        If EliminaRegAuxiliaresxVoucher(.Columns(6).Value, .Columns(0).Value) = True Then
                            entro = True
                        Else
                            entro = False
                        End If
                    Else
                        Exit Sub
                    End If
                
                End If
            End If
        
            Dim sMsg2 As String
            If nOpcion = 1 Then
               'sMsg = "Desea anular el asiento : " & .Columns(6).Value & ""
               'sMsg2 = "Confirmar Eliminar Registro"
            Else
                sMsg = "¿Desea eliminar definitivamente el registro seleccionado?"
                sMsg2 = "Confirmar Eliminar Registro"
            End If
            
            If entro = True Then
                respuesta = vbYes
            Else
                respuesta = MsgBox(sMsg, vbYesNo + vbQuestion + vbDefaultButton2, sMsg2)
            End If
            
            If respuesta = vbYes Then
                Dim clsMante As clsMantoTablas
                
                Set clsMante = New clsMantoTablas
                Screen.MousePointer = vbHourglass
                
                lNumInterno = .Columns(0).Value ' *** Interno
                
                ' *** Si es ELIMINAR Revertir Saldos de Cuentas
                Call CargaArregloSaldos
                lArrCab(0) = "REVERTIR"
                lArrCab(1) = .Columns(0).Value  ' *** Interno
                lArrCab(2) = gsEmpresa          ' *** Empresa
                lArrCab(3) = .Columns(1).Value  ' *** Año
                lArrCab(4) = .Columns(2).Value  ' *** Periodo
                lArrCab(5) = .Columns(4).Value  ' *** Libro
                lArrCab(6) = .Columns(6).Value  ' *** Voucher
                lArrCab(7) = gsUsuario
                
                If clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCn_ActualizaSaldos", lArrCab(), False) = False Then
                   Set clsMante = Nothing
                   Mensajes "El proceso no ha concluido. Verificar...", vbInformation
                   Screen.MousePointer = vbNormal
                   Exit Sub
                End If
            
                ' *** Eliminando el asiento
                Call CargaArregloCab
                
                lArrCab(0) = "ELIMINAR"         ' *** Accion
                lArrCab(1) = .Columns(0).Value  ' *** Interno
                lArrCab(2) = gsEmpresa          ' *** Empresa
                lArrCab(3) = .Columns(1).Value  ' *** Año
                lArrCab(4) = .Columns(2).Value  ' *** Periodo
                lArrCab(5) = .Columns(4).Value  ' *** Libro
                lArrCab(6) = .Columns(6).Value  ' *** Voucher
                
                Pos = Me.tdbgAsientos.Bookmark
                If clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCn_GrabaAsientoCab", lArrCab(), False) = False Then
                    Mensajes "El proceso no se ha realizado. Verificar...", vbInformation
                   Screen.MousePointer = vbNormal
                   Exit Sub
                End If
                
                ' *** RECALCULA LOS SALDOS DE LOS DOCUMENTOS EN EL VOUCHER
                ReDim lArrCab(3) As Variant
                lArrCab(0) = gsEmpresa          ' *** Empresa
                lArrCab(1) = .Columns(1).Value  ' *** Año
                lArrCab(2) = ""                 ' *** NUMMOV NO ENVIAMOS PARAMETRO PARA QUE CALCULE SOLO EL VOUCHER ACTIVO
                lArrCab(3) = .Columns(6).Value  ' *** Voucher
                
                If clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCn_ReprocesoSaldosProvVou", lArrCab(), True) = False Then
                    Mensajes "El proceso no se ha realizado. Verificar...", vbInformation
                   Screen.MousePointer = vbNormal
                   Exit Sub
                End If
  
                
                Set clsMante = Nothing
                
                If nOpcion = 1 Then sNroMov = lrsAsientos("Ase_cNummov")
                
                lrsAsientos.MoveNext
                
                If lrsAsientos.EOF Then
                   lrsAsientos.MovePrevious
                   lrsAsientos.MovePrevious
                End If
                
                If lrsAsientos.BOF Then
                   lrsAsientos.MoveFirst
                End If
                
                If nOpcion = 2 Then sNroMov = lrsAsientos("Ase_cNummov")
                
                CargaTabla ("periodo")
                FiltrarRecordSet
                If Not lrsAsientos Is Nothing Then
                   If nOpcion = 1 Then
                      lrsAsientos.Find "Ase_cNummov like '" & sNroMov & "%'"
                   Else
                      lrsAsientos.Find "Ase_cNummov like '" & sNroMov & "%'"
                   End If
                End If
                
                Screen.MousePointer = vbDefault
                If nOpcion = 1 Then
                   Mensajes "El asiento contable ha sido anulado", vbInformation
                Else
                   Mensajes "Registro ha sido eliminado", vbInformation
                End If
            End If
        Else
           Mensajes "No existe ningun registro seleccionado", vbInformation
        End If
    End With
    ' ***
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       EliminaRegAuxiliaresxVoucher
' Description:       funcion que elimina los registros axiliares asociados al voucher a eliminar
'
' Parameters :       Voucher (String)
'                    Nummov (String)
'--------------------------------------------------------------------------------
Private Function EliminaRegAuxiliaresxVoucher(Voucher As String, Nummov As String) As Boolean
    
    Dim clsMante As clsMantoTablas
    Set clsMante = New clsMantoTablas
    EliminaRegAuxiliaresxVoucher = True
    
    Dim lArrCab(31) As Variant
    lArrCab(0) = "ELIMINAR_XVOU"
    lArrCab(1) = gsEmpresa
    lArrCab(2) = gsAnio
    lArrCab(3) = gsPeriodo
    
    lArrCab(4) = Null
    lArrCab(5) = Null
    lArrCab(6) = Null
    lArrCab(7) = Null
    lArrCab(8) = Null
    lArrCab(9) = Null
    lArrCab(10) = Null
    lArrCab(11) = Null
    lArrCab(12) = Null
    lArrCab(13) = Null
    lArrCab(14) = Null
    lArrCab(15) = 0
    lArrCab(16) = Null
    lArrCab(17) = Null
    lArrCab(18) = Null
    lArrCab(19) = Null
    lArrCab(20) = Null
    lArrCab(21) = Null
    lArrCab(22) = Null
    lArrCab(23) = Null
    lArrCab(24) = Null
    lArrCab(25) = Null
    lArrCab(26) = Null
    lArrCab(27) = Null
    lArrCab(28) = Null
    lArrCab(29) = Null
    
    lArrCab(30) = Nummov
    lArrCab(31) = Voucher
    
    If clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCNT_REG_BOLETAS", lArrCab(), True) = False Then
        Mensajes "El proceso no ha concluido. Verificar...", vbInformation
        Screen.MousePointer = vbDefault
        
        EliminaRegAuxiliaresxVoucher = False
    End If
    
    Set clsMante = Nothing
    
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       IniciarCamposDocumento
' Description:       Procedimeinto que inicializa los campos del documento de referencia
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub IniciarCamposDocumento()

    Activar tdbtComprobante, False
    
    Activar tdbtNroConsta, False
    Activar dtpFecDeposito, False
    Activar tdbtNroDocRef, False
    Activar dtpFecDocRef, False
    Activar tdbtTipDocRef, False
    Activar tdbtSerDocRef, False
    
    tdbtComprobante.Text = ""
    tdbtNroConsta.Text = ""
    dtpFecDeposito.Text = ""
    tdbtNroDocRef.Text = ""
    dtpFecDocRef.Text = ""
    tdbtTipDocRef.Text = ""
    tdbtSerDocRef.Text = ""
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       HabilitaFormulario
' Description:       Procedimiento que habilita los controles de la cabecera
'
' Parameters :       Accion (String)
'--------------------------------------------------------------------------------
Private Sub HabilitaFormulario(accion As String)
        
    If accion = "Nuevo" Then
        tdbcMoneda.Enabled = True
        tdbtObservaciones.Enabled = True
        tdbnPorcIGV.Enabled = True
    End If
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Editar
' Description:       Procedimiento que permite editar un voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub Editar()
    lnOpcion = 1
    If datosLlenos = False Then
        Call LlenarCombos
        datosLlenos = True
    End If
    
    DoEvents
    
    If tdbgAsientos.Columns(1).Value <> "" Then
        ' *** Validar q mes no haya sido cerrado
        If CierreMes(tdbgAsientos.Columns(2).Value, tdbcLibroCab.BoundText) = True Then
            Mensajes "Mes seleccionado ya fue cerrado. No se puede modificar Asiento.", vbInformation
            Call Cancelar
            Exit Sub
        End If

       'Se deshabilita esta opción para utilizar el campo como Valor Embarcado, cuando la N.C o N.D modifica una DUA
       Call LlenarComboTipoMoneda
       
       If tdbcLibro.BoundText = lsLibroCom Then
            lblValorEmb.Visible = False
            tdbtMonedaAdic.Visible = False
            pctValorEmB.Visible = False
        ElseIf tdbcLibro.BoundText = lsLibroVen Then
            lblValorEmb.Visible = True
            tdbtMonedaAdic.Visible = True
            pctValorEmB.Visible = True
       End If
       
        'Call HabilitaControl(Me)
        Call HabilitaFormulario("Nuevo")

        Me.Caption = "PERIODO: " & tdbcMes & " " & gsAnio
        Me.lblEstado.Caption = "EDICION"

        tdbcTipoTx.BoundText = ""
        tdbcPagoIGV.BoundText = ""

        ActivarControl tdbcPagoIGV, False
        ActivarControl tdbcTipoTx, False

        With tdbgAsientos
             Me.CheckCuadraCompMan.Value = NE(.Columns(12).Value)
             Call CargaDatosRegistro(.Columns(1).Value, .Columns(2).Value, .Columns(4).Value, .Columns(6).Value, EDICION, .Columns(0).Value)
        End With
        DoEvents
                
        tdbgDetalle.Splits(0).Locked = False

        Call IniciarCamposDocumento
        
        Call TabMantenimiento(True)
        
        '------- Habilita el ingreso de Operación de Caja ----------'
        
        Call VisualizaTipoOperacionCaja
        
        '------- Habilita el IGV --------------'
        Label1(5).Visible = False: tdbnPorcIGV.Visible = False

        If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Then
           Label1(5).Visible = True
           tdbnPorcIGV.Visible = True
        End If

        'PGBV - 02012013
        Dim sql As String

        sql = "select * from CNT_lIBROSGENERADOS where Emp_cCodigo = '" & gsEmpresa & "' and Pan_cAnio = '" & gsAnio & "' and Per_cPeriodo = '" & gsPeriodo & "' and Lib_cTipoLibro = '" & tdbcLibro.BoundText & "' and Estado ='A'"
        If tdbcLibro.BoundText <> "02" And tdbcLibro.BoundText <> "04" And tdbcLibro.BoundText <> "01" And tdbcLibro.BoundText <> "07" And tdbcLibro.BoundText <> "08" Then
            If Month(dtpFecha.Value) < Month(lsFecha) Or Year(dtpFecha.Value) < Year(lsFecha) Then
                If ExisteDato(sql) = True Then
                    If tdbcLibro.BoundText = "05" Or tdbcLibro.BoundText = "06" Or tdbcLibro.BoundText = "03" Then
                        EstadoDes = "9"
    '                Else
    '                    EstadoDes = "8"
                    End If
                Else
                    EstadoDes = ""
                End If
            End If
        Else
            If tdbcLibro.BoundText = "01" Or tdbcLibro.BoundText = "02" Or tdbcLibro.BoundText = "04" Or tdbcLibro.BoundText = "07" Or tdbcLibro.BoundText = "08" Then
                sql = "select * from CNT_CIERRE where Emp_cCodigo = '" & gsEmpresa & "' and Pan_cAnio = '" & gsAnio & "' and Per_cPeriodo = '" & gsPeriodo & "' and TipoLibro = '" & tdbcLibro.BoundText & "' and Cic_cEstado ='A'"
                If ExisteDato(sql) = True Then EstadoDes = "9"
            End If
        End If
        SWEdit = True

        'tdbgDetalle.Splits(0).Locked = False
        If Me.dtpFecha.Enabled = False Then dtpFecha.Enabled = True
                
        tdbcLibro.Enabled = False: tdbtNumVoucher.Enabled = False
        Me.cmdEliminaItem.Enabled = True
        Me.cmdGenerarDifCambio.Enabled = True
        Me.cmdCrearEntidad.Enabled = True
        Me.tdbtMonedaAdic.Enabled = True
        
        Me.tdbcTipoPago.Enabled = True
        
        strSalida = True
        SumarTotales
        
        Dim FilaInicio As Integer
        FilaInicio = NumeroFilas
        
        'FilaInicio = 1
        DoEvents
        
        If FilaInicio >= 1 Then
            On Error Resume Next
            tdbgDetalle_RowColChange 1, 1
            DoEvents
            
            tdbgDetalle.Bookmark = 0

            lArrDetalle(0, nColAsd_cModif) = 0

            'UpdateGrilla
            tdbgDetalle.RefreshRow
            
            DoEvents
        End If
        
        cmdRepetirGlosa.Enabled = True
        RefreshGrilla
        
        DoEvents
        
        tdbgDetalle.ReBind

        DoEvents
        gsUltimaGlosa = CE(tdbtObservaciones)
        gsKeyCodePress = False
        TimerKey.Enabled = False
        
        LlenarDatosCabecera
        
        pSetFocus dtpFecha
        
        DoEvents
        If tdbgAsientos.Columns(12).Value = "1" Then
            lblCalculoManual.Visible = True
        Else
            lblCalculoManual.Visible = False
        End If
        
        lblEstado.Visible = True
        
        gTerminaCargarNuevo = True
                
    Else
        Mensajes "No existe ningun registro seleccionado", vbInformation
        tbrOpciones.Buttons(5).Enabled = True
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       VerDatos
' Description:       Procedimiento que permite hacer una consulta al voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub VerDatos()
    lnOpcion = 2
    If datosLlenos = False Then
        Call LlenarCombos
        datosLlenos = True
    End If
    
    Call LlenarComboTipoMoneda
    
    If CE(tdbgAsientos.Columns(1).Value) <> "" Then
        
        Me.Caption = "PERIODO: " & tdbcMes & " " & gsAnio
        Me.lblEstado.Caption = "CONSULTA"
                
        tdbcTipoTx.BoundText = ""
        tdbcPagoIGV.BoundText = ""
        
        ActivarControl tdbcPagoIGV, False
        ActivarControl tdbcTipoTx, False
                
        tdbgDetalle.Splits(0).Locked = True
        With tdbgAsientos
             If .Columns(4).Value = lsLibroCajIng Or .Columns(4).Value = lsLibroCajEgr Or .Columns(4).Value = lsLibroDiario Then
                
                'Me.tdbcTipoOperacion.Visible = True
                'Label1(6).Visible = True 'ingreso / egreso
                Me.tdbnPorcIGV.Visible = False
                Label1(5).Visible = False 'IGV
                
             ElseIf .Columns(4).Value = lsLibroCom Or .Columns(4).Value = lsLibroVen Then
             
                'Me.tdbcTipoOperacion.Visible = False
                'Label1(6).Visible = False 'ingreso / egreso
                Me.tdbnPorcIGV.Visible = True
                Label1(5).Visible = True 'IGV
                
                Me.tdbnPorcIGV.Value = fIgv()
             Else
                
                Me.tdbnPorcIGV.Visible = False
                'Label1(6).Visible = False 'ingreso / egreso
                'Me.tdbcTipoOperacion.Visible = False
                Label1(5).Visible = False 'IGV
                
             End If
             
            '------- Habilita el ingreso de Operación de Caja ----------'
            Call VisualizaTipoOperacionCaja

            '---------
            Call CargaDatosRegistro(.Columns(1).Value, .Columns(2).Value, .Columns(4).Value, .Columns(6).Value, CONSULTA, .Columns(0).Value)
            Call IniciarCamposDocumento
                         
        End With
        
        sstAsientos.TabEnabled(1) = True
        sstAsientos.TabEnabled(0) = False
        
        sstAsientos.Tab = 1
        
        tbrOpciones.Buttons(1).Enabled = False
        tbrOpciones.Buttons(2).Enabled = False
        tbrOpciones.Buttons(3).Enabled = False
        tbrOpciones.Buttons(5).Enabled = False
        tbrOpciones.Buttons(6).Enabled = False
        
        tbrOpciones.Buttons(7).Image = 8
        tbrOpciones.Buttons(4).Enabled = False  ' *** Borrar
        OpcionModificar False
                        
        pSetFocus Me.SSTab1
        Me.tdbtNumVoucher.Enabled = False
        Me.tdbgDetalle.Columns(nColPla_cTipoAfect).Visible = False
        'Me.chkInafecto.Visible = True
        
        If lnOpcion = 2 Then 'SI ES CONSULTA DE VOUCHER
            tdbtMonedaAdic.Enabled = False
            
            Me.tdbcTipoPago.Enabled = False
        Else
            tdbtMonedaAdic.Enabled = True
            
            Me.tdbcTipoPago.Enabled = True
        End If
        
       If tdbcLibro.BoundText = lsLibroCom Then
            lblValorEmb.Visible = False
            tdbtMonedaAdic.Visible = False
            pctValorEmB.Visible = False
        ElseIf tdbcLibro.BoundText = lsLibroVen Then
            lblValorEmb.Visible = True
            tdbtMonedaAdic.Visible = True
            pctValorEmB.Visible = True
       End If
        
        Call OcultaCamposBimoneda
        
        cmdRepetirGlosa.Enabled = False
        
        strSalida = False
                
        Call LlenaComboBaseImponible

        SumarTotales
        tdbgDetalle_RowColChange 1, 1
        
        tdbgDetalle.Splits(0).Locked = True
        
        lblEstado.Visible = True
        
        If tdbgAsientos.Columns(12).Value = "1" Then
            lblCalculoManual.Visible = True
        Else
            lblCalculoManual.Visible = False
        End If
        
        If tdbcLibro.BoundText = lsLibroCom Then
            lblComp.Visible = True
            tdbtComprobante.Visible = True
        Else
            lblComp.Visible = False
            tdbtComprobante.Visible = False
        
        End If
        
    Else
        Mensajes "No existe ningun registro seleccionado", vbInformation
        tbrOpciones.Buttons(2).Enabled = True
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CargaDatosRegistro
' Description:       Procedimiento que carga los datos del voucher seleccionado
'
' Parameters :       año (String)
'                    periodo (String)
'                    Libro (String)
'                    Voucher (String)
'                    Caso (Tipo)
'                    Nummov (String)
'                    bNC (Boolean = False)
'                    nImporteMN (Double = 0)
'                    nImporteME (Double = 0)
'--------------------------------------------------------------------------------
Private Sub CargaDatosRegistro(año As String, periodo As String, Libro As String, Voucher As String, Caso As Tipo, Nummov As String, Optional bNC As Boolean = False, Optional nImporteMN As Double = 0, Optional nImporteME As Double = 0)
'    Dim rsArreglo As ADODB.Recordset
    Dim clDatos As clsMantoTablas
    Set clDatos = New clsMantoTablas
    Dim arrDatos() As Variant
    Dim valorDato  As String
    Dim Cont As Integer, nCol  As Integer
    Dim Cuenta As String
    Dim i As Long
    Dim cDH As String
    Dim nConst As Double
    Dim nAuxMN As Double
    Dim nAuxME As Double
    Dim nCalcMN As Double
    Dim nCalcME As Double
    Dim bTieneIGV As Boolean
    Dim bEsCtaXPC As Boolean
    Dim bTieneCtaBase As Boolean
    Dim bMsgNC As Boolean
    
    Dim cCuenta As String
    Dim cTipoEnt As String
    Dim cCodEnt As String
    Dim cTipoDoc As String
    Dim cSerieDoc As String
    Dim cNumDoc As String
    
    bMsgNC = False
    bEsCtaXPC = False
    bTieneCtaBase = False
    
    On Error GoTo serror
    Cont = 0
    ' *** NUM_FILAS = 2000
    NUM_FILAS = 100
    NUM_FILAS_ELIM = 100
    
    ' *** Cargando Datos del Asiento
    Dim sqlSp As String
    Dim cadena As String
    
    Screen.MousePointer = vbHourglass
    
    
    If Caso = CONSULTA Then
        cadena = "SEL_REG"
    Else
        cadena = "SEL_REG_EDIT"
    End If
    
    '******************
    If bNC = True Then
        cadena = "SEL_REG_EDIT_NC"
    End If
    '******************
    
    '-----------------------------------------------
    sqlSp = "spCn_ConsultaAsientos '" & cadena & "', '" & Nummov & "','" & gsEmpresa & _
            "', '" & año & "', '" & periodo & "', '" & Libro & "', '" & Voucher & "', '', '', '', ''"
            
    arrDatos = Array(sqlSp)
'    Set rsArreglo = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
    rsArreglo.ConnectionString = gsCadenaConexion
    rsArreglo.RecordSource = sqlSp
    rsArreglo.Refresh
    
    If rsArreglo Is Nothing Then
        Mensajes "El voucher no tiene detalle.", vbInformation
        Screen.MousePointer = vbDefault
        Set rsArreglo = Nothing
        
        lArrDetalle.Clear
        lArrDetalle.ReDim 0, 1, 0, NUM_COLUMNAS  ' filas

        Set tdbgDetalle.Array = lArrDetalle
        RefreshGrilla
        Set clDatos = Nothing
        Exit Sub
    End If
    
    '******************
    bTieneIGV = False
    bTieneCtaBase = False
    
    If bNC = True Then
        Do While Not rsArreglo.Recordset.EOF
            If Left(CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value), 2) = "40" Then
                bTieneIGV = True
            End If
            
            If Left(CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value), 1) = "6" Or Left(CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value), 1) = "9" Or Left(CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value), 1) = "7" Then
                bTieneCtaBase = True
            End If

            rsArreglo.Recordset.MoveNext
        Loop
        rsArreglo.Recordset.MoveFirst
    End If
    '******************
    
    If lnOpcion = 1 Then
        NUM_FILAS = rsArreglo.Recordset.RecordCount
    End If
    
    If lnOpcion = 2 Then
        NUM_FILAS = rsArreglo.Recordset.RecordCount - 1
    End If
    
    
    '--------------------------------------------------
    lArrDetalleElim.Clear
    
    If lnOpcion = 1 Then 'SI ES EDICION
        lArrDetalleElim.ReDim 0, NUM_FILAS_ELIM, 0, NUM_COLUMNAS   ' filas
    Else
        lArrDetalleElim.ReDim 0, 0, 0, NUM_COLUMNAS   ' filas
    End If
    '--------------------------------------------------
    lArrDetalle.Clear
    lArrDetalle.ReDim 0, NUM_FILAS, 0, NUM_COLUMNAS
    '--------------------------------------------------
    lArrDetalleTemp.Clear
    
    If lnOpcion = 1 Then 'SI ES EDICION
        lArrDetalleTemp.ReDim 0, NUM_FILAS, 0, NUM_COLUMNAS
    Else
        lArrDetalleTemp.ReDim 0, 0, 0, NUM_COLUMNAS
    End If
    
    ' ----- Cargando datos de la cabecera ------
    
    lNumInterno = rsArreglo.Recordset.Fields("Ase_cNumMov")
    
    'PGBV - 05012013
    If IsNull(rsArreglo.Recordset.Fields("Asd_cEstadoO")) Then
        EstadoOri = ""
    Else
        EstadoOri = rsArreglo.Recordset.Fields("Asd_cEstadoO")
    End If
    
    LlenaIngresoEgreso Libro
    Me.tdbcLibro.BoundText = Libro
    
    DoEvents
    'tdbcLibro_ItemChange
    tdbcLibro_LostFocus
    
    Me.tdbcMoneda.BoundText = CE(rsArreglo.Recordset.Fields("Ase_cTipoMoneda"))
    Me.tdbtObservaciones = CE(rsArreglo.Recordset.Fields("Ase_cGlosa"))
    
    '*****************
    If bNC = False Then
        Me.tdbtNumVoucher = CE(rsArreglo.Recordset.Fields("Ase_nVoucher"))
        Me.dtpFecha = CE(rsArreglo.Recordset.Fields("Ase_dFecha"))
        gsUltimaFcha = CE(rsArreglo.Recordset.Fields("Ase_dFecha"))
        tdbcTipoOperacion.BoundText = CE(rsArreglo.Recordset.Fields("ASE_COPERACAJA"))
        gsMonedaGuardada = tdbcMoneda.BoundText
        gsUltimaGlosa = tdbtObservaciones
    End If
    '*****************
    i = 0
'    rsArreglo.Recordset.GetRows 1, 14, 82
    While Not rsArreglo.Recordset.EOF
        If tdbnPorcIGV = 0 Then
           tdbnPorcIGV = CE(rsArreglo.Recordset.Fields("Imp_nPorcentaje").Value)
        End If
            
        i = i + 1
        'If CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value) = "63002" Then
            'Debug.Print CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value) & " - " & CE(rsArreglo.Recordset.Fields("Cos_cDescripcion").Value)
        'End If
        lArrDetalle(i - 1, nColAsd_nItem) = CE(rsArreglo.Recordset.Fields("Asd_nItem").Value)
        lArrDetalle(i - 1, nColPla_cCuentaContable) = CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value)
        lArrDetalle(i - 1, nColPla_cTipoAfect) = CE(rsArreglo.Recordset.Fields("Pla_cTipoAfect").Value)
        lArrDetalle(i - 1, nColPla_cNombreCuenta) = CE(rsArreglo.Recordset.Fields("Pla_cNombreCuenta").Value)
        lArrDetalle(i - 1, nCol_cFlgCCosto) = CE(rsArreglo.Recordset.Fields("Pla_cCentroCosto").Value)
        lArrDetalle(i - 1, nCol_cFlgProv) = CE(rsArreglo.Recordset.Fields("Pla_cProvision").Value)
        lArrDetalle(i - 1, nColAsd_cGlosa) = CE(rsArreglo.Recordset.Fields("Asd_cGlosa").Value)
        '-----------------------------------------------'
        lArrDetalle(i - 1, nColAsd_nMontoInafecto) = CE(rsArreglo.Recordset.Fields("Asd_nMontoInafecto").Value)
        lArrDetalle(i - 1, nColCos_cCodigo) = CE(rsArreglo.Recordset.Fields("Cos_cCodigo").Value)
        lArrDetalle(i - 1, nCol_cTipoEntiCta) = CE(rsArreglo.Recordset.Fields("TipoEntiCta").Value)
        lArrDetalle(i - 1, nColTen_cTipoEntidad) = CE(rsArreglo.Recordset.Fields("Ten_cTipoEntidad").Value)
        lArrDetalle(i - 1, nColEnt_cCodEntidad) = CE(rsArreglo.Recordset.Fields("Ent_cCodEntidad").Value)
        lArrDetalle(i - 1, nColEnt_cPersona) = CE(rsArreglo.Recordset.Fields("Ent_cPersona").Value)
        lArrDetalle(i - 1, nColAsd_cTipoDoc) = CE(rsArreglo.Recordset.Fields("Asd_cTipoDoc").Value)
        
        '**********************
        If bNC = True Then
            If CE(rsArreglo.Recordset.Fields("Pla_cDocumento").Value) = "1" Then
                lArrDetalle(i - 1, nColAsd_cTipoDoc) = BuscaValorEnOp("012")
            Else
                lArrDetalle(i - 1, nColAsd_cTipoDoc) = ""
            End If
        End If
        '**********************
        lArrDetalle(i - 1, nColAsd_cSerieDoc) = CE(rsArreglo.Recordset.Fields("Asd_cSerieDoc").Value)
        lArrDetalle(i - 1, nColAsd_cNumDoc) = CE(rsArreglo.Recordset.Fields("Asd_cNumDoc").Value)
        
        lArrDetalle(i - 1, nColAsd_cNomTD) = BuscaTDArray(CE(rsArreglo.Recordset.Fields("Asd_cTipoDoc").Value))
        lArrDetalle(i - 1, nColAsd_cNomCC) = CE(rsArreglo.Recordset.Fields("Cos_cDescripcion").Value)
        
        '---------------- TIPO DE MONEDA ---------------------'
        lArrDetalle(i - 1, nColAsd_cNomMoneda) = CE(rsArreglo.Recordset.Fields("NomMoneCorto"))
        lArrDetalle(i - 1, nColAsd_cTipoMoneda) = CE(rsArreglo.Recordset.Fields("Asd_cTipoMoneda"))
        
        lArrDetalle(i - 1, nCol_cFlgMonNac) = CE(rsArreglo.Recordset.Fields("FlgMonNac").Value)
        lArrDetalle(i - 1, nColAsd_cMonedaCalculo) = CE(rsArreglo.Recordset.Fields("Asd_cMonedaCalculo").Value)
        
        '---------------- TIPO DE CAMBIO ---------------------'
        lArrDetalle(i - 1, nColAsd_cOperaTC) = CE(rsArreglo.Recordset.Fields("Asd_cOperaTC"))
        lArrDetalle(i - 1, nColAsd_nTipoCambio) = rsArreglo.Recordset.Fields("Asd_nTipoCambio").Value
        
        '**************
        If bNC = True And nImporteME = 0 Then
            lArrDetalle(i - 1, nColAsd_cOperaTC) = "SCV"
            lArrDetalle(i - 1, nColAsd_nTipoCambio) = 0
            
            lArrDetalle(i - 1, nColAsd_cNomMoneda) = gsMonedaNacAbrev
            lArrDetalle(i - 1, nColAsd_cTipoMoneda) = gsMonedaNac
            
            lArrDetalle(i - 1, nCol_cFlgMonNac) = "1"
            lArrDetalle(i - 1, nColAsd_cMonedaCalculo) = "1"
            
        End If
        '**************
        
        '---------------- MONTOS  ---------------------'
        If bNC = False Then
            lArrDetalle(i - 1, nColAsd_nDebeSoles) = rsArreglo.Recordset.Fields("Asd_nDebeSoles").Value
            lArrDetalle(i - 1, nColAsd_nDebeMonExt) = rsArreglo.Recordset.Fields("Asd_nDebeMonExt").Value
            lArrDetalle(i - 1, nColAsd_nHaberSoles) = rsArreglo.Recordset.Fields("Asd_nHaberSoles").Value
            lArrDetalle(i - 1, nColAsd_nHaberMonExt) = rsArreglo.Recordset.Fields("Asd_nHaberMonExt").Value
        Else
            If NE(rsArreglo.Recordset.Fields("Asd_nDebeSoles").Value) - NE(rsArreglo.Recordset.Fields("Asd_nHaberSoles").Value) > 0 Then
                cDH = "H"
            Else
                cDH = "D"
            End If
            
            nCalcMN = 0
            nCalcME = 0
            
            If CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value) <> gsCuentaDifGan And _
               CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value) <> gsCuentaDifPer And _
               CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value) <> gsCuentaRedGan And _
               CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value) <> gsCuentaRedPer Then
            
                Cuenta = CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value)
                
                If BuscaCuentaEnConfigOP(Cuenta, "009") Or BuscaCuentaEnConfigOP(Cuenta, "010") Then
                    nCalcMN = nImporteMN
                    nCalcME = nImporteME
                    
                    bEsCtaXPC = True
                Else
                    bEsCtaXPC = False
                End If
                
                If bTieneIGV = True Then
                    If Left(CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value), 2) = "40" Then
                        nConst = 1 + (tdbnPorcIGV.Value / 100)
                        nAuxMN = Redondear(nImporteMN / nConst, 2)
                        nAuxME = Redondear(nImporteME / nConst, 2)
                    
                        nCalcMN = nImporteMN - nAuxMN
                        nCalcME = nImporteME - nAuxME
                    End If

                     If Left(CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value), 2) <> "40" And _
                        bEsCtaXPC = False Then
                       
                        nConst = 1 + (tdbnPorcIGV.Value / 100)
                        nCalcMN = Redondear(nImporteMN / nConst, 2)
                        nCalcME = Redondear(nImporteME / nConst, 2)
                    End If
                Else
                    nCalcMN = nImporteMN
                    nCalcME = nImporteME
                End If
            End If
            
            If NE(lArrDetalle(i - 1, nColAsd_nTipoCambio)) > 0 And nCalcME > 0 Then
                nCalcMN = Redondear(nCalcME * NE(lArrDetalle(i - 1, nColAsd_nTipoCambio)), 2)
            End If
            
            If bTieneCtaBase = True And Left(CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value), 2) = "49" Or Left(CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value), 2) = "38" Then
                nCalcMN = 0
                nCalcME = 0
                
                bMsgNC = True
            End If
            
            lArrDetalle(i - 1, nColAsd_nDebeSoles) = IIf(cDH = "D", nCalcMN, 0)
            lArrDetalle(i - 1, nColAsd_nDebeMonExt) = IIf(cDH = "D", nCalcME, 0)
            lArrDetalle(i - 1, nColAsd_nHaberSoles) = IIf(cDH = "H", nCalcMN, 0)
            lArrDetalle(i - 1, nColAsd_nHaberMonExt) = IIf(cDH = "H", nCalcME, 0)
        
        End If
        
        '---------------- FECHAS DOC, VENC, AUX ----------------'
        If rsArreglo.Recordset.Fields("Asd_dFecDoc").Value = "01/01/1900" Then
           lArrDetalle(i - 1, nColAsd_dFecDoc) = Null
        Else
           lArrDetalle(i - 1, nColAsd_dFecDoc) = CE(rsArreglo.Recordset.Fields("Asd_dFecDoc").Value)
        End If
        '*******************
        If bNC = True And CE(rsArreglo.Recordset.Fields("Pla_cDocumento").Value) = "0" Then
            lArrDetalle(i - 1, nColAsd_dFecDoc) = Me.dtpFecha.Value
        End If
        '*******************
        
        If rsArreglo.Recordset.Fields("Asd_dFecVen").Value = "01/01/1900" Then
           lArrDetalle(i - 1, nColAsd_dFecVen) = Null
        Else
           lArrDetalle(i - 1, nColAsd_dFecVen) = CE(rsArreglo.Recordset.Fields("Asd_dFecVen").Value)
        End If
        
        lArrDetalle(i - 1, nColAsd_dFecDocAux) = CE(lArrDetalle.Value(i - 1, nColAsd_dFecDoc))
        
        '------------- FLAG DE COMBO PAGO IGV ----------------'
        lArrDetalle(i - 1, nColAsd_cFormaPago) = CE(rsArreglo.Recordset.Fields("Asd_cFormaPago").Value)
        lArrDetalle(i - 1, nCol_cFlgDetRet) = CE(rsArreglo.Recordset.Fields("Asd_cRetencion").Value)
        

        If bNC = True And CE(rsArreglo.Recordset.Fields("Asd_cRetencion").Value) <> "" Then
            lArrDetalle(i - 1, nColAsd_cFormaPago) = "008"
        End If
        
        '---------- DOCUMENTOS DE REFERENCIA -----------------'
        lArrDetalle(i - 1, nColAsd_cTipoDocRef) = CE(rsArreglo.Recordset.Fields("Asd_cTipoDocRef").Value)
        lArrDetalle(i - 1, nColAsd_cSerieDocRef) = CE(rsArreglo.Recordset.Fields("Asd_cSerieDocRef").Value)
        lArrDetalle(i - 1, nColAsd_cNumDocRef) = CE(rsArreglo.Recordset.Fields("Asd_cNumDocRef").Value)
            
        If rsArreglo.Recordset.Fields("Asd_dFecDocRef").Value = "01/01/1900" Then
           lArrDetalle(i - 1, nColAsd_dFecDocRef) = Null
        Else
           lArrDetalle(i - 1, nColAsd_dFecDocRef) = CE(rsArreglo.Recordset.Fields("Asd_dFecDocRef").Value)
        End If
        
        '------------------------------------------------------'
        If bNC = True And CE(rsArreglo.Recordset.Fields("Pla_cDocumento").Value) = "1" Then
            lArrDetalle(i - 1, nColAsd_cTipoDocRef) = CE(rsArreglo.Recordset.Fields("Asd_cTipoDoc").Value)
            lArrDetalle(i - 1, nColAsd_cSerieDocRef) = CE(rsArreglo.Recordset.Fields("Asd_cSerieDoc").Value)
            lArrDetalle(i - 1, nColAsd_cNumDocRef) = CE(rsArreglo.Recordset.Fields("Asd_cNumDoc").Value)
            lArrDetalle(i - 1, nColAsd_dFecDocRef) = CE(rsArreglo.Recordset.Fields("Asd_dFecDoc").Value)
        End If
        
        '---------- DOCUMENTO DE DEPOSITO ---------------------'
        lArrDetalle(i - 1, nColAsd_cNumSpot) = CE(rsArreglo.Recordset.Fields("Asd_cNumSpot").Value)
        
        If rsArreglo.Recordset.Fields("Asd_dFechaSpot").Value = "01/01/1900" Then
           lArrDetalle(i - 1, nColAsd_dFechaSpot) = Null
        Else
           lArrDetalle(i - 1, nColAsd_dFechaSpot) = CE(rsArreglo.Recordset.Fields("Asd_dFechaSpot").Value)
        End If
        '-------------------------------------------------------'
        
        lArrDetalle(i - 1, nColAsd_cDestino) = CE(rsArreglo.Recordset.Fields("Asd_cDestino").Value)
        lArrDetalle(i - 1, nColAsd_nCorre) = CE(rsArreglo.Recordset.Fields("Asd_nCorre").Value)

        lArrDetalle(i - 1, nColPla_cDocumento) = CE(rsArreglo.Recordset.Fields("Pla_cDocumento").Value)
        lArrDetalle(i - 1, nCol_nPorceImp) = NE(rsArreglo.Recordset.Fields("Imp_nPorcentaje"))
        lArrDetalle(i - 1, nColTra_cCodigo) = CE(rsArreglo.Recordset.Fields("Tra_cCodigo").Value)
        
        lArrDetalle(i - 1, nColAsd_cBaseImp) = CE(rsArreglo.Recordset.Fields("Asd_cBaseImp").Value)
        lArrDetalle(i - 1, nColPla_cDetraccion) = CE(rsArreglo.Recordset.Fields("Pla_cDetraccion").Value)
        lArrDetalle(i - 1, nColPla_cRetencion) = CE(rsArreglo.Recordset.Fields("Pla_cRetencion").Value)
        lArrDetalle(i - 1, nColPla_cPercepcion) = CE(rsArreglo.Recordset.Fields("Pla_cPercepcion").Value)
        lArrDetalle(i - 1, nColPla_cNCND) = CE(rsArreglo.Recordset.Fields("Pla_cNCND").Value)
        
        lArrDetalle(i - 1, nColAsd_cComprobante) = CE(rsArreglo.Recordset.Fields("Asd_cComprobante").Value)
        
        If CE(rsArreglo.Recordset.Fields("Pla_cCentroCosto").Value) = "0" Then
            lArrDetalle(i - 1, nColAsd_cProceso) = ""
        Else
            lArrDetalle(i - 1, nColAsd_cProceso) = CE(rsArreglo.Recordset.Fields("Asd_cProceso").Value)
        End If

'       lArrDetalle(i - 1, nColAsd_cMonAdic) = CE(rsArreglo.Recordset.Fields("Asd_cMonAdic").Value)
        lArrDetalle(i - 1, nColAsd_cImpAdic) = NE(rsArreglo.Recordset.Fields("Asd_cImpAdic").Value)
                
        lArrDetalle(i - 1, nColAsd_nSaldoProv) = 0
        lArrDetalle(i - 1, nColAsd_nSaldoExtProv) = 0
        
'        If LTrim(RTrim(rsArreglo.Recordset.Fields("Asd_cProvCanc").Value)) <> "" Then MsgBox rsArreglo.Recordset.Fields("Asd_cProvCanc").Value
        lArrDetalle(i - 1, nColAsd_cProvCanc) = CE(rsArreglo.Recordset.Fields("Asd_cProvCanc").Value)
        lArrDetalle(i - 1, nColAsd_cModif) = 0
                
        '-------------------------------------------------------------------------------
        If CE(rsArreglo.Recordset.Fields("Asd_cProvCanc")) = "P" Or CE(rsArreglo.Recordset.Fields("Asd_cProvCanc")) = "C" Then
           
            lArrDetalle(i - 1, nColAsd_cEntTipSerNum) = BuscaEntTipSerNum(i - 1)
        Else
            lArrDetalle(i - 1, nColAsd_cEntTipSerNum) = ""
        End If
        
        '-------------------------------------------------------------------------------
        If CE(rsArreglo.Recordset.Fields("Asd_cProvCanc")) = "C" Then
            lArrDetalle(i - 1, nColAsd_cCanc) = "C"
        Else
            lArrDetalle(i - 1, nColAsd_cCanc) = ""
        End If
        
        lArrDetalle(i - 1, nColAsd_cGrupo) = CE(rsArreglo.Recordset.Fields("Asd_cGrupo").Value)
        '-------------------------------------------------------------------------------
        
        If bNC = False Then
            gsCorrelProv = NE(rsArreglo.Recordset.Fields("Asd_nCorre").Value)
            valorDato = ExisteDocumentoProviEntidad(Nummov, Voucher, NE(rsArreglo.Recordset.Fields("Asd_nCorre")))
        Else
            gsCorrelProv = 0
            valorDato = ""
        End If
        '-------------------------------------------------------------------------------
        If Libro = lsLibroApe Then
            If CE(lArrDetalle(i - 1, nColAsd_cProvCanc)) = "P" And _
               valorDato <> "" And _
               CE(lArrDetalle(i - 1, nCol_cFlgProv)) = "1" And _
               CE(lArrDetalle(i - 1, nColAsd_nCorre)) > "0" Then
    
                lArrDetalle(i - 1, nColAsd_Cancelado) = "1"
            Else
                lArrDetalle(i - 1, nColAsd_Cancelado) = ""
            End If
        Else
            If CE(lArrDetalle(i - 1, nColAsd_cProvCanc)) = "P" Then
                cCuenta = CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value)
                cTipoEnt = CE(rsArreglo.Recordset.Fields("Ten_cTipoEntidad").Value)
                cCodEnt = CE(rsArreglo.Recordset.Fields("Ent_cCodEntidad").Value)
                cTipoDoc = CE(rsArreglo.Recordset.Fields("Asd_cTipoDoc").Value)
                cSerieDoc = CE(rsArreglo.Recordset.Fields("Asd_cSerieDoc").Value)
                cNumDoc = CE(rsArreglo.Recordset.Fields("Asd_cNumDoc").Value)
    
                If TieneCancelacion(gsEmpresa, año, periodo, Libro, Voucher, Nummov, cCuenta, cTipoEnt, cCodEnt, cTipoDoc, cSerieDoc, cNumDoc) <> "" Then
                    lArrDetalle(i - 1, nColAsd_Cancelado) = "1"
                Else
                    lArrDetalle(i - 1, nColAsd_Cancelado) = ""
                End If
            Else
                lArrDetalle(i - 1, nColAsd_Cancelado) = ""
            End If
        End If
        '-------------------------------------------------------------------------------
        lArrDetalle(i - 1, nColAsd_cGuardado) = "S"

        If CE(lArrDetalle(i - 1, nCol_cFlgProv)) = "1" And gsCorrelProv = 0 And _
           CE(rsArreglo.Recordset.Fields("Asd_cTipoDoc").Value) <> "" And _
           CE(rsArreglo.Recordset.Fields("Asd_cSerieDoc").Value) <> "" And _
           CE(rsArreglo.Recordset.Fields("Asd_cNumDoc").Value) <> "" Then
           
            lArrDetalle(i - 1, nColAsd_cGuardado) = "N"
            Cont = Cont + 1
        End If
        
        '**********************
        If bNC = True Then
            lArrDetalle(i - 1, nColAsd_cGuardado) = "N"
            lArrDetalle(i - 1, nColAsd_cModif) = 1
        End If
        '**********************
        
        lArrDetalle(i - 1, nColAsd_cDetalle) = BuscaLineaDetalle(i - 1)
        lArrDetalle(i - 1, nColAsd_cDetNac) = BuscaLineaNac(i - 1)
        lArrDetalle(i - 1, nColAsd_cDetExt) = BuscaLineaExt(i - 1)
        lArrDetalle(i - 1, nColAsd_cDetCorrel) = NE(rsArreglo.Recordset.Fields("Asd_nCorre").Value)
        lArrDetalle(i - 1, nColAsd_cDetProvCanc) = CE(rsArreglo.Recordset.Fields("Asd_cProvCanc").Value)
        lArrDetalle(i - 1, nColAsd_cDetOtros) = BuscaLineaOtros(i - 1)
        lArrDetalle(i - 1, nColAsd_cDetProv) = BuscaLineaProv(i - 1)
        
        Cuenta = CE(rsArreglo.Recordset.Fields("Pla_cCuentaContable").Value)
        
        If BuscaCuentaEnConfigOP(Cuenta, "009") = True Then
           lArrDetalle(i - 1, nColAsd_cCtaPagCob) = "CC"
        Else
            If BuscaCuentaEnConfigOP(Cuenta, "010") = True Then
               lArrDetalle(i - 1, nColAsd_cCtaPagCob) = "CP"
               
               If lArrDetalle(i - 1, nColAsd_cDetProvCanc) = "C" Then
                  lArrDetalle(i - 1, nColAsd_cCanc) = "C"
               End If
            Else
               lArrDetalle(i - 1, nColAsd_cCtaPagCob) = ""
            End If
        End If
        lArrDetalle(i - 1, nColAsd_cEcpOperacion) = CE(rsArreglo.Recordset.Fields("ECP_COPERACION").Value)
        lArrDetalle(i - 1, nColAsd_cRegAux) = NE(rsArreglo.Recordset.Fields("Asd_cRegAux").Value)
        lArrDetalle(i - 1, nColAsd_cRegAuxDet) = CE(rsArreglo.Recordset.Fields("Asd_cRegAuxDet").Value)
        lArrDetalle(i - 1, nColAsd_cManual) = CE(rsArreglo.Recordset.Fields("Asd_cManual").Value)

        '-------------------------------------------------------------------------------
        lArrDetalle(i - 1, nColAsd_cXCtaEntTipSerNumFijo) = RetornaCtaEntTipSerNum(i - 1)
        lArrDetalle(i - 1, nColAsd_cXImportes) = RetornaImportes(i - 1)
        lArrDetalle(i - 1, nColAsd_cXOtrosVal) = RetornaOtros(i - 1)
        
        lArrDetalle(i - 1, nColAsd_nNacional) = NE(lArrDetalle(i - 1, nColAsd_nDebeSoles)) + NE(lArrDetalle(i - 1, nColAsd_nHaberSoles))
        lArrDetalle(i - 1, nColAsd_nExtranjera) = NE(lArrDetalle(i - 1, nColAsd_nDebeMonExt)) + NE(lArrDetalle(i - 1, nColAsd_nHaberMonExt))
        
        lArrDetalle(i - 1, nColAsd_nTCAlmacenado) = NE(rsArreglo.Recordset.Fields("Asd_nTipoCambio").Value)
        
        lArrDetalle(i - 1, nColAsd_nImporteEditado) = "0"
        '-------------------------------------------------------------------------------
        
        lArrDetalle(i - 1, nColAsd_cCodConcepto) = CE(rsArreglo.Recordset.Fields("Asd_cCodConcepto").Value)
        
        lArrDetalle(i - 1, nColAsd_cDesConcepto) = CE(rsArreglo.Recordset.Fields("Asl_cDescripcion").Value)
        
        '--------------------------------------------------------------------------------
        
        If lnOpcion = 1 Then 'SI ES EDICION
            For nCol = 0 To NUM_COLUMNAS - 1
                lArrDetalleTemp(i - 1, nCol) = lArrDetalle(i - 1, nCol)
            Next nCol
        End If
        
        rsArreglo.Recordset.MoveNext
        DoEvents
    Wend
    On Error Resume Next
    tdbgDetalle.Refresh
    tdbgDetalle.ReBind
    
    Set tdbgDetalle.Array = lArrDetalle
    
    lItem = i
    
    Call CerrarRecordSet(rsArreglo)
    
    On Error Resume Next
    tdbgDetalle.Bookmark = 0
    
    Call SumarTotales
    Call ActivaComboTipoIGV(lArrDetalle(0, nColPla_cDetraccion), _
                            lArrDetalle(0, nColPla_cRetencion), _
                            lArrDetalle(0, nColPla_cPercepcion))
    
    Call LlenaCajaTextoPagoIGV

    DoEvents
    RefreshGrilla
    DoEvents
    tdbgDetalle.ReBind
    
    If bMsgNC = True Then
        UpdateGrilla
        Mensajes "Verifique la distribucion de los importes de la NOTA DE CREDITO creada"
    End If
    GoTo PASONORMAL
serror:
    MsgBox Err.Description
'    Resume
    
PASONORMAL:
    Screen.MousePointer = vbDefault
    Set clDatos = Nothing
        
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CompletaCerosCampos
' Description:       Procedimiento que completa los ceros al codigo entidad, tipo , serie y numero de documento
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub CompletaCerosCampos()
    
    If lArrDetalle Is Nothing Then
       Exit Sub
    End If
    
    Dim Entidad As String
    Dim Tipo As String
    Dim Serie As String
    Dim Numero As String
    Dim iFila As Integer
    
    
    iFila = NE(tdbgDetalle.Bookmark)
    If iFila < 0 Then iFila = 0
    
    On Error Resume Next
    
    Entidad = CE(tdbgDetalle.Columns(nColEnt_cCodEntidad))
    If Len(Entidad) < 5 And Entidad <> "" Then Entidad = Right("00000" & Entidad, 5)
    '-------------------------------------------------------------------------
    Tipo = CE(tdbgDetalle.Columns(nColAsd_cTipoDoc))
    If Len(Tipo) < 2 And Tipo <> "" Then Tipo = Right("00" & Tipo, 2)
    '*****SE QUITO ESTE IF POR PROBLEMAS CON LA RESOLUCION 234-SUNAT QUE EXISTE EL DOCUMENTO 00 (TMF PERU)*****
'    If Tipo = "00" Then
'        tdbgDetalle.Columns(nColAsd_cTipoDoc) = ""
'        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
'        Tipo = ""
'    End If
    '-------------------------------------------------------------------------
    Serie = CE(tdbgDetalle.Columns(nColAsd_cSerieDoc))
    If Len(Serie) < 3 And Serie <> "" Then Serie = Right("000" & Serie, 3)
    '-------------------------------------------------------------------------
    Numero = CE(tdbgDetalle.Columns(nColAsd_cNumDoc))
    If Len(Numero) < 8 And Numero <> "" Then Numero = Right("00000000" & Numero, 8)
    '-------------------------------------------------------------------------
    
    lArrDetalle(iFila, nColEnt_cCodEntidad) = Entidad
    lArrDetalle(iFila, nColAsd_cTipoDoc) = Tipo
    lArrDetalle(iFila, nColAsd_cSerieDoc) = Serie
    lArrDetalle(iFila, nColAsd_cNumDoc) = Numero
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       pUpdateArray
' Description:       Procedimiento que actualiza el array del detalle
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub pUpdateArray()
    
    If lArrDetalle Is Nothing Then
       Exit Sub
    End If
    
    Dim iFila As Integer
    
    iFila = (tdbgDetalle.Bookmark)
    If iFila < 0 Then iFila = 0
    
    On Error GoTo serror
    '-------------------------------------------------------------------------
    lArrDetalle(iFila, nColEnt_cCodEntidad) = (tdbgDetalle.Columns(nColEnt_cCodEntidad))
    lArrDetalle(iFila, nColPla_cCuentaContable) = (tdbgDetalle.Columns(nColPla_cCuentaContable))
    lArrDetalle(iFila, nColCos_cCodigo) = (tdbgDetalle.Columns(nColCos_cCodigo))
    lArrDetalle(iFila, nColAsd_dFecDoc) = (tdbgDetalle.Columns(nColAsd_dFecDoc))
    lArrDetalle(iFila, nColAsd_dFecVen) = (tdbgDetalle.Columns(nColAsd_dFecVen))
    lArrDetalle(iFila, nColAsd_nItem) = (tdbgDetalle.Columns(nColAsd_nItem))
    
    lArrDetalle(iFila, nColAsd_cNumDoc) = (tdbgDetalle.Columns(nColAsd_cNumDoc))
    lArrDetalle(iFila, nColAsd_cSerieDoc) = (tdbgDetalle.Columns(nColAsd_cSerieDoc))
    lArrDetalle(iFila, nColAsd_cTipoDoc) = (tdbgDetalle.Columns(nColAsd_cTipoDoc))
    
    If lArrDetalle(iFila, nColPla_cCuentaContable) <> "" Then
       lArrDetalle(iFila, nColAsd_nTipoCambio) = (tdbgDetalle.Columns(nColAsd_nTipoCambio))
       lArrDetalle(iFila, nColAsd_nDebeSoles) = (tdbgDetalle.Columns(nColAsd_nDebeSoles))
       lArrDetalle(iFila, nColAsd_nHaberSoles) = (tdbgDetalle.Columns(nColAsd_nHaberSoles))
       lArrDetalle(iFila, nColAsd_nDebeMonExt) = (tdbgDetalle.Columns(nColAsd_nDebeMonExt))
       lArrDetalle(iFila, nColAsd_nHaberMonExt) = (tdbgDetalle.Columns(nColAsd_nHaberMonExt))
    End If

    Exit Sub
    
serror:
    Mensajes "ERROR"
End Sub


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaEntTipSerNum
' Description:       Funcion que retorna la llave principal de la linea del voucher
'
' Parameters :       Fila (Integer)
'--------------------------------------------------------------------------------
Private Function BuscaEntTipSerNum(Fila As Long) As String
    Dim Entidad As String
    Dim Tipo As String
    Dim Serie As String
    Dim Numero As String
    Dim Cuenta As String
    
    If lArrDetalle Is Nothing Then
       Exit Function
    End If
    
    On Error Resume Next
    Cuenta = CE(lArrDetalle(Fila, nColPla_cCuentaContable))
    '-------------------------------------------------------------------------
    If CE(lArrDetalle(Fila, nColEnt_cCodEntidad)) <> "" Then
        Entidad = CE(lArrDetalle(Fila, nColEnt_cCodEntidad))
        If Len(Entidad) < 5 Then Entidad = Right("00000" & Entidad, 5)
    End If
    '-------------------------------------------------------------------------
    If CE(lArrDetalle(Fila, nColAsd_cTipoDoc)) <> "" Then
        Tipo = Right("00" & CE(lArrDetalle(Fila, nColAsd_cTipoDoc)), 2)
        If Len(Tipo) < 2 Then Tipo = Right("00" & Tipo, 2)
    End If
    '-------------------------------------------------------------------------
    If CE(lArrDetalle(Fila, nColAsd_cSerieDoc)) <> "" Then
        Serie = CE(lArrDetalle(Fila, nColAsd_cSerieDoc))
        If Len(Serie) < 3 And Serie <> "" Then Serie = Right("0000" & Serie, 4)
    End If
    '-------------------------------------------------------------------------
    If CE(lArrDetalle(Fila, nColAsd_cNumDoc)) <> "" Then
        Numero = CE(lArrDetalle(Fila, nColAsd_cNumDoc))
        If Len(Numero) < 8 And Numero <> "" Then Numero = Right("00000000" & Numero, 8)
    End If
    '-------------------------------------------------------------------------
    BuscaEntTipSerNum = Cuenta & Entidad & Tipo & Serie & Numero
    
End Function


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       VerificaModificoLinea
' Description:       Funcion que determina si se modifico toda la linea deldetalle del voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub VerificaModificoLinea()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    Dim i As Long
    For i = 0 To NUM_FILAS - 1
        If (ModificoLinea(i) = True Or ModificoLineaOtros(i) = True) And NE(lArrDetalle(i, nColAsd_cModif)) = 0 Then
           lArrDetalle(i, nColAsd_cModif) = 1
        End If
    Next i

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ModificoLineaOtros
' Description:       Procedimiento que verifica si se modifico los campos otros
'
' Parameters :       Fila (Integer)
'--------------------------------------------------------------------------------
Private Function ModificoLineaOtros(Fila As Long) As Boolean
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If

    ModificoLineaOtros = False
    tdbgDetalle.RefreshRow
    
    If BuscaLineaOtros(Fila) <> CE(lArrDetalle(Fila, nColAsd_cDetOtros)) Then
        ModificoLineaOtros = True
        Exit Function
    End If
    
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ModificoProv
' Description:       Funcion que determina si se modifico la linea del documento provisionado
'
' Parameters :       Fila (Integer)
'--------------------------------------------------------------------------------
Private Function ModificoProv(Fila As Long) As Boolean
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If

    ModificoProv = False
    
    If BuscaLineaProv(Fila) <> CE(lArrDetalle(Fila, nColAsd_cDetProv)) Then
        ModificoProv = True
        Exit Function
    End If
    
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ModificoLinea
' Description:       Funcion que determina si se modifico la linea del detalle y los importes
'
' Parameters :       Fila (Integer)
'--------------------------------------------------------------------------------
Private Function ModificoLinea(Fila As Long) As Boolean
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If

    ModificoLinea = False
    UpdateGrilla
    
    'tdbgDetalle.RefreshRow
    
    If BuscaLineaDetalle(Fila) <> CE(lArrDetalle(Fila, nColAsd_cDetalle)) Then
        ModificoLinea = True
        Exit Function
    End If
    
    If BuscaLineaNac(Fila) <> NE(lArrDetalle(Fila, nColAsd_cDetNac)) Then
        ModificoLinea = True
        Exit Function
    End If
    
    If BuscaLineaExt(Fila) <> NE(lArrDetalle(Fila, nColAsd_cDetExt)) Then
        ModificoLinea = True
        Exit Function
    End If
    
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaLineaOtros
' Description:       Funcion que busca los datos de tipo referencial del detalle
'
' Parameters :       Fila (Integer)
'--------------------------------------------------------------------------------
Private Function BuscaLineaOtros(Fila As Long) As String
    If lArrDetalle Is Nothing Then
        Exit Function
    End If
    On Error Resume Next
    BuscaLineaOtros = CE(lArrDetalle(Fila, nColPla_cTipoAfect)) & _
                      CE(lArrDetalle(Fila, nColAsd_cGlosa)) & _
                      CE(lArrDetalle(Fila, nColAsd_nMontoInafecto)) & _
                      CE(lArrDetalle(Fila, nCol_cFlgDetRet)) & _
                      CE(lArrDetalle(Fila, nColAsd_cTipoDocRef)) & _
                      CE(lArrDetalle(Fila, nColAsd_cSerieDocRef)) & _
                      CE(lArrDetalle(Fila, nColAsd_cNumDocRef)) & _
                      CE(lArrDetalle(Fila, nColAsd_dFecDocRef)) & _
                      CE(lArrDetalle(Fila, nColAsd_cNumSpot)) & _
                      CE(lArrDetalle(Fila, nColAsd_dFechaSpot)) & _
                      CE(lArrDetalle(Fila, nColTra_cCodigo)) & _
                      CE(lArrDetalle(Fila, nColAsd_cFormaPago)) & _
                      CE(lArrDetalle(Fila, nColAsd_cBaseImp)) & _
                      CE(lArrDetalle(Fila, nColPla_cDetraccion)) & _
                      CE(lArrDetalle(Fila, nColPla_cRetencion)) & _
                      CE(lArrDetalle(Fila, nColPla_cPercepcion)) & _
                      CE(lArrDetalle(Fila, nColAsd_cMonAdic)) & _
                      CE(lArrDetalle(Fila, nColAsd_cImpAdic))

End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaLineaProv
' Description:       Funcion que retorna la llave de provision
'
' Parameters :       Fila (Integer)
'--------------------------------------------------------------------------------
Private Function BuscaLineaProv(Fila As Long) As String
    If lArrDetalle Is Nothing Then
        Exit Function
    End If
    On Error Resume Next
    BuscaLineaProv = CE(lArrDetalle(Fila, nColPla_cCuentaContable)) & _
                        CE(lArrDetalle(Fila, nColEnt_cCodEntidad)) & _
                        CE(lArrDetalle(Fila, nColAsd_cTipoDoc)) & _
                        CE(lArrDetalle(Fila, nColAsd_cSerieDoc)) & _
                        CE(lArrDetalle(Fila, nColAsd_cNumDoc))
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaLineaDetalle
' Description:       Funcion que retorna la linea del detalle
'
' Parameters :       Fila (Integer)
'--------------------------------------------------------------------------------
Private Function BuscaLineaDetalle(Fila As Long) As String
    If lArrDetalle Is Nothing Then
        Exit Function
    End If
    On Error Resume Next
    BuscaLineaDetalle = CE(lArrDetalle(Fila, nColAsd_nItem)) & _
                        CE(lArrDetalle(Fila, nColPla_cCuentaContable)) & _
                        CE(lArrDetalle(Fila, nColEnt_cCodEntidad)) & _
                        CE(lArrDetalle(Fila, nColCos_cCodigo)) & _
                        CE(lArrDetalle(Fila, nColAsd_cTipoDoc)) & _
                        CE(lArrDetalle(Fila, nColAsd_cSerieDoc)) & _
                        CE(lArrDetalle(Fila, nColAsd_cNumDoc)) & _
                        CE(lArrDetalle(Fila, nColAsd_cNomMoneda)) & _
                        CE(lArrDetalle(Fila, nColAsd_cOperaTC)) & _
                        CE(lArrDetalle(Fila, nColAsd_dFecDoc)) & _
                        CE(lArrDetalle(Fila, nColAsd_dFecVen)) & _
                        CE(lArrDetalle(Fila, nColAsd_nTipoCambio))
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaLineaNac
' Description:       Funcion que retornalos importes nacionales de la linea del detalle
'
' Parameters :       Fila (Integer)
'--------------------------------------------------------------------------------
Private Function BuscaLineaNac(Fila As Long) As Double
    If lArrDetalle Is Nothing Then
        Exit Function
    End If
    On Error Resume Next
    BuscaLineaNac = NE(lArrDetalle(Fila, nColAsd_nDebeSoles)) + NE(lArrDetalle(Fila, nColAsd_nHaberSoles))
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaLineaExt
' Description:       Funcion que retorna los importes extrangeros de la linea del detalle
'
' Parameters :       Fila (Integer)
'--------------------------------------------------------------------------------
Private Function BuscaLineaExt(Fila As Long) As Double
    If lArrDetalle Is Nothing Then
        Exit Function
    End If
    On Error Resume Next
    BuscaLineaExt = NE(lArrDetalle(Fila, nColAsd_nDebeMonExt)) + NE(lArrDetalle(Fila, nColAsd_nHaberMonExt))
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Imprimir
' Description:       Procedimiento que imprimeel voucher contable
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub Imprimir()
    ' *** Reporte Estandar de Voucher Contable
    Dim matriz_fecha(11) As Variant
    Dim Tipo As String
    
    If tdbgAsientos.Columns(1).Value <> "" Then
       Tipo = "SEL_REG"
       With Me.tdbgAsientos
            matriz_fecha(0) = "@Tipo;" & Tipo & ";True"
            matriz_fecha(1) = "@Ase_cNummov;" & .Columns(0).Value & ";True"
            matriz_fecha(2) = "@Emp_cCodigo;" & gsEmpresa & ";True"
            matriz_fecha(3) = "@Pan_cAnio;" & .Columns(1).Value & ";True"
            matriz_fecha(4) = "@Per_cPeriodo;" & .Columns(2).Value & ";True"
            matriz_fecha(5) = "@Lib_cTipoLibro;" & .Columns(4).Value & ";True"
            matriz_fecha(6) = "@Ase_nVoucher;" & .Columns(6).Value & ";True"
            matriz_fecha(7) = "@desde;" & dtpDesde.Text & ";True"
            matriz_fecha(8) = "@hasta;" & dtpHasta.Text & ";True"
            matriz_fecha(9) = "@Pla_cCuentaContable;;True"
            
            matriz_fecha(10) = "@EMPRESA;" & gsEmpresaNom & ";True"
            matriz_fecha(11) = "@RUC;" & "RUC : " & gsRUC & ";True"
       End With
       
       Dim formulas(0) As Variant
       AbreReporteParam gsDSN, Me, rutaReportes & "RptVoucherContable.rpt", crptToWindow, "Emisión de Voucher", "", matriz_fecha(), formulas()
       
       
       'A.Ase_nTipoCambio
    Else
       Mensajes "Seleccione un registro", vbInformation
    End If
    ' ***
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Cancelar
' Description:       Procedimiento que cancela la operacion del voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub Cancelar()
    If lnOpcion = 2 Then
        OpcionModificar True
    Else
        HabilitaControl Me
    End If
    Call TabMantenimiento(False)
    Me.Caption = lsTituOpcion
    
    
    '------------------ eliminando Array ---------------------
    Set tdbgDetalle.DataSource = Nothing
    
    'Set lArrDetalle = Nothing
    
    If lnOpcion <> 2 Then 'si no es consulta
        'Set lArrDetalleElim = Nothing
        lArrDetalleElim.Clear
    End If
    
    '----------------------------------------------------------
    
'    lArrDetalle.Clear
'    lArrDetalleElim.Clear
'
'    Set tdbgDetalle.Array = lArrDetalle
''''''    cmdCancelaciones.Enabled = True
    cmdCancelaciones.Enabled = False
    tdbcLibroCab.Enabled = True
    dtpDesde.Enabled = True
    dtpHasta.Enabled = True
    
'    tdbgDetalle.Bookmark = tdbgDetalle.Bookmark
    pSetFocus tdbgAsientos
    strSalida = False
    Activar tdbcTipoTx, False
    lblCalculoManual.Visible = False
    lblEstado.Visible = False
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       OcultaCamposBimoneda
' Description:       Procedimiento que oculta los campos de bimoneda
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub OcultaCamposBimoneda()
    If gsByMoneda = "0" Then
        pbMontosAdic.Visible = True
        tdbnDiferenciaME.Visible = True
        Label13(6).Visible = True
        Label13(8).Visible = True
        pbDescripcion.Width = 9330
    Else
        pbMontosAdic.Visible = True
        tdbnDiferenciaME.Visible = True
        Label13(6).Visible = True
        Label13(8).Visible = True
        pbDescripcion.Width = 9330
    End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaUltimaFecha
' Description:       funcion que retorna la ultima fecha del libro seleccionado en el periodo seleccionado
'
' Parameters :       Libro (String)
'--------------------------------------------------------------------------------
Private Function BuscaUltimaFecha(Libro As String) As String
    Dim sqlver  As String, valorDato As String
    sqlver = "select max(ase_dfecha) from CNC_ASIENTO_VOUCHER " & _
             "WHERE Emp_cCodigo='" & gsEmpresa & "' and pan_cAnio='" & gsAnio & "' and ase_cdeleted<>'*' and " & _
             "lib_ctipolibro='" & Libro & "' and per_cperiodo = '" & gsPeriodo & "'"
    valorDato = ExtraeDescripcion(sqlver)
    
    If IsDate(valorDato) = False Then
       If gsPeriodo < "01" Then gsPeriodo = "01"
       If gsPeriodo > "12" Then gsPeriodo = "12"
       valorDato = "01/" & gsPeriodo & "/" & gsAnio
    End If
    BuscaUltimaFecha = valorDato
End Function


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       AgregaFilaDetalle
' Description:       Procedimiento que agrega una fila en el detalle del voucher
'
' Parameters :       nFilas (Integer)
'                    MoveBookmark (Boolean = True)
'                    Tipo (String = "")
'--------------------------------------------------------------------------------
Private Function AgregaFilaDetalle(nFilas As Integer, Optional MoveBookmark As Boolean = True, Optional Tipo As String = "") As Boolean
    Dim iFilas As Integer
    iFilas = NumeroFilas
    AgregaFilaDetalle = False
    
    DoEvents
    
    If iFilas = lArrDetalle.Count(1) Or iFilas = 0 Or Tipo <> "" Then
        If nFilas = 1 Then
            NUM_FILAS = iFilas
            lItem = NUM_FILAS - 1
        End If
        
        If Tipo = "DIFE" Then
            NUM_FILAS = iFilas + 1
            lItem = NUM_FILAS - 1
        End If
        
        
        If Tipo = "TIPO" Then
            NUM_FILAS = iFilas + nFilas
            lItem = NUM_FILAS - 1
        End If
        
        
        If Tipo = "PROV" Then
            NUM_FILAS = iFilas ' + 1
            lItem = NUM_FILAS - 1
        End If
        
        lArrDetalle.ReDim 0, NUM_FILAS, 0, NUM_COLUMNAS   ' filas
        tdbgDetalle.ReBind
        AgregaFilaDetalle = True
        

        Call UpdateGrilla
        Call SumarTotales
        
        DoEvents
    End If
    
     If MoveBookmark Then tdbgDetalle.Bookmark = NUM_FILAS
End Function

Private Sub LlenaDatosConceptos()
        If gsDiarioSimplificado = 1 Then
            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cCodConcepto) = gsCodConceptoDefecto
            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cDesConcepto) = gsDesConceptoDefecto
            
            tdbgDetalle.Columns(nColAsd_cCodConcepto) = gsCodConceptoDefecto
            tdbgDetalle.Columns(nColAsd_cDesConcepto) = gsDesConceptoDefecto
        End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       EliminaFilaDetalle
' Description:       Procedimiento que elimina una fila en el detalle delvoucher
'
' Parameters :       nFilas (Integer)
'--------------------------------------------------------------------------------
Private Sub EliminaFilaDetalle(nFilas As Integer)
    Dim iFilas As Integer
    
    lArrDetalle.DeleteRows tdbgDetalle.Bookmark
    
    iFilas = NumeroFilas
    
    NUM_FILAS = iFilas
    lArrDetalle.ReDim 0, NUM_FILAS, 0, NUM_COLUMNAS   ' filas
    
    tdbgDetalle.ReBind
End Sub


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ManNuevo
' Description:       Procedimiento que crea un nuevo voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub ManNuevo()
    If tdbcLibroCab.BoundText = "" Then
        Mensajes "Seleccione un libro de la lista"
        tbrOpciones.Buttons(1).Enabled = True
        pSetFocus tdbcLibro
        Exit Sub
    End If

    Dim strFecha As String
    gTerminaCargarNuevo = False
    lnOpcion = 0
    lItem = 1
    tdbtMonto = 0
    tdbtMonto2 = 0
    tdbtMonto3 = 0
    tdbtMonto4 = 0
    
    tipoDocRef = ""
    SerieDocRef = ""
    NumDocRef = ""
    fechDocRef = ""
    EstadoOri = ""
    EstadoDes = ""
    '------------
    
    lArrDetalle.Clear
    lArrDetalleElim.Clear
    lArrDetalleTemp.Clear
    DoEvents
    '--------------------------------------------------
    ChkRegAux.Visible = False
    ChkRegAux.Value = vbUnchecked
    

    If CierreMes(tdbcMes.BoundText, tdbcLibroCab.BoundText) = True Then
       Mensajes "Mes seleccionado ya fue cerrado. No se puede generar asientos.", vbInformation
       tbrOpciones.Buttons(1).Enabled = True
       Exit Sub
    End If

    NUM_FILAS = 0
    NUM_FILAS_ELIM = 100
    
    '--------------------------------------------------
    If lnOpcion = 1 Then 'SI ES EDICION
        lArrDetalleElim.ReDim 0, NUM_FILAS_ELIM, 0, NUM_COLUMNAS   ' filas
    Else
        lArrDetalleElim.ReDim 0, 0, 0, NUM_COLUMNAS   ' filas
    End If
    '--------------------------------------------------
    
    lArrDetalle.ReDim 0, NUM_FILAS, 0, NUM_COLUMNAS
    '--------------------------------------------------
    lArrDetalleTemp.Clear
    lArrDetalle.Clear
    
    If lnOpcion = 1 Then 'SI ES EDICION
        lArrDetalleTemp.ReDim 0, NUM_FILAS, 0, NUM_COLUMNAS
    Else
        lArrDetalleTemp.ReDim 0, 0, 0, NUM_COLUMNAS
    End If
    '--------------------------------------------------
    
    Set tdbgDetalle.Array = lArrDetalle
    
    
    tdbgDetalle.ReBind
    
    '----------------------------------------------------------

    If datosLlenos = False Then
       Call LlenarCombos
       datosLlenos = True
    End If
    
    
    Me.CheckCuadraCompMan.Value = vbUnchecked
    
    'Se deshabilita esta opción para utilizar el campo como Valor Embarcado, cuando la N.C o N.D modifica una DUA
     Call LlenarComboTipoMoneda
    
    Call LimpiaTexto(Me)
    Call HabilitaControl(Me)
    
    '------- Habilita el ingreso de Operación de Caja ----------'
    If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Then
       Label1(6).Visible = False
       tdbcTipoOperacion.Visible = False
    Else
       Label1(6).Visible = True
       tdbcTipoOperacion.Visible = True
    End If
    
    Me.Caption = "PERIODO: " & tdbcMes & " " & gsAnio
    Me.lblEstado.Caption = "NUEVO"
    Me.lblNomEnti.Caption = ""
    Me.lblEntidad.Caption = ""
    Me.lblDesCta.Caption = ""
    
    Call BuscarMonedaNacional
    Call TabMantenimiento(True)
    Call OcultaCamposBimoneda

    tdbcLibro.Bookmark = 0
    
    'If gsUltimoLibro <> "" Then
    '    tdbcLibro.BoundText = gsUltimoLibro
    'Else
        tdbcLibro.BoundText = tdbcLibroCab.BoundText
    'End If
    
 
    tdbcLibro_ItemChange
        
    
    tdbgDetalle.Splits(0).Locked = False
        
    tdbgDetalle.Columns(nColAsd_nDebeSoles).FooterText = "0.00"
    tdbgDetalle.Columns(nColAsd_nHaberSoles).FooterText = "0.00"
    tdbgDetalle.Columns(nColAsd_nDebeMonExt).FooterText = "0.00"
    tdbgDetalle.Columns(nColAsd_nHaberMonExt).FooterText = "0.00"
    SumarTotales
    
    tdbcLibro.Enabled = True
    tdbtNumVoucher.Enabled = True
    
    
    Activar Me.tdbcPagoIGV, False
    Me.cmdEliminaItem.Enabled = True
    Me.cmdGenerarDifCambio.Enabled = True
    Me.cmdCrearEntidad.Enabled = True
    
    Me.tdbcTipoPago.Enabled = True
    'SumarTotales
    strSalida = True
    Call IniciarCamposDocumento
    
    Me.tdbcMoneda.Enabled = True
    Me.tdbtObservaciones.Enabled = True
    Me.tdbcTipoOperacion.Enabled = True
    Me.tdbnPorcIGV.Enabled = True
    
    cmdRepetirGlosa.Enabled = True
    tdbcTipoTx.BoundText = ""
    tdbcPagoIGV.BoundText = ""

    ActivarControl tdbcPagoIGV, False
    ActivarControl tdbcTipoTx, False

    If gsUltimoLibro = tdbcLibro.BoundText Then
        tdbtObservaciones.Text = gsUltimaGlosa
    End If

    On Error Resume Next
    tdbgDetalle.Bookmark = 0

    pSetFocus tdbcLibro
    tdbgDetalle.Splits(0).Locked = False

    lblEstado.Visible = True
    DoEvents
    gTerminaCargarNuevo = True
    
       If tdbcLibro.BoundText = lsLibroCom Then
            lblValorEmb.Visible = False
            tdbtMonedaAdic.Visible = False
            pctValorEmB.Visible = False
        ElseIf tdbcLibro.BoundText = lsLibroVen Then
            lblValorEmb.Visible = True
            tdbtMonedaAdic.Visible = True
            pctValorEmB.Visible = True
       End If

    '------------
    'PGBV - 02012013
    Dim sql As String

    sql = "select * from CNT_lIBROSGENERADOS where Emp_cCodigo = '" & gsEmpresa & "' and Pan_cAnio = '" & gsAnio & "' and Per_cPeriodo = '" & gsPeriodo & "' and Lib_cTipoLibro = '" & tdbcLibro.BoundText & "' and Estado ='A'"
    If tdbcLibro.BoundText <> "02" And tdbcLibro.BoundText <> "04" And tdbcLibro.BoundText <> "01" And tdbcLibro.BoundText <> "07" And tdbcLibro.BoundText <> "08" Then
        If ExisteDato(sql) = True And (Month(dtpFecha.Value) <> Month(lsFecha) Or Year(dtpFecha.Value) <> Year(lsFecha)) Then
            If tdbcLibro.BoundText = "06" Then
                Mensajes "Si no registró el comprobante de pago en el Período de Emisión, recuerde que tiene un plazo de " & CE(gsMesesAnteriores) & " meses (Revise parametros iniciales) para registrarlo. ¡Registre su comprobante en el Período " & UCase(MonthName(Month(lsFecha))) & " del ejercicio " & Str(Year(lsFecha)) & "!", vbInformation
                Call Cancelar
                Exit Sub
                'EstadoDes = "9"
            Else
                EstadoDes = "8"
            End If
        End If
    Else
        If tdbcLibro.BoundText = "01" Or tdbcLibro.BoundText = "02" Or tdbcLibro.BoundText = "04" Or tdbcLibro.BoundText = "07" Or tdbcLibro.BoundText = "08" Then
            sql = "select * from CNT_CIERRE where Emp_cCodigo = '" & gsEmpresa & "' and Pan_cAnio = '" & gsAnio & "' and Per_cPeriodo = '" & IIf(tdbcLibro.BoundText = "01", "00", gsPeriodo) & "' and TipoLibro = '" & tdbcLibro.BoundText & "' and Cic_cEstado ='A'"
            If ExisteDato(sql) = True Then EstadoDes = "8"
        End If
    End If

'    EstadoOri = 1

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcLibro_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el combo del libro
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcLibro_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyF4 Then
        KeyCode = 0
        Exit Sub
    End If

    If gsKeyCodePress = True Then
        KeyCode = 0
        Exit Sub
    End If
    DoEvents

    
    If KeyCode = vbKeyReturn Then
       If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Or tdbcLibro.BoundText = lsLibroDiario Then
            Call OcultaComboBase(True)
       Else
            Call OcultaComboBase(False)
       End If
    
       pSetFocus Me.tdbtNumVoucher
    End If
    
    If KeyCode = vbKeyPageUp Or KeyCode = vbKeyPageDown Then
        KeyCode = 0
    End If
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcMoneda_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el combo de moneda
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbcMoneda_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyF4 Then
        KeyCode = 0
        Exit Sub
    End If

    If KeyCode = 9 Then
        KeyCode = 0
    End If
    If KeyCode = 13 Then
        pSetFocus tdbtObservaciones
        If tdbtObservaciones.Enabled = True Then
            tdbtObservaciones.SelStart = 0
            tdbtObservaciones.SelLength = Len(tdbtObservaciones)
        End If
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbcMoneda_ItemChange
' Description:       Evento que se ejecuta al cambiar un item en el combo de moneda
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbcMoneda_ItemChange()

    cmdTipoAsiento.Enabled = True
    
    If tdbcMoneda.Columns(2) = "1" Then
       
            If CE(tdbcLibro.Columns(0).Value) = lsLibroCom Or CE(tdbcLibro.Columns(0).Value) = lsLibroVen Then
                Call LlenaComboTipoOperacion(Left(tdbcMoneda.Text, 1))
            Else
                Call LlenaComboTipoOperacion("D")
            End If
       
    Else
       
           If CE(tdbcLibro.Columns(0).Value) = lsLibroCom Or CE(tdbcLibro.Columns(0).Value) = lsLibroVen Then
                Call LlenaComboTipoOperacion(Left(tdbcMoneda.Text, 1))
            Else
                Call LlenaComboTipoOperacion("D")
            End If
       
        Call LlenaComboTipoOperacion("D")
    End If
    

    
End Sub


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgAsientos_Error
' Description:       Evento que se ejecuta al salir un error en el detalle del voucher
'
' Parameters :       DataError (Integer)
'                    Response (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbgAsientos_Error(ByVal DataError As Integer, Response As Integer)
On Error Resume Next
If DataError = 16389 Then
    Response = 0
End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgAsientos_GotFocus
' Description:       Evento que se ejecuta al obtener el enfoque la grilla de asientos por mes
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbgAsientos_GotFocus()
    On Error Resume Next
    tdbgAsientos.HighlightRowStyle = "HighlightRow"
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgAsientos_HeadClick
' Description:       Evento que se ejecuta al hacer clic en la cabecera de la grilla de asientos por mes
'
' Parameters :       ColIndex (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbgAsientos_HeadClick(ByVal ColIndex As Integer)
    If Not lrsAsientos Is Nothing Then
        If lrsAsientos.RecordCount > 0 Then
    
            lrsAsientos.Sort = tdbgAsientos.Columns(ColIndex).DataField
            tdbgAsientos.DataSource = lrsAsientos
            
        End If
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgAsientos_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en la grilla deasientos por mes
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbgAsientos_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Then
        Editar
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgAsientos_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque la grilla de asientos por mes
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbgAsientos_LostFocus()
    tdbgAsientos.HighlightRowStyle = ""
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       pCambiodeEnfoque
' Description:       Funcion que retorna el tipo de operacion de la linea de detalle seleccionada
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function pCambiodeEnfoque() As String
    If tdbgDetalle.Columns(nColAsd_cOperaTC).Value <> "SCV" And tdbgDetalle.Columns(nColAsd_cOperaTC).Value <> "OTR" Then
       pCambiodeEnfoque = tdbgDetalle.Columns(nColAsd_cOperaTC).Value
    Else
       If tdbgDetalle.Columns(nColAsd_cOperaTC).Value = "" Then
          pCambiodeEnfoque = "SCV"
       Else
          pCambiodeEnfoque = tdbgDetalle.Columns(nColAsd_cOperaTC).Value
       End If
    End If
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgAsientos_MouseUp
' Description:       Evento que se ejecuta al hacer clic en la grilla de asientos por mes
'
' Parameters :       Button (Integer)
'                    Shift (Integer)
'                    X (Single)
'                    Y (Single)
'--------------------------------------------------------------------------------
Private Sub tdbgAsientos_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)
    If Mid(gsGrupo, 3, 1) = "1" Or gsGrupo = gsPrivilegioAdmin Then
'        If Button = vbRightButton Then
'           PopupMenu frmMDIConta.mnuAnular, vbPopupMenuLeftAlign
'        End If
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgAsientos_RowColChange
' Description:       Evento que se ejecuta al cambiar de fila en la grilla de asientos por mes
'
' Parameters :       LastRow (Variant)
'                    LastCol (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbgAsientos_RowColChange(LastRow As Variant, ByVal LastCol As Integer)
'    If tdbgAsientos.Columns(0).Text <> "" Then
'        If Mid(gsGrupo, 3, 1) <> "1" And gsGrupo <> gsPrivilegioAdmin Then
'            tbrOpciones.Buttons(5).Enabled = False
'        Else
'            If NE(tdbgAsientos.Columns(13)) = 1 Then
'                tbrOpciones.Buttons(5).Enabled = False
'            Else
'                tbrOpciones.Buttons(5).Enabled = True
'            End If
'        End If
'    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgDetalle_AfterColEdit
' Description:       Evento que se ejecuta al terminar de editar una linea en el detalle de voucher
'
' Parameters :       ColIndex (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbgDetalle_AfterColEdit(ByVal ColIndex As Integer)
ColIndex = ColIndex

    
    If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoMoneda)) = gsMonedaExt Then
        If ColIndex = nColAsd_nDebeMonExt Or ColIndex = nColAsd_nHaberMonExt Then
            Call CalculaMonNac(True)
        End If
        
    End If
    
    If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoMoneda)) = gsMonedaNac Then
        If ColIndex = nColAsd_nDebeSoles Or ColIndex = nColAsd_nHaberSoles Then
            Call CalculaMonExt(True)
        End If
    End If
    
'    If Trim(lblNomEnti.Caption) = "ANULADO" Then
'         EstadoDes = "2"
'    End If
    
End Sub

Private Sub tdbgDetalle_AfterUpdate()
On Error GoTo Control
     If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cCanc)) = "C" And 18 >= nColAsd_nDebeSoles And _
          CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)) <> "" Then

            If NE(CDbl(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_nDebeMonExt))) + NE(CDbl(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_nHaberMonExt))) <> NE(CDbl(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_nExtranjera))) Or _
               NE(CDbl(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_nDebeSoles))) + NE(CDbl(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_nHaberSoles))) <> NE(CDbl(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_nNacional))) Then

               lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nImporteEditado) = 1
               'Sleep 0&
                pSaltoColGridActivo (tdbgDetalle.Col)
               'Sleep 0&
            End If

        End If
Exit Sub
Control:
 If Err.Number = -2147217888 Then Resume Next Else MsgBox Err.Description 'Error del Control ITrueDBGridCtrl
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgDetalle_BeforeColEdit
' Description:       Evento que se ejecuta al iniciar la edicion en el detalle del voucher
'
' Parameters :       ColIndex (Integer)
'                    KeyAscii (Integer)
'                    Cancel (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbgDetalle_BeforeColEdit(ByVal ColIndex As Integer, ByVal KeyAscii As Integer, Cancel As Integer)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    DoEvents
    '-------------- Valida para que no edite en modo consulta -----------------------'
    If lnOpcion = 2 Then
        RefreshGrilla
        DoEvents
    
       Mensajes "No se puede editar, esta en modo consulta...", vbInformation
       Cancel = 1
       tdbgDetalle.Col = nColPla_cCuentaContable
       pSetFocus tdbgDetalle
       Exit Sub
    End If
        
    '-------------- Valida que no modifique si no se ingreso una cuenta  ------------------------'
    If ColIndex = 0 Then
       Cancel = 1
       Exit Sub
    End If
    
     '----- NO PERMITE ESCRIBIR SI EL BOOKMARK ES MAYO A LA ULTIMA LINEA ------'
     If tdbgDetalle.Bookmark > NUM_FILAS Then
       Cancel = 1
       Exit Sub
     End If
    
    '-------------- Valida que no modifique codigo entidad ------------------------'
    If ColIndex = nColEnt_cCodEntidad And CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nCol_cTipoEntiCta)) = "" Then
       Cancel = 1
       Exit Sub
    End If
    
    '-------------- Valida que no modifique centro de costo ------------------------'
    If ColIndex = nColCos_cCodigo And lArrDetalle.Value(tdbgDetalle.Bookmark, nCol_cFlgCCosto) = "0" Then
       Cancel = 1
       Exit Sub
    End If
    
    '-------------- Valida que no modifique documento  ------------------------'
    If lArrDetalle.Value(tdbgDetalle.Bookmark, nColPla_cDocumento) = "0" Then
       If ColIndex = nColAsd_cTipoDoc Or ColIndex = nColAsd_cSerieDoc Or ColIndex = nColAsd_cNumDoc Then
            Cancel = 1
            Exit Sub
       End If
    End If
    
    
    '-------------- Valida que no modifique si no se ingreso una cuenta  ------------------------'
    If ColIndex <> nColPla_cCuentaContable And CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColPla_cCuentaContable)) = "" Then
       Cancel = 1
       Exit Sub
    End If
    
    '-------------- Valida que no modifique el importe moneda nacional  ------------------------'
    If ColIndex = nColAsd_nDebeSoles And NE(tdbgDetalle.Columns(nColAsd_nHaberSoles)) > 0 Then
       Cancel = 1
       Exit Sub
    End If
    
    If ColIndex = nColAsd_nHaberSoles And NE(tdbgDetalle.Columns(nColAsd_nDebeSoles)) > 0 Then
       Cancel = 1
       Exit Sub
    End If
    '-------------- Valida que no modifique el importe moneda extranjera ------------------------'
    If ColIndex = nColAsd_nDebeMonExt And NE(tdbgDetalle.Columns(nColAsd_nHaberMonExt)) > 0 Then
       Cancel = 1
       Exit Sub
    End If
    
    If ColIndex = nColAsd_nHaberMonExt And NE(tdbgDetalle.Columns(nColAsd_nDebeMonExt)) > 0 Then
       Cancel = 1
       Exit Sub
    End If
    
    '-------------- Valida que no modifique SI ES UNA CANCELACION ------------------------'
    If ColIndex = nColAsd_nDebeSoles And CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cEcpOperacion)) = "D" Then
       Cancel = 1
       Exit Sub
    End If
    
    If ColIndex = nColAsd_nHaberSoles And CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cEcpOperacion)) = "H" Then
       Cancel = 1
       Exit Sub
    End If
    '-------------- Valida que no modifique SI ES UNA CANCELACION ------------------------'
    If ColIndex = nColAsd_nDebeMonExt And CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cEcpOperacion)) = "D" Then
       Cancel = 1
       Exit Sub
    End If
    
    If ColIndex = nColAsd_nHaberMonExt And CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cEcpOperacion)) = "H" Then
       Cancel = 1
       Exit Sub
    End If
    
    
    '-------------- Valida para que no edite si es una cancelacion que se jala de provision -----------------------'
    'ya sea manualmente o de la tabla de provisiones
    If gTerminaCargarNuevo = True Then
        If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cCanc)) = "C" And ColIndex < nColAsd_nDebeSoles And CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)) <> "" Then
            RefreshGrilla
            DoEvents
        
'           Mensajes "Solo se pueden modificar los importes" & Salto(1) & "de una cancelación o cobro" & Salto(1) & "de un documento provisionado...", vbExclamation
'           Cancel = 1
           pSetFocus tdbgDetalle
           
           Exit Sub
        Else
        
            If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cCanc)) = "C" And _
               ColIndex >= nColAsd_nDebeSoles And _
               CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)) <> "" Then
               
                If NE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_nDebeMonExt)) + NE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_nHaberMonExt)) <> NE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_nExtranjera)) Or _
                   NE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_nDebeSoles)) + NE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_nHaberSoles)) <> NE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_nNacional)) Then
                    
                   lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nImporteEditado) = 1
                    
                End If
                
            End If
        End If
    End If
        

    '-------------- Valida para que no edite las cuentas destino -----------------------'
    If tdbgDetalle.Columns(nColAsd_cDestino) = "1" And lnOpcion = 1 Then
        RefreshGrilla
        DoEvents
    
       Mensajes "No se puede corregir un registro automatico...", vbInformation
       Cancel = 1
       tdbgDetalle.Col = nColPla_cCuentaContable
       pSetFocus tdbgDetalle
       Exit Sub
    End If
    
    
    '-------------- Valida para que no edite si la cuenta es cancelada -----------------------'
    If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_Cancelado)) = "1" And lnOpcion = 1 Then
        RefreshGrilla
        DoEvents
    
       Mensajes "Provision tiene PAGOS REGISTRADOS. " & Salto(2) & "Para poder modificar los datos," & Salto(1) & "primero elimine los pagos", vbInformation
       Cancel = 1
       tdbgDetalle.Col = nColPla_cCuentaContable
       pSetFocus tdbgDetalle
       Exit Sub
    End If

    '-------------- Valida para que no edite tiene registros auxiliares -----------------------'
    If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cRegAuxDet)) = "1" And lnOpcion = 1 Then
        RefreshGrilla
        DoEvents
    
       Mensajes "Provision tiene detalle en REGISTROS AUXILIARES." & Salto(2) & "Para poder modificar los datos," & Salto(1) & "primero elimine sus dependencias", vbInformation
       Cancel = 1
       tdbgDetalle.Col = nColPla_cCuentaContable
       pSetFocus tdbgDetalle
       Exit Sub
    End If

   '--------------- Verifica Cambios DDHH ------------------------------------------------'
    If (ColIndex = nColAsd_nDebeMonExt Or ColIndex = nColAsd_nHaberMonExt) And _
        CheckCuadraCompMan.Value = vbUnchecked Then
       If tdbgDetalle.Columns(nCol_cFlgMonNac) = "1" Then
          Cancel = 1
          Exit Sub
       End If
    End If
    
    If (ColIndex = nColAsd_nDebeSoles Or ColIndex = nColAsd_nHaberSoles) And _
       CheckCuadraCompMan.Value = vbUnchecked Then
       If tdbgDetalle.Columns(nCol_cFlgMonNac) <> "1" Then
          Cancel = 1
          Exit Sub
       End If
    End If
    '--------------- Valida para que no edite el tipo de cambio ---------------------------'
    If ColIndex = nColAsd_nTipoCambio And _
       NE(tdbgDetalle.Columns(nColAsd_nTipoCambio).Text) > 0 And _
       tdbgDetalle.Columns(nColAsd_cOperaTC).Text <> "OTR" Then
       
       Cancel = 1
       pSetFocus tdbgDetalle
       Exit Sub
    End If
    '----------------------------------------------------'
    
    If ColIndex = nColAsd_nTipoCambio And _
       NE(tdbgDetalle.Columns(nColAsd_nTipoCambio).Text) = 0 And tdbgDetalle.Columns(nColAsd_cOperaTC).Text <> "OTR" Then
       Cancel = 0
       gsActualizaTC = True
    Else
       gsActualizaTC = False
    End If
    '----------------------------------------------------'
    If tdbgDetalle.Col = nColAsd_nTipoCambio Then
        
           If lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cOperaTC) = "OTR" Then
           
           If gsKeyCode = vbKeyDelete Or gsKeyCode = vbKeyBack Then
              tdbtCambio.Value = 0
              tdbgDetalle.Columns(nColAsd_nTipoCambio) = 0
              lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nTipoCambio) = 0
           End If
           
           
'           tdbgDetalle.Columns(nColAsd_nTipoCambio) = 0
'           tdbgDetalle.RefreshRow
'                Me.tdbtCambio.ReadOnly = True
'           Else
'                Me.tdbtCambio.ReadOnly = False
           End If
    End If
    '----------------------------------------------------'
    
    If ColIndex = nColAsd_nTipoCambio And tdbgDetalle.Columns(nColAsd_cOperaTC).Text = "SCV" Then
       Cancel = 1
       pSetFocus tdbgDetalle
       Exit Sub
    End If

    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenaCajaTextoPagoIGV
' Description:       Procedimiento que llena activa los controls de referencia segun del Pago de IGV seleccionado
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub LlenaCajaTextoPagoIGV()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    DoEvents
    If tdbgDetalle.Bookmark > NumeroFilas Then
        Exit Sub
    End If
    DoEvents
    
    With tdbgDetalle
        If CE(.Columns(nCol_cFlgDetRet)) <> "" Then
            
            Activar tdbcPagoIGV, True
            
            Me.tdbcPagoIGV.BoundText = CE(.Columns(nCol_cFlgDetRet))
            ActualizaCamposPagoIVG False 'False = solo limpia las cajas de texto
        Else
            Me.tdbcPagoIGV.BoundText = ""
            ActualizaCamposPagoIVG False 'False = solo limpia las cajas de texto
        End If
        
        DoEvents
        
        lblDesCta.Caption = CE(.Columns(nColPla_cNombreCuenta).Value)
        chkCC.Value = NE(.Columns(nCol_cFlgCCosto).Value)
        chkProv.Value = NE(.Columns(nCol_cFlgProv).Value)
               
        tdbtGlosa.Text = CE(.Columns(nColAsd_cGlosa).Value)
        
        tdbtTipDocRef.Text = CE(.Columns(nColAsd_cTipoDocRef).Value)
        tdbtSerDocRef.Text = CE(.Columns(nColAsd_cSerieDocRef).Value)
        tdbtNroDocRef.Text = CE(.Columns(nColAsd_cNumDocRef).Value)
        dtpFecDocRef.Value = CE(.Columns(nColAsd_dFecDocRef).Value)
        
        If tipoDocRef = "" Then tipoDocRef = CE(.Columns(nColAsd_cTipoDocRef).Value)
        If SerieDocRef = "" Then SerieDocRef = CE(.Columns(nColAsd_cSerieDocRef).Value)
        If NumDocRef = "" Then NumDocRef = CE(.Columns(nColAsd_cNumDocRef).Value)
        If fechDocRef = "" Then fechDocRef = CE(.Columns(nColAsd_dFecDocRef).Value)
        If ValEmb = 0 Then ValEmb = NE(lArrDetalle(.Bookmark, nColAsd_cImpAdic))
        
        tdbtComprobante.Text = CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cComprobante))
        
        tdbcProceso.BoundText = CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cProceso))
        
        tdbtMonedaAdic.Value = NE(lArrDetalle(.Bookmark, nColAsd_cImpAdic))
        ValEmbAnt = ValEmb
        
        tdbtNroConsta.Text = CE(.Columns(nColAsd_cNumSpot).Value)
        dtpFecDeposito.Value = CE(.Columns(nColAsd_dFechaSpot).Value)
        
        DoEvents
    End With
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgDetalle_Error
' Description:       Evento que se ejecuta al salir un error en el detalle del voucher
'
' Parameters :       DataError (Integer)
'                    Response (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbgDetalle_Error(ByVal DataError As Integer, Response As Integer)
    On Error Resume Next
    If DataError = 16389 Then
        Response = 0
    End If

End Sub


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgDetalle_FetchCellStyle
' Description:       Evento que se ejecuta para pintar las celdad del detalle del voucher
'
' Parameters :       Condition (Integer)
'                    Split (Integer)
'                    Bookmark (Variant)
'                    Col (Integer)
'                    CellStyle (TrueOleDBGrid70.StyleDisp)
'--------------------------------------------------------------------------------
Private Sub tdbgDetalle_FetchCellStyle(ByVal Condition As Integer, ByVal Split As Integer, Bookmark As Variant, ByVal Col As Integer, ByVal CellStyle As TrueOleDBGrid70.StyleDisp)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    If Bookmark > lItem Then
       Exit Sub
    End If
    
    On Error GoTo serror
    
    If lItem = 0 Then
        CellStyle.BackColor = gsColorActivado
    End If
    
    If Bookmark <= lItem And NE(lArrDetalle.Value(Bookmark, nColAsd_cDestino)) = 0 And _
       CE(lArrDetalle(Bookmark, nColAsd_Cancelado)) = "" And _
       CE(lArrDetalle(Bookmark, nColAsd_cRegAuxDet)) <> "1" Then
       
        Select Case Col
            Case nColAsd_nItem
                 If NE(lArrDetalle.Value(Bookmark, nColAsd_cManual)) = 1 Then
                    CellStyle.BackColor = vbRed
                    CellStyle.ForeColor = vbYellow
                 End If
            Case nColEnt_cCodEntidad
                 If CE(lArrDetalle.Value(Bookmark, nCol_cTipoEntiCta)) = "" Then
                    CellStyle.BackColor = gsColorDesactivado
                    
                    If CE(lArrDetalle.Value(Bookmark, nColPla_cCuentaContable)) = "" Then
                       CellStyle.BackColor = gsColorActivado
                    End If
                    
                 Else
                    CellStyle.BackColor = gsColorActivado
                 End If
                 
                 If tdbgDetalle.IsSelected(Bookmark) = 0 Then
                    CellStyle.BackColor = tdbgDetalle.SelectedBackColor
                 End If
        
            Case nColCos_cCodigo
                If lArrDetalle.Value(Bookmark, nCol_cFlgCCosto) = "0" Then
                   CellStyle.BackColor = gsColorDesactivado
                 Else
                    CellStyle.BackColor = gsColorActivado
                End If
                
                If tdbgDetalle.IsSelected(Bookmark) = 0 Then
                    CellStyle.BackColor = tdbgDetalle.SelectedBackColor
                End If
                
            Case nColAsd_cTipoDoc
                If CE(lArrDetalle.Value(Bookmark, nColPla_cDocumento)) = "0" Then
                   CellStyle.BackColor = gsColorDesactivado
                Else
                    CellStyle.BackColor = gsColorActivado
                End If
            
                If tdbgDetalle.IsSelected(Bookmark) = 0 Then
                    CellStyle.BackColor = tdbgDetalle.SelectedBackColor
                End If
            
            Case nColAsd_cSerieDoc
                If CE(lArrDetalle.Value(Bookmark, nColPla_cDocumento)) = "0" Then
                   CellStyle.BackColor = gsColorDesactivado
                Else
                   CellStyle.BackColor = gsColorActivado
                End If
                
                If tdbgDetalle.IsSelected(Bookmark) = 0 Then
                   CellStyle.BackColor = tdbgDetalle.SelectedBackColor
                End If
                
            Case nColAsd_cNumDoc
                If CE(lArrDetalle.Value(Bookmark, nColPla_cDocumento)) = "0" Then
                   CellStyle.BackColor = gsColorDesactivado
                Else
                    CellStyle.BackColor = gsColorActivado
                End If
                
                If tdbgDetalle.IsSelected(Bookmark) = 0 Then
                    CellStyle.BackColor = tdbgDetalle.SelectedBackColor
                End If
                
            Case nColAsd_nDebeSoles, nColAsd_nHaberSoles   'NACIONAL
                
                If lArrDetalle.Value(Bookmark, nColAsd_cTipoMoneda) = gsMonedaNac Then
                    CellStyle.BackColor = gsColorActivado
                Else
                    CellStyle.BackColor = gsColorDesactivado
                    
                    If CE(lArrDetalle.Value(Bookmark, nColPla_cCuentaContable)) = "" Then
                       CellStyle.BackColor = gsColorActivado
                    End If

                End If
                
                If tdbgDetalle.IsSelected(Bookmark) = 0 Then
                    CellStyle.BackColor = tdbgDetalle.SelectedBackColor
                End If
                '****************************************************************
                If CE(lArrDetalle(Bookmark, nColAsd_cEcpOperacion)) <> "" Then
                    If CE(lArrDetalle(Bookmark, nColAsd_cEcpOperacion)) = "H" Then
                        If Col = nColAsd_nDebeSoles Then
                            'CellStyle.BackColor = gsColorActivado
                        Else
                            CellStyle.BackColor = gsColorDesactivado
                        End If
                    Else
                        If Col = nColAsd_nHaberSoles Then
                            'CellStyle.BackColor = gsColorActivado
                        Else
                            CellStyle.BackColor = gsColorDesactivado
                        End If
                    End If
                End If
                '****************************************************************
            Case nColAsd_nDebeMonExt, nColAsd_nHaberMonExt  'EXTRANJERA
                
                'If CheckCuadraCompMan.Value = vbChecked Then
                '    CellStyle.BackColor = gsColorActivado
                '    Exit Sub
                'End If

                
                If lArrDetalle.Value(Bookmark, nColAsd_cTipoMoneda) = gsMonedaNac Then
                    CellStyle.BackColor = gsColorDesactivado
                    
                    If CE(lArrDetalle.Value(Bookmark, nColPla_cCuentaContable)) = "" Then
                       CellStyle.BackColor = gsColorActivado
                    End If
                    
                Else
                    CellStyle.BackColor = gsColorActivado
                End If
                
                If tdbgDetalle.IsSelected(Bookmark) = 0 Then
                    CellStyle.BackColor = tdbgDetalle.SelectedBackColor
                End If
                '****************************************************************
                If CE(lArrDetalle(Bookmark, nColAsd_cEcpOperacion)) <> "" Then
                    If CE(lArrDetalle(Bookmark, nColAsd_cEcpOperacion)) = "H" Then
                        If Col = nColAsd_nDebeMonExt Then
                            'CellStyle.BackColor = gsColorActivado
                        Else
                            CellStyle.BackColor = gsColorDesactivado
                        End If
                    Else
                        If Col = nColAsd_nHaberMonExt Then
                            'CellStyle.BackColor = gsColorActivado
                        Else
                            CellStyle.BackColor = gsColorDesactivado
                        End If
                    End If
                End If
                '****************************************************************
        End Select
    End If
    
serror:
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgDetalle_FetchCellTips
' Description:       Evento que se ejecuta para mostrar los tooltipos del detalle del voucher
'
' Parameters :       SplitIndex (Integer)
'                    ColIndex (Integer)
'                    RowIndex (Long)
'                    CellTip (String)
'                    FullyDisplayed (Boolean)
'                    TipStyle (TrueOleDBGrid70.StyleDisp)
'--------------------------------------------------------------------------------

Private Sub tdbgDetalle_FetchCellTips(ByVal SplitIndex As Integer, ByVal ColIndex As Integer, ByVal RowIndex As Long, CellTip As String, ByVal FullyDisplayed As Boolean, ByVal TipStyle As TrueOleDBGrid70.StyleDisp)
    On Error GoTo serror
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    If RowIndex > lItem Then
       Exit Sub
    End If

    If RowIndex < 0 Then
       Exit Sub
    End If

    
    If ColIndex = nColAsd_nItem And NE(lArrDetalle(RowIndex, nColAsd_cManual)) = 1 Then
        CellTip = " La provision del documento " & Salto(1) & " tiene calculo manual"
        TipStyle.ForeColor = vbRed
        TipStyle.Font.Bold = True
        TipStyle.Alignment = dbgCenter
        TipStyle.WrapText = True
    End If

    If ColIndex = nColAsd_cCanc And CE(lArrDetalle(RowIndex, nColAsd_cCanc)) = "C" Then
        CellTip = " Indica si la cuenta contable" & Salto(1) & " es de Pago o cobro"
        TipStyle.ForeColor = vbBlue
        TipStyle.Font.Bold = True
        TipStyle.Alignment = dbgCenter
        TipStyle.WrapText = True
    End If

    If ColIndex = nColAsd_cGrupo And CE(lArrDetalle(RowIndex, nColAsd_cGrupo)) <> "" Then
        CellTip = " Indica el grupo asignado por el usuario" & Salto(1) & " cuando son varios Pagos o Cobros" & Salto(1) & " en un mismo voucher"
        TipStyle.ForeColor = vbBlue
        TipStyle.Font.Bold = True
        TipStyle.Alignment = dbgCenter
        TipStyle.WrapText = True
    End If

serror:
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgDetalle_FetchRowStyle
' Description:       Evento que se ejecuta para pintar toda la fila del detalle del voucher
'
' Parameters :       Split (Integer)
'                    Bookmark (Variant)
'                    RowStyle (TrueOleDBGrid70.StyleDisp)
'--------------------------------------------------------------------------------
Private Sub tdbgDetalle_FetchRowStyle(ByVal Split As Integer, Bookmark As Variant, ByVal RowStyle As TrueOleDBGrid70.StyleDisp)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    If Bookmark > lItem Then
       Exit Sub
    End If
    
    On Error GoTo serror
    
    If lArrDetalle(Bookmark, nColAsd_cDestino) = "1" Then
        RowStyle.BackColor = gsColorBCGenerada
        RowStyle.ForeColor = gsColorFCGenerada
        
    Else

        If CE(lArrDetalle(Bookmark, nColAsd_cRegAuxDet)) = "1" Then
            RowStyle.BackColor = gsColorRegAux
        End If
        
        If CE(lArrDetalle(Bookmark, nColAsd_Cancelado)) = "1" Then
            RowStyle.BackColor = gsColorDesactProv
        End If
        
    End If
    
'        If Trim(lblNomEnti.Caption) = "ANULADO" Then
'            EstadoDes = "2"
'        End If
serror:
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgDetalle_GotFocus
' Description:       Evento que se ejecuta al obtener el enfoque la grilla del detalle
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbgDetalle_GotFocus()
    TimerKey.Enabled = False
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgDetalle_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en la grilla del detalle
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbgDetalle_KeyPress(KeyAscii As Integer)
    
    If gsKeyCode = 0 Then KeyAscii = gsKeyCode

    If KeyAscii <> 13 And KeyAscii <> vbKeyLeft And KeyAscii <> vbKeyDown And KeyAscii <> vbKeyRight And KeyAscii <> vbKeyUp And KeyAscii <> vbKeyHome And KeyAscii <> vbKeyEnd And KeyAscii <> vbKeyPageUp And KeyAscii <> vbKeyPageDown Then
       gsKeyAscii = KeyAscii
    End If

    If KeyAscii = 13 Then
        CuentaMensajes = 0
    End If
    If gsFlagKeydownDet = True And KeyAscii <> 13 Then
        
        If tdbgDetalle.Col = nColAsd_nDebeSoles Or tdbgDetalle.Col = nColAsd_nHaberSoles Or tdbgDetalle.Col = nColAsd_nDebeMonExt Or tdbgDetalle.Col = nColAsd_nHaberMonExt Then
            gsFlagKeydownDet = False
            
            TimerKey.Enabled = False
            gsKeyCodePress = False
            
        Else
            KeyAscii = 0
            Exit Sub
        End If
    End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgDetalle_KeyUp
' Description:       Evento que se ejecuta al presionar una tecla en la grilla del detalle del voucher
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbgDetalle_KeyUp(KeyCode As Integer, Shift As Integer)

    TimerKey.Enabled = False
    gsKeyCodePress = False
    
    If KeyCode = 17 Then gsKeyControl = False
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgDetalle_MouseUp
' Description:       Evento que se ejecuta al hacer un clic en el detalle del voucher
'
' Parameters :       Button (Integer)
'                    Shift (Integer)
'                    X (Single)
'                    Y (Single)
'--------------------------------------------------------------------------------
Private Sub tdbgDetalle_MouseUp(Button As Integer, Shift As Integer, x As Single, y As Single)
    gsKeyCode = -1
    tdbgDetalle.MarqueeStyle = dbgSolidCellBorder
    
    If VisualizarMenusOpcionales = True Then
        If frmMDIConta.mnuDiarioSimplificado.Visible = True Or frmMDIConta.mnuGrupos.Visible = True Then
            If Button = 2 And tdbgDetalle.IsSelected(tdbgDetalle.Bookmark) = 0 Then
                PopupMenu frmMDIConta.mnuOpciones, vbPopupMenuLeftAlign
            End If
        End If
    End If

End Sub

Private Function VisualizarMenusOpcionales() As Boolean

    On Error GoTo serror
    frmMDIConta.mnuDiarioSimplificado.Visible = True
    frmMDIConta.mnuGrupos.Visible = True
    
    If tdbgDetalle.Columns(nColAsd_cDesConcepto).Visible = False And tdbgDetalle.Columns(nColAsd_cGrupo).Visible = False Then
        VisualizarMenusOpcionales = False
    Else
        frmMDIConta.mnuDiarioSimplificado.Visible = BE(gsDiarioSimplificado)
        frmMDIConta.mnuGrupos.Visible = tdbgDetalle.Columns(41).Visible
        
        VisualizarMenusOpcionales = True
    End If
    
    Exit Function
serror:
    VisualizarMenusOpcionales = False

End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       PintaCajasFecha
' Description:       Procedimiento que pinta las fechas del detalle segun su estado
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub PintaCajasFecha()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    With tdbgDetalle
        If .Col = nColAsd_dFecDoc Or .Col = nColAsd_dFecVen Then
            If VerificaCuentaDestino = True Then
                dtpFechaDoc.BackColor = gsColorBCGenerada
            ElseIf lArrDetalle(tdbgDetalle.Bookmark, nColAsd_Cancelado) = "1" Then
                dtpFechaDoc.BackColor = gsColorDesactProv
            Else
                dtpFechaDoc.BackColor = gsColorActivado
            End If
        End If
    End With
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       PintaCajasTextNumerico
' Description:       Procedimiento que pinta las caja de texto de importes del detalle segun su estado
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub PintaCajasTextNumerico()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    With tdbgDetalle
        If .Col = nColAsd_nTipoCambio Or .Col = nColAsd_nDebeMonExt Or .Col = nColAsd_nDebeSoles Or .Col = nColAsd_nHaberMonExt Or .Col = nColAsd_nHaberSoles Then
            If VerificaCuentaDestino = True Then
                tdbtCambio.BackColor = gsColorBCGenerada
                tdbtMonto.BackColor = gsColorBCGenerada
                tdbtMonto2.BackColor = gsColorBCGenerada
                tdbtMonto3.BackColor = gsColorBCGenerada
                tdbtMonto4.BackColor = gsColorBCGenerada
                
                
            ElseIf lArrDetalle(tdbgDetalle.Bookmark, nColAsd_Cancelado) = "1" Then
                tdbtCambio.BackColor = gsColorDesactProv
                tdbtMonto.BackColor = gsColorDesactProv
                tdbtMonto2.BackColor = gsColorDesactProv
                tdbtMonto3.BackColor = gsColorDesactProv
                tdbtMonto4.BackColor = gsColorDesactProv
                
                
            Else
                tdbtCambio.BackColor = gsColorActivado
                tdbtMonto.BackColor = gsColorActivado
                tdbtMonto2.BackColor = gsColorActivado
                tdbtMonto3.BackColor = gsColorActivado
                tdbtMonto4.BackColor = gsColorActivado
                
                
                If CheckCuadraCompMan.Value = vbUnchecked And CE(lArrDetalle.Value(.Bookmark, nColAsd_cTipoMoneda)) = gsMonedaNac And (.Col = nColAsd_nDebeMonExt Or .Col = nColAsd_nHaberMonExt) Then
                    tdbtMonto.BackColor = gsColorDesactivado
                    tdbtMonto2.BackColor = gsColorDesactivado
                    tdbtMonto3.BackColor = gsColorDesactivado
                    tdbtMonto4.BackColor = gsColorDesactivado
                End If
                
                If CheckCuadraCompMan.Value = vbUnchecked And CE(lArrDetalle.Value(.Bookmark, nColAsd_cTipoMoneda)) = gsMonedaExt And (.Col = nColAsd_nDebeSoles Or .Col = nColAsd_nHaberSoles) Then
                    tdbtMonto.BackColor = gsColorDesactivado
                    tdbtMonto2.BackColor = gsColorDesactivado
                    tdbtMonto3.BackColor = gsColorDesactivado
                    tdbtMonto4.BackColor = gsColorDesactivado
                End If
                
            End If
            
        End If
    End With
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ValidaCamposDetalle
' Description:       Funcion que valida la fila del detalle
'
' Parameters :       Fila (Integer)
'--------------------------------------------------------------------------------
Private Function ValidaCamposDetalle(Fila As Integer) As Boolean
    'FUNCION DE VALIDACION PARA EL CAMBIO DE LINEA
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If
    
    ValidaCamposDetalle = True
    
    If CE(lArrDetalle(Fila, nColAsd_nItem)) = "" Then
       Exit Function
    End If
    
    If lnOpcion = 2 Then 'modo consulta
       ValidaCamposDetalle = True
       Exit Function
    End If
    
    If CE(lArrDetalle(Fila, nColPla_cCuentaContable)) = "" Then
        CuentaMensajes = CuentaMensajes + 1
        UpdateGrilla
        
        Mensajes "Ingrese la cuenta contable ", vbOKOnly + vbInformation
        
        If CuentaMensajes < 2 Then tdbgDetalle.Bookmark = Fila
        DoEvents
        tdbgDetalle.Col = nColPla_cCuentaContable
        pSetFocus tdbgDetalle
        ValidaCamposDetalle = False
        
        Exit Function
    End If
    
    If lArrDetalle(Fila, nCol_cFlgCCosto) <> "0" And ValidaDentroPeriodo Then
        If CE(lArrDetalle(Fila, nColCos_cCodigo)) = "" Then
           CuentaMensajes = CuentaMensajes + 1
           UpdateGrilla
           
           Mensajes "Ingrese el codigo de centro de costo en la cuenta " & CE(lArrDetalle(Fila, nColPla_cCuentaContable)), vbOKOnly + vbInformation
           
           If CuentaMensajes < 2 Then tdbgDetalle.Bookmark = Fila
           DoEvents
           tdbgDetalle.Col = nColCos_cCodigo
           pSetFocus tdbgDetalle
           ValidaCamposDetalle = False
           
           Exit Function
        End If
    End If
    
    If CE(lArrDetalle.Value(Fila, nCol_cTipoEntiCta)) <> "" And ValidaDentroPeriodo Then
        If CE(lArrDetalle(Fila, nColEnt_cCodEntidad)) = "" Then
           CuentaMensajes = CuentaMensajes + 1
           UpdateGrilla
           
           Mensajes "Ingrese el codigo de entidad en la cuenta " & CE(lArrDetalle(Fila, nColPla_cCuentaContable)), vbOKOnly + vbInformation
           
           If CuentaMensajes < 2 Then tdbgDetalle.Bookmark = Fila
           DoEvents
           tdbgDetalle.Col = nColEnt_cCodEntidad
           
           'tdbgDetalle.AllowUpdate = True
           tdbgDetalle.Splits(0).MarqueeStyle = dbgFloatingEditor


           pSetFocus tdbgDetalle
           ValidaCamposDetalle = False
           
           Exit Function
        End If
    End If
    
    If CE(lArrDetalle(Fila, nColPla_cDocumento)) = "1" And ValidaDentroPeriodo Then
        If CE(lArrDetalle(Fila, nColAsd_cTipoDoc)) = "" Then
            CuentaMensajes = CuentaMensajes + 1
            UpdateGrilla
            
            Mensajes "Ingrese el tipo de documento en la cuenta " & CE(lArrDetalle(Fila, nColPla_cCuentaContable)), vbOKOnly + vbInformation
            
            If CuentaMensajes < 2 Then tdbgDetalle.Bookmark = Fila
            DoEvents
            tdbgDetalle.Col = nColAsd_cTipoDoc
            pSetFocus tdbgDetalle
            ValidaCamposDetalle = False
            
            Exit Function
         End If
    
        If CE(lArrDetalle(Fila, nColAsd_cTipoDoc)) = "99" Or CE(lArrDetalle(Fila, nColAsd_cTipoDoc)) = "98" Then
            If CE(lArrDetalle(Fila, nColAsd_cSerieDoc)) = "" And CE(lArrDetalle(Fila, nColAsd_cNumDoc)) = "" And NE(lArrDetalle(Fila, nCol_cFlgProv)) = 1 Then
               CuentaMensajes = CuentaMensajes + 1
               UpdateGrilla
               
               Mensajes "Ingrese el número de documento en la cuenta " & CE(lArrDetalle(Fila, nColPla_cCuentaContable)) & Salto(1) & "Por ser una cuenta que genera una provision", vbOKOnly + vbInformation
               
               If CuentaMensajes < 2 Then tdbgDetalle.Bookmark = Fila
               DoEvents
               tdbgDetalle.Col = nColAsd_cNumDoc
               pSetFocus tdbgDetalle
               ValidaCamposDetalle = False
               
               Exit Function
           End If
         End If
        
        If CE(lArrDetalle(Fila, nColAsd_cTipoDoc)) <> "99" And CE(lArrDetalle(Fila, nColAsd_cTipoDoc)) <> "98" Then
            If CE(lArrDetalle(Fila, nColAsd_cSerieDoc)) = "" Then
               CuentaMensajes = CuentaMensajes + 1
               UpdateGrilla
               
               Mensajes "Ingrese la serie del documento en la cuenta " & CE(lArrDetalle(Fila, nColPla_cCuentaContable)), vbOKOnly + vbInformation
               
               If CuentaMensajes < 2 Then tdbgDetalle.Bookmark = Fila
               DoEvents
               tdbgDetalle.Col = nColAsd_cSerieDoc
               pSetFocus tdbgDetalle
               ValidaCamposDetalle = False
               
               Exit Function
           End If
         End If
        
        'If CE(lArrDetalle(fila, nColAsd_cTipoDoc)) <> "99" And CE(lArrDetalle(fila, nColAsd_cTipoDoc)) <> "98" Then
            If CE(lArrDetalle(Fila, nColAsd_cNumDoc)) = "" Then
               CuentaMensajes = CuentaMensajes + 1
               UpdateGrilla
               
               Mensajes "Ingrese el número de documento en la cuenta " & CE(lArrDetalle(Fila, nColPla_cCuentaContable)), vbOKOnly + vbInformation
               
               
               If CuentaMensajes < 2 Then tdbgDetalle.Bookmark = Fila
               DoEvents
               tdbgDetalle.Col = nColAsd_cNumDoc
               pSetFocus tdbgDetalle
               ValidaCamposDetalle = False
               
               Exit Function
           End If
         'End If
     End If
    
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgDetalle_RowColChange
' Description:       Evento que se ejecuta al cambiar la fila del detalle
'
' Parameters :       LastRow (Variant)
'                    LastCol (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbgDetalle_RowColChange(LastRow As Variant, ByVal LastCol As Integer)
    Dim sql As String
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
   
    
    On Local Error GoTo ErrorEjecucion
    
    If LastRow <> "" And LastRow <> tdbgDetalle.Bookmark Then
       If ValidaCamposDetalle(NE(LastRow)) = False Then
          Exit Sub
       End If
    End If
    
    If gsFlagBotonBarra = True Then
        Exit Sub
    End If
    
    ' ---  Valida que Valor Embarcado no se active, si no es una 12 --------'
    If Left(CE(tdbgDetalle.Columns(nColPla_cCuentaContable)), 2) = "12" And (CE(tdbgDetalle.Columns(nColAsd_cTipoDocRef)) = "50" Or CE(tdbgDetalle.Columns(nColAsd_cTipoDocRef)) = "52") Then
        tdbtMonedaAdic.Enabled = True
    Else
        tdbtMonedaAdic.Enabled = False
    End If
    
    If CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) = "99" And gsPLE = 1 Then
        Mensajes "Estimado Usuario: Esta opción ha sido deshabilitada por " & vbCrLf & " R.S. 248-2012/SUNAT ingrese en forma individual la información.", vbInformation
        tdbgDetalle.Columns(nColAsd_cTipoDoc) = ""
        tdbgDetalle.Col = tdbgDetalle.Col - 1
'        pSaltoColGridActivo = False
        Exit Sub
    End If
    
    CuentaActiva = CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColPla_cCuentaContable))
    gsUltimaCuenta = CE(tdbgDetalle.Columns(nColPla_cCuentaContable))
    gsUltimoCC = CE(tdbgDetalle.Columns(nColCos_cCodigo))
    gsUltimaEnt = CE(tdbgDetalle.Columns(nColEnt_cCodEntidad))
    gsUltimoTD = CE(tdbgDetalle.Columns(nColAsd_cTipoDoc))
    
    gsSalirControl = False

    If gsKeyCodePress = True Then
        Exit Sub
    End If
    
    '-------------------- VERIFICA QUE LA CELDA NO SEA LA PRIMERA DE TODAS  -----------------------'
    If gsKeyCode = vbKeyLeft And tdbgDetalle.Col <= 1 And tdbgDetalle.Bookmark = 0 Then
        Exit Sub
    End If
    '---------------- ACTUALIZA LISTA DE PROCESOS  -----------------------'
    If NE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgCCosto)) = 1 Then
        ActivarControl tdbcProceso, True
    Else
        tdbcProceso.BoundText = ""
        ActivarControl tdbcProceso, False
    End If
    
    '---------------- ACTUALIZA LABEL DE DESCRIPCIONES -----------------------'
    If CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)) <> "" Then
        If tdbgDetalle.Col = nColAsd_cTipoDoc Then
            lblNomEnti.Caption = CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNomTD))
            lblEntidad.Caption = "TIPO DOC: "
        ElseIf tdbgDetalle.Col = nColCos_cCodigo Then
            lblNomEnti.Caption = CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cNomCC))
            lblEntidad.Caption = "C.COSTO: "
        Else
            lblNomEnti.Caption = CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColEnt_cPersona))
            lblEntidad.Caption = "ENTIDAD: "
        End If
        If Trim(lblNomEnti.Caption) = "ANULADO" Or Trim(lblNomEnti.Caption) = "ANULADA" Then
            sql = "select * from CNT_lIBROSGENERADOS where Emp_cCodigo = '" & gsEmpresa & "' and Pan_cAnio = '" & gsAnio & "' and Per_cPeriodo = '" & gsPeriodo & "' and Lib_cTipoLibro = '" & tdbcLibro.BoundText & "' and Estado ='A'"
            If ExisteDato(sql) = False Or (Month(dtpFecha.Value) = Month(lsFecha) And Year(dtpFecha.Value) = Year(lsFecha)) Then
                EstadoDes = "2"
            End If
        End If
        
        lblCuenta.Caption = "CUENTA: "
        lblDesCta.Caption = CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColPla_cNombreCuenta))
    Else
    
        lblCuenta.Caption = ""
        lblNomEnti.Caption = ""
        lblDesCta.Caption = ""
        lblEntidad.Caption = ""
    End If
    
    '--------------------- SI NO TIENE CUENTA NO DESPLAZAR  -------------------------'
    If CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)) = "" Then
        tdbcBaseImponible.BoundText = ""
        tdbcPagoIGV.BoundText = ""
        tdbcTipoTx.BoundText = ""
        tdbtGlosa.Text = ""
        
        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cBaseImp) = ""
        'UpdateGrilla
        
        tdbgDetalle.RefreshRow
        DoEvents
        
        Activar tdbcBaseImponible, False
        ActivarControl tdbcPagoIGV, False
        ActivarControl tdbcTipoTx, False
        ActivaCamposDocumRef
        ActualizaCamposPagoIVG True
        
        tdbgDetalle.Col = nColPla_cCuentaContable
        
        tdbcTipoPago.Visible = False
        lblBaseImponible.Caption = "Base :"
        
        If tdbcLibro.BoundText <> lsLibroCom And tdbcLibro.BoundText <> lsLibroVen And tdbcLibro.BoundText <> lsLibroDiario Then
           Call OcultaComboBase(False)
        End If
        
        pSetFocus tdbgDetalle
        Exit Sub
    Else
        '----------------------------
        
        Call ActivaBaseImponible

        
        If Left(CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)), 2) = "10" Then
            tdbcTipoPago.Visible = True
            lblBaseImponible.Caption = "Medio :"
            tdbcTipoPago.BoundText = lArrDetalle(tdbgDetalle.Bookmark, nColTra_cCodigo)
        Else
            tdbcTipoPago.Visible = False
            lblBaseImponible.Caption = "Base :"
            tdbcTipoPago.BoundText = ""
        End If
        
        If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Or tdbcLibro.BoundText = lsLibroDiario Or Left(CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)), 2) = "10" Then
            lblBaseImponible.Visible = True
        Else
            lblBaseImponible.Visible = False
        End If
        
        pSetFocus tdbgDetalle
    End If
    
    Dim sqlver As String, valorDato As String
    
    
    Call PintaCajasTextNumerico
    Call PintaCajasFecha
    Call ActivaChekRegAuxiliares


    '---------------------------------------------------------------------------'
    
    
    If LastRow <> "" Then
        With tdbgDetalle
            ' ----------- SI ESTA ACTIVADA LA PESTAÑA DE EDITAR VOUCHER  -----'
            If sstAsientos.TabEnabled(1) = True Then
                
                If LastRow = .Bookmark And .Col = nColAsd_cGlosa And .Columns(nColAsd_nItem) <> "" Then
                   ' ----------- COPIA LA GLOSA DEL ANTERIOR -----'
                   If .Columns(nColAsd_nItem) > 1 Then
                      If .Columns(nColAsd_cGlosa) = "" Then .Columns(nColAsd_cGlosa) = lArrDetalle.Value(LastRow - 1, nColAsd_cGlosa)
                   Else
                      If .Columns(nColAsd_cGlosa) = "" Then .Columns(nColAsd_cGlosa) = tdbtObservaciones
                   End If
                End If

                If LastRow <> .Bookmark Then
                    ' --------------- MONEDA ADICIONAL ------------
                    Me.tdbcMonedaAdic.BoundText = CE(lArrDetalle(.Bookmark, nColAsd_cMonAdic))
                    Me.tdbtMonedaAdic.Value = NE(lArrDetalle(.Bookmark, nColAsd_cImpAdic))
                    
                    ' --------------- COMBO BASE IMP ------------
                    tdbcBaseImponible.BoundText = lArrDetalle(.Bookmark, nColAsd_cBaseImp)
                    
                    ' --------------- COMBO MEDIO DE PAGO ------------
                    If (Left(CE(lArrDetalle(.Bookmark, nColPla_cCuentaContable)), 2) = "43") And _
                        CE(lArrDetalle(.Bookmark, nColAsd_cBaseImp)) <> "" And tdbcLibro.BoundText = lsLibroCom Then
                        tdbcBaseImponible.BoundText = ""
                    Else
                        tdbcTipoPago.BoundText = lArrDetalle(.Bookmark, nColTra_cCodigo)
                    End If
                    
                    ' -------------- COMBO PAGO IGV SOLO PARA LIBRO CAJA, DIARIO, COMPRAS (RETEN, PERCEP, DETRAC) --------------'
                    If NE(.Columns(nColAsd_cDestino)) <> 1 And CE(.Columns(nColPla_cCuentaContable)) <> "" Then
                        ActivaComboTipoIGV lArrDetalle(.Bookmark, nColPla_cDetraccion), lArrDetalle(.Bookmark, nColPla_cRetencion), lArrDetalle(.Bookmark, nColPla_cPercepcion)
                        
                        tdbcTipoTx.BoundText = lArrDetalle.Value(.Bookmark, nColAsd_cFormaPago)
                        
                        DoEvents
                    Else
                        tdbcPagoIGV.BoundText = ""
                        Activar tdbcPagoIGV, False
                        tdbcTipoTx.BoundText = ""
                        Activar tdbcTipoTx, False
                    End If
                    '--------------- ACTIVA CAJAS DE TEXTO DE LOS DOCUMENTOS --------------------'
                    Call LlenaCajaTextoPagoIGV
                    Call ActivaCamposDocumRef
                    '--------------- VALIDA SI ES UNA CTA GENERADA (PARTE SUP DEL FRAME) --------
                    If VerificaCuentaDestino = True Then
                       Activar tdbtGlosa, False
                    Else
                       Activar tdbtGlosa, True
                    End If
                    '-------------------------------------------------------------------------------'
                    pSetFocus tdbgDetalle
                End If
            End If
        End With
    End If
    DoEvents
    gsColumna = tdbgDetalle.Col
    'Me.lblCaption.Caption = " BUSCAR EN : " & UCase(tdbgDetalle.Columns(tdbgDetalle.Col).Caption)
    gsKeyCodePress = False
    CuentaMensajes = 0
            
    Exit Sub
    
ErrorEjecucion:
    'Mensajes "Evento RowColChange TGBGDetalle, " & Str(Err.Number) & Err.Description, vbInformation
    pSetFocus tdbgDetalle
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ActivaBaseImponible
' Description:       Procedimiento que permite activar o desactivar la base imponible
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub ActivaBaseImponible()
    Dim sPla_cCuentaContable1 As String
    Dim sPla_cCuentaContable2 As String
    
    With tdbgDetalle
        If tdbcLibro.BoundText = lsLibroVen Or tdbcLibro.BoundText = lsLibroCom Then
        
            sPla_cCuentaContable2 = Left(CE(lArrDetalle(.Bookmark, nColPla_cCuentaContable)), 2)
            If (sPla_cCuentaContable2 = "12" Or sPla_cCuentaContable2 = "16") And _
                CE(lArrDetalle(.Bookmark, nColAsd_cBaseImp)) = "" And tdbcLibro.BoundText = lsLibroVen Then
                Activar tdbcBaseImponible, False
                
            ElseIf (sPla_cCuentaContable2 = "42" Or sPla_cCuentaContable2 = "46" Or sPla_cCuentaContable2 = "48") And _
                CE(lArrDetalle(.Bookmark, nColAsd_cBaseImp)) = "" And tdbcLibro.BoundText = lsLibroCom Then
                
                Activar tdbcBaseImponible, False
                
            ElseIf (sPla_cCuentaContable2 = "43") And _
                    (CE(lArrDetalle(.Bookmark, nColAsd_cBaseImp)) <> "" Or _
                    CE(lArrDetalle(.Bookmark, nColAsd_cBaseImp)) = "") And _
                    tdbcLibro.BoundText = lsLibroCom Then
                lArrDetalle(.Bookmark, nColAsd_cBaseImp) = ""
                Activar tdbcBaseImponible, False
            Else
                Activar tdbcBaseImponible, True
            End If
        End If
        
        If tdbcLibro.BoundText = lsLibroDiario Then
            sPla_cCuentaContable1 = Left(CE(lArrDetalle(.Bookmark, nColPla_cCuentaContable)), 1)
            If (sPla_cCuentaContable1 = "9" Or sPla_cCuentaContable1 = "6") Then
                Activar tdbcBaseImponible, True
            Else
                Activar tdbcBaseImponible, False
            End If
        End If
    End With
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ActivaChekRegAuxiliares
' Description:       Procedimiento que activa el check de registos auxiliares solo si el Td es una boleta
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub ActivaChekRegAuxiliares()
    Dim Valor As Integer
    Valor = NE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cRegAux))
    If Valor > 0 Then Valor = 1
        
    If lnOpcion = 2 Then
        ChkRegAux.Enabled = False
    Else
        ChkRegAux.Enabled = True
    End If
    
    
    If BuscaRsBolVenta(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDoc)) = True Then
        ChkRegAux.Visible = True
        ChkRegAux.Value = Valor
        
        If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cRegAuxDet)) = "1" Then ChkRegAux.Enabled = False
    Else
        ChkRegAux.Value = vbUnchecked
        ChkRegAux.Visible = False
        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cRegAux) = "0"
        
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgDetalle_BeforeRowColChange
' Description:       Evento que se ejecuta al cambiar de fila en el detalle del voucher
'
' Parameters :       Cancel (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbgDetalle_BeforeRowColChange(Cancel As Integer)

    If lItem = 0 Then lItem = 1
    
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Cancel = 0
        Exit Sub
    End If
    
    If gsKeyCode = vbKeyLeft And tdbgDetalle.Col = nColPla_cCuentaContable Then
       Cancel = 1
       Exit Sub
    End If
    
    If gsKeyCode = vbKeyRight Then
        If NE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgMonNac)) = 1 And tdbgDetalle.Col = nColAsd_nHaberSoles Then
            Cancel = 1
            Exit Sub
        End If
        
        If NE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgMonNac)) = 0 And tdbgDetalle.Col = nColAsd_nHaberMonExt Then
            Cancel = 1
            
            Exit Sub
        End If
    
    End If
    
    If gsKeyCodePress = True Then
        Cancel = 1
        Exit Sub
    End If
    
    
    gsFlagKeydownDet = False
    
    If lnOpcion = 2 Then 'modo consulta
       Exit Sub
    End If
    
    '-------------- Verifica Fecha de vencimiento ------------------------'
    'If tdbgDetalle.Columns(td) = "14" Then
        If tdbgDetalle.Col = nColAsd_dFecVen Then
           If CE(tdbgDetalle.Columns(nColAsd_dFecVen)) = "__/__/____" Then
               tdbgDetalle.Columns(nColAsd_dFecVen) = ""
           End If
    '    End If
    End If
    
    '-------------- Verifica Fecha de documento ------------------------'
  
    If tdbgDetalle.Col = nColAsd_dFecDoc Then
       If tdbgDetalle.Columns(nColAsd_dFecDoc) = "__/__/____" Then
           tdbgDetalle.Columns(nColAsd_dFecDoc) = ""
       End If
       
       If IsDate(tdbgDetalle.Columns(nColAsd_dFecDoc)) And tdbcLibro.BoundText = lsLibroCom Then
           Dim dFechaAct As Date
           Dim dFechaMin As Date
           
           dFechaAct = dtpFecha.Value
           dFechaMin = DateAdd("m", gsMesesAnteriores * -1, dFechaAct)
           
           'PGBV - 04012013
           
          
           If CE(tdbgDetalle.Columns(nColEnt_cCodEntidad)) <> "" Then
                If EstadoDes = "" Then
                    If tdbgDetalle.Columns(nColAsd_dFecDoc) > dFechaMin Then
                        'If Month(tdbgDetalle.Columns(nColAsd_dFecDoc)) < Month(lsFecha) Or Year(tdbgDetalle.Columns(nColAsd_dFecDoc)) < Year(lsFecha) And Year(dtpFecha.Value) <= Year(lsFecha) Then
                            EstadoOri = "6"
                            If Month(dFechaAct) = Month(tdbgDetalle.Columns(nColAsd_dFecDoc)) And Year(dFechaAct) = Year(tdbgDetalle.Columns(nColAsd_dFecDoc)) Then
                               'If Trim(EstadoOri) = "" Then EstadoOri = "1"
                               EstadoOri = "1"
                            End If
                        'End If
                    ElseIf tdbgDetalle.Columns(nColAsd_dFecDoc) < dFechaMin Then
                        Mensajes "El comprobante ingresado supera los " & CE(gsMesesAnteriores) & " meses (Revise parametros iniciales), se informará a SUNAT lo que implicaría una infracción tributaria. "
                        If MsgBox("Desea continuar..?", vbQuestion + vbOKCancel, gsNombreModulo) = vbOK Then
                           EstadoOri = "7"
                        Else
                            tdbgDetalle.Columns(nColAsd_dFecDoc) = dFechaAct
                        End If
                    End If
                Else
                    EstadoDes = "9"
                End If
           End If
       End If
       
    End If
    
        '-------------- Verifica Fecha de documento ------------------------'
    If tdbgDetalle.Col = nColAsd_dFecDoc Then
       If tdbgDetalle.Columns(nColAsd_dFecDoc) = "__/__/____" Then
           tdbgDetalle.Columns(nColAsd_dFecDoc) = ""
       End If
       
       
       If IsDate(tdbgDetalle.Columns(nColAsd_dFecDoc)) And tdbcLibro.BoundText = lsLibroVen Then
            If CE(tdbgDetalle.Columns(nColEnt_cCodEntidad)) <> "" And EstadoDes = "" Then
                'If Month(tdbgDetalle.Columns(nColAsd_dFecDoc)) <> Month(dtpFecha.Value) And Year(tdbgDetalle.Columns(nColAsd_dFecDoc)) <> Year(dtpFecha.Value) Then   'And Year(dtpFecha.Value) = Year(lsFecha) Then
                If Month(CDate(tdbgDetalle.Columns(nColAsd_dFecDoc))) < Month(dtpFecha.Value) And Year(CDate(tdbgDetalle.Columns(nColAsd_dFecDoc))) <= Year(dtpFecha.Value) Then
                    Mensajes "El comprobante ingresado corresponde a un período anterior, se informará a SUNAT lo que implicaría una infracción tributaria. "
                    If MsgBox("Desea continuar..?", vbQuestion + vbOKCancel, gsNombreModulo) = vbOK Then
                        EstadoDes = "8"
                    Else
                        tdbgDetalle.Columns(nColAsd_dFecDoc) = dFechaAct
                    End If
                Else
                EstadoOri = ""
                End If
            End If
       End If
       
    End If
    
    '-------------- Completa los digitos de tipo de documento ------------------------'
    If tdbgDetalle.Col = nColAsd_cTipoDoc Then
       If IsNumeric(CE(tdbgDetalle.Columns(nColAsd_cTipoDoc))) Then
           tdbgDetalle.Columns(nColAsd_cTipoDoc) = Right("00" & CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)), 2)
       End If
    End If

    '-------------- Completa los digitos del numero de serie ------------------------'
    If tdbgDetalle.Col = nColAsd_cSerieDoc Then
       If CE(tdbgDetalle.Columns(nColAsd_cSerieDoc)) <> "" Then
            If Len(CE(tdbgDetalle.Columns(nColAsd_cSerieDoc))) > 3 Then
                tdbgDetalle.Columns(nColAsd_cSerieDoc) = CE(tdbgDetalle.Columns(nColAsd_cSerieDoc))
            Else
                tdbgDetalle.Columns(nColAsd_cSerieDoc) = Right("0000" & CE(tdbgDetalle.Columns(nColAsd_cSerieDoc)), 4)
            End If
       End If
    End If
    '-------------- Completa los digitos del numero de documento ------------------------'
    If tdbgDetalle.Col = nColAsd_cNumDoc Then
       If CE(tdbgDetalle.Columns(nColAsd_cNumDoc)) <> "" Then
            If Len(CE(tdbgDetalle.Columns(nColAsd_cNumDoc))) > 8 Then
                tdbgDetalle.Columns(nColAsd_cNumDoc) = CE(tdbgDetalle.Columns(nColAsd_cNumDoc))
            Else
                tdbgDetalle.Columns(nColAsd_cNumDoc) = Right("00000000" & CE(tdbgDetalle.Columns(nColAsd_cNumDoc)), 8)
            End If
       End If
    End If
    '-------------- Completa los digitos del codigo de entidad ------------------------'
    If tdbgDetalle.Col = nColEnt_cCodEntidad Then
       If CE(tdbgDetalle.Columns(nColEnt_cCodEntidad)) <> "" Then
            tdbgDetalle.Columns(nColEnt_cCodEntidad) = Right("00000" & CE(tdbgDetalle.Columns(nColEnt_cCodEntidad)), 5)
            
            pSetFocus tdbgDetalle
            DoEvents
            
       End If
    End If
    
    '-------------- Validación del tipo, serie y numero de documento -------------------'
    'LIN 00
    If lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1 And NE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgProv) = 1) Then
        'LIN 01
        If (tdbgDetalle.Col = nColAsd_cTipoDoc Or _
            tdbgDetalle.Col = nColAsd_cSerieDoc Or _
            tdbgDetalle.Col = nColAsd_cNumDoc) Or _
           ((tdbgDetalle.Col = nColPla_cCuentaContable Or _
            tdbgDetalle.Col = nColEnt_cCodEntidad) And lnOpcion <> 2) Then
    
            pUpdateArray
    
    
            If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cEntTipSerNum)) <> BuscaEntTipSerNum(tdbgDetalle.Bookmark) Then
    
                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nCorre) = 0
                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nSaldoProv) = 0
                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nSaldoExtProv) = 0
            End If
        '-------------------------------------------------
    
             'LIN 04
             If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cEntTipSerNum)) = BuscaEntTipSerNum(tdbgDetalle.Bookmark) And _
               (NE(tdbgDetalle.Columns(nColAsd_nDebeSoles)) + _
                NE(tdbgDetalle.Columns(nColAsd_nHaberSoles)) + _
                NE(tdbgDetalle.Columns(nColAsd_nDebeMonExt)) + _
                NE(tdbgDetalle.Columns(nColAsd_nHaberMonExt)) = 0) Then
    
                 'LIN 05
                 If BuscaDocumentoProvisionado = True Then
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cProvCanc) = "C"
                 Else
                    'si se encuentra el documento en otra fila del detalle
                    'gsDocEnDetalle  se actualiza con la funcion BuscaDocumentoProvisionado
                    'LIN 06
                    If gsDocEnDetalle = True Then
                         tdbgDetalle.Col = nColAsd_cNumDoc
                         tdbgDetalle.Columns(nColAsd_cNumDoc) = ""
                         UpdateGrilla
    
                         Mensajes gsMensaje, vbOKOnly + vbInformation
                         Cancel = 1
                         pSetFocus tdbgDetalle
                         Exit Sub
    
                    Else
                         lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cProvCanc) = "P"
                         
                         If gsDocSinSaldo = True Then
                             tdbgDetalle.Col = nColAsd_cNumDoc
                             tdbgDetalle.Columns(nColAsd_cNumDoc) = ""
                             
                             UpdateGrilla
    
                             Mensajes gsMensaje, vbOKOnly + vbInformation
                             Cancel = 1
                             pSetFocus tdbgDetalle
                             Exit Sub
                             
                         End If
    
                    End If 'FLIN 06
    
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nSaldoProv) = 0
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nSaldoExtProv) = 0
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nCorre) = 0
    
    
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cDetCorrel) = lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nCorre)
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cDetProvCanc) = lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cProvCanc)
    
                 End If 'FLIN 05
            End If 'FLIN 04
    
    
            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cGuardado) = "N"
    
            '-------------------------------------------------
            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    
    
            RefreshGrilla
    
            DoEvents
    
        End If 'FLIN 01
    End If 'FLIN 00
    
    '-------------------- VALIDA importes de provision -------------------------------'
    If tdbgDetalle.Col = nColAsd_nDebeSoles Then
       If ValidaNaturalezaCta = False Then
          Cancel = 1
          DoEvents
          SumarTotales
          Exit Sub
       End If
       
       If NE(tdbgDetalle.Columns(nColAsd_nDebeSoles)) <> NE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nDebeSoles)) Then
          lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
       End If
       
    End If
    
    If tdbgDetalle.Col = nColAsd_nHaberSoles Then
       If ValidaNaturalezaCta = False Then
          Cancel = 1
          DoEvents
          SumarTotales
          Exit Sub
       End If
       
       If NE(tdbgDetalle.Columns(nColAsd_nHaberSoles)) <> NE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nHaberSoles)) Then
          lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
       End If
       
    End If
    
    If tdbgDetalle.Col = nColAsd_nDebeMonExt Then
       If ValidaNaturalezaCta = False Then
          Cancel = 1
          DoEvents
          SumarTotales
          Exit Sub
       End If
       
       If NE(tdbgDetalle.Columns(nColAsd_nDebeMonExt)) <> NE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nDebeMonExt)) Then
          lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
       End If
       
    End If
    
    If tdbgDetalle.Col = nColAsd_nHaberMonExt Then
       If ValidaNaturalezaCta = False Then
          Cancel = 1
          DoEvents
          SumarTotales
          Exit Sub
       End If
       
       If NE(tdbgDetalle.Columns(nColAsd_nHaberMonExt)) <> NE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nHaberMonExt)) Then
          lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
       End If
       
    End If
    
   
    '-------------- valida el tipo de CAMBIO ------------------------'
    If tdbgDetalle.Col = nColAsd_nTipoCambio And _
       gsActualizaTC = True And _
       tdbgDetalle.Columns(nColAsd_cOperaTC) <> "OTR" Then
       
        MantenimientoTipoCambio NE(tdbgDetalle.Columns(nColAsd_nTipoCambio))
        gsActualizaTC = False
    End If

    '-------------- valida el tipo de MONEDA ------------------------'
    If tdbgDetalle.Col = nColAsd_cNomMoneda And CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) <> "" Then
       If CE(tdbgDetalle.Columns(nColAsd_cNomMoneda)) = "" Then
            RefreshGrilla
            DoEvents
            Mensajes "Moneda no existe, verificar...", vbInformation
            
            
            pSetFocus tdbgDetalle
            Cancel = 1
            
            
            Exit Sub
       End If
    End If
    
    '-------------- valida el tipo de OPERACION ------------------------'
    If tdbgDetalle.Col = nColAsd_cOperaTC And CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) <> "" Then
       If CE(tdbgDetalle.Columns(nColAsd_cOperaTC)) = "" Then
            RefreshGrilla
            DoEvents
            Mensajes "Operación no existe, verificar...", vbInformation
            pSetFocus tdbgDetalle
            Cancel = 1
            Exit Sub
       End If
    End If
    
    '-------------------- VERIFICA QUE LA CELDA NO SEA LA PRIMERA DE TODAS  -----------------------'
    If gsKeyCode = vbKeyLeft And tdbgDetalle.Col <= 1 And tdbgDetalle.Bookmark = 0 Then
        Exit Sub
    End If
    
    '---------------------- SI ES GENERADA NO DESPLAZAR --------------------------'
    If VerificaCuentaDestino = True Then
        Exit Sub
    End If
    
    '--------------------- SI NO TIENE CUENTA NO DESPLAZAR DERECHA -------------------------'
    If CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColPla_cCuentaContable)) = "" And gsKeyCode = vbKeyRight Then
        Cancel = 1
        Exit Sub
    End If
    
    '---------------------- PINTA SEGUN TIPO DE MONEDA --------------------------'
    If tdbgDetalle.Col = nColAsd_cNomMoneda Then
       tdbgDetalle.RefreshRow
    End If
    
    '-----------------------------------------------------------------------------'
    
    If CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nCol_cTipoEntiCta)) = "" Then
       lArrDetalle(tdbgDetalle.Bookmark, nColEnt_cCodEntidad) = ""
    End If
    
    If CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nCol_cFlgCCosto)) = "0" Then
       lArrDetalle(tdbgDetalle.Bookmark, nColCos_cCodigo) = ""
    End If
    
    If CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColPla_cDocumento)) = "0" Then
       lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDoc) = ""
       lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cSerieDoc) = ""
       lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumDoc) = ""
    End If
    
    
     '-------------------- VALIDA TIPO DE DOCUMENTO -------------------------------'
    If (tdbgDetalle.Col = nColAsd_cTipoDoc Or tdbgDetalle.Col = nColAsd_cSerieDoc Or tdbgDetalle.Col = nColAsd_cNumDoc) And ValidaDentroPeriodo Then
         If CE(tdbgDetalle.Columns(nColPla_cDocumento).Value) = "1" And CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) <> "" Then
            If CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) = "" Then
              UpdateGrilla

              If gsKeyPressF1 = True Or gsColumnaInicialPress = nColAsd_cTipoDoc Then
                Mensajes "Ingrese el Tipo de Documento", vbInformation
                tdbgDetalle.Col = nColAsd_cTipoDoc
              End If
              
              pSetFocus tdbgDetalle
              Cancel = 1
              Exit Sub
            End If
        End If
     End If
     
     '-------------------- VALIDA LA FECHA DE VENCIMIENTO-------------------------------'
    If (tdbgDetalle.Col = nColAsd_dFecVen) And ValidaDentroPeriodo Then
         If CE(tdbgDetalle.Columns(nColAsd_cTipoDoc).Value) = "14" And CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) <> "" Then
            If CE(tdbgDetalle.Columns(nColAsd_dFecVen)) = "" Then
              UpdateGrilla

              If gsKeyPressF1 = True Or gsColumnaInicialPress = nColAsd_dFecVen Then
                Mensajes "Ingrese la fecha de vencimiento", vbInformation
                tdbgDetalle.Col = nColAsd_dFecVen
              End If
              
              pSetFocus tdbgDetalle
              Cancel = 1
              Exit Sub
            End If
        End If
     End If
     
    '-------------------- VALIDA SERIE DEL DOCUMENTO -------------------------------'
    If tdbgDetalle.Col = nColAsd_cSerieDoc And ValidaDentroPeriodo Then
         If CE(tdbgDetalle.Columns(nColPla_cDocumento).Value) = "1" Then

            If CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) <> "99" And _
               CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) <> "98" And _
               CE(tdbgDetalle.Columns(nColAsd_cSerieDoc)) = "" Then
                      UpdateGrilla
                      
                      Mensajes "Ingrese el Nro de Serie en el registro actual", vbInformation
                      tdbgDetalle.Col = nColAsd_cSerieDoc
                      tdbgDetalle.Columns(nColAsd_cSerieDoc) = ""

                      pSetFocus tdbgDetalle
                      Cancel = 1
                      Exit Sub
            End If
        End If
     End If
    '-------------------- VALIDA NUMERO DEL DOCUMENTO -------------------------------'
   
    If tdbgDetalle.Col = nColAsd_cNumDoc Then
       If CE(tdbgDetalle.Columns(nColPla_cDocumento).Value) = "1" And ValidaDentroPeriodo Then

            If CE(tdbgDetalle.Columns(nColAsd_cNumDoc)) = "" Then
                      UpdateGrilla

                      Mensajes "Ingrese el Nro de documento en el registro actual", vbInformation
                      tdbgDetalle.Col = nColAsd_cNumDoc
                      tdbgDetalle.Columns(nColAsd_cNumDoc) = ""

                      DoEvents
                      pSetFocus tdbgDetalle
                      Cancel = 1
                      Exit Sub
            End If
        
            If (CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) = "99" Or _
               CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) = "98") And _
               CE(tdbgDetalle.Columns(nColAsd_cNumDoc)) = "" And _
               CE(tdbgDetalle.Columns(nColAsd_cSerieDoc)) = "" And NE(tdbgDetalle.Columns(nCol_cFlgProv)) = 1 Then
                      UpdateGrilla
                      
                      Mensajes "Ingrese la serie o el número de documento del registro actual", vbInformation
                      tdbgDetalle.Col = nColAsd_cNumDoc
                      tdbgDetalle.Columns(nColAsd_cNumDoc) = ""

                      DoEvents
                      pSetFocus tdbgDetalle
                      Cancel = 1
                      Exit Sub
            End If
        
        End If
     End If
    
    '-------------------- VALIDA CODIGO CC -------------------------------'
    If tdbgDetalle.Col = nColCos_cCodigo And ValidaDentroPeriodo Then
    
       If CE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgCCosto)) = "1" And _
          CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) <> "" And _
          CE(tdbgDetalle.Columns(nColCos_cCodigo)) = "" Then
            UpdateGrilla
            
            Mensajes "Ingrese un codigo de centro de costo, verificar...", vbInformation
            tdbgDetalle.Col = nColCos_cCodigo
            tdbgDetalle.Columns(nColCos_cCodigo) = ""
            DoEvents
            pSetFocus tdbgDetalle
            Cancel = 1
            Exit Sub
       End If
    End If
    '-------------------- VALIDA CODIGO DE ENTIDAD -------------------------------'
    If tdbgDetalle.Col = nColEnt_cCodEntidad And ValidaDentroPeriodo Then
        If CE(tdbgDetalle.Columns(nColEnt_cCodEntidad)) = "" And CE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cTipoEntiCta)) <> "" Then
             UpdateGrilla
             
             Mensajes "Ingrese un codigo de entidad, verificar...", vbInformation
             tdbgDetalle.Col = nColEnt_cCodEntidad
             tdbgDetalle.Columns(nColEnt_cCodEntidad) = ""
             DoEvents
             
             If CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) = "" Then tdbgDetalle.Col = nColPla_cCuentaContable
             
             pSetFocus tdbgDetalle
             Cancel = 1
             Exit Sub
        
        End If
        
        Dim sql As String
        
        If Trim(lblNomEnti.Caption) = "ANULADO" Or Trim(lblNomEnti.Caption) = "ANULADA" Then
             sql = "select * from CNT_lIBROSGENERADOS where Emp_cCodigo = '" & gsEmpresa & "' and Pan_cAnio = '" & gsAnio & "' and Per_cPeriodo = '" & gsPeriodo & "' and Lib_cTipoLibro = '" & tdbcLibro.BoundText & "' and Estado ='A'"
            If ExisteDato(sql) = False Or (Month(dtpFecha.Value) = Month(lsFecha) And Year(dtpFecha.Value) = Year(lsFecha)) Then
                EstadoDes = "2"
            End If
        End If
    End If
    '----------------- VALIDA LA CELDA Y LE ASIGNA NUEVA COLUMNA -----------------'
     Dim Valido As Boolean
     Dim Columna As Integer
     Columna = tdbgDetalle.Col
     gsColumna = tdbgDetalle.Col

     DoEvents
     
     Valido = pSaltoColGridActivo(tdbgDetalle.Col)
     
     DoEvents
     
     If gsKeyCode = 13 Or gsKeyCode = vbKeyLeft Or gsKeyCode = vbKeyRight Then
        Cancel = 1
        If CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) = "" Then
            gsColumna = tdbgDetalle.Col
            'gsUltimaCuenta = ""
            'tdbgDetalle.Columns(nColPla_cCuentaContable) = ""
        End If
     Else
        Cancel = 0
        
        If Valido = False Then Cancel = 1
        If tdbgDetalle.Bookmark = NumeroFilas Then Cancel = 0
     End If
     
     
     If tdbgDetalle.Col >= nColAsd_nDebeSoles And tdbgDetalle.Col <= nColAsd_nHaberMonExt Then
           UpdateGrilla
           SumarTotales
     End If
     
     
    If gsKeyCode = 13 Then
        If tdbgDetalle.Col = nColAsd_nHaberSoles And CheckCuadraCompMan.Value = vbUnchecked Then
           gsColumna = nColPla_cCuentaContable
        End If
        
        If tdbgDetalle.Col = nColAsd_nHaberMonExt Then
            gsColumna = nColPla_cCuentaContable
        End If
    End If
                     
    'DoEvents
    tdbgDetalle.Col = gsColumna
    
    pSetFocus tdbgDetalle
    gsFlagKeydownDet = False
    gsKeyCodePress = False
        
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ValidaDentroPeriodo
' Description:       Funcino que valida si se esta fuera del periodo de enero a diciembre
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function ValidaDentroPeriodo() As Boolean
    If tdbcMes.BoundText = "00" Or tdbcMes.BoundText > "12" Then
        ValidaDentroPeriodo = False
    Else
        ValidaDentroPeriodo = True
    End If
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ValidaCamposDoc
' Description:       Funcion que valida los campos del documento
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function ValidaCamposDoc() As Boolean

    ValidaCamposDoc = False
    
    If CE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgProv)) = "1" And _
       CE(lArrDetalle(tdbgDetalle.Bookmark, nColEnt_cCodEntidad)) <> "" And _
       CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDoc)) <> "" Then
       
       If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDoc)) <> "99" And CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDoc)) <> "98" Then
       
            If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cSerieDoc)) <> "" And _
               CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumDoc)) <> "" Then
               
               ValidaCamposDoc = True
            End If
       Else
            If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cSerieDoc)) <> "" Or _
               CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumDoc)) <> "" Then
               
               ValidaCamposDoc = True
            End If
       End If
     End If


End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ValidaNaturalezaCta
' Description:       Funcin que valida que el importe ingresado este segun su naturaleza
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function ValidaNaturalezaCta() As Boolean
    Dim Valor As Double
    Dim Cuenta As String
    Dim Col As Integer
    Dim Fil As Long
    Dim td As String
    
    On Error Resume Next
    
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If
    
    
    Fil = tdbgDetalle.Bookmark
    td = CE(lArrDetalle(Fil, nColAsd_cTipoDoc))
    Col = tdbgDetalle.Col
    Cuenta = CE(lArrDetalle(Fil, nColPla_cCuentaContable))
    
    ValidaNaturalezaCta = True
    
    
    If (NE(lArrDetalle(Fil, nCol_cFlgProv)) = 0 Or _
       CE(lArrDetalle(Fil, nColPla_cCuentaContable)) = "" Or _
       CE(lArrDetalle(Fil, nColEnt_cCodEntidad)) = "" Or _
       CE(lArrDetalle(Fil, nColAsd_cTipoDoc)) = "" Or _
       CE(lArrDetalle(Fil, nColAsd_cProvCanc)) <> "P") Or _
       (tdbcLibro.BoundText <> lsLibroDiario And _
       tdbcLibro.BoundText <> lsLibroCajIng And _
       tdbcLibro.BoundText <> lsLibroCajEgr) Then
       
       Exit Function
       
    End If
    
    If RetornaCtaEntTipSerNum(Fil) = CE(lArrDetalle(Fil, nColAsd_cXCtaEntTipSerNumFijo)) And _
       RetornaImportes(Fil) = CE(lArrDetalle(Fil, nColAsd_cXImportes)) And _
       RetornaOtros(Fil) = CE(lArrDetalle(Fil, nColAsd_cXOtrosVal)) Then
        Exit Function
    End If
    
    pUpdateArray
    
    Valor = NE(lArrDetalle(Fil, Col))
    Cuenta = CE(tdbgDetalle.Columns(nColPla_cCuentaContable))
    'si el valor mayor que cero y la cuenta no es de anticipos (cobrar/pagar)
    If Valor > 0 And Left(Cuenta, 3) <> "122" And Left(Cuenta, 3) <> "422" Then
        'cuenta por cobrar
        If CE(lArrDetalle(Fil, nColAsd_cCtaPagCob)) = "CC" Then
            
            If (Col = nColAsd_nHaberSoles Or Col = nColAsd_nHaberMonExt) And td <> gsTDNC Then
                tdbgDetalle.Columns(Col) = "0.00"
                lArrDetalle(Fil, Col) = "0.00"
                lArrDetalle(Fil, nColAsd_cModif) = 1
                UpdateGrilla
                
                Mensajes "Se necesita una provisión para este documento", vbOKOnly + vbInformation
                ValidaNaturalezaCta = False
            End If
        
            If (Col = nColAsd_nDebeSoles Or Col = nColAsd_nDebeMonExt) And _
                td = gsTDNC And _
                tdbcLibro.BoundText <> lsLibroDiario And _
                tdbcLibro.BoundText <> lsLibroCajIng And tdbcLibro.BoundText <> lsLibroCajEgr Then
            
                tdbgDetalle.Columns(Col) = "0.00"
                lArrDetalle(Fil, Col) = "0.00"
                lArrDetalle(Fil, nColAsd_cModif) = 1
                UpdateGrilla
                
                Mensajes "Se necesita una provisión para este documento", vbOKOnly + vbInformation
                ValidaNaturalezaCta = False
            End If
            
        End If
        'cuenta por pagar
        If CE(lArrDetalle(Fil, nColAsd_cCtaPagCob)) = "CP" Then
            
            If (Col = nColAsd_nDebeSoles Or Col = nColAsd_nDebeMonExt) And td <> gsTDNC Then
            
                tdbgDetalle.Columns(nColAsd_nDebeSoles) = "0.00"
                lArrDetalle(Fil, nColAsd_nDebeSoles) = "0.00"
                tdbgDetalle.Columns(nColAsd_nDebeMonExt) = "0.00"
                lArrDetalle(Fil, nColAsd_nDebeMonExt) = "0.00"
                
                lArrDetalle(Fil, nColAsd_cModif) = 1
                UpdateGrilla
                
                Mensajes "Se necesita una provisión para este documento", vbOKOnly + vbInformation
                ValidaNaturalezaCta = False
            End If
        
            If (Col = nColAsd_nHaberSoles Or Col = nColAsd_nHaberMonExt) And _
                td = gsTDNC And _
                tdbcLibro.BoundText <> lsLibroDiario And _
                tdbcLibro.BoundText <> lsLibroCajIng And tdbcLibro.BoundText <> lsLibroCajEgr Then
                
                tdbgDetalle.Columns(nColAsd_nHaberSoles) = "0.00"
                lArrDetalle(Fil, nColAsd_nHaberSoles) = "0.00"
                tdbgDetalle.Columns(nColAsd_nHaberMonExt) = "0.00"
                lArrDetalle(Fil, nColAsd_nHaberMonExt) = "0.00"
                
                lArrDetalle(Fil, nColAsd_cModif) = 1
                UpdateGrilla
                
                Mensajes "Se necesita una provisión para este documento", vbOKOnly + vbInformation
                ValidaNaturalezaCta = False
            End If
            
        End If
    End If
    pSetFocus tdbgDetalle
    
End Function


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       VerificaCuentaDestino
' Description:       Funcion que verifica la fila es o no una cuenta de destino
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function VerificaCuentaDestino() As Boolean
    If tdbgDetalle.Columns(nColAsd_cDestino) = "1" Then
        VerificaCuentaDestino = True
    Else
        VerificaCuentaDestino = False
    End If
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbgDetalle_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el detalle del voucher
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbgDetalle_KeyDown(KeyCode As Integer, Shift As Integer)

    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    Dim tipoTer As String
    Dim sqlver As String
    Dim valorDato As String
    Dim Cancel As Integer
    
    If lArrDetalle Is Nothing Then
        KeyCode = 0
        Exit Sub
    End If
    
    
    If KeyCode = 13 Then
        CuentaMensajes = 0
        If tdbgDetalle.Col = nColAsd_cNumDoc And _
        ((tdbgDetalle.Columns(nColAsd_nDebeSoles).Value = 0 And tdbgDetalle.Columns(nColAsd_nHaberSoles).Value = 0 And NE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgMonNac)) = 0) Or _
        (tdbgDetalle.Columns(nColAsd_nDebeMonExt).Value = 0 And tdbgDetalle.Columns(nColAsd_nHaberMonExt).Value = 0 And NE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgMonNac)) = 0)) Then
            tdbgDetalle.Enabled = False
        End If
    End If
    
    If gsFlagKeydownDet = True Then
        If tdbgDetalle.Col = nColAsd_nDebeSoles Or _
           tdbgDetalle.Col = nColAsd_nHaberSoles Or _
           tdbgDetalle.Col = nColAsd_nDebeMonExt Or _
           tdbgDetalle.Col = nColAsd_nHaberMonExt Then
            
           gsFlagKeydownDet = False
           TimerKey.Enabled = False
           gsKeyCodePress = False
        Else
           KeyCode = 0
           Exit Sub
        End If
    End If
    
    
    If KeyCode = 17 Then gsKeyControl = True
    
    If gsKeyCodePress = True Then
        KeyCode = 0
        gsKeyCodePress = False
        TimerKey.Enabled = False
        Exit Sub
    End If
    
    DoEvents
    gsKeyCode = KeyCode
    
    With tdbgDetalle
    
        '-------------- Valida que no modifique si no se ingreso una cuenta  ------------------------'
        If .Col <> nColPla_cCuentaContable And CE(.Columns(nColPla_cCuentaContable)) = "" And KeyCode <> vbKeyLeft And KeyCode <> vbKeyRight And KeyCode <> vbKeyUp And KeyCode <> vbKeyDown And KeyCode <> 13 Then
           KeyCode = 0
           Exit Sub
        End If
        '-------------------- VERIFICA QUE LA CELDA NO SEA LA PRIMERA DE TODAS  -----------------------'
        If gsKeyCode = vbKeyLeft And .Col <= 1 And .Bookmark = 0 Then
            Exit Sub
        End If
    
        '------------ TECLAS PAGEDOWN, PAGEUP, KEYUP, KEYDOWN --------'
        If KeyCode = vbKeyHome Then
           If lnOpcion <> 2 Then 'SI NO ES CONSULTA
                gsKeyCode = -1
                tdbgDetalle_BeforeRowColChange Cancel
                If Cancel = 1 Then
                    KeyCode = 0
                    Exit Sub
                End If
                DoEvents
                tdbgDetalle.Col = nColPla_cCuentaContable
                pSetFocus tdbgDetalle
                KeyCode = 0
                On Error Resume Next
                If NE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgMonNac)) = 0 Then
                    Call CalculaMonNac
                 End If
                
                UpdateGrilla
                
    
                SumarTotales
                Exit Sub
           Else 'SI ES CONSULTA
                tdbgDetalle.Col = nColPla_cCuentaContable
                pSetFocus tdbgDetalle
                KeyCode = 0
                Exit Sub
           End If
        End If
        
        If KeyCode = vbKeyEnd Then
           If lnOpcion <> 2 Then 'SI NO ES CONSULTA
                gsKeyCode = -1
                tdbgDetalle_BeforeRowColChange Cancel
                If Cancel = 1 Then
                    KeyCode = 0
                    Exit Sub
                End If
            
                If NE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgMonNac)) = 1 Then
                    tdbgDetalle.Col = nColAsd_nHaberSoles
                Else
                    tdbgDetalle.Col = nColAsd_nHaberMonExt
                End If
                
                pSetFocus tdbgDetalle
                KeyCode = 0
                On Error Resume Next
                If NE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgMonNac)) = 0 Then
                   Call CalculaMonNac
                 End If
                
                UpdateGrilla
                
    
                SumarTotales
                
                Exit Sub
            Else 'SI ES CONSULTA
                If NE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgMonNac)) = 1 Then
                    tdbgDetalle.Col = nColAsd_nHaberSoles
                Else
                    tdbgDetalle.Col = nColAsd_nHaberMonExt
                End If
                
                pSetFocus tdbgDetalle
                KeyCode = 0
                Exit Sub
            End If
        End If
        
        If KeyCode = vbKeyPageUp And gsKeyControl = True Then
        
            On Error Resume Next
            tdbgDetalle.MoveFirst
            tdbgDetalle.Col = nColPla_cCuentaContable
            pSetFocus tdbgDetalle
            KeyCode = 0
            Exit Sub
        End If
        
        If KeyCode = vbKeyPageDown And lItem > 1 And gsKeyControl = True Then
        
            On Error Resume Next
            tdbgDetalle.MoveLast
            tdbgDetalle.Col = nColPla_cCuentaContable
            pSetFocus tdbgDetalle
            KeyCode = 0
            Exit Sub
        End If
        
        If KeyCode = vbKeyPageUp Then
           If lnOpcion <> 2 Then 'SI NO ES CONSULTA
                gsKeyCode = -1
                tdbgDetalle_BeforeRowColChange Cancel
                If Cancel = 1 Then
                    KeyCode = 0
                    Exit Sub
                End If
            
                On Error Resume Next
                tdbgDetalle.MoveRelative -5
                If tdbgDetalle.BOF Then tdbgDetalle.MoveFirst
                Exit Sub
            Else 'SI ES CONSULTA
                On Error Resume Next
                tdbgDetalle.MoveRelative -5
                If tdbgDetalle.BOF Then tdbgDetalle.MoveFirst
                Exit Sub
            End If
        End If
        
        If KeyCode = vbKeyPageDown And lItem > 1 Then
           If lnOpcion <> 2 Then 'SI NO ES CONSULTA
                gsKeyCode = -1
                tdbgDetalle_BeforeRowColChange Cancel
                If Cancel = 1 Then
                    KeyCode = 0
                    Exit Sub
                End If
            
                On Error Resume Next
                tdbgDetalle.MoveRelative 5
                If tdbgDetalle.Bookmark > lItem - 1 Then
                     tdbgDetalle.Bookmark = lItem - 1
                End If
                Exit Sub
            Else 'SI ES CONSULTA
                On Error Resume Next
                tdbgDetalle.MoveRelative 5
                If tdbgDetalle.Bookmark > lItem - 1 Then
                     tdbgDetalle.Bookmark = lItem - 1
                End If
                Exit Sub
            
            End If
        End If
        
        
        If KeyCode = vbKeyDown Then
            If .Columns(nColAsd_nItem).Value = "" And .Col <> nColPla_cCuentaContable Then
                On Error Resume Next
                tdbgDetalle.Bookmark = lItem
                KeyCode = 0
                Exit Sub
            End If
        End If
        
        '--------- VALIDA QUE NO SEA CUENTA DE DESTINO ---------------'
        If (VerificaCuentaDestino = True Or CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColPla_cCuentaContable)) = "") And .Col <> nColPla_cCuentaContable Then
            Exit Sub
        End If
        '--------- VALIDA QUE NO SEA CUENTA CANCELADA ---------------'
        If CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_Cancelado)) = "1" And .Col <> nColPla_cCuentaContable Then
            Exit Sub
        End If
        
        '--------------- TECLA F1 AYUDA DE LA CELDA --------------------'
        If KeyCode = vbKeyF1 Then
           If lnOpcion = 2 Then
                KeyCode = 0
                Exit Sub
           End If
           
           If .Col = nColPla_cCuentaContable Then
                '-------------- Valida para que no edite si la cuenta es cancelada -----------------------'
                If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_Cancelado)) = "1" Then
                   UpdateGrilla
                   DoEvents
                   Mensajes "Provision tiene pagos registrados. Para poder modificar la cuenta, primero elimine los pagos", vbInformation
                   
                   pSetFocus tdbgDetalle
                   Exit Sub
                End If
                   
               Call LlamaBuscar(frmBuscador, "Cuentas", lControl, "CuentasN", Me, tdbcMes.BoundText, CE(.Columns(.Col).Value))
           End If
           
           If .Columns(nColAsd_nItem).Value = "" And .Col <> nColPla_cCuentaContable Then
               Exit Sub
           End If
            
           If .Col = nColAsd_cTipoDoc Then
              Call LlamaBuscar(frmBuscador, "TipoDocumentoAsiento", lControl, "TipoDocumentoAsiento", Me, tdbcMes.BoundText, tdbcLibro.BoundText)
           End If
            
           If .Col = nColCos_cCodigo And .Columns(nCol_cFlgCCosto).Value = "1" Then
              Call LlamaBuscar(frmBuscador, "CentroCosto", lControl, "CentroCosto", Me, tdbcMes.BoundText, CE(.Columns(.Col).Value))
           End If
            
           If .Col = nColEnt_cCodEntidad Then   ' *** Si es cuenta con Entidad, pedir Entidad
               tipoTer = .Columns(nCol_cTipoEntiCta).Value
               If Len(Trim(tipoTer)) = 0 Then Exit Sub
               
               Call LlamaBuscar(frmBuscador, "Entidad", lControl, "Entidad", Me, tdbcMes.BoundText, CE(tipoTer))
           End If
        End If
        '------------------------ TECLA ENTER DE LA CELDA ---------------------'
         gsColumnaInicialPress = .Col
        
        
        If KeyCode = 13 And Shift = 0 Then
        
            gsColumnaInicialPress = .Col
            
            If gsColumnaInicialPress = nColAsd_dFecDoc Or gsColumnaInicialPress = nColAsd_dFecVen Then
                UpdateGrilla
            End If
            
            '-------- NO EJECUTA EL ENTER SI ES GENERADA O ES CONSULTA -------------'
            If CE(.Columns(nColAsd_cDestino)) = "1" Or lnOpcion = 2 Then
                Exit Sub
            End If
            
            Dim SumaMontos  As Double
            
            '-- SALTO DE LINEA SOLO SI ES HABER_EXT YA Q NO SE EJECUTA CAMBIO DE CELDA POR SER ULTIMA COL --'
            If gsColumnaInicialPress = nColAsd_nHaberMonExt Then
                     
                If gsKeyCode = 13 Then
                     lItem = NumeroFilas
                     If lItem = 0 Then lItem = 1
                     
                     If ValModificoImpConSaldosProv = True Then
                         If ValidaProvCancel(tdbgDetalle.Bookmark) = False Then
                            gsKeyCode = 0
                            KeyCode = 0
                            tdbgDetalle.RefreshRow
                            Exit Sub
                         End If
                     End If
                     
                     UpdateGrilla
                     
                     If NE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgMonNac)) = 0 Then
                        Call CalculaMonNac
                        '.Columns(nColAsd_nDebeSoles) = Redondear(NE(.Columns(nColAsd_nDebeMonExt)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
                        '.Columns(nColAsd_nHaberSoles) = Redondear(NE(.Columns(nColAsd_nHaberMonExt)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
                      End If
                      
                      SumaMontos = NE(.Columns(nColAsd_nDebeSoles)) + NE(.Columns(nColAsd_nHaberSoles))
                      'If NE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cDetNac)) <> SumaMontos Then
                      
                        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
                        tdbgDetalle.RefreshRow
                        DoEvents
                        
                      'End If
                     
                     
                     If tdbgDetalle.Bookmark < lArrDetalle.Count(1) - 1 Then
                         On Error Resume Next
                         UpdateGrilla

                         tdbgDetalle.Bookmark = tdbgDetalle.Bookmark + 1
                         DoEvents
                     Else
                         On Error Resume Next
                         UpdateGrilla
                         
                         AgregaFilaDetalle 1
                         DoEvents
                     End If
                     
                     tdbgDetalle.Col = nColPla_cCuentaContable
                     DoEvents
                     SumarTotales
                     
                     IniciarCamposDocumento
                     Exit Sub
                End If
            End If

            '---------------- NUMERO DE CUENTA ------------------------'
            If .Col = nColPla_cCuentaContable Then
               If CE(.Columns(nColPla_cCuentaContable)) = gsUltimaCuenta Then
                  If (tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen) And CE(.Columns(nColAsd_cTipoMoneda)) <> tdbcMoneda.BoundText Then
                  Else
                      Exit Sub
                  End If
               End If
            
            
                lItem = NumeroFilas
                If lItem = 0 Then lItem = 1
                
                If CE(.Columns(.Col)) <> "" Then
                    gsFlagKeydownDet = True
                End If
                                
                gsKeyPressF1 = False
                gsUltimaCuenta = CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable))
                     
               If lnOpcion = 1 And CE(.Columns(nColAsd_nItem).Value) <> "" Then

                   If NE(.Columns(nColAsd_nCorre).Value) > 0 Then
                       
                       If .Columns(.Col) <> CuentaActiva Then
                            If ProvisionCancelada(.Columns(nColAsd_nCorre).Value) = True Then
                                RefreshGrilla
                                DoEvents

                                Mensajes "Provision tiene pagos registrados. Para poder modificar la cuenta, primero elimine los pagos", vbInformation
                                RefreshGrilla
                                gsFlagKeydownDet = False
                                Exit Sub
                            End If
                       End If
                   End If
               End If
               
               If CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) = "" Then
                  Exit Sub
               Else
                    valorDato = BuscaDatosCuenta(tdbgDetalle.Columns(nColPla_cCuentaContable))
                    
                    If valorDato = "" Then
                       tdbgDetalle.Columns(nColPla_cCuentaContable) = ""
                       UpdateGrilla
                       DoEvents
                    
                       Mensajes "Número de cuenta no existe, verificar...", vbInformation
                       Me.lblDesCta.Caption = valorDato
                       KeyCode = 0
                       RefreshGrilla
                       pSetFocus tdbgDetalle
                       gsFlagKeydownDet = False
                       Exit Sub
                    Else
                       
                       .Columns(nColPla_cNombreCuenta).Value = valorDato
                       RecibirDatos "Cuentas", tdbgDetalle.Columns(nColPla_cCuentaContable), valorDato, ""
                       
                       LimpiaCeldasInactivas
                       
                       Me.lblCuenta.Caption = "CUENTA :"
                       Me.lblDesCta.Caption = valorDato
                    End If
               End If
               
               '------------- SI TIENE NOTA DE CREDITO O DEBITO ------------'
               ActivaCamposDocumRef
               
               gsKeyCode = 13
               
            End If
        End If
        '------------- Repetir el dato Anterior --------------'
        If KeyCode = vbKeyF12 Then
           If lnOpcion = 2 Then
                KeyCode = 0
                Exit Sub
           End If

            If tdbgDetalle.Bookmark > 0 Then
            
            
                If .Col = nColCos_cCodigo And CE(lArrDetalle.Value(.Bookmark, nCol_cFlgCCosto)) = "1" Then
                    .Columns(.Col) = lArrDetalle.Value(.Bookmark - 1, .Col)
                    lArrDetalle.Value(.Bookmark, nColAsd_cModif) = 1
                    
                ElseIf .Col = nColEnt_cCodEntidad And CE(lArrDetalle.Value(.Bookmark, nCol_cTipoEntiCta)) <> "" Then
                    .Columns(.Col) = lArrDetalle.Value(.Bookmark - 1, .Col)
                    lArrDetalle.Value(.Bookmark, nColAsd_cModif) = 1
                    
                ElseIf .Col = nColAsd_cNomMoneda Then
                    .Columns(.Col) = lArrDetalle.Value(.Bookmark - 1, .Col)
                    lArrDetalle.Value(.Bookmark, nColAsd_cModif) = 1
                    
                    If .Columns(.Col) <> gsMonedaNacAbrev Then
                    
                        '**************************
                        LlenaCodigoOP .Columns(nColPla_cCuentaContable)
                        '**************************

                        .Columns(nColAsd_cOperaTC) = BuscaOperaTCSiEsBimoneda(CE(.Columns(nColPla_cCuentaContable)))
                        lArrDetalle.Value(.Bookmark, nColAsd_cOperaTC) = .Columns(nColAsd_cOperaTC).Value
                        .Columns(nCol_cFlgMonNac) = 0
                        lArrDetalle.Value(.Bookmark, nCol_cFlgMonNac) = 0
                        lArrDetalle.Value(.Bookmark, nColAsd_cTipoMoneda) = lArrDetalle.Value(.Bookmark - 1, nColAsd_cTipoMoneda)
                        
                        Dim TC As Double
                        TC = TipoCambio(lArrDetalle(.Bookmark, nColAsd_dFecDoc), lArrDetalle(.Bookmark, nColAsd_cOperaTC))
                        If TC < 0 Then TC = 0
                        .Columns(nColAsd_nTipoCambio) = TC
                        lArrDetalle.Value(.Bookmark, nColAsd_nTipoCambio) = TC
                    Else
                        .Columns(nColAsd_cOperaTC) = "SCV"
                        lArrDetalle.Value(.Bookmark, nColAsd_cOperaTC) = .Columns(nColAsd_cOperaTC).Value
                        .Columns(nCol_cFlgMonNac) = 1
                        lArrDetalle.Value(.Bookmark, nCol_cFlgMonNac) = 1
                        lArrDetalle.Value(.Bookmark, nColAsd_cTipoMoneda) = gsMonedaNac
                        .Columns(nColAsd_nTipoCambio) = 0
                        lArrDetalle.Value(.Bookmark, nColAsd_nTipoCambio) = 0

                    End If
                    
                ElseIf .Col = nColAsd_cOperaTC Then
                
                    If NE(.Columns(nCol_cFlgMonNac)) <> 1 Then
                       .Columns(.Col) = lArrDetalle.Value(.Bookmark - 1, .Col)
                    Else
                       .Columns(.Col) = "SCV"
                    End If
                    
                    lArrDetalle.Value(.Bookmark, nColAsd_cModif) = 1
                
                ElseIf .Col = nColAsd_nTipoCambio Then
                    
                    If NE(.Columns(nCol_cFlgMonNac)) <> 1 Then
                       .Columns(.Col) = lArrDetalle.Value(.Bookmark - 1, .Col)
                    Else
                       .Columns(.Col) = "0.00"
                    End If
                    
                    lArrDetalle.Value(.Bookmark, nColAsd_cModif) = 1
                Else
                    .Columns(.Col) = lArrDetalle.Value(.Bookmark - 1, .Col)
                    lArrDetalle.Value(.Bookmark, nColAsd_cModif) = 1
                End If
                
                tdbgDetalle.RefreshRow
                DoEvents
            End If
        End If
        '------------- Repetir todos los datos ---------------'
        If KeyCode = vbKeyF11 And .Columns(nColAsd_nItem) <> "" Then
            If lnOpcion = 2 Then
                KeyCode = 0
                Exit Sub
            End If

            Call RepiteAnterior
            
            tdbgDetalle.Col = nColAsd_cNumDoc
            pSetFocus tdbgDetalle
            
        End If
        '-------------------- IGV ----------------------------'
        If KeyCode = vbKeyF9 And .Columns(nColAsd_nItem) <> "" Then
            If lnOpcion = 2 Then
             KeyCode = 0
             Exit Sub
            End If
            If tdbcLibro.BoundText = "05" Or tdbcLibro.BoundText = "06" Then
             Select Case CE(Left(lArrDetalle(.Bookmark, nColPla_cCuentaContable), 1))
              Case "4", "6", "9"
              If Not BuscaCodigoConfOp(CE(lArrDetalle(.Bookmark, nColPla_cCuentaContable)), "099", CE(lArrDetalle(.Bookmark, nColPla_cCuentaContable))) Then
                MsgBox "La Cta: " & CE(lArrDetalle(.Bookmark, nColPla_cCuentaContable)) & " NO esta configurada como Cta. de Impuesto " & _
                       "dentro del Plan de Cuentas,Verifique...", vbInformation, App.Title
                 tdbgDetalle.SetFocus
                 If CDbl(tdbgDetalle.Columns(17)) <> 0 Then tdbgDetalle.Columns(17) = 0
                 tdbgDetalle.SetFocus
                 Exit Sub
                End If
             End Select
            End If
            Call CalculaIGV
        End If
        '-------------------- REPITE ACUMULADO FALTANTE ----------------------------'
        If gsKeyControl = True And KeyCode = vbKeyF10 Then
            If lnOpcion <> 2 Then
                If lArrDetalle.Value(.Bookmark, nCol_cFlgMonNac) = "1" Then
                    If lArrDetalle(.Bookmark, nColAsd_cEcpOperacion) = "D" And .Col = nColAsd_nDebeSoles Then
                        KeyCode = 0
                        Exit Sub
                    End If
                
                    If lArrDetalle(.Bookmark, nColAsd_cEcpOperacion) = "H" And .Col = nColAsd_nHaberSoles Then
                        KeyCode = 0
                        Exit Sub
                    End If
                Else
                    If lArrDetalle(.Bookmark, nColAsd_cEcpOperacion) = "D" And .Col = nColAsd_nDebeMonExt Then
                        KeyCode = 0
                        Exit Sub
                    End If
                
                    If lArrDetalle(.Bookmark, nColAsd_cEcpOperacion) = "H" And .Col = nColAsd_nHaberMonExt Then
                        KeyCode = 0
                        Exit Sub
                    End If
                End If
            Else
                KeyCode = 0
                Exit Sub
            End If
        
            Call RepiteAcumuladoFaltante
            KeyCode = 0
        End If
        '-------------------- REPITE ACUMULADO ----------------------------'
        If gsKeyControl = False And KeyCode = vbKeyF10 And .Columns(nColAsd_nItem) <> "" Then
            If lnOpcion = 2 Then
                KeyCode = 0
                Exit Sub
            End If
        
            Call RepiteAcumuladoFaltante 'RepiteAcumulado
            KeyCode = 0
        End If
        
        If tdbgDetalle.Col = nColAsd_cNumDoc And KeyCode = 13 Then
            tdbgDetalle.Enabled = True
            Call pSaltoColGridActivo(tdbgDetalle.Col)
            
        End If
        
    End With
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       RepiteAcumulado
' Description:       Procedimineto que repite el acumulado a la celda seleccionada
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub RepiteAcumulado()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    With tdbgDetalle
    
        If NE(.Columns(nCol_cFlgMonNac)) = 1 Then
            If .Col = nColAsd_nDebeMonExt Or .Col = nColAsd_nHaberMonExt Then
                Exit Sub
            End If
        Else
            If .Col = nColAsd_nDebeSoles Or .Col = nColAsd_nHaberSoles Then
                Exit Sub
            End If
        End If
    
        .Columns(nColAsd_nDebeSoles) = 0
        .Columns(nColAsd_nHaberSoles) = 0
        .Columns(nColAsd_nDebeMonExt) = 0
        .Columns(nColAsd_nHaberMonExt) = 0
        SumarTotales
        DoEvents
        
        If NE(.Columns(nCol_cFlgMonNac)) = 1 Then
            If .Col = nColAsd_nDebeSoles Then
                .Columns(.Col) = .Columns(nColAsd_nHaberSoles).FooterText
            End If
        
            If .Col = nColAsd_nHaberSoles Then
                .Columns(.Col) = .Columns(nColAsd_nDebeSoles).FooterText
            End If
            
            If NE(.Columns(nColAsd_nTipoCambio)) <> 0 Then
               .Columns(nColAsd_nDebeMonExt) = Redondear(NE(.Columns(nColAsd_nDebeSoles)) / NE(.Columns(nColAsd_nTipoCambio)), 2)
               .Columns(nColAsd_nHaberMonExt) = Redondear(NE(.Columns(nColAsd_nHaberSoles)) / NE(.Columns(nColAsd_nTipoCambio)), 2)
            End If
            
        Else
            If .Col = nColAsd_nDebeMonExt Then
                .Columns(.Col) = .Columns(nColAsd_nHaberMonExt).FooterText
            End If
            
            If .Col = nColAsd_nHaberMonExt Then
                .Columns(.Col) = .Columns(nColAsd_nDebeMonExt).FooterText
            End If
        
            .Columns(nColAsd_nDebeSoles) = Redondear(NE(.Columns(nColAsd_nDebeMonExt)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
            .Columns(nColAsd_nHaberSoles) = Redondear(NE(.Columns(nColAsd_nHaberMonExt)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
        End If
        
        lArrDetalle.Value(.Bookmark, nColAsd_cModif) = 1
        UpdateGrilla
        
        SumarTotales
        
    End With
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaDatosCuenta
' Description:       Funcion que retorna los datos de la cuenta
'
' Parameters :       Cuenta (String)
'--------------------------------------------------------------------------------
Public Function BuscaDatosCuenta(Cuenta As String) As String
    Dim clDatos As clsMantoTablas
    Set clDatos = New clsMantoTablas
    Dim rsTabla As ADODB.Recordset
    Set rsTabla = New ADODB.Recordset
    Dim arrDatos() As Variant
    Dim sqlver  As String
    
    sqlver = "SELECT Pla_cNombreCuenta, Pla_cCentroCosto, Pla_cProvision, Pla_cOperaTC, Pla_cDifCambio, " & _
             "Pla_cRedondeo, Ten_CTipoEntidad, Pla_cDocumento, Pla_cTipoAfect, " & _
             "pla_cdetraccion, pla_cretencion, pla_cpercepcion,Pla_cNCND " & _
             "From CNM_PLAN_CTA WHERE Emp_cCodigo='" & gsEmpresa & "' And Pan_cAnio='" & gsAnio & "' " & _
             "AND Pla_cCuentaContable='" & Cuenta & "' AND Pla_cTitulo='N'"
    
    BuscaDatosCuenta = ""
    LimpiaArrayCuenta
    
    arrDatos = Array(sqlver)
    Set rsTabla = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
    If Not rsTabla Is Nothing Then
        If Not (rsTabla.EOF And rsTabla.BOF) Then
            gsDatosCuenta(0) = CE(rsTabla!Pla_cNombreCuenta)
            gsDatosCuenta(1) = CE(rsTabla!Pla_cCentroCosto)
            gsDatosCuenta(2) = CE(rsTabla!Pla_cProvision)
            gsDatosCuenta(3) = CE(rsTabla!Pla_cOperaTC)
            gsDatosCuenta(4) = CE(rsTabla!Pla_cDifCambio)
            gsDatosCuenta(5) = CE(rsTabla!Pla_cRedondeo)
            gsDatosCuenta(6) = CE(rsTabla!Ten_cTipoEntidad)
            gsDatosCuenta(7) = CE(rsTabla!Pla_cDocumento)
            gsDatosCuenta(8) = CE(rsTabla!Pla_cTipoAfect)
            gsDatosCuenta(9) = CE(rsTabla!pla_cdetraccion)
            gsDatosCuenta(10) = CE(rsTabla!pla_cretencion)
            gsDatosCuenta(11) = CE(rsTabla!pla_cpercepcion)
            gsDatosCuenta(12) = CE(rsTabla!Pla_cNCND)

            BuscaDatosCuenta = CE(rsTabla!Pla_cNombreCuenta)
        End If
    End If
    
    Set clDatos = Nothing
    Set rsTabla = Nothing
    
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LimpiaArrayCuenta
' Description:       Procedimiento que limpia las variables de la cuenta
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub LimpiaArrayCuenta()
    gsDatosCuenta(0) = ""
    gsDatosCuenta(1) = ""
    gsDatosCuenta(2) = ""
    gsDatosCuenta(3) = ""
    gsDatosCuenta(4) = ""
    gsDatosCuenta(5) = ""
    gsDatosCuenta(6) = ""
    gsDatosCuenta(7) = ""
    gsDatosCuenta(8) = ""
    gsDatosCuenta(9) = ""
    gsDatosCuenta(10) = ""
    gsDatosCuenta(11) = ""
    gsDatosCuenta(12) = ""
    
End Sub
'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       RepiteAcumuladoFaltante
' Description:       Procedimiento que repite el acumulado faltante a la cela de importe seleccionada
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub RepiteAcumuladoFaltante()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    With tdbgDetalle
    
        If NE(.Columns(nCol_cFlgMonNac)) = 1 Then
            If .Col = nColAsd_nDebeMonExt Or .Col = nColAsd_nHaberMonExt Then
                Exit Sub
            End If
        Else
            If .Col = nColAsd_nDebeSoles Or .Col = nColAsd_nHaberSoles Then
                Exit Sub
            End If
        End If
    
        .Columns(nColAsd_nDebeSoles) = 0
        .Columns(nColAsd_nHaberSoles) = 0
        .Columns(nColAsd_nDebeMonExt) = 0
        .Columns(nColAsd_nHaberMonExt) = 0
        SumarTotales
        DoEvents
        
        If NE(.Columns(nCol_cFlgMonNac)) = 1 Then
            If .Col = nColAsd_nDebeSoles Then
                .Columns(.Col) = Abs(NE(tdbnDiferenciaMN.Text))
            End If
        
            If .Col = nColAsd_nHaberSoles Then
                .Columns(.Col) = Abs(NE(tdbnDiferenciaMN.Text))
            End If
            
            If NE(.Columns(nColAsd_nTipoCambio)) <> 0 Then
               .Columns(nColAsd_nDebeMonExt) = Redondear(NE(.Columns(nColAsd_nDebeSoles)) / NE(.Columns(nColAsd_nTipoCambio)), 2)
               .Columns(nColAsd_nHaberMonExt) = Redondear(NE(.Columns(nColAsd_nHaberSoles)) / NE(.Columns(nColAsd_nTipoCambio)), 2)
            End If
            
        Else
            If .Col = nColAsd_nDebeMonExt Then
                .Columns(.Col) = Abs(NE(tdbnDiferenciaME.Text))
            End If
            
            If .Col = nColAsd_nHaberMonExt Then
                .Columns(.Col) = Abs(NE(tdbnDiferenciaME.Text))
            End If
        
            .Columns(nColAsd_nDebeSoles) = Redondear(NE(.Columns(nColAsd_nDebeMonExt)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
            .Columns(nColAsd_nHaberSoles) = Redondear(NE(.Columns(nColAsd_nHaberMonExt)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
        End If
        
        lArrDetalle.Value(.Bookmark, nColAsd_cModif) = 1
        UpdateGrilla
        
        SumarTotales
        
    End With

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscarCodigoBaseImp
' Description:       Funcion que busca el codigo de base imponible segun la cuneta contable
'
' Parameters :       sCuenta (String)
'--------------------------------------------------------------------------------
Private Function BuscarCodigoBaseImp(sCuenta As String) As String
    Dim rsArreglo As ADODB.Recordset
    Dim clDatos As clsMantoTablas
    Set clDatos = New clsMantoTablas
    Dim arrDatos() As Variant
    Dim Codigo As String, cadena As String, sqlSp  As String
    
    If tdbcLibro.BoundText = lsLibroCom Then
       cadena = "COMPRAS"
    Else
       cadena = "VENTAS"
    End If
    Codigo = ""
    sqlSp = "spCn_ConsultaBaseImponible '" & cadena & "', '" & gsEmpresa & "', '" & gsAnio & "'," & _
            "'" & sCuenta & "'"
            
    arrDatos = Array(sqlSp)
    Set rsArreglo = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
    If Not rsArreglo Is Nothing Then
       BuscarCodigoBaseImp = CE(rsArreglo!Codigo)
       
       If tdbcLibro.BoundText = lsLibroCom And CE(gsBaseImpDefCom) <> "" And CE(rsArreglo!Codigo) <> "" Then
          BuscarCodigoBaseImp = gsBaseImpDefCom
       End If
       
       If tdbcLibro.BoundText = lsLibroVen And CE(gsBaseImpDefVtas) <> "" And CE(rsArreglo!Codigo) <> "" Then
          BuscarCodigoBaseImp = gsBaseImpDefVtas
       End If
       
    End If

    CerrarRecordSet rsArreglo
    Set clDatos = Nothing
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenaBaseImponible
' Description:       Procedimiento que llena la base imponible
'
' Parameters :
'--------------------------------------------------------------------------------
Public Sub LlenaBaseImponible()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    Dim Codigo As String
    Codigo = BuscarCodigoBaseImp(CE(tdbgDetalle.Columns(nColPla_cCuentaContable)))
    
    If Codigo = "003" Then
        Codigo = "999" 'INAFECTO O NO GRAVADA
    End If
    
    'If Codigo = "002" Then
     '   Codigo = "998" 'INAFECTO O NO GRAVADA
'    End If
    
    If Codigo = "008" Then
        Call AsigaBaseACuentas(Codigo) 'SOLO PARA IGV REINTEGRO
    End If
    
    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cBaseImp) = Codigo
    tdbcBaseImponible.BoundText = Codigo
    
    tdbgDetalle.RefreshRow
    DoEvents

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       AsigaBaseACuentas
' Description:       Procedimiento que asigna la base imponible a la cuenta seleccionada
'
' Parameters :       Codigo (String)
'--------------------------------------------------------------------------------
Private Sub AsigaBaseACuentas(Codigo As String)
    On Error GoTo serror
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    Dim i As Integer
    Dim sPla_cCuentaContable As String
    
    If tdbcLibro.BoundText = lsLibroCom Then
        If BuscaBasesImponiblesEnDetalle = False Then
            For i = 0 To lItem - 1
                sPla_cCuentaContable = Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2)
                If sPla_cCuentaContable <> "42" Or sPla_cCuentaContable <> "48" Then
                   lArrDetalle(i, nColAsd_cBaseImp) = Codigo
                   lArrDetalle(i, nColAsd_cModif) = 1
                Else
                   lArrDetalle(i, nColAsd_cBaseImp) = ""
                   lArrDetalle(i, nColAsd_cModif) = 1
                End If
            Next i
        End If
    End If
serror:
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LimpiaCeldasInactivas
' Description:       Procedimiento que limpia las columnas si no hay documento, cc o entidad
'
' Parameters :
'--------------------------------------------------------------------------------
Public Sub LimpiaCeldasInactivas()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    With tdbgDetalle
        If CE(lArrDetalle.Value(.Bookmark, nCol_cTipoEntiCta)) = "" Then
            .Columns(nColEnt_cCodEntidad) = ""
        End If
    
        If lArrDetalle.Value(.Bookmark, nCol_cFlgCCosto) = "0" Then
            .Columns(nColCos_cCodigo) = ""
        End If
        
        If CE(lArrDetalle.Value(.Bookmark, nColPla_cDocumento)) = "0" Then
            .Columns(nColAsd_cTipoDoc) = ""
            .Columns(nColAsd_cSerieDoc) = ""
            .Columns(nColAsd_cNumDoc) = ""
        End If
    End With
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ActivaCamposDocumRef
' Description:       Procedimiento que activa los campos de documento de referencia
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub ActivaCamposDocumRef()
    DoEvents
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    DoEvents
    If NE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColPla_cNCND)) = 1 And tdbcPagoIGV.BoundText <> "D" Then
        Activar tdbtComprobante, True
    
        Activar tdbtTipDocRef, True
        Activar tdbtSerDocRef, True
        Activar tdbtNroDocRef, True
        Activar dtpFecDocRef, True
    Else
        If (tdbcPagoIGV.BoundText = "P" Or tdbcPagoIGV.BoundText = "R") Then
            Activar tdbtComprobante, True
            Activar tdbtTipDocRef, True
            Activar tdbtSerDocRef, True
            Activar tdbtNroDocRef, True
            Activar dtpFecDocRef, True
        Else
'            Activar tdbtComprobante, False
'            Activar tdbtTipDocRef, False
'            Activar tdbtSerDocRef, False
'            Activar tdbtNroDocRef, False
'            Activar dtpFecDocRef, False

            


'            tdbtComprobante.Text = ""
'            tdbtTipDocRef.Text = ""
'            tdbtSerDocRef.Text = ""
'            tdbtNroDocRef.Text = ""
'            dtpFecDocRef.Text = "__/__/____"
            
        End If
    End If
End Sub


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       RepiteAnterior
' Description:       Procedimiento que repite los importes de la fila anterior
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub RepiteAnterior()

    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    If tdbgDetalle.Bookmark = 0 Then Exit Sub
    

    Dim i As Integer, nFil As Integer
    With Me.tdbgDetalle
        If NE(.Columns(nColAsd_nItem).Value) > 1 Then
        
            .Columns(nColAsd_nDebeSoles) = 0
            .Columns(nColAsd_nHaberSoles) = 0
            .Columns(nColAsd_nDebeMonExt) = 0
            .Columns(nColAsd_nHaberMonExt) = 0
        
            If .Columns(nColAsd_cGlosa).Value = "" Then .Columns(nColAsd_cGlosa).Value = lArrDetalle.Value(.Bookmark - 1, nColAsd_cGlosa)
            
            If CE(lArrDetalle.Value(.Bookmark, nCol_cTipoEntiCta)) <> "" Then
                If CE(.Columns(nColEnt_cCodEntidad).Value) <> "" Then
                .Columns(nColTen_cTipoEntidad).Value = lArrDetalle.Value(.Bookmark - 1, nColTen_cTipoEntidad)
                .Columns(nColEnt_cCodEntidad).Value = lArrDetalle.Value(.Bookmark - 1, nColEnt_cCodEntidad)
                .Columns(nColEnt_cPersona).Value = lArrDetalle.Value(.Bookmark - 1, nColEnt_cPersona)
               End If
            End If
            
            If CE(lArrDetalle.Value(.Bookmark, nCol_cFlgCCosto)) <> "0" Then
                If CE(.Columns(nColCos_cCodigo).Value) <> "" Then
                .Columns(nColCos_cCodigo).Value = lArrDetalle.Value(.Bookmark - 1, nColCos_cCodigo)
                End If
            End If
            
            If CE(lArrDetalle.Value(.Bookmark, nColPla_cDocumento)) <> "0" Then
                .Columns(nColAsd_cTipoDoc).Value = lArrDetalle.Value(.Bookmark - 1, nColAsd_cTipoDoc)
                .Columns(nColAsd_cSerieDoc).Value = lArrDetalle.Value(.Bookmark - 1, nColAsd_cSerieDoc)
                .Columns(nColAsd_cNumDoc).Value = lArrDetalle.Value(.Bookmark - 1, nColAsd_cNumDoc)
            End If
            
            .Columns(nColAsd_cTipoDocRef).Value = lArrDetalle.Value(.Bookmark - 1, nColAsd_cTipoDocRef)
            .Columns(nColAsd_cSerieDocRef).Value = lArrDetalle.Value(.Bookmark - 1, nColAsd_cSerieDocRef)
            .Columns(nColAsd_cNumDocRef).Value = lArrDetalle.Value(.Bookmark - 1, nColAsd_cNumDocRef)
            .Columns(nColAsd_dFecDocRef).Value = lArrDetalle.Value(.Bookmark - 1, nColAsd_dFecDocRef)
            .Columns(nColAsd_dFecVen).Value = lArrDetalle.Value(.Bookmark - 1, nColAsd_dFecVen)
            
            .Columns(nColAsd_nDebeSoles) = lArrDetalle.Value(.Bookmark - 1, nColAsd_nDebeSoles)
            .Columns(nColAsd_nHaberSoles) = lArrDetalle.Value(.Bookmark - 1, nColAsd_nHaberSoles)
            .Columns(nColAsd_nDebeMonExt) = lArrDetalle.Value(.Bookmark - 1, nColAsd_nDebeMonExt)
            .Columns(nColAsd_nHaberMonExt) = lArrDetalle.Value(.Bookmark - 1, nColAsd_nHaberMonExt)
            
            .Columns(nColAsd_cNumSpot).Value = lArrDetalle.Value(.Bookmark - 1, nColAsd_cNumSpot)
            .Columns(nColAsd_dFechaSpot).Value = lArrDetalle.Value(.Bookmark - 1, nColAsd_dFechaSpot)
            
            lArrDetalle.Value(.Bookmark, nColAsd_cModif) = 1
            
            If .Col > nColAsd_nHaberMonExt Then
               .Col = nColAsd_nTipoCambio
               pSetFocus tdbgDetalle
            End If
            
            
            Call SumarTotales
        End If
    End With
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       pSaltoColGridActivo
' Description:       Funcion que valida los datos de la fila ingresada y ubica la columna siguiente
'
' Parameters :       nColTab (Integer)
'--------------------------------------------------------------------------------
Private Function pSaltoColGridActivo(nColTab As Integer) As Boolean
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If
    
'    If gintBiMoneda = 1 Then tdbgDetalle.EditActive = True
    
    Dim clDatos As New clsMantoTablas
    'Dim rsArreglo As ADODB.Recordset, rsArreglo2 As ADODB.Recordset
    Dim arrDatos() As Variant
    Dim sqlver As String, tipoTer As String, valorDato As String, varVoucher As String, nNroProvi As Long
    Dim entro As Boolean, Buscar As Boolean
    Dim i As Integer
    Dim TC As Double, SumaMontos  As Double
    Dim Interno As String
    Dim Saldo As Double
    Dim sql As String
    

    entro = False
    Buscar = True
    
    RefreshGrilla
    
    Me.dtpFechaDoc.Enabled = True
    

If lnOpcion <> 2 Then
    
    '----------- VALIDA LA CUENTA CONTABLE -----------------'
    If nColTab = nColPla_cCuentaContable Then 'LIN_00
        If tdbgDetalle.Bookmark <= lItem And gsKeyCode <> 13 And gsKeyCode <> 112 Then 'LIN_01
           If CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) <> gsUltimaCuenta Then  'LIN_02
    
               If CE(tdbgDetalle.Columns(nColTab).Value) = "" Then
                  tdbgDetalle.Col = nColTab
                  tdbgDetalle.Columns(nColTab) = ""
                  pSaltoColGridActivo = False
                  Exit Function
               Else
                  If CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) <> "" Then
                       With tdbgDetalle
                         If Len(CE(.Columns(nColPla_cCuentaContable))) <= 2 Then
                            UpdateGrilla
                            MsgBox "Cuenta Nº " & .Columns(nColPla_cCuentaContable) & " no pertenece al Libro seleccionado", vbInformation, "Aviso..."
                            .Col = nColTab
                            .Columns(nColTab) = ""
                            .Refresh
                            pSaltoColGridActivo = False
                            
                            Exit Function
                         End If
                         'verifica si se le configuraron cuentas al libro
                         If BuscaCtasLibro(CE(.Columns(nColPla_cCuentaContable))) = True Then
                             'valida si la cuenta ingresada pertenece al libro seleccionado
                             valorDato = CE(ExisteCtaLibroCuenta(tdbcLibro.BoundText, .Columns(nColPla_cCuentaContable)))
                             If valorDato = "" Then
                                UpdateGrilla
                                MsgBox "Cuenta Nº " & .Columns(nColPla_cCuentaContable) & " no pertenece al Libro seleccionado", vbInformation, "Aviso..."
                                .Col = nColTab
                                .Columns(nColTab) = ""
                                .Refresh
                                pSaltoColGridActivo = False
                                
                                Exit Function
                             End If
                         End If
                       End With
                  End If
               
                  With tdbgDetalle
                        'Datos deL ITEM AUTOMATICO
                        If .Columns(nColAsd_nItem).Value = "" Then
                            Call AñadeItem
                        End If
                        
                        'Datos de la Moneda
                        If CE(.Columns(nColAsd_cTipoMoneda).Value) = "" Then
                            .Columns(nColAsd_cNomMoneda).Value = tdbcMoneda.Columns(4).Value
                            .Columns(nColAsd_cTipoMoneda).Value = tdbcMoneda.BoundText
                            .Columns(nCol_cFlgMonNac).Value = tdbcMoneda.Columns(2).Value
                        End If
                        
                        valorDato = BuscaDatosCuenta(.Columns(nColPla_cCuentaContable))
                        
                        If valorDato <> "" Then
                            .Columns(nCol_cFlgCCosto).Value = gsDatosCuenta(1) 'CE(rsArreglo("Pla_cCentroCosto"))
                            .Columns(nCol_cFlgProv).Value = gsDatosCuenta(2) 'CE(rsArreglo("Pla_cProvision"))
                            '.Columns(nColAsd_cOperaTC).Value = ce(rsArreglo("Pla_cOperaTC"))
                            .Columns(nColTen_cTipoEntidad).Value = gsDatosCuenta(6) 'CE(rsArreglo("Ten_CTipoEntidad"))
                            .Columns(nCol_cTipoEntiCta).Value = gsDatosCuenta(6) 'CE(rsArreglo("Ten_CTipoEntidad"))
                            .Columns(nColPla_cDocumento).Value = gsDatosCuenta(7) 'CE(rsArreglo("Pla_cDocumento"))
                            .Columns(nColPla_cTipoAfect).Value = gsDatosCuenta(8) 'CE(rsArreglo("Pla_cTipoAfect"))
                            .Columns(nCol_nPorceImp).Value = tdbnPorcIGV.Value
                            
                            If CE(.Columns(nColAsd_dFecDoc).Value) = "" Then
                                .Columns(nColAsd_dFecDoc).Value = dtpFecha.Value
                            End If
                           
                            .Columns(nColAsd_dFecDocAux).Value = .Columns(nColAsd_dFecDoc).Value
                           
                            If Trim(.Columns(nColAsd_cGlosa).Value) = "" Then
                               If .Columns(nColAsd_nItem) > 1 Then
                                  If .Bookmark > 1 Then
                                  .Columns(nColAsd_cGlosa).Value = lArrDetalle.Value(.Bookmark - 1, nColAsd_cGlosa)
                                  End If
                               Else
                                  .Columns(nColAsd_cGlosa).Value = tdbtObservaciones
                               End If
                            End If
                            
                            If .Columns(nColAsd_cOperaTC).Value = "" Then .Columns(nColAsd_cOperaTC).Value = "SCV"
                            
                            
                            
                        End If
                    
                  End With

                  On Error Resume Next
                  UpdateGrilla
                  LimpiaCeldasInactivas
               End If
               
           End If 'LIN_02
           
       
        End If 'LIN_01
        
        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cEntTipSerNum) = BuscaEntTipSerNum(tdbgDetalle.Bookmark)
        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cDetProv) = BuscaLineaProv(tdbgDetalle.Bookmark)
        
    End If 'LIN_00
    '----------- VALIDA SI NO TIENE ITEM -----------------'
    If VerificaCuentaDestino = True Or CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_nItem)) = "" Then
       tdbgDetalle.Col = nColTab
       pSaltoColGridActivo = False
       gsUltimaCuenta = ""
       Exit Function
    End If
    
    '------------- VALIDA TIPO DE MONEDA -------------------'
    If nColTab = nColAsd_cNomMoneda Then
       If Trim(tdbgDetalle.Columns(nColTab)) = "" Then
            RefreshGrilla
            DoEvents

             Mensajes "Moneda no existe, verificar...", vbInformation
             tdbgDetalle.Col = nColTab
             tdbgDetalle.Columns(nColTab) = ""

             tdbgDetalle.Columns(nColAsd_cTipoMoneda) = ""
             tdbgDetalle.Columns(nCol_cFlgMonNac) = ""
          
             pSaltoColGridActivo = False
             
             
             Exit Function
          
       End If
    End If
    
    '----------- VALIDA TIPO DE DOCUMENTO --------------------'
    If nColTab = nColAsd_cTipoDoc And ValidaDentroPeriodo Then
       If CE(tdbgDetalle.Columns(nColPla_cDocumento).Value) = "1" And CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) <> "" Then
                If CE(tdbgDetalle.Columns(nColTab)) = "" Then
                      RefreshGrilla
                      DoEvents

                      If gsKeyPressF1 = True Or gsColumnaInicialPress = nColAsd_cTipoDoc Then
                        Mensajes "Ingrese el Tipo de Documento", vbInformation
                      End If
                      gsKeyPressF1 = True
                      tdbgDetalle.Col = nColTab
                      tdbgDetalle.Columns(nColTab) = ""
                      pSaltoColGridActivo = False
                      
                      
                      Exit Function
                End If
        End If
        ActivaChekRegAuxiliares
     End If
     
    '-------------------- VALIDA SERIE DEL DOCUMENTO -------------------------------'
    If nColTab = nColAsd_cSerieDoc And ValidaDentroPeriodo Then
         If CE(tdbgDetalle.Columns(nColPla_cDocumento).Value) = "1" Then

            If CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) <> "99" And _
               CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) <> "98" And _
               CE(tdbgDetalle.Columns(nColAsd_cSerieDoc)) = "" Then
                      UpdateGrilla
                      DoEvents

                      Mensajes "Ingrese el Nro de Serie en el registro actual", vbInformation
                      tdbgDetalle.Col = nColAsd_cSerieDoc
                      tdbgDetalle.Columns(nColTab) = ""

                      DoEvents
                      RefreshGrilla
                      pSaltoColGridActivo = False
                      
                      
                      Exit Function

            End If
        End If
     End If
    '-------------------- VALIDA NUMERO DEL DOCUMENTO -------------------------------'
   
    If nColTab = nColAsd_cNumDoc Then
       If CE(tdbgDetalle.Columns(nColPla_cDocumento).Value) = "1" And ValidaDentroPeriodo Then

            If CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) <> "99" And _
               CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) <> "98" And _
               CE(tdbgDetalle.Columns(nColAsd_cNumDoc)) = "" Then
                      UpdateGrilla
                      DoEvents

                      Mensajes "Ingrese el Nro de documento en el registro actual", vbInformation
                      tdbgDetalle.Col = nColAsd_cNumDoc
                      tdbgDetalle.Columns(nColTab) = ""

                      DoEvents
                      RefreshGrilla
                      pSaltoColGridActivo = False
                      
                      
                      Exit Function

            End If
            
        End If
     End If
    
'---------------- VALIDA EL DOCUMENTO SI ES PROVISIONADO ----------------'

    If nColTab = nColAsd_cTipoDoc Or nColTab = nColAsd_cNumDoc Or nColTab = nColAsd_cSerieDoc Then
    
        If CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) <> "" And _
          (CE(tdbgDetalle.Columns(nColAsd_cNumDoc)) <> "" Or _
           CE(tdbgDetalle.Columns(nColAsd_cSerieDoc)) <> "") Then
        
        Call pUpdateArray
        
        
        If nColTab = nColAsd_cNumDoc Then
           CompletaCerosCampos
        End If
        
        If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cEntTipSerNum)) <> BuscaEntTipSerNum(tdbgDetalle.Bookmark) Then
        If ModificoProv(tdbgDetalle.Bookmark) = True Then
           '-- INICIO LIN_00
           tipoTer = tdbgDetalle.Columns(nColTen_cTipoEntidad).Value
           With tdbgDetalle
                valorDato = ""
                If lnOpcion = 1 Then valorDato = lNumInterno
                
                'No valida tipo de documento cuando es DOCS VARIOS
                If ModificoLinea(.Bookmark) = True Then 'And CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) <> "98" And CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) <> "99" Then
                    Saldo = 0
                    
                    'Si no uso Ayuda de Provisión, Se debe obtener los datos de la provision si es cancelacion
                    '-----------------------------------------------------------------------------------------
                    If CE(lArrDetalle(.Bookmark, nColAsd_cProvCanc)) = "C" And .Columns(nCol_cFlgProv).Value = "1" Then 'And CE(lArrDetalle(.Bookmark, nColAsd_cProvCanc)) = "" Then
                        
                           'busca si el documento fue ingresado en otra linea del voucher
                           If BuscaCorrelProvisionDetalle(CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)), _
                                                          CE(lArrDetalle(tdbgDetalle.Bookmark, nColEnt_cCodEntidad)), _
                                                          CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDoc)), _
                                                          CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cSerieDoc)), _
                                                          CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumDoc))) = True Then
                                                            
                              .Columns(nColTab) = ""
                              UpdateGrilla
                              DoEvents
                              Mensajes gsMensaje, vbInformation + vbOKOnly
                              .Col = nColTab
                              lArrDetalle(.Bookmark, nColAsd_cProvCanc) = ""
                              DoEvents
                              RefreshGrilla
                              pSaltoColGridActivo = False
                             
                              Exit Function
                           End If
                        
                        .Columns(nColAsd_nCorre).Value = NE(.Columns(nColAsd_nCorre).Value)
                        'If NE(.Columns(nColAsd_nDebeSoles)) = 0 And NE(.Columns(nColAsd_nHaberSoles)) = 0 And NE(.Columns(nColAsd_nDebeMonExt)) = 0 And NE(.Columns(nColAsd_nHaberMonExt)) = 0 Then
                        'If gsKeyCode = 13 Then
                            If BuscaDocumentoProvisionado = False Then
                                  tdbgDetalle.RefreshRow
                                  DoEvents
                                  
                                  If gsDocProvisionado = False Then
                                        If gsDocEnDetalle = False Then
                                                
                                             lArrDetalle(.Bookmark, nColAsd_cProvCanc) = "P"
                                            
                                        Else
                                            Mensajes gsMensaje, vbInformation + vbOKOnly
                                            lArrDetalle(.Bookmark, nColAsd_cProvCanc) = ""
                                            .Columns(nColAsd_cNumDoc) = ""
                                            UpdateGrilla
                                            pSaltoColGridActivo = False
                                            
                                            
                                            Exit Function
                                        End If
                                  Else
                                        If gsMensaje <> "" Then
                                           Mensajes gsMensaje, vbInformation + vbOKOnly
                                           lArrDetalle(.Bookmark, nColAsd_cProvCanc) = ""
                                           .Columns(nColAsd_cNumDoc) = ""
                                           UpdateGrilla
                                           pSaltoColGridActivo = False
                                           
                                           
                                           Exit Function
                                        End If
                                  End If
                                  
                                  
                                  RefreshGrilla
                                  DoEvents
                            End If
                        'End If
                    End If
                    '-----------------------------------------------------------------------------------------
                    If CE(lArrDetalle(.Bookmark, nColAsd_cProvCanc)) = "P" And .Columns(nCol_cFlgProv).Value = "1" Then

                           'busca si el documento fue ingresado en otra linea del voucher
                           If BuscaCorrelProvisionDetalle(CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)), _
                                                          CE(lArrDetalle(tdbgDetalle.Bookmark, nColEnt_cCodEntidad)), _
                                                          CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDoc)), _
                                                          CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cSerieDoc)), _
                                                          CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumDoc))) = True Then
                                                            
                              .Columns(nColTab) = ""
                              UpdateGrilla
                              DoEvents
                              Mensajes gsMensaje, vbInformation + vbOKOnly
                              .Col = nColTab
                              lArrDetalle(.Bookmark, nColAsd_cManual) = 0
                              lArrDetalle(.Bookmark, nColAsd_cProvCanc) = ""
                              DoEvents
                              RefreshGrilla
                              pSaltoColGridActivo = False
                              
                              
                              Exit Function
                           End If
    
                           'busca si este documento fue provisionado en otro voucher
                           Dim Pos As Integer
                           Pos = BuscaDatosDoc(.Bookmark)
                           If Pos >= 0 Then
                                Interno = ""
                                Call CargaValoresAlmacenados(Pos)
                           Else
                                Interno = NroCorre_Documento_Provisionado(tipoTer, .Columns(nColEnt_cCodEntidad), .Columns(nColAsd_cTipoDoc), _
                                           .Columns(nColAsd_cSerieDoc), .Columns(nColAsd_cNumDoc), Me.dtpFecha.Value, gsCorrelProv, .Columns(nColPla_cCuentaContable))
                            End If
    
                           
                           If Interno <> "" And Me.tdbtNumVoucher.Text <> Left(Interno, 10) Then
                                .Columns(nColAsd_cNumDoc) = ""
                                UpdateGrilla
                                DoEvents
    
                                Mensajes "Este Documento ya fue provisionado en el " & Salto(2) & "VOUCHER : " & Interno, vbInformation
                                .Col = nColTab
                                lArrDetalle(.Bookmark, nColAsd_cProvCanc) = ""
                                DoEvents
                                RefreshGrilla
                                pSaltoColGridActivo = False
                                
                                
                                Exit Function
                           End If
                    End If
                End If
           End With
           '-- FIN LIN_00
           
           lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cEntTipSerNum) = BuscaEntTipSerNum(tdbgDetalle.Bookmark)
           lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cDetProv) = BuscaLineaProv(tdbgDetalle.Bookmark)
        End If
        End If
        End If
    End If
    
    '--------- VALIDA TIPO DE DOCUMENTO -------------'
    If nColTab = nColAsd_cTipoDoc And CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) <> "" Then
    
    If nColTab = nColAsd_cTipoDoc Then
        If CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) = "99" And gsPLE = 1 Then
            tdbgDetalle.Columns(nColAsd_cTipoDoc) = ""
            DoEvents
            RefreshGrilla
            
            Mensajes "Estimado Usuario: Esta opción ha sido deshabilitada por " & vbCrLf & "R.S. 248-2012/SUNAT ingrese en forma individual la información", vbInformation
            Call CargaTipoDoc
            tdbgDetalle.Col = nColTab
            pSaltoColGridActivo = False
            Exit Function
         End If
    End If
    
       If CE(tdbgDetalle.Columns(nColAsd_cTipoDoc)) <> gsUltimoTD Then
       
            valorDato = BuscaTDArray(tdbgDetalle.Columns(nColTab))
            
       
            If valorDato = "" Then
    
               If nColTab = nColAsd_cTipoDoc Then
                  tdbgDetalle.Columns(nColAsd_cTipoDoc) = ""
                  DoEvents
               End If
    
               RefreshGrilla
               DoEvents
    
               Mensajes "Codigo de Documento no existe o fue ingresado despues de" & Salto(1) & "iniciar el formulario de ingreso de voucher," & Salto(1) & "se volveran a cargar la lista de documentos...", vbInformation
               Call CargaTipoDoc
               tdbgDetalle.Col = nColTab
               pSaltoColGridActivo = False
               Exit Function
           Else
               If nColTab = nColAsd_cTipoDoc Then
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNomTD) = valorDato
               End If
    
           End If
       End If

    End If
    

    
    '------------- VALIDA FECHA DE DOCUMENTO ---------------'
    If nColTab = nColAsd_dFecDoc Then
       UpdateGrilla
       With tdbgDetalle
            
            If lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecDoc) = "__/__/____" Then lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecDoc) = ""
       
            If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecDoc)) <> "" Then
                If IsDate(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecDoc)) Then
                    If Year(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecDoc)) < 1900 Then
                        .Columns(nColAsd_dFecDoc) = ""
                        UpdateGrilla
                        DoEvents
                        MsgBox "El año de la Fecha es invalida ingrese un año mayor a 1900, ver item N." & CE(.Columns(nColAsd_nItem)), vbInformation + vbOKOnly
                        .Col = nColTab
                        .Refresh
                        pSaltoColGridActivo = False
                        
                        
                        Exit Function
        
                    End If
                Else
                
                        .Columns(nColAsd_dFecDoc) = ""
                        UpdateGrilla
                        DoEvents
                        MsgBox "La fecha del documento es invalida, ver item N." & CE(.Columns(nColAsd_nItem)), vbInformation + vbOKOnly
                        .Col = nColTab
                        .Refresh
                        pSaltoColGridActivo = False
                        
                        
                        Exit Function
                End If
            End If
            
            If IsDate(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecDoc)) = False Then
                .Columns(nColAsd_dFecDoc) = ""
                UpdateGrilla
                DoEvents
                MsgBox "La Fecha de la Cuenta no es valida, ver item N." & CE(.Columns(nColAsd_nItem)), vbInformation + vbOKOnly
                .Col = nColTab
                .Refresh
                pSaltoColGridActivo = False
                
                
                Exit Function

            End If
            
            If tdbcMes.BoundText <> "00" Then
                If Format(.Columns(nColAsd_dFecDoc), "yyyyMMdd") > Format(UltimoDiaMes(gsPeriodo, gsAnio), "yyyyMMdd") Then
                    .Columns(nColAsd_dFecDoc) = ""
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecDoc) = ""
                    UpdateGrilla
                    DoEvents
                    MsgBox "Fecha de la Cuenta, no puede ser mayor a la fecha del ultimo dia del periodo", vbInformation + vbOKOnly
                    .Col = nColTab
                    .Columns(nColAsd_dFecDoc) = dtpFecha.Value '  "__/__/____"
                    .Refresh
                    pSaltoColGridActivo = False
                    Exit Function
                End If
            Else
                If Format(.Columns(nColAsd_dFecDoc), "yyyyMMdd") > Format(dtpFecha.Value, "yyyyMMdd") Then
                    .Columns(nColAsd_dFecDoc) = ""
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecDoc) = ""
                    UpdateGrilla
                    DoEvents
                    MsgBox "Fecha de la Cuenta, no puede ser mayor a la fecha del ultimo dia del periodo", vbInformation + vbOKOnly
                    .Col = nColTab
                    .Columns(nColAsd_dFecDoc) = dtpFecha.Value '  "__/__/____"
                    .Refresh
                    pSaltoColGridActivo = False
                    Exit Function
                End If
            End If
            
            'permite fecha en blanco solo si son cuentas de dif cambio o redondeo
            If CE(tdbgDetalle.Columns(nColAsd_dFecDoc)) = "" And _
               tdbgDetalle.Columns(nColPla_cCuentaContable) <> gsCuentaDifGan And _
               tdbgDetalle.Columns(nColPla_cCuentaContable) <> gsCuentaDifPer And _
               tdbgDetalle.Columns(nColPla_cCuentaContable) <> gsCuentaRedGan And _
               tdbgDetalle.Columns(nColPla_cCuentaContable) <> gsCuentaRedPer And _
               CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) <> "" Then
               .Col = nColTab
               .Columns(nColTab) = ""
                UpdateGrilla
                DoEvents

               Mensajes "Fecha de documento no Válida, verificar", vbInformation
               .Refresh
               pSaltoColGridActivo = False
               
               
               Exit Function
            End If
            
       End With
    End If
    '------------- VALIDA FECHA DE DOCUMENTO DE VENCIMIENTO ---------------'
    If nColTab = nColAsd_dFecVen Then
    
        If CE(tdbgDetalle.Columns(nColAsd_dFecVen)) <> "" Then
        
           With tdbgDetalle
           
                If lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecVen) = "__/__/____" Then
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecVen) = ""
                    tdbgDetalle.Columns(nColAsd_dFecVen) = ""
                End If

                If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecVen)) <> "" Then
                    If IsDate(CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecVen))) Then
                        If Year(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecVen)) < 1900 Then
                            tdbgDetalle.Columns(nColAsd_dFecVen).Value = ""
                            UpdateGrilla
                            
                            MsgBox "El año de la Fecha es invalida ingrese un año mayor a 1900, ver item N." & CE(.Columns(nColAsd_nItem)), vbInformation + vbOKOnly
                            .Col = nColTab
                            .Refresh
                            pSaltoColGridActivo = False
                            
                            
                            Exit Function
                
                        End If
                    Else
                            tdbgDetalle.Columns(nColAsd_dFecVen).Value = ""
                            UpdateGrilla
                            
                            MsgBox "Fecha de vencimiento no valida, ver item N." & CE(.Columns(nColAsd_nItem)), vbInformation + vbOKOnly
                            .Col = nColTab
                            .Refresh
                            pSaltoColGridActivo = False
                            
                            
                            Exit Function
                    
                    End If
                    
                    
                End If
                
                If CE(.Columns(nColTab)) <> "" And Format(.Columns(nColTab), "yyyy/mm/dd") < Format(.Columns(nColAsd_dFecDoc), "yyyy/mm/dd") And .Columns(nColAsd_cTipoDoc) = "14" Then
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecVen) = ""
                    .Columns(nColAsd_dFecVen).Value = ""
                    UpdateGrilla
                    
                    MsgBox "Fecha de la cuenta, no puede ser menor a la fecha del Documento", vbInformation + vbOKOnly
                    .Col = nColTab
    
                    .Columns(nColAsd_dFecVen).Value = "__/__/____"
                    .Refresh
                    pSaltoColGridActivo = False
                    
                    
                    Exit Function
    
                End If
                
                If gintBiMoneda = 1 Then
                    If CE(.Columns(nColTab)) <> "__/__/____" Then
                        If CE(.Columns(nColTab)) <> "" And Month(Format(.Columns(nColTab), "yyyy/mm/dd")) > Int(gsPeriodo) And Year(Format(.Columns(nColTab), "yyyy/mm/dd")) >= Int(gsAnio) And .Columns(nColAsd_cTipoDoc) = "14" Then
                        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecVen) = ""
                        .Columns(nColAsd_dFecVen).Value = ""
                        UpdateGrilla
                        
                        MsgBox "Fecha de vencimiento no puede ser mayor al periodo del Voucher", vbInformation + vbOKOnly
                        .Col = nColTab
        
                        .Columns(nColAsd_dFecVen).Value = "__/__/____"
                        .Refresh
                        pSaltoColGridActivo = False
                        
                        Exit Function
        
                        End If
                    End If
                Else
                    If CE(.Columns(nColTab)) <> "" And Month(Format(.Columns(nColTab), "yyyy/mm/dd")) > Int(gsPeriodo) And Year(Format(.Columns(nColTab), "yyyy/mm/dd")) >= Int(gsAnio) And .Columns(nColAsd_cTipoDoc) = "14" Then
                        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecVen) = ""
                        .Columns(nColAsd_dFecVen).Value = ""
                        UpdateGrilla
                        
                        MsgBox "Fecha de vencimiento no puede ser mayor al periodo del Voucher", vbInformation + vbOKOnly
                        .Col = nColTab
        
                        .Columns(nColAsd_dFecVen).Value = "__/__/____"
                        .Refresh
                        pSaltoColGridActivo = False
                        
                        Exit Function
        
                    End If
                End If
                
'                If CE(.Columns(nColTab)) <> "" And Month(Format(.Columns(nColTab), "yyyy/mm/dd")) > Int(gsPeriodo) And Year(Format(.Columns(nColTab), "yyyy/mm/dd")) >= Int(gsAnio) And .Columns(nColAsd_cTipoDoc) = "14" Then
'                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecVen) = ""
'                    .Columns(nColAsd_dFecVen).Value = ""
'                    UpdateGrilla
'
'                    MsgBox "Fecha de vencimiento no puede ser mayor al periodo del Voucher", vbInformation + vbOKOnly
'                    .Col = nColTab
'
'                    .Columns(nColAsd_dFecVen).Value = "__/__/____"
'                    .Refresh
'                    pSaltoColGridActivo = False
'
'                    Exit Function
'
'                End If
                
                
                
           End With
        End If
    End If
    '---------------------- COLUMNA TIPO DE OPERACION -----------------------------------'
    If nColTab = nColAsd_cOperaTC Then
       If CE(tdbgDetalle.Columns(nColTab)) = "" Then

             Mensajes "Codigo de Tipo de Operación para TC no existe, verificar...", vbInformation
             tdbgDetalle.Col = nColTab
             tdbgDetalle.Columns(nColTab) = "VEP"
             
             pSaltoColGridActivo = False
             
             
             Exit Function

       End If
    End If
    
    '----------------------------- TIPO DE CAMBIO ---------------------------------'
'    If nColTab = nColAsd_nTipoCambio Then
'        If NE(tdbgDetalle.Columns(nColAsd_nTipoCambio)) = 0 And tdbgDetalle.Columns(nColAsd_cOperaTC) = "OTR" And tdbgDetalle.Columns(nColAsd_cOperaTC) <> "SCV" Then
'            UpdateGrilla
'            DoEvents
'            Mensajes "El tipo de cambio no puede ser CERO cuando la moneda de la operacion no es la moneda nacional", vbInformation + vbOKOnly
'            tdbgDetalle.Col = nColTab
'
'            tdbgDetalle.Columns(nColAsd_nTipoCambio).Value = "0.00"
'            tdbtCambio.Value = 0
'            RefreshGrilla
'            pSaltoColGridActivo = False
'
'
'            Exit Function
'        End If
'    End If

    '---------------------- COLUMNA TIPO DE OPERACION - SEGUNDA PARTE -----------------------------------'
    If nColTab = nColAsd_cNomMoneda Or nColTab = nColAsd_cOperaTC Then
        If tdbgDetalle.Columns(nColAsd_cOperaTC) <> "SCV" And tdbgDetalle.Columns(nColAsd_cOperaTC) <> "OTR" Then
            With tdbgDetalle
                If IsDate(.Columns(nColAsd_dFecDoc).Value) <> False Then
                
                    If .Columns(nColAsd_nTipoCambio).Value = "" Then .Columns(nColAsd_nTipoCambio).Value = 0
                    
                    Dim FilasMoneda As Integer
                    FilasMoneda = tdbcMoneda.VisibleRows
                    
                    TC = TipoCambio(.Columns(nColAsd_dFecDoc).Text, .Columns(nColAsd_cOperaTC).Text)
                    
                    If gsByMoneda = 0 And CE(tdbgDetalle.Columns(nColAsd_cOperaTC).Value) = "" Then
                        tdbgDetalle.Columns(nColAsd_cOperaTC).Value = "SCV"
                        TC = 0
                    End If
                    
                    If TC < 0 Then TC = 0
                    tdbtCambio.Value = TC
                    .Columns(nColAsd_nTipoCambio).Value = TC
                    
                    
                    
                End If
           End With
        End If
    End If
    '---------------------- COLUMNA CENTRO DE COSTO -----------------------------------'
    If nColTab = nColCos_cCodigo And _
       CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nCol_cFlgCCosto)) = "1" And _
       CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) <> "" Then
       
       If CE(tdbgDetalle.Columns(nColCos_cCodigo)) <> gsUltimoCC Then
       
           sqlver = "SELECT Cos_cTitulo+Cos_cSTitulo +Cos_cDescripcion As descripcion From CNT_CENTRO_COSTO " & _
                    "WHERE Emp_cCodigo = '" & gsEmpresa & "' AND Pan_cAnio = '" & gsAnio & "' AND Cos_cDeleted <> '*' AND Cos_cEstado = 'A'" & _
                    "AND Cos_cCodigo = '" & tdbgDetalle.Columns(nColTab) & "' "
           valorDato = ExtraeDescripcion(sqlver)
           If valorDato = "" Then
                UpdateGrilla
                DoEvents
                If gsKeyPressF1 = True Or gsColumnaInicialPress = nColCos_cCodigo Then
                Mensajes "Codigo no existe, verificar...", vbInformation
                End If
                gsKeyPressF1 = True
                tdbgDetalle.Col = nColTab
                tdbgDetalle.Columns(nColTab) = ""
                
                pSaltoColGridActivo = False
                
                
                Exit Function
    
           Else
              If Mid(CE(valorDato), 1, 1) = "S" Or Mid(CE(valorDato), 2, 1) = "S" Then
                RefreshGrilla
                DoEvents
    
                 Mensajes "Centro de Costo esta definido como titulo o subtitulo, revisar", vbInformation
                 tdbgDetalle.Col = nColTab
                 tdbgDetalle.Columns(nColTab) = ""
                 
                 pSaltoColGridActivo = False
                 
                 
                 Exit Function
              Else
                 lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNomCC) = Mid(valorDato, 3, Len(valorDato) - 2)
                 lArrDetalle(tdbgDetalle.Bookmark, nColCos_cCodigo) = tdbgDetalle.Columns(nColTab)
              End If
           End If
       End If
       

    End If
    '-------------------------- COLUMNA ENTIDAD -----------------------------------------'
    If nColTab = nColEnt_cCodEntidad Then
        Call pUpdateArray
        
        If CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cEntTipSerNum)) <> BuscaEntTipSerNum(tdbgDetalle.Bookmark) Then
            If CE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgProv)) = "1" Then

                     'busca si el documento fue ingresado en otra linea del voucher
                     If BuscaCorrelProvisionDetalle(CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)), _
                                                    CE(lArrDetalle(tdbgDetalle.Bookmark, nColEnt_cCodEntidad)), _
                                                    CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDoc)), _
                                                    CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cSerieDoc)), _
                                                    CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumDoc))) = True Then

                        tdbgDetalle.Columns(nColTab) = ""
                        UpdateGrilla
                        DoEvents
                        Mensajes gsMensaje, vbInformation + vbOKOnly
                        tdbgDetalle.Col = nColTab
                        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cProvCanc) = ""
                        DoEvents
                        RefreshGrilla
                        pSaltoColGridActivo = False


                        Exit Function
                     End If
            End If
        End If
    End If
    
    If nColTab = nColEnt_cCodEntidad Then
        
        If CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) <> "" And _
           CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nCol_cTipoEntiCta)) <> "" And _
           gsKeyCode <> 112 Then
           'LIN 00
           If CE(tdbgDetalle.Columns(nColEnt_cCodEntidad)) <> gsUltimaEnt Then

               tipoTer = CE(tdbgDetalle.Columns(nColTen_cTipoEntidad))
               'LIN 01
               If tipoTer = "" Then
                  UpdateGrilla

                  Mensajes "No ingreso el Tipo de Entidad. Utilize la ayuda para obtener la Entidad", vbInformation
                  tdbgDetalle.Col = nColTab
                  tdbgDetalle.Columns(nColTab) = ""

                  pSaltoColGridActivo = False
                  Exit Function
               Else
                    
                  'LIN 02
                  If CE(tdbgDetalle.Columns(nColEnt_cCodEntidad)) <> "" Then
                      sqlver = "SELECT ENT_CPERSONA From CNM_ENTIDAD WHERE Emp_cCodigo = '" & gsEmpresa & "' AND Ent_cEstado = 'A'  AND " & _
                               "Ent_cCodEntidad = '" & tdbgDetalle.Columns(nColEnt_cCodEntidad) & "'  AND " & _
                               "Ten_cTipoEntidad = '" & tipoTer & "' "
                      
                      valorDato = CE(ExtraeDescripcion(sqlver))
                      'LIN 03
                      If valorDato = "" Then
                            UpdateGrilla
                            If gsKeyPressF1 = True Or gsColumnaInicialPress = nColEnt_cCodEntidad Then
                            Mensajes "Codigo de Entidad no existe, verificar...", vbInformation
                            End If
                            gsKeyPressF1 = True
                            tdbgDetalle.Col = nColTab
                            tdbgDetalle.Columns(nColTab) = ""
                            pSaltoColGridActivo = False
                            Exit Function
                      Else
                         tdbgDetalle.Columns(nColEnt_cPersona).Value = valorDato
                         tdbgDetalle.Columns(nColTen_cTipoEntidad).Value = tipoTer
                         lArrDetalle(tdbgDetalle.Bookmark, nColEnt_cCodEntidad) = tdbgDetalle.Columns(nColTab)
                         'lArrDetalle(tdbgDetalle.Bookmark, nColEnt_cPersona) = valorDato
                         'lArrDetalle(tdbgDetalle.Bookmark, nColTen_cTipoEntidad) = tipoTer
                         Me.lblNomEnti.Caption = valorDato
                         If valorDato = "ANULADO" Or valorDato = "ANULADA" Then
                            sql = "select * from CNT_lIBROSGENERADOS where Emp_cCodigo = '" & gsEmpresa & "' and Pan_cAnio = '" & gsAnio & "' and Per_cPeriodo = '" & gsPeriodo & "' and Lib_cTipoLibro = '" & tdbcLibro.BoundText & "' and Estado ='A'"
                            If ExisteDato(sql) = False Or (Month(dtpFecha.Value) = Month(lsFecha) And Year(dtpFecha.Value) = Year(lsFecha)) Then
                                EstadoDesTMP = EstadoDes
                                EstadoDes = "2"
                            End If
                         End If
                         If valorDato <> "ANULADO" Or valorDato <> "ANULADA" Then
                            If EstadoDesTMP = "" Then EstadoDes = EstadoDesTMP
                         End If
                         Me.lblEntidad.Caption = "ENTIDAD: "
                      End If 'FLIN 03
                  Else
                       If gsKeyPressF1 = True Or gsColumnaInicialPress = nColEnt_cCodEntidad Then
                          UpdateGrilla
                          Mensajes "Ingrese Codigo de Entidad , verificar...", vbInformation
                       End If
                       
                       tdbgDetalle.Col = nColTab
                       tdbgDetalle.Columns(nColTab) = ""

                       pSaltoColGridActivo = False

                       Exit Function

                  End If 'FLIN 02
               End If 'FLIN 01
           End If 'FLIN 00
       End If
    End If
    '---------------- VALIDA CAMPO DEBE Y HABER ----------------------------'
    If (nColTab = nColAsd_nTipoCambio Or _
       nColTab = nColAsd_nDebeSoles Or _
       nColTab = nColAsd_nHaberSoles Or _
       nColTab = nColAsd_nDebeMonExt Or _
       nColTab = nColAsd_nHaberMonExt) Then
        
        If NE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nImporteEditado)) = 0 And _
           CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cProvCanc)) = "C" Then
            
            pSaltoColGridActivo = True
            
            If lArrDetalle.Count(1) = NumeroFilas And (nColTab = nColAsd_nHaberSoles Or nColTab = nColAsd_nHaberMonExt) Then
                UpdateGrilla
                Call AgregaFilaDetalle(1, True, "")
            '    GoTo BUSCA_CELDA
            End If
            
           ' Exit Function
        End If
        
        If ValModificoImpConSaldosProv = True Then
            If ValidaProvCancel(tdbgDetalle.Bookmark) = False Then
                pSaltoColGridActivo = False
                Exit Function
            End If
        End If
        
        If tdbgDetalle.Columns(nColAsd_nTipoCambio) = "" Then tdbgDetalle.Columns(nColAsd_nTipoCambio) = 0
        
        If tdbgDetalle.Columns(nCol_cFlgMonNac) = "1" Then
           With tdbgDetalle
               If NE(lArrDetalle.Value(.Bookmark, nColAsd_nDebeSoles)) > 0 And NE(lArrDetalle.Value(.Bookmark, nColAsd_nHaberSoles)) > 0 Then
                  .Columns(nColAsd_nHaberSoles) = "0.00"
                  UpdateGrilla
                  DoEvents

                  Mensajes "Debe y haber no deben ser mayores de 0 en mismo registro", vbInformation
                  .Col = nColAsd_nHaberSoles
                  pSaltoColGridActivo = False
                  Exit Function
                  
               End If
               
               If Me.CheckCuadraCompMan.Value = vbUnchecked And _
                  .Columns(nColAsd_cOperaTC) <> "SCV" Then
                  
                  '-- MIO --
            
                  If .Columns(nColAsd_nTipoCambio) <> 0 Then
                     Call CalculaMonExt
                  Else
                    .Columns(nColAsd_nDebeMonExt) = 0
                    .Columns(nColAsd_nHaberMonExt) = 0
                  End If
                  
                   
                   SumaMontos = NE(.Columns(nColAsd_nDebeMonExt)) + NE(.Columns(nColAsd_nHaberMonExt))
                   If NE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cDetExt)) <> SumaMontos Then
                      lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
                      tdbgDetalle.RefreshRow
                      DoEvents
                   End If
                  
               End If
               
               'Si no esta activo la opcion Bimoneda en la empresa
               If .Columns(nColAsd_cOperaTC) = "SCV" And gintBiMoneda = 0 Then
                   .Columns(nColAsd_nDebeMonExt) = 0
                   .Columns(nColAsd_nHaberMonExt) = 0
               
               End If
               
               
                UpdateGrilla
                DoEvents

               Call SumarTotales
           End With
        Else
           With tdbgDetalle
               .Columns(nColAsd_nDebeMonExt) = NE(.Columns(nColAsd_nDebeMonExt))
               .Columns(nColAsd_nHaberMonExt) = NE(.Columns(nColAsd_nHaberMonExt))
        
               If NE(lArrDetalle.Value(.Bookmark, nColAsd_nDebeMonExt)) > 0 And NE(lArrDetalle.Value(.Bookmark, nColAsd_nHaberMonExt)) > 0 Then
                  .Columns(nColAsd_nHaberMonExt) = "0.00"
                  UpdateGrilla
                  DoEvents

                  Mensajes "Debe y haber no deben ser mayores de 0 en mismo registro", vbInformation
                  .Col = nColAsd_nHaberMonExt
                  .Columns(.Col) = 0
                  lArrDetalle.Value(.Bookmark, nColAsd_nDebeMonExt) = 0
                  pSaltoColGridActivo = False
                  
                  Exit Function
               End If
               
               If Me.CheckCuadraCompMan.Value = vbUnchecked Then
            
                   If .Columns(nColAsd_cMonedaCalculo).Value <> "1" Then
                      Call CalculaMonNac
                   Else
                     .Columns(nColAsd_nDebeSoles) = 0
                     .Columns(nColAsd_nHaberSoles) = 0
                   End If
                   
                      
                   SumaMontos = NE(.Columns(nColAsd_nDebeSoles)) + NE(.Columns(nColAsd_nHaberSoles))
                   If NE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cDetNac)) <> SumaMontos Then
                      
                      lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
                      tdbgDetalle.RefreshRow
                      DoEvents
                        
                   End If
               End If
               
                UpdateGrilla
                DoEvents

               Call SumarTotales
           End With
        End If
    End If
End If


'---------------------- BUSCA CELDA ACTIVA --------------------------------'
BUSCA_CELDA:

    Dim iFila As Integer
    entro = False
    If Buscar = True Then
    
        If gsKeyCode = vbKeyRight Or gsKeyCode = 13 Then
        
            If gsColumnaInicialPress = nColAsd_nHaberSoles And CheckCuadraCompMan.Value = vbUnchecked Then
            
                If gsKeyCode = 13 Then
                     lItem = NumeroFilas
                     
                     If tdbgDetalle.Bookmark = lArrDetalle.Count(1) - 1 Then
                        UpdateGrilla
                        AgregaFilaDetalle 1
                        DoEvents
                     Else
                        tdbgDetalle.Col = nColPla_cCuentaContable
                        tdbgDetalle.Bookmark = tdbgDetalle.Bookmark + 1
                        
                     End If
                     
                     tdbgDetalle.Col = nColPla_cCuentaContable
                     DoEvents
                Else
                     entro = BuscaColumna(nColAsd_nHaberSoles)
                End If
            
            
            ElseIf gsColumnaInicialPress = nColAsd_nHaberMonExt Then
                     
                If gsKeyCode = 13 Then
                     lItem = NumeroFilas
                     
                     If tdbgDetalle.Bookmark = lArrDetalle.Count(1) - 1 Then
                        UpdateGrilla
                        AgregaFilaDetalle 1
                        DoEvents
                     End If
                     
                     tdbgDetalle.Col = nColPla_cCuentaContable
                     DoEvents
                Else
                      entro = BuscaColumna(nColAsd_nHaberMonExt)
                End If
            
            Else
                If nColTab = nColAsd_cTipoDoc Then
                   entro = True
                   gsColumna = nColAsd_cSerieDoc
                ElseIf nColTab = nColAsd_cSerieDoc Then
                   entro = True
                   gsColumna = nColAsd_cNumDoc
                Else
                    For i = nColTab + 1 To nColAsd_cCanc + 1 'nColAsd_cCanc + 1
                        If BuscaColumna(i) Then
                            entro = True
                            
                            Exit For
                        End If
                    Next i
                End If
                
            End If
            
        ElseIf gsKeyCode = vbKeyLeft Then
            For i = nColTab - 1 To 0 Step -1
                If BuscaColumna(i) Then
                    entro = True
                    Exit For
                End If
            Next i
        ElseIf gsKeyCode = vbKeyUp Then
            gsColumna = nColTab
            entro = True
        ElseIf gsKeyCode = vbKeyDown Then
            gsColumna = nColTab
            entro = True
        ElseIf gsKeyCode = -1 Then
            entro = True
        End If
        
        
    End If

    'gsColumna = gsColumna
    
    pSaltoColGridActivo = entro
    'gsFlagBotonBarra = False
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ValModificoImpConSaldosProv
' Description:       Funcion que valida si se modificaron los importes de los documentos provisionados
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function ValModificoImpConSaldosProv() As Boolean
    On Error GoTo serror
    Dim bModif1 As Boolean, bModif2 As Boolean
    Dim bModif3 As Boolean, bModif4 As Boolean
    bModif1 = False
    bModif2 = False
    bModif3 = False
    bModif4 = False
    '-----------------------------------------
    With tdbgDetalle
        If NE(lArrDetalle(.Bookmark, nColAsd_nSaldoProv)) > 0 And _
           NE(lArrDetalle(.Bookmark, nColAsd_nSaldoProv)) <> NE(lArrDetalle(.Bookmark, nColAsd_nDebeSoles)) + NE(lArrDetalle(.Bookmark, nColAsd_nHaberSoles)) Then
           
           bModif1 = True
        End If
        '----------------
        If NE(lArrDetalle(.Bookmark, nColAsd_nSaldoExtProv)) > 0 And _
           NE(lArrDetalle(.Bookmark, nColAsd_nSaldoExtProv)) <> NE(lArrDetalle(.Bookmark, nColAsd_nDebeMonExt)) + NE(lArrDetalle(.Bookmark, nColAsd_nHaberMonExt)) Then
           
           bModif2 = True
        End If
        '----------------
        If NE(.Columns(nColAsd_nDebeSoles)) + NE(.Columns(nColAsd_nHaberSoles)) <> lArrDetalle(.Bookmark, nColAsd_nNacional) Then
           
           bModif3 = True
        End If
        '----------------
        If NE(.Columns(nColAsd_nDebeMonExt)) + NE(.Columns(nColAsd_nHaberMonExt)) <> lArrDetalle(.Bookmark, nColAsd_nExtranjera) Then
           
           bModif4 = True
        End If
        
        
        If bModif1 = True Or bModif2 = True Or bModif3 = True Or bModif4 = True Then
            ValModificoImpConSaldosProv = True
        Else
            ValModificoImpConSaldosProv = False
        End If
    
    End With
    Exit Function
serror:
    ValModificoImpConSaldosProv = True
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaTDArray
' Description:       Fincion que retorna la descripcion del tipo de documento en el array de TD
'
' Parameters :       Valor (String)
'--------------------------------------------------------------------------------
Private Function BuscaTDArray(Valor As String) As String
    On Error Resume Next
    Dim Indice As Long
    Indice = lArrTipoDoc.Find(0, 0, Valor)
    BuscaTDArray = lArrTipoDoc(Indice, 1)
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaCorrelProvisionDetalle
' Description:       Funcion que retorna el correlativo del documento provisionado
'
' Parameters :       Cuenta (String)
'                    Entidad (String)
'                    Tipo (String)
'                    Serie (String)
'                    numero (String)
'                    Fila (Integer = 0)
'--------------------------------------------------------------------------------
Public Function BuscaCorrelProvisionDetalle(Cuenta As String, Entidad As String, _
                                             Tipo As String, Serie As String, _
                                             Numero As String, Optional Fila As Integer = 0) As Boolean
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If
    
    If Fila = 0 Then Fila = tdbgDetalle.Bookmark
    
    If Entidad <> "" And Tipo <> "" Then
        lItem = NumeroFilas
        Dim i As Integer
        On Error Resume Next
        
        For i = 0 To lItem - 1
                If Cuenta <> "" Then
                    If CE(lArrDetalle(i, nColEnt_cCodEntidad)) = Entidad And _
                       CE(lArrDetalle(i, nColPla_cCuentaContable)) = Cuenta And _
                       CE(lArrDetalle(i, nColAsd_cTipoDoc)) = Tipo And _
                       CE(lArrDetalle(i, nColAsd_cSerieDoc)) = Serie And _
                       CE(lArrDetalle(i, nColAsd_cNumDoc)) = Numero And _
                       NE(lArrDetalle(i, nColAsd_nItem)) <> NE(lArrDetalle(Fila, nColAsd_nItem)) Then
                        BuscaCorrelProvisionDetalle = True
                        gsMensaje = "Este documento ya fue seleccionado en este voucher, en el Item N. " & CE(lArrDetalle(i, nColAsd_nItem))
                        Exit Function
                    End If
                Else
                    If CE(lArrDetalle(i, nColEnt_cCodEntidad)) = Entidad And _
                       CE(lArrDetalle(i, nColAsd_cTipoDoc)) = Tipo And _
                       CE(lArrDetalle(i, nColAsd_cSerieDoc)) = Serie And _
                       CE(lArrDetalle(i, nColAsd_cNumDoc)) = Numero Then
                        BuscaCorrelProvisionDetalle = True
                        gsMensaje = "Este documento ya fue seleccionado en este voucher, en el Item N. " & CE(lArrDetalle(i, nColAsd_nItem))
                        Exit Function
                    End If
                End If
        Next i
    End If
    
    BuscaCorrelProvisionDetalle = False

End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaDocumentoProvisionado
' Description:       Funcion que retorna si el documento ha sido provisionado o no
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function BuscaDocumentoProvisionado() As Boolean
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If
    
    '------------------------------------------
    Dim rsArreglo As ADODB.Recordset
    Dim clDatos As clsMantoTablas
    Dim arrDatos() As Variant, sqlSp As String
    
    '------------------------------------------
    'BUSCA LINEA TEMPORAL ELIMINADA EN BUFFER Y RETORNA VALOR
'    Dim Pos As Integer
'    Pos = BuscaDatosDoc(tdbgDetalle.Bookmark)


'    If Pos >= 0 Then
'        Call CargaValoresAlmacenados(Pos)
'        Call SumarTotales
'        Exit Function
'    End If
    '------------------------------------------
    
    gsMensaje = ""
    BuscaDocumentoProvisionado = True
    gsDocSinSaldo = False
    gsDocEnDetalle = False
    
    pUpdateArray
    

    If CE(lArrDetalle(tdbgDetalle.Bookmark, nColEnt_cCodEntidad)) <> "" And CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDoc)) <> "" And CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumDoc)) <> "" And CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)) <> "" Then

        If BuscaCorrelProvisionDetalle(CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)), _
                                       CE(lArrDetalle(tdbgDetalle.Bookmark, nColEnt_cCodEntidad)), _
                                       CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDoc)), _
                                       CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cSerieDoc)), _
                                       CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumDoc))) = True Then
                                          
            BuscaDocumentoProvisionado = False 'indica si ya se encontro la provision en el detalle
            gsDocEnDetalle = True
              
            CerrarRecordSet rsArreglo
            Set clDatos = Nothing
            Exit Function
        End If

        
        Set clDatos = New clsMantoTablas
                
            sqlSp = "spCn_ConsultaProvisionesDoc 'BUSCAPROV', " & _
                    "'" & gsEmpresa & "', " & _
                    "'" & gsAnio & "', " & _
                    "'" & CE(lArrDetalle(tdbgDetalle.Bookmark, nColEnt_cCodEntidad)) & "', " & _
                    "'" & UltimoDiaMes(gsPeriodo, gsAnio) & "', " & _
                    "'" & CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDoc)) & "', " & _
                    "'" & CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cSerieDoc)) & "', " & _
                    "'" & CE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumDoc)) & "', " & _
                    "'" & CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)) & "'"
                    
            arrDatos = Array(sqlSp)
            
            
            Set rsArreglo = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
    
    '---------------------------------------------
    'ILin00
    Dim cResultado As VbMsgBoxResult
    Dim cMensaje As String
    
    If Not rsArreglo Is Nothing Then
       'ILin01
       lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cManual) = 0
       
       If Not (rsArreglo.EOF And rsArreglo.BOF) Then
          If CE(rsArreglo(0)) = "SP" Then
                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cEcpOperacion) = ""
                gsMensaje = "Este documento no fue provisionado."
                gsDocProvisionado = False 'indica si el documento tiene provision
                BuscaDocumentoProvisionado = False
                CerrarRecordSet rsArreglo
                Set clDatos = Nothing
                Exit Function
          End If
       
          If CE(rsArreglo(0)) = "SS" Then
                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cEcpOperacion) = ""
                gsMensaje = "Este documento ya fue cancelado."
                gsDocProvisionado = True
                BuscaDocumentoProvisionado = False
                gsDocSinSaldo = True
                
                CerrarRecordSet rsArreglo
                Set clDatos = Nothing
                Exit Function
          End If
          
          If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Then
            
        '********* Se adiciona el segmento para los libros electrónicos ******
        'PGBV - 14012013
        If gsPLE = 1 Then
            Mensajes "Este documento ya fue provisionado anteriormente. Verifique!!", vbInformation
            tdbgDetalle.Columns(nColAsd_cNumDoc) = ""
            tdbgDetalle.Col = tdbgDetalle.Col - 1
                Set clDatos = Nothing
                Exit Function
        Else
            cMensaje = "Este documento ya fue provisionado anteriormente," & Salto(1) & "desea utilizarlo para realizar un "
            If tdbcLibro.BoundText = lsLibroCom Then cResultado = Mensajes(cMensaje & "pago", vbInformation + vbYesNo)
            If tdbcLibro.BoundText = lsLibroVen Then cResultado = Mensajes(cMensaje & "cobro", vbInformation + vbYesNo)
            If cResultado = vbNo Then
                BuscaDocumentoProvisionado = False
                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cNumDoc) = ""
                tdbgDetalle.Columns(nColAsd_cNumDoc) = ""
                'Call RefreshGrilla
                CerrarRecordSet rsArreglo
                Set clDatos = Nothing
                Exit Function
            End If
        End If
        End If
          
          '-----------------------------------
          Dim Mes As String
          Mes = Mid(CE(rsArreglo("Asd_dFecDoc")), 4, 2)
        
          If CE(rsArreglo("DifCambio")) = "D" And Mes > gsPeriodo Then
              BuscaDocumentoProvisionado = False
              gsDocEnDetalle = True
              gsMensaje = "No se puede seleccionar este documento" & Salto(1) & _
                          "por que tiene asientos en " & Salto(1) & _
                          "el libro Diferencia de Cambio" & Salto(1) & _
                          "en el mes de " & NombreMes(Mes) & "," & Salto(1) & _
                          "para utilizarlo elimine primero los asientos" & Salto(1) & _
                          "del libro y del periodo mencionado"
              
              CerrarRecordSet rsArreglo
              Set clDatos = Nothing
              Exit Function
          End If
          '-----------------------------------
          
          gsDocProvisionado = True 'indica si el documento tiene provision
          
          DoEvents
          tdbgDetalle.Enabled = False
          With tdbgDetalle
            .Columns(nColAsd_nCorre).Value = NE(rsArreglo("Correl"))
          
            .Columns(nColPla_cCuentaContable) = CE(rsArreglo("Pla_cCuentaContable"))
            .Columns(nColAsd_dFecDoc) = CE(rsArreglo("Asd_dFecDoc"))
            .Columns(nColAsd_cOperaTC) = CE(rsArreglo("Asd_cOperaTC"))
            
            'PGBV - Consultado por Javier Pazos
'            If CE(rsArreglo("Asd_cOperaTC")) <> "SCV" Then
'                .Columns(nColAsd_cOperaTC) = "OTR"
'            End If
            
            .Columns(nColAsd_cTipoMoneda) = CE(rsArreglo("mone"))
            .Columns(nColAsd_nTipoCambio) = NE(rsArreglo("Asd_nTipoCambio"))
            .Columns(nColAsd_cNomMoneda).Value = CE(rsArreglo("NomMoneCorto"))
            
            lArrDetalle(.Bookmark, nColAsd_nSaldoProv) = NE(rsArreglo("SdoSoles"))
            lArrDetalle(.Bookmark, nColAsd_nSaldoExtProv) = NE(rsArreglo("SdoDolares"))
            
            lArrDetalle(.Bookmark, nColAsd_nImporteEditado) = "0"
            
            lArrDetalle(.Bookmark, nColAsd_cProvCanc) = "C"
            
            lArrDetalle(.Bookmark, nColAsd_cCanc) = "C"
            
            lArrDetalle(.Bookmark, nColAsd_cDetCorrel) = NE(rsArreglo("Correl"))
            lArrDetalle(.Bookmark, nColAsd_cDetProvCanc) = "C"
            
            lArrDetalle(.Bookmark, nColAsd_cManual) = NE(rsArreglo("Ase_cCuadreManual"))

            lArrDetalle(.Bookmark, nColAsd_cEcpOperacion) = CE(rsArreglo("Cnp_cDebeHaber"))
            lArrDetalle(.Bookmark, nColAsd_dFecVen) = CE(rsArreglo("Asd_dFecVen"))
            
            If CE(rsArreglo("mone")) = gsMonedaNac Then
                '.Columns(nCol_cFlgMonNac).Value = "1"
                lArrDetalle.Value(.Bookmark, nCol_cFlgMonNac) = "1"
            Else
                '.Columns(nCol_cFlgMonNac).Value = "0"
                lArrDetalle.Value(.Bookmark, nCol_cFlgMonNac) = "0"
            End If
            
            'If NE(.Columns(nColAsd_nDebeSoles)) = 0 And NE(.Columns(nColAsd_nHaberSoles)) = 0 And NE(.Columns(nColAsd_nDebeMonExt)) = 0 And NE(.Columns(nColAsd_nHaberMonExt)) = 0 Then
            
            If CE(rsArreglo("Cnp_cDebeHaber")) = "H" Then
               .Columns(nColAsd_nDebeSoles) = NE(rsArreglo("SdoSoles"))        ' *** Debe Soles
               .Columns(nColAsd_nDebeMonExt) = NE(rsArreglo("SdoDolares"))       ' *** Debe Dolar
               .Columns(nColAsd_nHaberSoles) = 0                                   ' *** Haber Soles
               .Columns(nColAsd_nHaberMonExt) = 0                                  ' *** Haber Dolar
            Else
               .Columns(nColAsd_nHaberSoles) = NE(rsArreglo("SdoSoles"))       ' *** Haber Soles
               .Columns(nColAsd_nHaberMonExt) = NE(rsArreglo("SdoDolares"))      ' *** Haber Dolar
               .Columns(nColAsd_nDebeSoles) = 0                                    ' *** Debe Soles
               .Columns(nColAsd_nDebeMonExt) = 0                                   ' *** Debe Dolar
            End If
            
            lArrDetalle(.Bookmark, nColAsd_nNacional) = NE(rsArreglo("SdoSoles").Value)
            lArrDetalle(.Bookmark, nColAsd_nExtranjera) = NE(rsArreglo("SdoDolares").Value)
            
            
          End With
      
        tdbgDetalle.Enabled = True
       Else
            gsMensaje = "Este documento ya fue cancelado."
            BuscaDocumentoProvisionado = False
       End If
       'FLin01
       CerrarRecordSet rsArreglo
       
       UpdateGrilla
       
       Call SumarTotales
       
        If lArrDetalle.Count(1) = NumeroFilas Then
            AgregaFilaDetalle 1, True, "PROV"
        End If
        
        RefreshGrilla
        DoEvents
        
        tdbgDetalle.ReBind
        
        
    Else
        gsDocSinSaldo = True
        gsMensaje = "Este documento ya fue cancelado."
        gsMensaje = "Este documento no fue provisionado o ya fué cancelado."
        BuscaDocumentoProvisionado = False
    End If
    'FLin00
    
    End If 'ENDIF DE VALIDACION SI TIENE ENTIDAD, CUENTA, TIPODOC Y NUMDOC
    
    CerrarRecordSet rsArreglo
    Set clDatos = Nothing
Saltar_Duplicacion:
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       MantenimientoTipoCambio
' Description:       Procedimiento que actualiza el tipo de cambio desde el mantenimiento de voucher
'
' Parameters :       TC (Double)
'--------------------------------------------------------------------------------
Private Sub MantenimientoTipoCambio(TC As Double)
    Dim clsMante As clsMantoTablas
    Dim i As Integer
    Dim condicion As Boolean

    Set clsMante = New clsMantoTablas

    On Local Error GoTo ErrorEjecucion
    
    CargaArregloMnt TC
    If clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCn_GrabaTipoCambio", lArrMnt(), True) = False Then
        Mensajes "El proceso no ha concluido. Verificar...", vbInformation
        
    End If
       
    Set clsMante = Nothing
    Exit Sub
    
ErrorEjecucion:
    
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CargaArregloMnt
' Description:       Procedimiento que busca el tipo de cambio del dia segun el tipo de operacion que el usuario selecciona
'
' Parameters :       TC (Double)
'--------------------------------------------------------------------------------
Private Sub CargaArregloMnt(TC As Double)
    Dim Operacion As String
    ReDim lArrMnt(10) As Variant
    lArrMnt(0) = "ACTUALIZA_VOUCHER"
    lArrMnt(1) = gsEmpresa          ' Empresa
    lArrMnt(2) = tdbgDetalle.Columns(nColAsd_dFecDoc) ' Fecha
    lArrMnt(3) = gsMonedaNac        ' MonedaOrigen
    lArrMnt(4) = tdbgDetalle.Columns(nColAsd_cTipoMoneda)    ' MonedaDestino
    
    Operacion = CE(tdbgDetalle.Columns(nColAsd_cOperaTC))
    
    lArrMnt(5) = 0
    lArrMnt(6) = 0
    lArrMnt(7) = 0
    lArrMnt(8) = 0
    
    Select Case Operacion
        Case "COM": lArrMnt(5) = TC
        Case "VEN": lArrMnt(6) = TC
        Case "VEP": lArrMnt(8) = TC
    End Select
    
    lArrMnt(9) = gsUsuario
    lArrMnt(10) = gsPeriodo
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaCeldaActiva
' Description:       Funcion que retorna el numero de columna activa
'
' Parameters :       nColTab (Integer)
'--------------------------------------------------------------------------------
Public Function BuscaCeldaActiva(nColTab As Integer) As Integer
    Dim i As Integer
    BuscaCeldaActiva = nColTab
    If gsFlagBotonBarra = True Then
        Exit Function
    End If
    
    For i = nColTab + 1 To nColAsd_nHaberMonExt
        If BuscaColumna(i) = True Then
            BuscaCeldaActiva = i
            Exit For
        End If
    Next i
    BuscaCeldaActiva = i
    
    'gsBuscoCeldaActiva = True
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaColumna
' Description:       Funcion que retorna la siguiente columna esta activa o no
'
' Parameters :       i (Integer)
'--------------------------------------------------------------------------------
Private Function BuscaColumna(i As Integer) As Boolean
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If

    Dim entro As Boolean
    entro = False
    Select Case i
                 
            Case nColPla_cCuentaContable
                 gsColumna = i
                 entro = True
            
            Case nColEnt_cCodEntidad
                 If CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nCol_cTipoEntiCta)) <> "" Then
                    gsColumna = i
                    entro = True
                 End If
        
            Case nColCos_cCodigo
                If CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nCol_cFlgCCosto)) <> "0" Then
                    gsColumna = i
                    entro = True
                End If
                
            Case nColAsd_cTipoDoc, nColAsd_cSerieDoc, nColAsd_cNumDoc
                If CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColPla_cDocumento)) <> "0" Then
                    gsColumna = i
                    entro = True
                End If
            
            Case nColAsd_dFecDoc
                   gsFlagKeydownDet = False
                   gsColumna = i
                   entro = True
                
            Case nColAsd_dFecVen
                   gsFlagKeydownDet = False
                   gsColumna = i
                   entro = True
                
            Case nColAsd_nTipoCambio, nColAsd_cNomMoneda, nColAsd_cOperaTC
                   gsFlagKeydownDet = False
                   gsColumna = i
                   entro = True
                   
            Case nColAsd_nDebeSoles
                gsFlagKeydownDet = False
                If CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cTipoMoneda)) = gsMonedaNac Or CheckCuadraCompMan.Value = vbChecked Then
                   gsColumna = i
                   entro = True
                End If
            
            Case nColAsd_nDebeMonExt
                gsFlagKeydownDet = False
                If CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cTipoMoneda)) <> gsMonedaNac Or CheckCuadraCompMan.Value = vbChecked Then
                   gsColumna = i
                   entro = True
                End If
                
            Case nColAsd_nHaberSoles
                gsFlagKeydownDet = False
                
                If CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cTipoMoneda)) = gsMonedaNac Or CheckCuadraCompMan.Value = vbChecked Then
                   gsColumna = i
                   entro = True
                End If
                    
                    
            Case nColAsd_nHaberMonExt
                gsFlagKeydownDet = False
                
                If CE(lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cTipoMoneda)) <> gsMonedaNac Or CheckCuadraCompMan.Value = vbChecked Then
                   gsColumna = i
                   entro = True
                End If
                
            Case nColAsd_cCanc
                   gsFlagKeydownDet = False
                   gsColumna = i
                   entro = True
                   
    End Select
    
    BuscaColumna = entro
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       pSaltoColGrid
' Description:       Procedimiento que salta a la siguiente columna activa
'
' Parameters :       nColTab (Integer)
'--------------------------------------------------------------------------------
Private Sub pSaltoColGrid(nColTab As Integer)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    On Error Resume Next
    If tdbtGlosa.TabIndex > nColTab And tdbtGlosa.Enabled Then
       pSetFocus tdbtGlosa
       Exit Sub
    End If
    
    '--------- OK ----------------
    If tdbcPagoIGV.TabIndex = nColTab And tdbtTipDocRef.Enabled Then
       pSetFocus tdbtTipDocRef
       Exit Sub
    End If

    If tdbcPagoIGV.TabIndex = nColTab And tdbtNroConsta.Enabled Then
       pSetFocus tdbtNroConsta
       Exit Sub
    End If
    
    
    If tdbcPagoIGV.TabIndex = nColTab And tdbtNroConsta.Enabled = False Then
       pSetFocus tdbgDetalle
       Exit Sub
    End If
    
    If tdbtNroConsta.TabIndex = nColTab And dtpFecDeposito.Enabled = True Then
       pSetFocus dtpFecDeposito
       Exit Sub
    End If
    
    If tdbcPagoIGV.TabIndex = nColTab And tdbtTipDocRef.Enabled Then
       pSetFocus tdbtTipDocRef
       Exit Sub
    End If
    
    If tdbtTipDocRef.TabIndex = nColTab And tdbtSerDocRef.Enabled Then
       pSetFocus tdbtSerDocRef
       Exit Sub
    End If
    
    If tdbtSerDocRef.TabIndex = nColTab And tdbtNroDocRef.Enabled Then
       pSetFocus tdbtNroDocRef
       Exit Sub
    End If
    
    If tdbtNroDocRef.TabIndex = nColTab And dtpFecDocRef.Enabled Then
       pSetFocus dtpFecDocRef
       Exit Sub
    End If
    
    If dtpFecDocRef.TabIndex = nColTab And Me.tdbcTipoTx.Enabled Then
        pSetFocus Me.tdbcTipoTx
        Exit Sub
    End If
    
    If dtpFecDocRef.TabIndex = nColTab And tdbtComprobante.Enabled Then
       pSetFocus tdbtComprobante
       Exit Sub
    End If
    
    If dtpFecDocRef.TabIndex = nColTab And tdbtNroConsta.Enabled Then
       pSetFocus tdbtNroConsta
       Exit Sub
    End If
    
    If dtpFecDeposito.TabIndex = nColTab Then
       pSetFocus tdbgDetalle
       Exit Sub
    End If
    
    If tdbcTipoTx.TabIndex = nColTab Then
        If tdbtComprobante.Enabled And tdbtComprobante.Visible Then
            pSetFocus tdbtComprobante
        Else
           pSetFocus tdbgDetalle
        End If
        Exit Sub
    End If
    
    If tdbtComprobante.TabIndex = nColTab Then
        If tdbtNroConsta.Enabled Then
            pSetFocus tdbtNroConsta
        Else
            pSetFocus tdbgDetalle
        End If
        Exit Sub
    End If
    
   '------------------------------
   'Si no enfoca en los controles, que se enfoque en el grid y pase a la siguiente linea.
   tdbgDetalle.Bookmark = tdbgDetalle.Bookmark + 1
   tdbgDetalle.Col = 1
   pSetFocus tdbgDetalle
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       VerificandoTipoCambio
' Description:       Funcion que verifica que valida el ingreso del tipo de cambio
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function VerificandoTipoCambio() As Boolean
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If
    
    Dim i As Integer
    
    UpdateGrilla
    
    VerificandoTipoCambio = False
    tdbgDetalle.Bookmark = tdbgDetalle.Bookmark
    
    On Error GoTo ErrorTC
    lItem = NumeroFilas
    
    For i = 0 To lItem - 1
        With lArrDetalle
            If .Value(i, nColAsd_nTipoCambio) = "" Then .Value(i, nColAsd_nTipoCambio) = 0
            
            If .Value(i, nColAsd_cMonedaCalculo) <> "1" And .Value(i, nColAsd_cOperaTC) <> "OTR" And .Value(i, nColAsd_cOperaTC) <> "SCV" And sTipoCambioDefecto <> "SCV" Then
               If .Value(i, nColAsd_nTipoCambio) = 0 Then
                  UpdateGrilla
                  DoEvents
               
                  Mensajes "No se ingresó el Tipo de Cambio en la cuenta : " & .Value(i, nColPla_cCuentaContable), vbInformation
                  
                  tdbgDetalle.Col = nColAsd_nTipoCambio
                  tdbgDetalle.Row = i
                  pSetFocus tdbgDetalle
                  Exit Function
               End If
            End If


            
        End With
    Next
    
    VerificandoTipoCambio = True
    Exit Function
    
ErrorTC:
    MsgBox "Verifique que los tipos de cambio sean mayores que CERO antes de grabar", vbOKOnly + vbInformation, "Cuidado.."
    VerificandoTipoCambio = False
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       SumarTotales
' Description:       Procedimiento que suma los totales del detalle
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub SumarTotales()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    Dim iFila As Integer
    tdbgDetalle.RefreshRow
    
    iFila = NumeroFilas
    Dim s_debe As Double, s_haber As Double
    Dim s_debeDol As Double, s_haberDol As Double
    Dim i As Integer
    Dim Valor As Double
    
    On Error Resume Next
    
    s_debe = 0: s_haber = 0
    s_debeDol = 0: s_haberDol = 0
    
    
    For i = 0 To iFila - 1
        If lnOpcion = 2 Then 'consulta
            s_debe = s_debe + NE(lArrDetalle.Value(i, nColAsd_nDebeSoles))
            s_haber = s_haber + NE(lArrDetalle.Value(i, nColAsd_nHaberSoles))
            s_debeDol = s_debeDol + NE(lArrDetalle.Value(i, nColAsd_nDebeMonExt))
            s_haberDol = s_haberDol + NE(lArrDetalle.Value(i, nColAsd_nHaberMonExt))
        Else 'nuevo o edicion
            If lArrDetalle.Value(i, nColAsd_cDestino) <> "1" Then
                s_debe = s_debe + NE(lArrDetalle.Value(i, nColAsd_nDebeSoles))
                s_haber = s_haber + NE(lArrDetalle.Value(i, nColAsd_nHaberSoles))
                s_debeDol = s_debeDol + NE(lArrDetalle.Value(i, nColAsd_nDebeMonExt))
                s_haberDol = s_haberDol + NE(lArrDetalle.Value(i, nColAsd_nHaberMonExt))
            End If
        End If
    Next
    tdbgDetalle.Columns(nColAsd_nDebeSoles).FooterText = Format(s_debe, "###,###,##0.00")
    tdbgDetalle.Columns(nColAsd_nHaberSoles).FooterText = Format(s_haber, "###,###,##0.00")
    tdbgDetalle.Columns(nColAsd_nDebeMonExt).FooterText = Format(s_debeDol, "###,###,##0.00")
    tdbgDetalle.Columns(nColAsd_nHaberMonExt).FooterText = Format(s_haberDol, "###,###,##0.00")
    
    '--- DIFERENCIA MON NAC
    Valor = NE(tdbgDetalle.Columns(nColAsd_nDebeSoles).FooterText) - NE(tdbgDetalle.Columns(nColAsd_nHaberSoles).FooterText)
    If Valor >= tdbnDiferenciaMN.MaxValue Then tdbnDiferenciaMN.MaxValue = Valor + 1000
    If Valor <= tdbnDiferenciaMN.MinValue Then tdbnDiferenciaMN.MinValue = Valor - 1000
    tdbnDiferenciaMN.Value = Valor
    '--- DIFERENCIA MON EXT
    Valor = NE(tdbgDetalle.Columns(nColAsd_nDebeMonExt).FooterText) - NE(tdbgDetalle.Columns(nColAsd_nHaberMonExt).FooterText)
    If Valor > tdbnDiferenciaME.MaxValue Then tdbnDiferenciaME.MaxValue = Valor
    If Valor < tdbnDiferenciaME.MinValue Then tdbnDiferenciaME.MinValue = Valor
    tdbnDiferenciaME.Value = Valor
    
    If NE(tdbnDiferenciaMN) <> 0 Then
        tdbnDiferenciaMN.BackColor = &HFFFF&
        tdbnDiferenciaMN.ForeColor = &H0&
    Else
        tdbnDiferenciaMN.BackColor = &H0&
        tdbnDiferenciaMN.ForeColor = &HFFFF&
    End If
    
    If NE(tdbnDiferenciaME) <> 0 Then
        tdbnDiferenciaME.BackColor = &HFFFF&
        tdbnDiferenciaME.ForeColor = &H0&
    Else
        tdbnDiferenciaME.BackColor = &H0&
        tdbnDiferenciaME.ForeColor = &HFFFF&
    End If
        
    tdbgDetalle.RefreshRow
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       VerificaFechaGrid
' Description:       Procedimiento que verifica la fecha del detalle
'
' Parameters :       numero (Integer)
'--------------------------------------------------------------------------------
Private Sub VerificaFechaGrid(Numero As Integer)
    With tdbgDetalle
        If .Columns(Numero) = "  /  /    " Then .Columns(Numero) = Null
        
        If .Columns(Numero) <> "" Then
           ' *** Si fecha no esta completa, completarla
           .Columns(Numero) = FormatoFecha(.Columns(Numero))
           If VerificaFecha(.Columns(Numero)) = False Then
              pSetFocus tdbgDetalle
              .Col = Numero - 1
           End If
        End If
    End With
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       AñadeItem
' Description:       Procedimiento que agrega un item en el detalle
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub AñadeItem()

    tdbgDetalle.Columns(nColAsd_nItem).Value = BuscaMaximoCorrel + 1
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaMaximoCorrel
' Description:       Funcion que retorna el maximo correlativo del detalle
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function BuscaMaximoCorrel() As Integer
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If

    Dim i As Integer
    Dim Maximo As Integer
    Maximo = 0
    
    NUM_FILAS = lArrDetalle.Count(1)
    
    For i = 0 To NUM_FILAS - 1
        If Maximo < NE(lArrDetalle(i, nColAsd_nItem)) Then
            Maximo = NE(lArrDetalle(i, nColAsd_nItem))
        End If
        
        'If NE(lArrDetalle(i, nColAsd_nItem)) = 0 Then
        '    Exit For
        'End If
    Next i

    BuscaMaximoCorrel = Maximo
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       NumeroFilas
' Description:       Funcion que retorna el numero de filas que tengan los datos llenos
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function NumeroFilas() As Integer
    Dim i As Integer
    Dim Filas As Integer
    Filas = 0
    
    On Error GoTo serror
    
    For i = 0 To lArrDetalle.Count(1) - 1
        
        If NE(lArrDetalle(i, nColAsd_nItem)) = 0 Then
            Exit For
        Else
            Filas = Filas + 1
        End If
    Next i
    NumeroFilas = Filas
    
    Exit Function
serror:
    NumeroFilas = Filas
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       NumeroFilasEliminadas
' Description:       Funcion que retorna el numero de filas eliminadas
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function NumeroFilasEliminadas() As Integer
    Dim i As Integer
    Dim Filas As Integer
    Filas = 0
    
    On Error GoTo serror
    
    For i = 0 To NUM_FILAS_ELIM - 1
        
        If NE(lArrDetalleElim(i, nColAsd_nItem)) = 0 Then
            Exit For
        Else
            Filas = Filas + 1
        End If
    Next i
    NumeroFilasEliminadas = Filas
    
    Exit Function
serror:
    NumeroFilasEliminadas = Filas
    
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenaCodigoOP
' Description:       Funcion que llena el RD de codigo de operaciones por cuenta
'
' Parameters :       Cuenta (String)
'--------------------------------------------------------------------------------
Private Function LlenaCodigoOP(Cuenta As String) As Boolean
    Dim clDatos As clsMantoTablas
    Set clDatos = New clsMantoTablas
    
    Dim arrDatos() As Variant
    Dim sqlSp As String
    sqlSp = "spCn_ConsultaCuentasLibro 'SEL_OPLIBRO','" & gsEmpresa & "', '" & gsAnio & "','','" & Cuenta & "'"
    arrDatos = Array(sqlSp)
    
    
    
    If Not lrsOpxCta Is Nothing Then
        If lrsOpxCta.State = 1 Then lrsOpxCta.Close
    End If
    
    Set lrsOpxCta = Nothing
    
    
    Set lrsOpxCta = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
    
    Set clDatos = Nothing

End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaOPxCuenta
' Description:       Funcion que retorna si el codigo d eoperacion del parametro se encuentra o no en el RS cargado
'
' Parameters :       Operacion (String)
'--------------------------------------------------------------------------------
Private Function BuscaOPxCuenta(Operacion As String) As Boolean
    BuscaOPxCuenta = False
    
    If Not lrsOpxCta Is Nothing Then
        If Not (lrsOpxCta.EOF And lrsOpxCta.BOF) Then
            lrsOpxCta.MoveFirst
            lrsOpxCta.Find "Cop_cCodigo = " & "'" & Operacion & "'"

            If lrsOpxCta.EOF Then
                BuscaOPxCuenta = False
            Else
                BuscaOPxCuenta = True
            End If
        End If
    End If
End Function


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaOperaTCSiEsBimoneda
' Description:       Funcion que retorna el tipo de operacion
'
' Parameters :       Cuenta (String)
'--------------------------------------------------------------------------------
Private Function BuscaOperaTCSiEsBimoneda(Cuenta As String) As String
    Dim TipoOp  As String, sqlver  As String, Resultado As String
    
    'Si no esta activado la opcion Bimoneda de la empresa
    If Me.tdbcMoneda.BoundText = gsMonedaNac And gintBiMoneda = 0 Then
        Resultado = "SCV"
        
        BuscaOperaTCSiEsBimoneda = Resultado
        
        Exit Function
    Else
        Resultado = "VEN"
    End If
    LlenaCodigoOP (Cuenta)
    With tdbgDetalle
        '----------------------------------------------------'
        If (Left(CE(Cuenta), 2) >= "10" And Left(CE(Cuenta), 2) <= "38") Or Left(CE(Cuenta), 1) = "7" Or Left(CE(Cuenta), 1) = "8" Then
            Resultado = "COM"
        End If
    
        '---------------- LIBRO CAJA INGRESOS ---------------'
        If tdbcLibro.BoundText = lsLibroCajIng Then
            
            If BuscaOPxCuenta("009") Then
               Resultado = "COM"
            End If
            
            If Left(CE(Cuenta), 2) = "10" Or Left(CE(Cuenta), 1) = "6" Or Left(CE(Cuenta), 1) = "9" Then
               Resultado = "COM"
            End If
            
        End If
        '---------------- LIBRO CAJA EGRESOS ---------------'
        If tdbcLibro.BoundText = lsLibroCajEgr Then
            
            If BuscaOPxCuenta("010") Then
               Resultado = "VEN"
            End If
            
            If Left(CE(Cuenta), 2) = "10" Or Left(CE(Cuenta), 1) = "6" Or Left(CE(Cuenta), 1) = "9" Then
               Resultado = "VEN"
            End If
        End If
        
        '---------------- LIBRO COMPRAS ---------------'
        If tdbcLibro.BoundText = lsLibroCom Then
            If BuscaOPxCuenta("006") Or BuscaOPxCuenta("008") Or BuscaOPxCuenta("010") Then
               Resultado = "VEN"
            End If
            
            If BuscaOPxCuenta("004") Then
               Resultado = "VEP"
            End If
        End If
        '---------------- LIBRO VENTAS ---------------'
        If tdbcLibro.BoundText = lsLibroVen Then
            
            If BuscaOPxCuenta("002") Then
               Resultado = "COM"
            End If
            
            If BuscaOPxCuenta("009") Then
               Resultado = "COM"
            End If
            
            If BuscaOPxCuenta("004") Then
               Resultado = "VEP"
            End If
        End If
        
    End With
    
    BuscaOperaTCSiEsBimoneda = Resultado
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenaCuentasPorLibro
' Description:       funcin que llena el RS con las cuentas por tipo de libro seleccionado
'
' Parameters :       Libro (String)
'--------------------------------------------------------------------------------
Private Function LlenaCuentasPorLibro(Libro As String) As Boolean
    LlenaCuentasPorLibro = False
    
    Dim clDatos As clsMantoTablas
    Set clDatos = New clsMantoTablas
    
    Dim arrDatos() As Variant
    Dim sqlSp As String
    sqlSp = "spCn_ConsultaCuentasLibro 'SEL_CTASLIBRO','" & gsEmpresa & "', '" & gsAnio & "','" & Libro & "',''"
    arrDatos = Array(sqlSp)
    
    
    If Not lrsCtasxLibro Is Nothing Then
        If lrsCtasxLibro.State = 1 Then
            lrsCtasxLibro.Close
        End If
    End If
    
    Set lrsCtasxLibro = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
    
    If Not lrsCtasxLibro Is Nothing Then
        If lrsCtasxLibro.RecordCount > 0 Then LlenaCuentasPorLibro = True
    End If
    
    Set clDatos = Nothing
    
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaCuentaPorLibro
' Description:       Funcion que retorna si la cuenta pertenece al libro seleccionado
'
' Parameters :       Cuenta (String)
'--------------------------------------------------------------------------------
Private Function BuscaCuentaPorLibro(Cuenta As String) As Boolean
    BuscaCuentaPorLibro = False
    LlenaCuentasPorLibro tdbcLibro.BoundText
    If Not lrsCtasxLibro Is Nothing Then
        If Not (lrsCtasxLibro.EOF And lrsCtasxLibro.BOF) Then
            lrsCtasxLibro.MoveFirst
            lrsCtasxLibro.Find "Pla_cCuentaContable = " & "'" & Left(Cuenta, 2) & "'"
            
            If lrsCtasxLibro.EOF Then
                BuscaCuentaPorLibro = False
            Else
                BuscaCuentaPorLibro = True
            End If
        End If
    Else
        BuscaCuentaPorLibro = True
    End If
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenaRsTDBolVenta
' Description:       Funcion que llena el RS con los tipos de boleta
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function LlenaRsTDBolVenta() As Boolean
    LlenaRsTDBolVenta = False
    
    Dim clDatos As clsMantoTablas
    Set clDatos = New clsMantoTablas
    
    Dim arrDatos() As Variant
    Dim sqlSp As String
    sqlSp = "SELECT COD_CVALORPARAM FROM CND_CONFIG_OPERA WHERE EMP_CCODIGO= '" & _
    gsEmpresa & "' AND PAN_CANIO='" & gsAnio & "' AND COP_CCODIGO='028'"
    arrDatos = Array(sqlSp)
    
    
    If Not lrsDocBolVta Is Nothing Then
        If lrsDocBolVta.State = 1 Then
            lrsDocBolVta.Close
        End If
    End If
    
    Set lrsDocBolVta = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
    
    If Not lrsDocBolVta Is Nothing Then
        If lrsDocBolVta.RecordCount > 0 Then LlenaRsTDBolVenta = True
    End If
    
    Set clDatos = Nothing
    
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaRsBolVenta
' Description:       Funcion que retorna si el TD se encuentra en el RS de boletas
'
' Parameters :       td (String)
'--------------------------------------------------------------------------------
Private Function BuscaRsBolVenta(td As String) As Boolean
    BuscaRsBolVenta = False
    
    Dim TComp As String
    Dim ArregloComp() As String
    Dim x As Integer
        
    TComp = "00/03/05/06/07/08/11/12/13/14/15/16/18/19/23/26/28/30/34/35/36/37/55/56/87/88"
    
    ArregloComp = Split(TComp, "/")
    
    For x = 0 To 25
        GoTo ir
    Next x
    
   ' If td = "03" Or td = "99" Then GoTo ir
    If CE(td) <> "" Then
        If Not lrsDocBolVta Is Nothing Then
            If Not (lrsDocBolVta.EOF And lrsDocBolVta.BOF) Then
                lrsDocBolVta.MoveFirst
                lrsDocBolVta.Find "COD_CVALORPARAM = " & "'" & td & "'"
                
                If lrsDocBolVta.EOF Then
                    BuscaRsBolVenta = False
                Else
ir:
                    BuscaRsBolVenta = True
                End If
            End If
        Else
            BuscaRsBolVenta = True
        End If
    End If
End Function


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       RecibirDatos
' Description:       Procedimiento que recibe los datos de los otros formularios como cc, entidad, TD
'
' Parameters :       lControl (String)
'                    param0 (String)
'                    param1 (String)
'                    param2 (String)
'--------------------------------------------------------------------------------
Public Sub RecibirDatos(ByVal lControl As String, ByVal param0 As String, ByVal param1 As String, ByVal param2 As String, Optional ByVal param3 As String)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    Dim dblTipoCambio As Double
    Dim valorDato  As String
    Dim TipoOp As String
    Dim sql As String
    
    Select Case lControl
           Case "Cuentas", "CuentasN"
               
               If lControl = "CuentasN" Then
                  BuscaDatosCuenta param0
                  DoEvents
               End If

               If CE(tdbgDetalle.Columns(nColAsd_nItem)) = "" Then
                  tdbgDetalle.Columns(nColAsd_nDebeMonExt) = "0.00"
                  tdbgDetalle.Columns(nColAsd_nHaberMonExt) = "0.00"
                  tdbgDetalle.Columns(nColAsd_nDebeSoles) = "0.00"
                  tdbgDetalle.Columns(nColAsd_nHaberSoles) = "0.00"
                  Call AñadeItem
               End If
               
               If NE(lArrDetalle(tdbgDetalle.Bookmark, nColAsd_Cancelado)) = 1 Then Exit Sub
               
               '-------------------------------------------------------------------
                If CE(param0) <> "" Then
                   With tdbgDetalle
                         If BuscaCuentaPorLibro(param0) = False Then
                            lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable) = ""
                            lArrDetalle(tdbgDetalle.Bookmark, nCol_cTipoEntiCta) = "1"
                            lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgCCosto) = ""
                            lArrDetalle(tdbgDetalle.Bookmark, nColPla_cDocumento) = ""
                            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoMoneda) = ""
                         
                            UpdateGrilla
                            
                            Mensajes "Cuenta Nº " & param0 & " no pertenece al Libro seleccionado", vbInformation + vbOKOnly
                            
                            .Columns(nColPla_cCuentaContable) = ""
                            .Col = nColPla_cCuentaContable
                            gsUltimaCuenta = ""
                            DoEvents
                            .Refresh
                            gsKeyCodePress = False
                            gsKeyPressF1 = True
                            pSetFocus tdbgDetalle
                            gsKeyCode = 0
                            Exit Sub
                         End If
                   End With
                End If
               '-------------------------------------------------------------------
                'Datos de la Cuenta Contable
                tdbgDetalle.Columns(nColPla_cCuentaContable).Value = param0
                tdbgDetalle.Columns(nColPla_cNombreCuenta).Value = param1


                If gsDatosCuenta(0) <> "" Then 'si encontro la cuenta
                   With tdbgDetalle
                   
                        '**************************
                        LlenaCodigoOP param0
                        '**************************
                        
                        lArrDetalle(.Bookmark, nColAsd_cModif) = 1
                        .Columns(nCol_cFlgCCosto).Value = gsDatosCuenta(1) 'CE(rsArreglo("Pla_cCentroCosto"))
                        .Columns(nCol_cFlgProv).Value = gsDatosCuenta(2) 'CE(rsArreglo("Pla_cProvision"))
                        
                        .Columns(nColTen_cTipoEntidad).Value = gsDatosCuenta(6) 'CE(rsArreglo("Ten_cTipoEntidad"))
                        .Columns(nCol_cTipoEntiCta).Value = gsDatosCuenta(6) 'CE(rsArreglo("Ten_cTipoEntidad"))
                        .Columns(nColPla_cDocumento).Value = gsDatosCuenta(7) 'CE(rsArreglo("Pla_cDocumento"))
                        .Columns(nCol_nPorceImp).Value = 0
                        
                        
                        If NE(.Columns(nColAsd_nMontoInafecto)) <> 1 Then
                            .Columns(nColAsd_nMontoInafecto).Value = 0
                        End If
                        
                        
                        .Columns(nColPla_cTipoAfect).Value = gsDatosCuenta(8) 'CE(rsArreglo("Pla_cTipoAfect"))
                        
                        lArrDetalle(.Bookmark, nColPla_cNCND) = gsDatosCuenta(12) ' CE(rsArreglo("Pla_cNCND"))
                        
                        .Columns(nCol_nPorceImp).Value = NE(tdbnPorcIGV.Value)
                        
                        If CE(.Columns(nColAsd_dFecDoc).Value) = "" Then
                            Dim FilaReg As Integer
                            FilaReg = tdbgDetalle.Bookmark
                            If FilaReg >= 1 Then
                                FilaReg = FilaReg - 1
                            Else
                                FilaReg = 0
                            End If
                            
                            
                            If CE(lArrDetalle(FilaReg, nColAsd_dFecDoc)) = "" Then
                                .Columns(nColAsd_dFecDoc).Value = Format(dtpFecha.Value, "dd/MM/yyyy")
                            Else
                                If tdbgDetalle.Bookmark > 0 Then
                                
                                    If Left(param0, 2) = "10" Then
                                        .Columns(nColAsd_dFecDoc).Value = dtpFecha.Value
                                    Else
                                        .Columns(nColAsd_dFecDoc).Value = CE(lArrDetalle(tdbgDetalle.Bookmark - 1, nColAsd_dFecDoc))
                                    End If
                                End If
                            End If
                            
                        End If
                        
                        .Columns(nColAsd_dFecDocAux).Value = Format(.Columns(nColAsd_dFecDoc).Value, "dd/MM/yyyy")
                  
                        If CE(.Columns(nColAsd_cGlosa).Value) = "" Then
                           If .Columns(nColAsd_nItem).Value > 1 Then
                              .Columns(nColAsd_cGlosa).Value = tdbtObservaciones 'lArrDetalle.Value(.Bookmark - 1, nColAsd_cGlosa)
                           Else
                              .Columns(nColAsd_cGlosa).Value = tdbtObservaciones
                           End If
                        End If
                        
                        'Si es COMPRAS o VENTAS que siempre actualice la moneda, tipo mon, flag mon moneda
                        If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Then
                        
                            
                           If (CE(.Columns(nColPla_cCuentaContable)) <> gsCuentaDifGan And _
                              CE(.Columns(nColPla_cCuentaContable)) <> gsCuentaDifPer And _
                              CE(.Columns(nColPla_cCuentaContable)) <> gsCuentaDifGan And _
                              CE(.Columns(nColPla_cCuentaContable)) <> gsCuentaDifPer) Or CE(.Columns(nColAsd_cTipoMoneda)) = "" Then
         
                              tdbgDetalle.Columns(nColAsd_cNomMoneda) = CE(tdbcMoneda.Columns(4))
                              tdbgDetalle.Columns(nColAsd_cTipoMoneda) = CE(tdbcMoneda.BoundText)
                              tdbgDetalle.Columns(nCol_cFlgMonNac) = CE(tdbcMoneda.Columns(2))
                           End If
                        
                        Else
                        
                            If tdbgDetalle.Columns(nColAsd_cNomMoneda) = "" Then
                               tdbgDetalle.Columns(nColAsd_cNomMoneda) = tdbcMoneda.Columns(4)
                               lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
                            End If
                             
                            If tdbgDetalle.Columns(nColAsd_cTipoMoneda) = "" Then
                               tdbgDetalle.Columns(nColAsd_cTipoMoneda) = tdbcMoneda.BoundText
                               lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
                            End If
                             
                            If tdbgDetalle.Columns(nCol_cFlgMonNac) = "" Then
                               tdbgDetalle.Columns(nCol_cFlgMonNac) = tdbcMoneda.Columns(2)
                                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
                            End If
                        
                        End If
                    
                         '------------- TIPO DE OPERACION ----------------------
                         
                         If Me.tdbcMoneda.BoundText <> gsMonedaNac Then
                         
                             If .Columns(nColAsd_cOperaTC) = "" Or tdbcMoneda.BoundText <> gsMonedaGuardada Then
                                 '.Columns(nColAsd_nDebeSoles) = "0.00"
                                 '.Columns(nColAsd_nHaberSoles) = "0.00"
                                 '.Columns(nColAsd_nDebeMonExt) = "0.00"
                                 '.Columns(nColAsd_nHaberMonExt) = "0.00"
                             
                                If CE(.Columns(nColAsd_cOperaTC).Value) = "SCV" Then
                                    If NE(.Columns(nCol_cFlgMonNac)) = 1 Then
                                        .Columns(nColAsd_nDebeMonExt) = "0.00"
                                        .Columns(nColAsd_nHaberMonExt) = "0.00"
                                    Else
                                        .Columns(nColAsd_nDebeSoles) = "0.00"
                                        .Columns(nColAsd_nHaberSoles) = "0.00"
                                    
                                        TipoOp = BuscaOperaTCSiEsBimoneda(CE(.Columns(nColPla_cCuentaContable)))
                                        .Columns(nColAsd_cOperaTC).Value = TipoOp
                                        
                                    End If
                                Else
                                    TipoOp = BuscaOperaTCSiEsBimoneda(CE(.Columns(nColPla_cCuentaContable)))
                                    .Columns(nColAsd_cOperaTC).Value = TipoOp
                                End If
                                
                             End If
                             
                             If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Then
                                If NE(.Columns(nCol_cFlgMonNac)) = 1 Then
                                    .Columns(nColAsd_nDebeMonExt) = "0.00"
                                    .Columns(nColAsd_nHaberMonExt) = "0.00"
                                
                                Else
                                    '.Columns(nColAsd_nDebeSoles) = "0.00"
                                    '.Columns(nColAsd_nHaberSoles) = "0.00"
                                
                                    'SOLO ES PARA COMPRAS O VENTAS
                                    If NE(lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgMonNac)) = 0 Then
                                       .Columns(nColAsd_nDebeSoles) = Redondear(NE(.Columns(nColAsd_nDebeMonExt)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
                                       .Columns(nColAsd_nHaberSoles) = Redondear(NE(.Columns(nColAsd_nHaberMonExt)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
                                     End If
                                
                                    TipoOp = BuscaOperaTCSiEsBimoneda(CE(.Columns(nColPla_cCuentaContable)))
                                    .Columns(nColAsd_cOperaTC).Value = TipoOp
                                
                                End If
                             
                             End If
                             
                             
                         Else
                             'Si es COMPRAS o VENTAS que siempre actualice la moneda, tipo mon, flag mon moneda
                             If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Then
                                .Columns(nColAsd_cOperaTC).Value = "SCV"
                                .Columns(nColAsd_nDebeMonExt) = "0.00"
                                .Columns(nColAsd_nHaberMonExt) = "0.00"
                                
                             Else
                                If CE(.Columns(nColAsd_cOperaTC)) = "" Then
                                   .Columns(nColAsd_cOperaTC).Value = "SCV"
                                   .Columns(nColAsd_nDebeMonExt) = "0.00"
                                   .Columns(nColAsd_nHaberMonExt) = "0.00"
                                   
                                   lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
                                End If
                            End If
                             
                             
                         End If
                         
                         '------------------------------------------------------
                         If tdbcLibro.BoundText = lsLibroCierre Then
                            tdbgDetalle.Columns(nColAsd_cNomMoneda).Value = gsMonedaNacAbrev
                            tdbgDetalle.Columns(nColAsd_cTipoMoneda).Value = gsMonedaNac
                            tdbgDetalle.Columns(nCol_cFlgMonNac).Value = "1"
                            .Columns(nColAsd_cOperaTC).Value = "SCV"
                            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
                            
                         End If
                         
                         '------------------------------------------------------

                        Dim TC As Double
                        If .Columns(nColAsd_cMonedaCalculo).Value <> "1" Then
                           If .Columns(nColAsd_cOperaTC).Value = "SCV" Then
                              tdbtCambio.Value = 0
                              .Columns(nColAsd_nTipoCambio) = 0
                           Else

                              TC = TipoCambio(.Columns(nColAsd_dFecDoc).Text, .Columns(nColAsd_cOperaTC).Text)
                              If TC < 0 Then TC = 0
                              tdbtCambio.Value = TC
                              .Columns(nColAsd_nTipoCambio) = TC
                              
                           End If
                        End If
                        
                        'Convierte los montos de soles a dolares segun el tipo de cambio
                        If gintBiMoneda = 1 And NE(.Columns(nCol_cFlgMonNac)) = 1 Then
                        
                            TipoOp = BuscaOperaTCSiEsBimoneda(CE(.Columns(nColPla_cCuentaContable)))
                            .Columns(nColAsd_cOperaTC).Value = TipoOp
                                                        
'                            dblTipoCambio = TipoCambio(.Columns(nColAsd_dFecDoc).Text, .Columns(nColAsd_cOperaTC).Text)
                             dblTipoCambio = TipoCambio(.Columns(nColAsd_dFecDoc).Text, TipoOp)
                              If dblTipoCambio < 0 Then dblTipoCambio = 0
                              tdbtCambio.Value = dblTipoCambio
                              .Columns(nColAsd_nTipoCambio) = dblTipoCambio
                              
                              .Columns(nColAsd_nDebeMonExt) = Redondear(NE(.Columns(nColAsd_nDebeSoles)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
                              .Columns(nColAsd_nHaberMonExt) = Redondear(NE(.Columns(nColAsd_nHaberSoles)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
                            
                        End If
                        
                        Call LimpiaCeldasInactivas
                        
                        lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
        
                        '-------------- PARA EL COMBO DE PAGO IGV ------------'
                        lArrDetalle(.Bookmark, nColPla_cDetraccion) = NE(gsDatosCuenta(9)) 'NE(rsArreglo("Pla_cDetraccion"))
                        lArrDetalle(.Bookmark, nColPla_cRetencion) = NE(gsDatosCuenta(10)) 'NE(rsArreglo("Pla_cRetencion"))
                        lArrDetalle(.Bookmark, nColPla_cPercepcion) = NE(gsDatosCuenta(11)) 'NE(rsArreglo("Pla_cPercepcion"))
                        
                        ActivaComboTipoIGV NE(gsDatosCuenta(9)), NE(gsDatosCuenta(10)), NE(gsDatosCuenta(11))
                        '-------------------------------------------------------'
                        
                        If gsUltimaCuenta <> CE(tdbgDetalle.Columns(nColPla_cCuentaContable)) Then
                            ActualizaCamposPagoIVG True
                        End If
                                                
                        If BuscaCuentaEnConfigOP(param0, "009") = True Then
                           lArrDetalle(.Bookmark, nColAsd_cCtaPagCob) = "CC"
                        Else
                            If BuscaCuentaEnConfigOP(param0, "010") = True Then
                               lArrDetalle(.Bookmark, nColAsd_cCtaPagCob) = "CP"
                            Else
                               lArrDetalle(.Bookmark, nColAsd_cCtaPagCob) = ""
                            End If
                        End If
                        
                        '------------------------------
                        
                        Call LlenaDatosConceptos
                        
                   End With
                End If
                
                UpdateGrilla
                DoEvents

                Call SumarTotales
                
                dtpFechaDoc.Enabled = True
                

                lItem = NumeroFilas
                DoEvents
                
                
                '----------------- BASE IMPONIBLE -------------'
                If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Then
                   Call LlenaBaseImponible
                End If
                
                BuscaCeldaActiva nColPla_cCuentaContable
                
                gsKeyCodePress = False
                gsFlagKeydownDet = False

           Case "TipoDocumentoAsiento"
                tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = param0
                lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cNomTD) = param1
                
                tdbgDetalle.Col = BuscaCeldaActiva(nColAsd_cTipoDoc)
                
                pSetFocus tdbgDetalle

           Case "TipoDocumentoRef"
                tdbtTipDocRef = param0
                
                pSetFocus tdbtTipDocRef
           
           Case "CentroCosto", "CentroCostoN"
                tdbgDetalle.Columns(nColCos_cCodigo).Value = param0
                lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cNomCC) = param1
                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
                tdbgDetalle.Col = BuscaCeldaActiva(nColCos_cCodigo)
                pSetFocus tdbgDetalle
           
           Case "Entidad"
                tdbgDetalle.Columns(nColTen_cTipoEntidad).Value = param2
                tdbgDetalle.Columns(nColEnt_cCodEntidad).Value = param0
                tdbgDetalle.Columns(nColEnt_cPersona).Value = param1
                If param1 = "ANULADO" Or param1 = "ANULADA" Then
                    sql = "select * from CNT_lIBROSGENERADOS where Emp_cCodigo = '" & gsEmpresa & "' and Pan_cAnio = '" & gsAnio & "' and Per_cPeriodo = '" & gsPeriodo & "' and Lib_cTipoLibro = '" & tdbcLibro.BoundText & "' and Estado ='A'"
                    If ExisteDato(sql) = False Or (Month(dtpFecha.Value) = Month(lsFecha) And Year(dtpFecha.Value) = Year(lsFecha)) Then
                        EstadoDesTMP = EstadoDes
                        EstadoDes = "2"
                    End If
                End If
                If param1 <> "ANULADO" Or param1 <> "ANULADA" Then
                    If EstadoDesTMP = "" Then EstadoDes = EstadoDesTMP
                End If
                         
                'If ModificoProv(tdbgDetalle.Bookmark) = True Then
                   lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
                'End If
                
                tdbgDetalle.Col = BuscaCeldaActiva(nColEnt_cCodEntidad)
                pSetFocus tdbgDetalle
           
           Case "Provisiones"
                ' *** En el caso de una cancelacion. Jalar los datos de la Provision
                If ProvisionEnVoucher = True Then
                    ' *** Si ya ha sido seleccionado anteriormente. No jalar datos
                    Mensajes "Provision ya ha sido seleccionada en este voucher", vbInformation
                    Exit Sub
                End If
                
                Call LlenaProvision
                Call SumarTotales
                
                Unload frmBusProvisiones
                pSetFocus tdbgDetalle
           
           Case "TipoAsiento"
                Call LlenaTipoAsiento
                Call SumarTotales
                
                'Unload frmBusTipoAsiento
                pSetFocus tdbgDetalle
           
           Case "TipoDocumento"
                tdbtTipDocRef = param0
                pSetFocus tdbtTipDocRef
                
            Case "CuentasB"
                tdbtBusCuenta = Trim(param0)
                Unload frmBuscador
                pSetFocus tdbtBusCuenta
                
            Case "EntidadB"
                tdbtBusCodEnt = Trim(param0)
                Unload frmBuscador
                pSetFocus tdbtBusCodEnt

    End Select
    
   ' RefreshGrilla
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ActivaComboTipoIGV
' Description:       Procedimiento que activa el combo de Tipo IGV
'
' Parameters :       Detraccion (String)
'                    Retencion (String)
'                    Percepcion (String)
'--------------------------------------------------------------------------------
Private Sub ActivaComboTipoIGV(Detraccion As String, Retencion As String, Percepcion As String)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    If tdbgDetalle.Bookmark > NumeroFilas Then
        Exit Sub
    End If

    Dim cadena As String, sqlcombos As String
    DoEvents
    cadena = ""
    '-------------- REGLAS DE VALIDACION ----------------'
    If tdbcLibro.BoundText = lsLibroCajIng Or tdbcLibro.BoundText = lsLibroCajEgr Then
        If tdbcTipoOperacion.BoundText = "M" Then
            cadena = cadena & " "
        Else
            'If NE(Retencion) = 1 And tdbcTipoOperacion.BoundText = "E" Then cadena = cadena & "R"
            'If NE(Percepcion) = 1 And tdbcTipoOperacion.BoundText = "I" Then cadena = cadena & "P"
            
            '*** agregado ****'
            If NE(Retencion) = 1 Then cadena = cadena & "R"
            If NE(Percepcion) = 1 Then cadena = cadena & "P"
            '*****************'
            
        End If
        
    End If

    If tdbcLibro.BoundText = lsLibroDiario Then
        If tdbcTipoOperacion.BoundText = "M" Then
            cadena = cadena & " "
        Else
            If NE(Retencion) = 1 Then cadena = cadena & "R"
            If NE(Percepcion) = 1 Then cadena = cadena & "P"
        End If
    End If

    If tdbcLibro.BoundText = lsLibroCom Then
        If NE(Detraccion) = 1 Then cadena = "D"
        
        '*** agregado ****'
        If NE(Retencion) = 1 Then cadena = cadena & "R"
        If NE(Percepcion) = 1 Then cadena = cadena & "P"
        '*****************'
        
    End If
    '*** agregado ****'
    If tdbcLibro.BoundText = lsLibroVen Or tdbcLibro.BoundText = lsLibroApe Then 'PGBV 18072014: Se adiciona el libro de apertura
        If NE(Retencion) = 1 Then cadena = cadena & "R"
        If NE(Percepcion) = 1 Then cadena = cadena & "P"
    End If
    '*****************'
    
    '----------------------------------------------------'
    
    If CE(cadena) <> "" Then
        LlenaComboIGV cadena
        tdbcPagoIGV.BoundText = lArrDetalle(tdbgDetalle.Bookmark, nCol_cFlgDetRet)
        Activar tdbcPagoIGV, True
        
    Else
        tdbcPagoIGV.BoundText = ""
        Activar tdbcPagoIGV, False
        tdbcTipoTx.BoundText = ""
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenaComboMedioPago
' Description:       Procedimiento que llena el combo de medio de pago
'
' Parameters :
'--------------------------------------------------------------------------------
Public Sub LlenaComboMedioPago()
    Dim sqlcombos  As String
    
    sqlcombos = "SELECT tab_ccodigo, tab_cdescripcampo " & _
                " FROM tabla WHERE EMP_CCODIGO =  '" & gsEmpresa & "' AND tab_ctabla='074' ORDER BY tab_cdescripcampo "
    LlenarComboAddItem tdbcTipoPago, sqlcombos, True, False
    
    tdbcTipoPago.Enabled = True
    tdbcTipoPago.BoundText = "" 'tdbcLibroCab.Columns(0).Value
    
    DoEvents
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenaComboIGV
' Description:       Procedimiento que llena el combo de IGV
'
' Parameters :       cadena (String)
'--------------------------------------------------------------------------------
Public Sub LlenaComboIGV(cadena As String)
    Call LlenaComboIGVPublico(tdbcPagoIGV, cadena)
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ProvisionEnVoucher
' Description:       Funcion quebusca la provision en el voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function ProvisionEnVoucher() As Boolean
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If

    Dim i As Integer
    lItem = NumeroFilas
    
    ProvisionEnVoucher = False
    
    Dim sArray As String
    Dim sGrilla As String
    
      
    sGrilla = CE(frmBusProvisiones.tdbgProvisiones.Columns(5)) + CE(frmBusProvisiones.tdbgProvisiones.Columns(1)) + CE(frmBusProvisiones.tdbgProvisiones.Columns(2)) + _
              CE(frmBusProvisiones.tdbgProvisiones.Columns(8)) + CE(frmBusProvisiones.tdbgProvisiones.Columns(9)) + CE(frmBusProvisiones.tdbgProvisiones.Columns(10))
              
              
    For i = 0 To lItem - 1
    
        sArray = CE(lArrDetalle(i, nColPla_cCuentaContable)) + CE(lArrDetalle(i, nColTen_cTipoEntidad)) + CE(lArrDetalle(i, nColEnt_cCodEntidad)) + _
                 CE(lArrDetalle(i, nColAsd_cTipoDoc)) + CE(lArrDetalle(i, nColAsd_cSerieDoc)) + CE(lArrDetalle(i, nColAsd_cNumDoc))
    
        If sGrilla = sArray Then
            ProvisionEnVoucher = True
            Exit For
        End If
    Next
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenaNC
' Description:       Procedimiento que llena la NC en el detalle del boucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub LlenaNC()
    Dim oExec As ClsFuncionesExecute
    Set oExec = New ClsFuncionesExecute
    Dim rs As ADODB.Recordset
    
    On Error GoTo serror
    
    With frmBusProvisiones.tdbgProvisiones
        Set rs = oExec.fRetornaRS("select Pan_cAnio, Per_cPeriodo, Ase_cNumMov, Ase_nVoucher from CND_ASIENTO_PROV where Emp_cCodigo='" & gsEmpresa & "' and Cnp_nCorre=" & CE(.Columns(0)))
        Call CargaDatosRegistro(rs.Fields("Pan_cAnio"), rs.Fields("Per_cPeriodo"), tdbcLibro.BoundText, rs.Fields("Ase_nVoucher"), Tipo.EDICION, rs.Fields("Ase_cNumMov"), True, NE(.Columns(14)), NE(.Columns(17)))
    End With
    
    RefreshGrilla
    DoEvents
        
    tdbgDetalle.ReBind

    If tdbcLibro.BoundText = lsLibroCom And lnOpcion = 0 Then
        tdbcTipoOperacion.BoundText = "E"
    End If
    If tdbcLibro.BoundText = lsLibroVen And lnOpcion = 0 Then
        tdbcTipoOperacion.BoundText = "I"
    End If

    Set oExec = Nothing
    DoEvents
    
    If tdbcMoneda.BoundText <> gsMonedaNac Then Call cmdGenerarDifCambio_Click

    Exit Sub
serror:
    Mensajes Err.Description

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenaProvision
' Description:       Procedimiento que llena la provision
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub LlenaProvision()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    Dim cTipoLibro As String
    Dim sResult As VbMsgBoxResult
    Dim sTipoMensaje As String
    
    If tdbcLibro.BoundText = lsLibroCom Then
        sTipoMensaje = "Pago"
    Else
        sTipoMensaje = "Cobro"
    End If
    
    With frmBusProvisiones.tdbgProvisiones
        cTipoLibro = Left(CE(.Columns(37)), 2)
    End With
    
    If (tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen) And _
       (cTipoLibro = lsLibroCom Or cTipoLibro = lsLibroVen) Then
       
        sResult = Mensajes("Se llenará el voucher con un asiento de tipo " & Salto(1) & "nota de credito del documento seleccionado" & Salto(2) & "[Si ] Generar Asiento Tipo Nota de Credito" & Salto(1) & "[No] Solo Seleccionar documento para " & sTipoMensaje, vbInformation + vbYesNoCancel)
        
        If sResult <> vbCancel Then
            If sResult = vbYes Then
                Call LlenaNC
                Exit Sub
            End If
        Else
            Exit Sub
        End If
    End If


    Dim i As Integer
    Dim iFila  As Long
    
    For i = 0 To frmBusProvisiones.tdbgProvisiones.SelBookmarks.Count - 1
    
        iFila = tdbgDetalle.Bookmark
        If iFila < 0 Then iFila = 0
    
        With frmBusProvisiones.tdbgProvisiones
        
            .Bookmark = .SelBookmarks(i)
        
            If CE(lArrDetalle(iFila, nColAsd_nItem)) = "" Then
                lArrDetalle(iFila, nColAsd_nItem) = BuscaMaximoCorrel + 1
            End If
            
            lArrDetalle(iFila, nColPla_cCuentaContable) = CE(.Columns(5))   ' *** Cuenta
            lArrDetalle(iFila, nColPla_cNombreCuenta) = CE(.Columns(6))     ' *** Nombre Cuenta
            lArrDetalle(iFila, nCol_cFlgCCosto) = CE(.Columns(24))            ' *** Flag Centro de Costo
            lArrDetalle(iFila, nCol_cFlgProv) = CE(.Columns(25))               ' *** Flag Provisiones
            lArrDetalle(iFila, nColPla_cDocumento) = CE(.Columns(26))          ' *** Flag Provisiones
            
            lArrDetalle(iFila, nColCos_cCodigo) = CE(.Columns(31))           ' *** centro de costo
            lArrDetalle(iFila, nColAsd_cNomCC) = CE(.Columns(32))            ' *** descrip CC
            lArrDetalle(iFila, nColAsd_cNomTD) = CE(.Columns(33))            ' *** descrip TD
            
            lArrDetalle(iFila, nColAsd_cEcpOperacion) = CE(.Columns(19))            ' *** DEBE HABER
            
            lArrDetalle(iFila, nColAsd_cGlosa) = CE(.Columns(18))            ' *** Glosa
            If .Columns(19) = "H" Then
               lArrDetalle(iFila, nColAsd_nHaberSoles) = 0                      ' *** Haber Soles
               lArrDetalle(iFila, nColAsd_nHaberMonExt) = 0                     ' *** Haber Dolar
               lArrDetalle(iFila, nColAsd_nDebeSoles) = NE(.Columns(14))     ' *** Debe Soles
               lArrDetalle(iFila, nColAsd_nDebeMonExt) = NE(.Columns(17))   ' *** Debe Dolar
               
            Else
               lArrDetalle(iFila, nColAsd_nHaberSoles) = NE(.Columns(14))    ' *** Haber Soles
               lArrDetalle(iFila, nColAsd_nHaberMonExt) = NE(.Columns(17))  ' *** Haber Dolar
               lArrDetalle(iFila, nColAsd_nDebeSoles) = 0                       ' *** Debe Soles
               lArrDetalle(iFila, nColAsd_nDebeMonExt) = 0                      ' *** Debe Dolar
            End If
            
            lArrDetalle(iFila, nColAsd_nNacional) = NE(.Columns(14))
            lArrDetalle(iFila, nColAsd_nExtranjera) = NE(.Columns(17))
            
            lArrDetalle(iFila, nCol_cTipoEntiCta) = CE(.Columns(27))           ' *** Tipo Entidad de Cuenta Contable
            lArrDetalle(iFila, nColTen_cTipoEntidad) = CE(.Columns(1))       ' *** Tipo Entidad
            lArrDetalle(iFila, nColEnt_cCodEntidad) = CE(.Columns(2))        ' *** Entidad
            lArrDetalle(iFila, nColEnt_cPersona) = CE(.Columns(4))           ' *** Nombre Entidad
            lArrDetalle(iFila, nColAsd_cTipoDoc) = CE(.Columns(8))          ' *** Tipo Doc
            lArrDetalle(iFila, nColAsd_cSerieDoc) = CE(.Columns(9))         ' *** Serie
            lArrDetalle(iFila, nColAsd_cNumDoc) = CE(.Columns(10))           ' *** NumDoc
            
            lArrDetalle(iFila, nColAsd_dFecDoc) = CE(.Columns(11))           ' *** Fecha
            lArrDetalle(iFila, nColAsd_dFecVen) = CE(.Columns(28))            ' *** Fecha
            
            lArrDetalle(iFila, nColAsd_cOperaTC) = CE(.Columns(20))            ' *** Tipo de Operación TC
            
'            TipoCambio(.Columns(nColAsd_dFecDoc).Text, .Columns(nColAsd_cOperaTC).Text)
            
            lArrDetalle(iFila, nColAsd_nTipoCambio) = NE(.Columns(7))        ' *** TC

             
'            lArrDetalle(iFila, nColAsd_nTipoCambio) = NE(TipoCambio(dtpFecha.Text, .Columns(20).Text))
            
            lArrDetalle(iFila, nColAsd_nCorre) = NE(.Columns(0))             ' *** Correlativo de Provision
            
            lArrDetalle(iFila, nColAsd_cTipoMoneda) = CE(.Columns(21))
            lArrDetalle(iFila, nColAsd_cNomMoneda) = CE(.Columns(22))
            lArrDetalle(iFila, nCol_cFlgMonNac) = CE(.Columns(23))
            tdbgDetalle.Columns(nColAsd_dFecDocAux) = .Columns(11)
            
            lArrDetalle(iFila, nColPla_cDetraccion) = ""
            lArrDetalle(iFila, nColPla_cRetencion) = ""
            lArrDetalle(iFila, nColPla_cPercepcion) = ""
    
            lArrDetalle(iFila, nColAsd_nSaldoProv) = NE(.Columns(29))
            lArrDetalle(iFila, nColAsd_nSaldoExtProv) = NE(.Columns(30))
            lArrDetalle(iFila, nColAsd_cProvCanc) = "C"
            
            lArrDetalle(iFila, nColAsd_cManual) = NE(.Columns(35))
    
    
            lArrDetalle(iFila, nColAsd_cModif) = 1
            'lArrDetalle(iFila, nColAsd_cGuardado )
            lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cBaseImp) = BuscarCodigoBaseImp(CE(lArrDetalle(iFila, nColPla_cCuentaContable)))
            
            lArrDetalle(iFila, nColAsd_cEntTipSerNum) = BuscaEntTipSerNum(iFila)
            lArrDetalle(iFila, nColAsd_cDetalle) = BuscaLineaDetalle(iFila)
            lArrDetalle(iFila, nColAsd_cDetNac) = 0 'BuscaLineaNac(iFila)
            lArrDetalle(iFila, nColAsd_cDetExt) = 0 'BuscaLineaExt(iFila)
            lArrDetalle(iFila, nColAsd_cDetCorrel) = NE(.Columns(0))
            lArrDetalle(iFila, nColAsd_cDetProvCanc) = "C"
            lArrDetalle(iFila, nColAsd_cDetOtros) = BuscaLineaOtros(iFila)
            
            lArrDetalle(iFila, nColAsd_cCanc) = "C"
    
            Dim sqlver As String
            Dim clDatos As New clsMantoTablas
            Dim rsArreglo As New ADODB.Recordset
            Dim arrDatos() As Variant
            
            sqlver = "SELECT pla_cdetraccion, pla_cretencion, pla_cpercepcion,Pla_cNCND " & _
                     "From CNM_PLAN_CTA WHERE Emp_cCodigo='" & gsEmpresa & "' And Pan_cAnio='" & gsAnio & "' " & _
                     "AND Pla_cCuentaContable='" & (.Columns(5)) & "'"
            arrDatos = Array(sqlver)
            Set rsArreglo = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
            
            If Not rsArreglo Is Nothing Then
                '-------------- PARA EL COMBO DE PAGO IGV ------------'
                lArrDetalle(iFila, nColPla_cDetraccion) = NE(rsArreglo("Pla_cDetraccion"))
                lArrDetalle(iFila, nColPla_cRetencion) = NE(rsArreglo("Pla_cRetencion"))
                lArrDetalle(iFila, nColPla_cPercepcion) = NE(rsArreglo("Pla_cPercepcion"))
    
            End If
            If rsArreglo.State = adStateOpen Then rsArreglo.Close
            Set rsArreglo = Nothing
            
            
                
    
            RefreshGrilla
            AgregaFilaDetalle 1, True, "PROV"
            
        End With
    
    Next i
    
    RefreshGrilla
    DoEvents
    tdbgDetalle.ReBind
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       LlenaTipoAsiento
' Description:       Procedimiento que llena el tipo de asiento
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub LlenaTipoAsiento()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    Dim rsArreglo As ADODB.Recordset, rsArreglo2 As ADODB.Recordset
    Dim clDatos As clsMantoTablas
    Dim arrDatos() As Variant
    Dim sqlSp As String
    Dim montoAux As Double, nMontoTC As Double
    Dim SaldoME As Double
    Dim SaldoMN As Double
    Dim Moneda As String
    Dim ConvAux As Double
    Dim cTipoMov As String
    Dim dblTipoCambio As Double
    Set clDatos = New clsMantoTablas
    
    Dim iFila  As Integer
    iFila = NumeroFilas
    
    If iFila < 0 Then iFila = 0
    
    ' *** Cargando Datos de la Cuenta
    With frmBusTipoAsiento
        frmManAsientosContables.tdbtObservaciones.Text = CE(.tdbtGlosa.Text)
        sqlSp = "spCn_GrabaTipoAsiento 'SEL_REG', '" & gsEmpresa & "', '" & gsAnio & "', '" & tdbcLibro.BoundText & "', '" & .tdbtCodTipoAsiento.Text & "', 0, '', '', '', 0, '', ''"
        arrDatos = Array(sqlSp)
        Set rsArreglo = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
        
        AgregaFilaDetalle NE(rsArreglo.RecordCount), True, "TIPO"
        
        Do While Not rsArreglo.EOF
            ' ***
            lArrDetalle(iFila, nColAsd_nItem) = BuscaMaximoCorrel + 1
            lArrDetalle(iFila, nColPla_cCuentaContable) = CE(rsArreglo("Asl_cCuenta").Value)      ' *** Cuenta
            lArrDetalle(iFila, nColPla_cNombreCuenta) = CE(rsArreglo("Pla_cNombreCuenta").Value)  ' *** Hallar el nombre de la cuenta
            lArrDetalle(iFila, nColAsd_cGlosa) = CE(.tdbtGlosa.Text)                              ' *** Glosa
            lArrDetalle(iFila, nCol_cFlgCCosto) = CE(rsArreglo("Pla_cCentroCosto"))
            lArrDetalle(iFila, nCol_cFlgProv) = CE(rsArreglo("Pla_cProvision"))
            lArrDetalle(iFila, nColPla_cDocumento) = CE(rsArreglo("Pla_cDocumento"))
            lArrDetalle(iFila, nCol_cTipoEntiCta) = CE(rsArreglo("TipoEntiCta"))
            lArrDetalle(iFila, nColAsd_cDestino) = "0"
            
            sqlSp = "spCn_ConsultaCuentas 'SEL_REG','" & gsEmpresa & _
                   "', '" & gsAnio & "', '" & rsArreglo("Asl_cCuenta").Value & "'"
            arrDatos = Array(sqlSp)
            
            Set rsArreglo2 = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
            
            If Not rsArreglo2 Is Nothing Then
               lArrDetalle(iFila, nColPla_cDetraccion) = NE(rsArreglo2!pla_cdetraccion)
               lArrDetalle(iFila, nColPla_cRetencion) = NE(rsArreglo2!pla_cretencion)
               lArrDetalle(iFila, nColPla_cPercepcion) = NE(rsArreglo2!pla_cpercepcion)
               lArrDetalle(iFila, nCol_cFlgDetRet) = ""
            End If
            
            Call CerrarRecordSet(rsArreglo2)
            
            lArrDetalle(iFila, nColAsd_cNomMoneda) = CE(tdbcMoneda.Columns(4).Value)
            lArrDetalle(iFila, nColAsd_cTipoMoneda) = CE(tdbcMoneda.BoundText)
            lArrDetalle(iFila, nCol_cFlgMonNac) = CE(tdbcMoneda.Columns(2).Value)
            '-------------------------------------------------------------------------------
            Dim TC As Double
            Dim TipoOp As String
            ' *** Operacion TC
            If tdbcMoneda.BoundText = gsMonedaNac And gintBiMoneda = 0 Then
                sTipoCambioDefecto = "SCV"
                lArrDetalle(iFila, nColAsd_cOperaTC) = sTipoCambioDefecto
                TC = 0
                lArrDetalle(iFila, nColAsd_nTipoCambio) = TC
                
                'Obtiene el tipo de operacion de cambio
            ElseIf Me.tdbcMoneda.BoundText = gsMonedaNac And gintBiMoneda = 1 Then
                
                TipoOp = BuscaOperaTCSiEsBimoneda(CE(lArrDetalle.Value(iFila, nColPla_cCuentaContable)))
                lArrDetalle(iFila, nColAsd_cOperaTC) = TipoOp

                 dblTipoCambio = TipoCambio(.dtpFecha.Value, TipoOp)
                 
                 
                  If dblTipoCambio < 0 Then dblTipoCambio = 0
                  tdbtCambio.Value = dblTipoCambio
                  lArrDetalle(iFila, nColAsd_nTipoCambio) = dblTipoCambio
                  
'                  .Columns(nColAsd_nDebeMonExt) = Redondear(NE(.Columns(nColAsd_nDebeSoles)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
'                  .Columns(nColAsd_nHaberMonExt) = Redondear(NE(.Columns(nColAsd_nHaberSoles)) * NE(.Columns(nColAsd_nTipoCambio)), 2)
            Else
                '**************************
                LlenaCodigoOP lArrDetalle.Value(iFila, nColPla_cCuentaContable)
                '**************************
            
                sTipoCambioDefecto = BuscaOperaTCSiEsBimoneda(CE(lArrDetalle.Value(iFila, nColPla_cCuentaContable)))
                lArrDetalle(iFila, nColAsd_cOperaTC) = sTipoCambioDefecto
                
                If .chkTipoCambio.Value = vbChecked Then
                    TC = TipoCambio(.dtpFecha.Value, lArrDetalle.Value(iFila, nColAsd_cOperaTC), tdbcMoneda.BoundText)
                Else
                    TC = .tdbnTCVentaP.Value
                    lArrDetalle(iFila, nColAsd_cOperaTC) = "VEP"
                End If
                lArrDetalle(iFila, nColAsd_nTipoCambio) = TC
            End If
            '-------------------------------------------------------------------------------
            'Si Mov es moneda nacional, entonces se maneja Operación TC del Voucher
            If lArrDetalle(iFila, nCol_cFlgMonNac) = "1" And gintBiMoneda = 0 Then
               lArrDetalle(iFila, nColAsd_cOperaTC) = sTipoCambioDefecto
            End If
            
            
            If TC < 0 And gintBiMoneda = 0 Then TC = 0
'            lArrDetalle(iFila, nColAsd_nTipoCambio) = TC
            
            If lArrDetalle(iFila, nColAsd_nTipoCambio) = "" Then lArrDetalle.Value(iFila, nColAsd_nTipoCambio) = 0
            nMontoTC = lArrDetalle(iFila, nColAsd_nTipoCambio)
            
            If lArrDetalle(iFila, nCol_cFlgCCosto) = "1" Then
               lArrDetalle(iFila, nColCos_cCodigo) = CE(.tdbtCCosto.Text)                   ' *** Centro de Costo
               lArrDetalle(iFila, nColAsd_cNomCC) = CE(.tdbtDesCCosto.Text)                    ' *** Centro de Costo
            End If
            
            If CE(lArrDetalle(iFila, nCol_cTipoEntiCta)) <> "" Or CE(lArrDetalle.Value(iFila, nCol_cTipoEntiCta)) = CE(.tdbcTipoEntidad.BoundText) Then
               lArrDetalle(iFila, nColTen_cTipoEntidad) = CE(.tdbcTipoEntidad.BoundText)         ' *** Tipo Entidad
               lArrDetalle(iFila, nColEnt_cCodEntidad) = CE(.tdbtEntidad.Text)                   ' *** Entidad
               lArrDetalle(iFila, nColEnt_cPersona) = CE(.tdbtNombreEntidad.Text)                ' *** Nombre Entidad
            End If
            
            'Redondea los montos en soles y dolares
            If tdbcMoneda.BoundText = gsMonedaNac And gintBiMoneda = 1 Then
                SaldoMN = Redondear(NE(.tdbnMonto) * NE(rsArreglo!Asl_nPorcen) / 100)
                SaldoME = Redondear(NE(SaldoMN) / lArrDetalle(iFila, nColAsd_nTipoCambio))
                
            Else
                If tdbcMoneda.BoundText <> gsMonedaNac Then
                    SaldoME = Redondear(NE(.tdbnMonto) * NE(rsArreglo!Asl_nPorcen) / 100)
                    SaldoMN = 0
                    If TC > 0 Then SaldoMN = Redondear(SaldoME * TC, 2)
                Else
                    SaldoMN = Redondear(NE(.tdbnMonto) * NE(rsArreglo!Asl_nPorcen) / 100)
                    SaldoME = 0
                    If TC > 0 Then SaldoME = Redondear(SaldoMN / TC, 2)
                End If
            End If
            
            If CE(lArrDetalle.Value(iFila, nColPla_cDocumento)) = "1" Then
                lArrDetalle.Value(iFila, nColAsd_cTipoDoc) = CE(.tdbcTD.BoundText)                      ' *** Tipo Doc
                lArrDetalle.Value(iFila, nColAsd_cNomTD) = CE(.tdbcTD.Text)                        ' *** Tipo Doc
                lArrDetalle.Value(iFila, nColAsd_cSerieDoc) = CE(.tdbtSerie.Text)                       ' *** Serie
                lArrDetalle.Value(iFila, nColAsd_cNumDoc) = CE(.tdbtNumero.Text)                        ' *** NumDoc
            End If
            
            ' *** Recalcula el monto del Debe y Haber en la otra Moneda
            cTipoMov = CE(rsArreglo("AslTipoMov"))
            
            If CE(.tdbtTipDocRef.Text) = gsTDNC Then
                If cTipoMov = "D" Then
                    cTipoMov = "H"
                Else
                    cTipoMov = "D"
                End If
            End If
            
            If SaldoMN > 0 Or SaldoME > 0 Then
                    If tdbcMoneda.Columns(2).Value = "1" Then
                    ' *** Moneda Nacional
                    If cTipoMov = "D" Then
                        lArrDetalle(iFila, nColAsd_nDebeSoles) = SaldoMN          ' *** Debe Soles
                        lArrDetalle(iFila, nColAsd_nDebeMonExt) = SaldoME      ' *** Debe Dolares
                        lArrDetalle(iFila, nColAsd_nHaberSoles) = 0               ' *** Haber Soles
                        lArrDetalle(iFila, nColAsd_nHaberMonExt) = 0              ' *** Haber Dolares
                    Else
                        lArrDetalle(iFila, nColAsd_nDebeSoles) = 0                ' *** Debe Soles
                        lArrDetalle(iFila, nColAsd_nDebeMonExt) = 0               ' *** Debe Dolares
                        lArrDetalle(iFila, nColAsd_nHaberSoles) = SaldoMN         ' *** Haber Soles
                        lArrDetalle(iFila, nColAsd_nHaberMonExt) = SaldoME     ' *** Haber Dolares
                    End If
                Else
                    ' *** Moneda Extranjera
                    If cTipoMov = "D" Then
                        lArrDetalle(iFila, nColAsd_nDebeSoles) = SaldoMN          ' *** Debe Soles
                        lArrDetalle(iFila, nColAsd_nDebeMonExt) = SaldoME         ' *** Debe Dolares
                        lArrDetalle(iFila, nColAsd_nHaberSoles) = 0               ' *** Haber Soles
                        lArrDetalle(iFila, nColAsd_nHaberMonExt) = 0              ' *** Haber Dolares
                    Else
                        lArrDetalle(iFila, nColAsd_nDebeSoles) = 0                ' *** Debe Soles
                        lArrDetalle(iFila, nColAsd_nDebeMonExt) = 0               ' *** Debe Dolares
                        lArrDetalle(iFila, nColAsd_nHaberSoles) = SaldoMN         ' *** Haber Soles
                        lArrDetalle(iFila, nColAsd_nHaberMonExt) = SaldoME        ' *** Haber Dolares
                    End If
                End If
            Else
                lArrDetalle(iFila, nColAsd_nDebeSoles) = 0                        ' *** Debe Soles
                lArrDetalle(iFila, nColAsd_nDebeMonExt) = 0                       ' *** Debe Dolares
                lArrDetalle(iFila, nColAsd_nHaberSoles) = 0                       ' *** Haber Soles
                lArrDetalle(iFila, nColAsd_nHaberMonExt) = 0                      ' *** Haber Dolares
            End If
            
            lArrDetalle(iFila, nColAsd_nSaldoProv) = 0
            lArrDetalle(iFila, nColAsd_nSaldoExtProv) = 0
            lArrDetalle(iFila, nColAsd_cProvCanc) = ""
            lArrDetalle(iFila, nColAsd_cModif) = 1
            lArrDetalle.Value(iFila, nColAsd_dFecDoc) = .dtpFecha.Value                           ' *** Fecha
            
            '--------------- datos complementarios ----------------------'
            If CE(rsArreglo("Pla_cNCND")) = "1" Or CE(rsArreglo("Pla_cRetencion")) = "1" Or CE(rsArreglo("Pla_cPercepcion")) = "1" Then
            
                lArrDetalle(iFila, nColPla_cNCND) = "1"
                lArrDetalle(iFila, nColAsd_cTipoDocRef) = .tdbtTDRef.Text
                lArrDetalle(iFila, nColAsd_cSerieDocRef) = .tdbtSerDocRef.Text
                lArrDetalle(iFila, nColAsd_cNumDocRef) = .tdbtNroDocRef.Text
                lArrDetalle(iFila, nColAsd_dFecDocRef) = .dtpFecDocRef.Value
            End If
            
            If CE(rsArreglo("Pla_cDetraccion")) = "1" Then
                lArrDetalle(iFila, nColAsd_cNumSpot) = .tdbtNroConsta.Text
                lArrDetalle(iFila, nColAsd_dFechaSpot) = .dtpFecDeposito.Value
            End If

            If CE(rsArreglo("Pla_cDocumento")) = "1" Then
                lArrDetalle(iFila, nColAsd_cComprobante) = .tdbtComprobante.Text
            End If
            
            If CE(rsArreglo("Pla_cProvision")) <> "1" Then
                lArrDetalle(iFila, nColAsd_cBaseImp) = .tdbcBaseImponible.BoundText
            Else
            
                If .tdbcPagoIGV.BoundText = "N" Then
                    lArrDetalle(iFila, nCol_cFlgDetRet) = ""
                Else
                    lArrDetalle(iFila, nCol_cFlgDetRet) = .tdbcPagoIGV.BoundText
                End If
                
                If CE(rsArreglo("Pla_cDetraccion")) = "1" Then
                    lArrDetalle(iFila, nColPla_cDetraccion) = "1"
                Else
                    lArrDetalle(iFila, nColPla_cDetraccion) = "0"
                End If
                
                If CE(rsArreglo("Pla_cRetencion")) = "1" Then
                    lArrDetalle(iFila, nColPla_cRetencion) = "1"
                Else
                    lArrDetalle(iFila, nColPla_cRetencion) = "0"
                End If
                
                If CE(rsArreglo("Pla_cPercepcion")) = "1" Then
                    lArrDetalle(iFila, nColPla_cPercepcion) = "1"
                Else
                    lArrDetalle(iFila, nColPla_cPercepcion) = "0"
                End If
            End If
            
            '--------------------------------------------------------------'
            DoEvents
            rsArreglo.MoveNext
            iFila = iFila + 1
            
        Loop
    End With
    Call CerrarRecordSet(rsArreglo)
    
    RefreshGrilla
    DoEvents
    
    tdbgDetalle.ReBind
    

        If tdbcMoneda.BoundText <> gsMonedaNac Then
            Call SumarTotales
            DoEvents
            Call cmdGenerarDifCambio_Click
        End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       pVerificaIngCuenta
' Description:       Procedimiento que verifica el ingreso de la cuenta
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub pVerificaIngCuenta()

    If tdbgDetalle.Columns(nColPla_cCuentaContable).Value = "" And lItem <> 0 Then
       Mensajes "Ingrese cuenta en el registro actual", vbInformation
       pSetFocus tdbgDetalle
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbnPorcIGV_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el campo del IGV
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbnPorcIGV_KeyPress(KeyAscii As Integer)

    If KeyAscii = 13 Then
       On Error Resume Next
       tdbgDetalle.Col = nColPla_cCuentaContable
       tdbgDetalle.Bookmark = 0
       pSetFocus tdbgDetalle
       RefreshGrilla
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbnPorcIGV_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque el cotrol del IGV
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbnPorcIGV_LostFocus()
    gsKeyCodePress = False
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtAnio_LostFocus
' Description:       Evento que se ejecuta al perder el enfoqueel campo del año
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtAnio_LostFocus()
    gsAnio = tdbtAnio
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       TabMantenimiento
' Description:       Procedimiento que activa los tabs del formulario principal
'
' Parameters :       Valor (Boolean)
'--------------------------------------------------------------------------------
Private Sub TabMantenimiento(Valor As Boolean)
    sstAsientos.TabEnabled(1) = Valor
    sstAsientos.TabEnabled(0) = Not Valor
    
    If Valor = True Then sstAsientos.Tab = 1
    If Valor = False Then sstAsientos.Tab = 0
    
    tbrOpciones.Buttons(1).Enabled = Not Valor  ' *** Nuevo
    tbrOpciones.Buttons(2).Enabled = Not Valor  ' *** Buscar
    tbrOpciones.Buttons(3).Enabled = Valor      ' *** Grabar
    tbrOpciones.Buttons(4).Enabled = Not Valor  ' *** Borrar
    tbrOpciones.Buttons(5).Enabled = Not Valor  ' *** Editar
    tbrOpciones.Buttons(6).Enabled = Not Valor  ' *** Imprimir

    If Valor = True Then
        tbrOpciones.Buttons(7).Image = 8
    Else
        tbrOpciones.Buttons(7).Image = 7
    End If
    lstProvDeleted.Clear
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       EliminarCabecera
' Description:       Procedimiento que elimina la cabecera del voucher
'
' Parameters :       nVoucher (String)
'                    nInterno (String)
'--------------------------------------------------------------------------------
Private Sub EliminarCabecera(nVoucher As String, nInterno As String)
    Dim clsMante As clsMantoTablas
    Set clsMante = New clsMantoTablas
    
    ReDim lArrCab(7) As Variant
    lArrCab(0) = "REVERTIR"
    lArrCab(1) = nInterno
    lArrCab(2) = gsEmpresa
    lArrCab(3) = gsAnio
    lArrCab(4) = gsPeriodo
    lArrCab(5) = tdbcLibro.BoundText
    lArrCab(6) = nVoucher
    lArrCab(7) = gsUsuario
    If clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCn_ActualizaSaldos", lArrCab(), False) = False Then
        Mensajes "El proceso no ha concluido. Verificar...", vbInformation
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
    
    Call CargaArregloCab
    
    lArrCab(0) = "ELIMINAR"
    lArrCab(1) = nInterno
    lArrCab(2) = gsEmpresa
    lArrCab(3) = gsAnio
    lArrCab(4) = gsPeriodo
    lArrCab(5) = tdbcLibro.BoundText
    lArrCab(6) = nVoucher
    
    If clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCn_GrabaAsientoCab", lArrCab(), True) = False Then
        Mensajes "El proceso no se ha realizado. Verificar...", vbInformation
        Screen.MousePointer = vbDefault
        Exit Sub
    End If
End Sub


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Grabar
' Description:       Procedimiento que graba el voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub Grabar()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        tbrOpciones.Buttons(3).Enabled = True
        Exit Sub
    End If
    
    Dim sql As String
    Dim Objfuncion As New ClsFuncionesExecute
    
    'Si la opcion es Insertar valida la existencia del Numero de Voucher
    If lnOpcion = 0 Then
    
        'Validacion para Multiusuario Libro
        sql = "SELECT COUNT(CAV.Ase_nVoucher) AS Cantidad FROM dbo.CNC_ASIENTO_VOUCHER CAV " & _
              "WHERE CAV.Emp_cCodigo = '" & gsEmpresa & "' AND CAV.Pan_cAnio = '" & gsAnio & "' AND CAV.Lib_cTipoLibro = '" & tdbcLibro.BoundText & "' AND CAV.Per_cPeriodo = '" & tdbcMes.BoundText & "' AND CAV.Ase_nVoucher = '" & tdbtNumVoucher & "'"
              
        If (CInt(Objfuncion.fRetornaValor(sql)) = 1) Then
            tdbtNumVoucher.Text = numeroVoucher("VOUCHER", gsAnio, tdbcMes.BoundText, tdbcLibro.BoundText)
        End If
        
    End If
    
    Dim ValorModif As Integer
    Dim iFila As Integer
    Dim cTipoCta As String
    Dim swGrbAsiDsto As Boolean
    
    Dim nModificados As Integer
    Dim nEliminados As Integer
    Dim nModificadoCab As Integer
    
    Call UpdateGrilla
    DoEvents

    Call SumarTotales
    DoEvents
    
    iFila = NumeroFilas
    
    gsUltimoLibro = tdbcLibro.BoundText
    gsUltimaGlosa = tdbtObservaciones
    gsMonedaGuardada = tdbcMoneda.BoundText
    
    Dim clsMante As clsMantoTablas
    Dim i As Integer, sNroMov As String
    Dim sqlver As String, valorDato As String, sMsgProvi As String
    Dim Anulado As Boolean
    Dim Filas As Integer
       
    Screen.MousePointer = vbHourglass
    If iFila < 1 Then
        Mensajes "El voucher no tiene registros contables", vbInformation + vbOKOnly
        Screen.MousePointer = vbNormal
        tbrOpciones.Buttons(3).Enabled = True
        Exit Sub
    End If
    
    Call RefreshGrilla
    
    '-------------------'
    ' en el caso de que la validacion sea True asignar gsKeyCode = -1 para q validarDatos sea True
    gsKeyCode = -1

    Dim fecdoc As Date
    If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Then
        Do While Not tdbgDetalle.EOF
        
                If (tdbgDetalle.Columns(8).Value = "07" Or tdbgDetalle.Columns(8).Value = "08") And EstadoDes <> "2" Then
                    ActivaCamposDocumRef
                    If Trim(tdbgDetalle.Columns(4).Value) <> "" And tdbtTipDocRef.Enabled = False Then Mensajes "La cuenta asociada no tiene habilitada el Doc. de Referencia. Verifique!", vbOKOnly + vbInformation: tbrOpciones.Buttons(3).Enabled = True: Exit Sub
                    If Trim(tdbgDetalle.Columns(4).Value) <> "" And Trim(tdbgDetalle.Columns(25).Value) = "" And Trim(tipoDocRef) = "" Then Mensajes "Llene el Tipo de Documento de Referencia.", vbOKOnly + vbInformation: ActivaCamposDocumRef: tbrOpciones.Buttons(3).Enabled = True: tdbtTipDocRef.Text = tipoDocRef: tdbtSerDocRef.Text = SerieDocRef: tdbtNroDocRef.Text = NumDocRef: dtpFecDocRef.Value = fechDocRef: tdbtTipDocRef.SetFocus: tdbtMonedaAdic.Value = ValEmb: Exit Sub
                    If Trim(tdbgDetalle.Columns(4).Value) <> "" And Trim(tdbgDetalle.Columns(26).Value) = "" And Trim(SerieDocRef) = "" Then Mensajes "Llene la Serie del Documento de Referencia.", vbOKOnly + vbInformation: ActivaCamposDocumRef: tbrOpciones.Buttons(3).Enabled = True: tdbtSerDocRef.SetFocus: tdbtTipDocRef.Text = tipoDocRef: tdbtSerDocRef.Text = SerieDocRef: tdbtNroDocRef.Text = NumDocRef: dtpFecDocRef.Value = fechDocRef: tdbtMonedaAdic.Value = ValEmb: Exit Sub
                    If Trim(tdbgDetalle.Columns(4).Value) <> "" And Trim(tdbgDetalle.Columns(27).Value) = "" And Trim(NumDocRef) = "" Then Mensajes "Llene el Número de Documento de Referencia.", vbOKOnly + vbInformation: ActivaCamposDocumRef: tbrOpciones.Buttons(3).Enabled = True: tdbtNroDocRef.SetFocus: tdbtTipDocRef.Text = tipoDocRef: tdbtSerDocRef.Text = SerieDocRef: tdbtNroDocRef.Text = NumDocRef: dtpFecDocRef.Value = fechDocRef: tdbtMonedaAdic.Value = ValEmb: Exit Sub
                    If Trim(tdbgDetalle.Columns(4).Value) <> "" And Trim(tdbgDetalle.Columns(28).Value) = "" And Trim(fechDocRef) = "__/__/____" Then Mensajes "Llene la Fecha del Documento de Referencia.", vbOKOnly + vbInformation: ActivaCamposDocumRef: tbrOpciones.Buttons(3).Enabled = True: dtpFecDocRef.SetFocus: tdbtTipDocRef.Text = tipoDocRef: tdbtSerDocRef.Text = SerieDocRef: tdbtNroDocRef.Text = NumDocRef: dtpFecDocRef.Text = fechDocRef: tdbtMonedaAdic.Value = ValEmb: Exit Sub
                    If Trim(tdbgDetalle.Columns(4).Value) <> "" And tdbcLibro.BoundText = lsLibroVen And (Trim(tipoDocRef) = "50" Or Trim(tipoDocRef) = "52") And Trim(tdbgDetalle.Columns(50).Value) = 0 Then Mensajes "Llene el Valor Embarcado del Documento de Embarco.", vbOKOnly + vbInformation: ActivaCamposDocumRef: tbrOpciones.Buttons(3).Enabled = True: tdbtMonedaAdic.SetFocus: tdbtTipDocRef.Text = tipoDocRef: tdbtSerDocRef.Text = SerieDocRef: tdbtNroDocRef.Text = NumDocRef: dtpFecDocRef.Text = fechDocRef: tdbtMonedaAdic.Value = ValEmb: Exit Sub
                    fecdoc = Format(tdbgDetalle.Columns(nColAsd_dFecDoc), "DD/MM/YYYY")
                    If (Trim(tdbgDetalle.Columns(28).Value) <> "" And Trim(fechDocRef) = "__/__/____") And (dtpFecDocRef.Value > fecdoc) Then
                        Mensajes "¡La fecha del documento de referencia no puede ser mayor a la fecha del documento origen!", vbExclamation
                        dtpFecDocRef.Value = Null
                        dtpFecDocRef.SetFocus
                        Exit Sub
                    End If
                ElseIf (tdbgDetalle.Columns(8).Value = "07" Or tdbgDetalle.Columns(8).Value = "08") And EstadoDes = "2" Then
                    tdbgDetalle.Columns(25).Value = ""
                    tdbgDetalle.Columns(26).Value = ""
                    tdbgDetalle.Columns(27).Value = ""
                    tdbgDetalle.Columns(28).Value = ""
                End If
                If tdbgDetalle.Columns(30).Value = "" Then
                    tdbgDetalle.Columns(30).Value = ""
                    tdbgDetalle.Columns(31).Value = ""
                End If

                If Trim(tdbgDetalle.Columns(28).Value) <> "" And dtpFecDocRef.Value > dtpFecha.Value And tipoDocRef <> "50" Then
                    Mensajes "¡La fecha del documento de referencia no puede ser mayor a la fecha del documento origen!", vbExclamation
                    dtpFecDocRef.Value = Null
                    tbrOpciones.Buttons(3).Enabled = True
                    dtpFecDocRef.SetFocus
                    Exit Sub
                End If
                
                If tdbcPagoIGV.Enabled And tdbcPagoIGV.BoundText = "D" And EstadoDes <> "2" Then
                    ActivaCamposDocumRef
                    If tdbtNroConsta.Text = "" And Trim(DocDepo) = "" Then Mensajes "Llene el Número de Documento de Deposito.", vbOKOnly + vbInformation: ActivaCamposDocumRef: tbrOpciones.Buttons(3).Enabled = True: tdbtNroConsta.Text = DocDepo: dtpFecDeposito.Text = fechaDepo: tdbtNroConsta.SetFocus: Exit Sub
                    If Trim(fechaDepo) = "" And dtpFecDeposito.Text = "__/__/____" And dtpFecDeposito.Text = "" Then Mensajes "Llene la Fecha del Documento de Deposito.", vbOKOnly + vbInformation: ActivaCamposDocumRef: tbrOpciones.Buttons(3).Enabled = True: tdbtNroConsta.Text = DocDepo: dtpFecDeposito.Text = fechaDepo: dtpFecDeposito.SetFocus: Exit Sub
                End If
                If tdbgDetalle.Columns(nColAsd_cTipoDoc) = "14" And EstadoDes <> "2" Then
                    If tdbgDetalle.Columns(nColAsd_dFecVen).Value = "__/__/____" Or tdbgDetalle.Columns(nColAsd_dFecVen).Value = "" Then Mensajes "Llene la Fecha de Vencimiento.", vbOKOnly + vbInformation: tbrOpciones.Buttons(3).Enabled = True: tdbgDetalle.Col = nColAsd_dFecVen: Exit Sub
                End If
                If tdbgDetalle.Columns(30).Value = "" Then
                    tdbgDetalle.Columns(30).Value = ""
                    tdbgDetalle.Columns(31).Value = ""
                End If
                
                If tdbgDetalle.Columns(nColAsd_dFecDoc) <> "" Then
                    If tdbcLibro.BoundText = lsLibroCom Then
                        If (tdbgDetalle.Columns(42).Value = "024" Or tdbgDetalle.Columns(42).Value = "999" Or tdbgDetalle.Columns(42).Value = "042") And (Year(tdbgDetalle.Columns(nColAsd_dFecDoc)) = Year(dtpFecha.Text) And _
                                    Month(tdbgDetalle.Columns(nColAsd_dFecDoc)) = Month(dtpFecha.Text)) And tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "01" Then
                            EstadoOri = "0"
                         ElseIf tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "02" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "03" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "10" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "15" _
                                Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "16" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "17" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "18" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "19" _
                                Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "21" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "22" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "44" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "45" Or tdbgDetalle.Columns(nColAsd_cTipoDoc).Value = "46" Then
                            EstadoOri = "0"
                         End If
                    End If
            End If
            
'         If tdbcLibro.BoundText = lsLibroCom And EstadoDes <> "9" Then
'            If tdbgDetalle.Columns(8).Value = "02" Or tdbgDetalle.Columns(8).Value = "03" Or tdbgDetalle.Columns(8).Value = "10" Or tdbgDetalle.Columns(8).Value = "15" Or _
'                    tdbgDetalle.Columns(8).Value = "16" Or tdbgDetalle.Columns(8).Value = "17" Or tdbgDetalle.Columns(8).Value = "18" Or tdbgDetalle.Columns(8).Value = "21" Or _
'                    tdbgDetalle.Columns(8).Value = "22" Or tdbgDetalle.Columns(8).Value = "44" Or tdbgDetalle.Columns(8).Value = "45" Or tdbgDetalle.Columns(8).Value = "46" Then
'                EstadoOri = "0"
'            End If
'
'         End If
            
            
                
        tdbgDetalle.MoveNext
        Loop
        tipoDocRef = ""
        SerieDocRef = ""
        NumDocRef = ""
        fechDocRef = ""
        ValEmb = 0
        tdbgDetalle.MoveFirst
    End If
    i = 0
    
    If VerificaGlosa = False Then
        Mensajes "Llene la Descripción de la Glosa del voucher", vbOKOnly + vbInformation
        pSetFocus tdbtObservaciones
        
        Screen.MousePointer = vbNormal
        tbrOpciones.Buttons(3).Enabled = True
        Exit Sub
    End If
    
    If ValidaFechaVoucher = False Then
        Screen.MousePointer = vbNormal
        tbrOpciones.Buttons(3).Enabled = True
        Exit Sub
    End If
    
    If tdbcLibro.BoundText = lsLibroVen Or tdbcLibro.BoundText = lsLibroCom Then
        If ValidaBasesImponibles = False Then
            UpdateGrilla
            DoEvents
            Mensajes gsMensaje, vbInformation
            Screen.MousePointer = vbNormal
            pSetFocus tdbgDetalle
            tbrOpciones.Buttons(3).Enabled = True
            Exit Sub
        End If
    End If
    
    If validarDatos(iFila) = False Then
        Screen.MousePointer = vbNormal
        pSetFocus tdbgDetalle
        tbrOpciones.Buttons(3).Enabled = True
        Exit Sub
    End If
    
    If ValidaGrupos = False Then
        Screen.MousePointer = vbNormal
        pSetFocus tdbgDetalle
        tbrOpciones.Buttons(3).Enabled = True
        Exit Sub
    End If

    'If ValidaConceptos = False Then
    '    Screen.MousePointer = vbNormal
    '    pSetFocus tdbgDetalle
    '    tbrOpciones.Buttons(3).Enabled = True
    '    Exit Sub
    'End If
    
    '-------------------'

    'PGBV - 03012013
    If EstadoOri <> "1" Or EstadoDes = "9" Or EstadoDes = "8" Or EstadoDes = "2" Then
        If EstadoDes <> "" And SWEdit = True Then
            nModificados = CuentaModificados
            nEliminados = CuentaEliminados
            nModificadoCab = 0
            If gsDatosCabecera <> BuscarDatosCabecera Then
               nModificadoCab = 1
            End If
        Else
            nModificados = 0
            nEliminados = 0
            nModificadoCab = 0
        End If

'    Dim Sql As String
    Dim SqlD As String
    Dim LEIEC As Boolean
    Dim NOTLEIEC As Boolean
    LEIEC = False
    NOTLEIEC = False
    sql = "select * from CNT_lIBROSGENERADOS where Emp_cCodigo = '" & gsEmpresa & "' and Pan_cAnio = '" & gsAnio & "' and Per_cPeriodo = '" & gsPeriodo & "' and Lib_cTipoLibro = '" & tdbcLibro.BoundText & "' and Estado ='A'"
    If (ExisteDato(sql) = True Or EstadoDes = "9") And (Month(dtpFecha.Value) <> Month(lsFecha) And (Year(dtpFecha.Value) <= Year(lsFecha))) Then
'        If tdbcLibro.BoundText = "01" Or tdbcLibro.BoundText = "02" Or tdbcLibro.BoundText = "04" Or tdbcLibro.BoundText = "07" Or tdbcLibro.BoundText = "08" Then
'            sql = "select * from CNT_CIERRE where Emp_cCodigo = '" & gsEmpresa & "' and Pan_cAnio = '" & gsAnio & "' and Per_cPeriodo = '" & gsPeriodo & "' and TipoLibro = '" & tdbcLibro.BoundText & "' and Cic_cEstado ='A'"
'            If ExisteDato(sql) = True Then
                LEIEC = True
'            Else
'                LEIEC = False
'            End If
    Else
        LEIEC = False
    End If
    
        If (nModificados > 0 Or nEliminados > 0 Or nModificadoCab > 0) And LEIEC = True Then
            If EstadoDes = "9" Or EstadoOri = "2" Then
                'If MsgBox("", vbInformation + vbOKCancel, gsNombreModulo) = vbCancel Then
                     Mensajes "Esta corrección modificará los datos ingresados, la misma que será informada a la SUNAT en el período " + UCase(MonthName(Month(lsFecha))) + " del ejercicio " + Str(Year(lsFecha)) + "."
                        If MsgBox("Desea continuar..?", vbQuestion + vbOKCancel, gsNombreModulo) = vbCancel Then
                            Call Cancelar
                            EstadoDes = ""
                            Exit Sub
                        Else
                            If tdbcLibro.BoundText = "06" Then
                                EstadoDes = "9"
                            ElseIf (tdbcLibro.BoundText = "05" Or tdbcLibro.BoundText = "03" Or tdbcLibro.BoundText = "02" Or tdbcLibro.BoundText = "04" Or tdbcLibro.BoundText = "07" Or tdbcLibro.BoundText = "08" Or tdbcLibro.BoundText = "01") And SWEdit = True Then
                                EstadoDes = "9"
                            Else
                                EstadoDes = "8"
                            End If
                        End If
                'End If
            End If
        End If
    Else
        EstadoDes = ""
    End If
    
    If Trim(EstadoOri) = "" Then EstadoOri = "1"
    
    'verifica que la cuenta por pagar o cobrar en el libro de compras o ventas con base en blanco sea provision'
    If tdbcLibro.BoundText = lsLibroCom Or tdbcLibro.BoundText = lsLibroVen Then
        Call VerificaProvCanc
    End If
    '-------------------'
    'si es edicion
    If lnOpcion = 1 Then lNumInterno = tdbgAsientos.Columns(0)
    'si es nuevo
    If lnOpcion = 0 Then
       lNumInterno = numeroVoucher("INTERNO", gsAnio, "", "")
       
       If fValidNroAsiento = False Then
          tbrOpciones.Buttons(3).Enabled = True
          Exit Sub
       End If
    End If
    '----------------------
    Set clsMante = New clsMantoTablas
    
    On Local Error GoTo ErrorEjecucion
    LibroDefault = tdbcLibro.BoundText
    
    ' *** Si es modificar Revertir Saldos de Cuentas
    If lnOpcion = 1 Then
       Call CargaArregloSaldos
       lArrCab(0) = "REVERTIR"
       If clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCn_ActualizaSaldos", lArrCab(), False) = False Then
          Set clsMante = Nothing
          Mensajes "El proceso no ha concluido. Verificar...", vbInformation
          Screen.MousePointer = vbNormal

          tbrOpciones.Buttons(3).Enabled = True
          Exit Sub
       End If

    End If
     
    '------------------------------------------------------------------------------------------------------
    ' *** Grabando Cabecera
    Call CargaArregloCab
    
    lArrCab(0) = IIf(lnOpcion = 1, "EDITAR", "INSERTAR") 'Accion
    
    If clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCn_GrabaAsientoCab", lArrCab(), False) = False Then
       Set clsMante = Nothing
    
       Mensajes "El proceso no ha concluido. Verificar...", vbInformation
       Screen.MousePointer = vbNormal
       
       tbrOpciones.Buttons(3).Enabled = True
       Exit Sub
    End If
    '------------------------------------------------------------------------------------------------------
    lArrCab(0) = "ELIMINAR_DESTINO"
    
    If clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCn_GrabaAsientoCab", lArrCab(), False) = False Then
       Set clsMante = Nothing
    
       Mensajes "El proceso no ha concluido. Verificar...", vbInformation
       Screen.MousePointer = vbNormal
       
       tbrOpciones.Buttons(3).Enabled = True
       Exit Sub
    End If
   
    '------ SI SE ELIMINO UNA FILA DEL DETALLE -------------------
    Filas = 0
    If lnOpcion = 1 Then
        Filas = NumeroFilasEliminadas
    End If
    
    
    If Filas > 0 Then
        For i = 0 To Filas - 1
            If lArrDetalleElim(i, nColAsd_cDestino) <> "1" Then
               
               Call CargaArregloDet(lArrDetalleElim, i)
               lArrDet(0) = "ACTUALIZAR_ELIMIN"
               
               If clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCn_GrabaAsientoDet", lArrDet(), False) = False Then
                  Set clsMante = Nothing
               
                  UpdateGrilla
                  DoEvents
                  Mensajes gsCadenaErr, vbInformation + vbOKOnly
                  Mensajes "El proceso no ha concluido. Verificar...", vbInformation
                  DoEvents
                  RefreshGrilla
                  
                  Screen.MousePointer = vbNormal
                  
                  tbrOpciones.Buttons(3).Enabled = True
                  Exit Sub
               End If
               
            End If
        Next
        
    End If
    
    
    '--------- GRABA LAS LINEAS DEL DETALLE --------------------
    
    iFila = NumeroFilas
    cTipoCta = ""
    
    If iFila > 0 Then
        For i = 0 To iFila - 1
            If lArrDetalle(i, nColAsd_cCtaPagCob) = "CP" Then cTipoCta = "P"
            If lArrDetalle(i, nColAsd_cCtaPagCob) = "CC" Then cTipoCta = "C"
        
            If NE(lArrDetalle(i, nColAsd_cDestino)) = 0 And NE(lArrDetalle(i, nColAsd_cModif)) = 1 Then
               
               Call CargaArregloDet(lArrDetalle, i)
    
               If clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCn_GrabaAsientoDet", lArrDet(), False) = False Then
                  Set clsMante = Nothing
               
                  UpdateGrilla
                  DoEvents
                  Mensajes gsCadenaErr, vbInformation + vbOKOnly
                  Mensajes "El proceso no ha concluido. Verificar...", vbInformation
                  DoEvents
                  RefreshGrilla
                  
                  Screen.MousePointer = vbNormal
                  
                  tbrOpciones.Buttons(3).Enabled = True
                  Exit Sub
               End If
               
            End If
        Next

    End If
    
    'PGBV - 05012013
    EstadoOri = ""
    EstadoDes = ""
    
    '-----------------------------------
    ReDim lArrDet(6) As Variant
    lArrDet(0) = lNumInterno            ' Empresa
    lArrDet(1) = gsEmpresa              ' Empresa
    lArrDet(2) = gsAnio                 ' Año
    lArrDet(3) = tdbcMes.BoundText      ' Mes
    lArrDet(4) = tdbcLibro.BoundText    ' Libro
    lArrDet(5) = tdbtNumVoucher         ' Numero de Voucher

    '----- Permite grabar asientos destino entre los periodos 01 y 12 ------
    If tdbcMes.BoundText >= "00" And tdbcMes.BoundText <= "13" And tdbcLibro.BoundText <> lsLibroCierre Then
       lArrDet(6) = BuscaMaximoCorrel + 1    ' @Asd_nItem
       If clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCn_GrabaAsientoDestino", lArrDet(), False) = False Then
          Set clsMante = Nothing

          Mensajes "El proceso no ha concluido. Verificar...", vbInformation
          Screen.MousePointer = vbNormal

          tbrOpciones.Buttons(3).Enabled = True
          Exit Sub
       End If
    End If
    
    clsMante.CommitTrans
    
    Set rstDestinos = New ADODB.Recordset
    ConectarAdvance
     sSql = "SELECT COUNT(1) FROM CND_ASIENTO_VOUCHER WITH(READUNCOMMITTED) WHERE Emp_cCodigo = '" & gsEmpresa & "' AND Pan_cAnio = '" & gsAnio & _
            "' AND Per_cPeriodo = '" & tdbcMes.BoundText & "' AND Lib_cTipoLibro = '" & tdbcLibro.BoundText & "' AND Ase_nVoucher = '" & _
            tdbtNumVoucher & "' AND Ase_cNummov = '" & lNumInterno & "' AND Asd_cDestino = '1' AND LEFT(Pla_cCuentaContable,1) = '7'"
     rstDestinos.Open sSql, gcnSistemaAdv, adOpenDynamic, adLockOptimistic
     If rstDestinos.State = 1 Then
      If rstDestinos.Fields(0) > 1 Then
       swGrbAsiDsto = clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCn_GrabaAsientoDestino_Round", lArrDet(), False)
      End If
    End If
    Desconectar
    Set rstDestinos = Nothing
    
    ' ------ Actualizar Saldos de las cuentas contables del voucher -----
    Call CargaArregloSaldos
    If clsMante.MantenimientoDeTablas(gsCadenaConexion, "spCn_ActualizaSaldos", lArrCab(), True) = False Then
       Set clsMante = Nothing

       Mensajes "El proceso no ha concluido. Verificar...", vbInformation
       Screen.MousePointer = vbNormal

       tbrOpciones.Buttons(3).Enabled = True
       Exit Sub
    End If
    
    On Error Resume Next
    Set clsMante = Nothing
    
    '-------- actualiza los saldos de la tabla de provisiones -----------'
    Call ProcesarSaldosProvVoucher(tdbtNumVoucher.Text)
    '---------------------------------------------------------------------
    
    sNroMov = lNumInterno

    nModificados = CuentaModificados
    nEliminados = CuentaEliminados
    nModificadoCab = 0

        If gsDatosCabecera <> BuscarDatosCabecera Then
           nModificadoCab = 1
        End If
    
    DoEvents
    '--------------------------------------------------------------------'
    If nModificados > 0 Or nEliminados > 0 Or nModificadoCab > 0 Then
        'Verifica si tiene docs provisionados, para ser mostrado en mensaje
        sqlver = "SELECT Ase_nVoucher From CND_ASIENTO_PROV WHERE Ase_cNummov='" & lNumInterno & "' AND Emp_cCodigo = '" & gsEmpresa & _
                 "' AND Pan_cAnio = '" & gsAnio & "' AND Per_cPeriodo = '" & tdbcMes.BoundText & "' AND Lib_cTipoLibro = '" & tdbcLibro.BoundText & "' AND Ase_nVoucher='" & tdbtNumVoucher & "'"
        valorDato = ExtraeDescripcion(sqlver)
        If valorDato <> "" Then
           sMsgProvi = "Se grabo en este asiento documento de provisión"
        End If
    Else
        UpdateGrilla
        DoEvents
        Mensajes "No se modifico ningún registro ...", vbInformation
        sMsgProvi = ""
    End If
    
    EstadoOri = ""
    EstadoDes = ""
    
    Call Cancelar
    
    tdbcLibroCab.BoundText = gsUltimoLibro
    DoEvents
    
    Call CargaTabla("periodo")
    
    DoEvents
    Call FiltrarRecordSet
    DoEvents
    
    'Ubicandose en el registro actual
    If Not lrsAsientos Is Nothing Then
       If Not (lrsAsientos.EOF And lrsAsientos.BOF) Then
            If lrsAsientos.RecordCount > 1 Then
               lrsAsientos.Find "Ase_cNummov like '" & sNroMov & "%'"
            Else
               lrsAsientos.MoveFirst
            End If
       End If
    End If

    If nModificados > 0 Or nEliminados > 0 Or nModificadoCab > 0 Then
        Mensajes "Los datos se grabaron con exito..." & vbCrLf & sMsgProvi, vbInformation
        SWEdit = False
    End If
    
    tdbcLibroCab.Enabled = True
    dtpDesde.Enabled = True
    dtpHasta.Enabled = True
    
    tbrOpciones.Buttons(3).Enabled = False
    
    gsEliminoFila = False
    
    tdbgAsientos.HighlightRowStyle = "HighlightRow"
    pSetFocus tdbgAsientos
    Screen.MousePointer = vbNormal
    Exit Sub
ErrorEjecucion:
    'Mensajes Str(Err.Number) & Err.Description, vbInformation
End Sub



'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ValidaBasesImponibles
' Description:       Funcion que valida las bases imponibles
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function ValidaBasesImponibles() As Boolean
    Dim i As Integer
    Dim Cont As Integer
    Cont = 0
    
    lItem = NumeroFilas
    If lItem = 0 Then lItem = 1
    
    Dim nCtaPagar42 As Integer
    Dim nCtaPagar43 As Integer
    Dim nCtaPagar44 As Integer
    Dim nCtaPagar45 As Integer
    Dim nCtaPagar46 As Integer
    Dim nCtaPagar47 As Integer
    Dim nCtaPagar48 As Integer
    
    Dim nCtaCobrar12 As Integer
    Dim nCtaCobrar14 As Integer
    Dim nCtaCobrar16 As Integer
    Dim nCtaCobrar13 As Integer
    Dim nCtaCobrar17 As Integer
    
    If tdbcLibro.BoundText = lsLibroVen Then
        For i = 0 To lItem - 1
        
            If (Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2) = "12") And _
               CE(lArrDetalle(i, nColAsd_cBaseImp)) = "" Then
               nCtaCobrar12 = nCtaCobrar12 + 1
            End If
        
            If (Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2) = "13") And _
               CE(lArrDetalle(i, nColAsd_cBaseImp)) = "" Then
               nCtaCobrar13 = nCtaCobrar13 + 1
            End If
        
            If (Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2) = "14") And _
               CE(lArrDetalle(i, nColAsd_cBaseImp)) = "" Then
               nCtaCobrar14 = nCtaCobrar14 + 1
            End If
        
            If (Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2) = "16") And _
               CE(lArrDetalle(i, nColAsd_cBaseImp)) = "" Then
               nCtaCobrar16 = nCtaCobrar16 + 1
            End If
        
            If (Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2) = "17") And _
               CE(lArrDetalle(i, nColAsd_cBaseImp)) = "" Then
               nCtaCobrar17 = nCtaCobrar17 + 1
            End If
        
        Next i
        gsMensaje = "cobrar"
    End If
        
    If tdbcLibro.BoundText = lsLibroCom Then
        For i = 0 To lItem - 1
            If (Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2) = "42") And _
               CE(lArrDetalle(i, nColAsd_cBaseImp)) = "" Then
               nCtaPagar42 = nCtaPagar42 + 1
            End If
        
            If (Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2) = "43") And _
               CE(lArrDetalle(i, nColAsd_cBaseImp)) = "" Then
               nCtaPagar43 = nCtaPagar43 + 1
            End If
        
            If (Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2) = "44") And _
               CE(lArrDetalle(i, nColAsd_cBaseImp)) = "" Then
               nCtaPagar44 = nCtaPagar44 + 1
            End If
            
            If (Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2) = "45") And _
               CE(lArrDetalle(i, nColAsd_cBaseImp)) = "" Then
               nCtaPagar45 = nCtaPagar45 + 1
            End If
            
            If (Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2) = "46") And _
               CE(lArrDetalle(i, nColAsd_cBaseImp)) = "" Then
               nCtaPagar46 = nCtaPagar46 + 1
            End If
        
            If (Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2) = "47") And _
               CE(lArrDetalle(i, nColAsd_cBaseImp)) = "" Then
               nCtaPagar47 = nCtaPagar47 + 1
            End If
        
            If (Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2) = "48") And _
               CE(lArrDetalle(i, nColAsd_cBaseImp)) = "" Then
               nCtaPagar48 = nCtaPagar48 + 1
            End If
        
        Next i
        gsMensaje = "pagar"
    End If
    '---------------------------------
    If tdbcLibro.BoundText = lsLibroVen Then
    
        If nCtaCobrar12 = 0 And nCtaCobrar13 = 0 And nCtaCobrar14 = 0 And nCtaCobrar16 = 0 And nCtaCobrar17 = 0 Then
            gsMensaje = "Se necesita una cuenta por cobrar sin base, Verificar..."
            ValidaBasesImponibles = False
            Exit Function
        End If
        
        If nCtaCobrar12 > 1 Or nCtaCobrar13 > 1 Or nCtaCobrar14 > 1 Or nCtaCobrar16 > 1 Or nCtaCobrar17 > 1 Then
            gsMensaje = "No se puede tener mas de una cuenta por cobrar de la misma clase, Verificar..."
            ValidaBasesImponibles = False
            Exit Function
        End If
        
    End If
    '---------------------------------
    If tdbcLibro.BoundText = lsLibroCom Then
        If nCtaPagar42 > 1 Or nCtaPagar43 > 1 Or nCtaPagar44 > 1 Or nCtaPagar45 > 1 Or _
        nCtaPagar46 > 1 Or nCtaPagar47 > 1 Or nCtaPagar48 > 1 Then
            gsMensaje = "No se puede tener mas de una cuenta por pagar de la misma clase, Verificar..."
            ValidaBasesImponibles = False
            Exit Function
        End If
        
        If nCtaPagar42 = 0 And nCtaPagar43 = 0 And nCtaPagar44 = 0 And nCtaPagar45 = 0 And _
        nCtaPagar46 = 0 And nCtaPagar47 = 0 And nCtaPagar48 = 0 Then
            gsMensaje = "Se necesita una cuenta por pagar sin base, Verificar..."
            ValidaBasesImponibles = False
            Exit Function
        End If
        
    End If
    '---------------------------------
    
    gsMensaje = ""
    ValidaBasesImponibles = True
    
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CuentaEliminados
' Description:       Funcion que retorna elnumero de filas eliminadas
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function CuentaEliminados() As Integer
    On Error Resume Next
    Dim i As Integer
    Dim Contador As Integer
    Contador = 0
    
    For i = 0 To NUM_FILAS_ELIM - 1
        If NE(lArrDetalleElim(i, nColAsd_nItem)) <> 0 Then
            Contador = Contador + 1
        End If
    Next i
    
    CuentaEliminados = Contador
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CuentaModificados
' Description:       Funcion que retorna el numero de filas modificadas
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function CuentaModificados() As Integer
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If

    Dim i As Integer
    Dim Contador As Integer
    Contador = 0
    
    For i = 0 To NUM_FILAS - 1
        If NE(lArrDetalle(i, nColAsd_cModif)) = 1 Then
            Contador = Contador + 1
        End If
    Next i
    
    CuentaModificados = Contador
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ValidaDetMov
' Description:       Funcion que retorna si el detalle del movimiento es valido
'
' Parameters :       iFila (Integer)
'--------------------------------------------------------------------------------
Private Function ValidaDetMov(iFila As Integer) As Boolean
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If

    Dim nfila As Integer
    Dim valorDato As String
    Dim sTipoEnti As String
    Dim nColDocAux As Integer, nImpDocMN As Double, nImpDocME As Double
    Dim nImpDif As Double
    Dim nSaldo As Double, nNacional As Double, nExtranjera As Double
    
    If iFila < 0 Then iFila = 0
    ValidaDetMov = False
    
    '----------------------------------
    For nfila = 0 To iFila - 1

    If NE(lArrDetalle.Value(nfila, nColAsd_cModif)) = 1 Then
  '=====================================================================================================================
           If CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) = "" And CE(lArrDetalle.Value(nfila, nColAsd_nItem)) <> "" Then
              UpdateGrilla
              DoEvents

              Mensajes "Ingrese una cuenta en el item Nª " & CE(lArrDetalle.Value(nfila, nColAsd_nItem)), vbInformation + vbOKOnly

              DoEvents

              On Error Resume Next
              tdbgDetalle.Bookmark = nfila
              tdbgDetalle.Col = nColPla_cCuentaContable

              pSetFocus tdbgDetalle

              Exit Function
           End If
  '=====================================================================================================================
           'Valida que ingrese la moneda en el detalle del mov.
           If CE(lArrDetalle.Value(nfila, nColAsd_cTipoMoneda)) = "" Then
                RefreshGrilla
                DoEvents

              Mensajes "En la cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & ", item " & CE(lArrDetalle.Value(nfila, nColAsd_nItem)) & Salto(1) & "Se debe ingresar la moneda", vbInformation
              
              On Error Resume Next
              tdbgDetalle.Bookmark = nfila
              tdbgDetalle.Col = nColAsd_cTipoMoneda

              pSetFocus tdbgDetalle
              
              Exit Function
           End If
  '=====================================================================================================================
           'Valida que ingrese la glosa en el detalle del mov.
           If CE(lArrDetalle.Value(nfila, nColAsd_cGlosa)) = "" Then
              UpdateGrilla
              DoEvents

              Mensajes "En la cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & ", item " & CE(lArrDetalle.Value(nfila, nColAsd_nItem)) & Salto(1) & "Se debe ingresar la glosa", vbInformation
              
              
              On Error Resume Next
              tdbgDetalle.Bookmark = nfila
              tdbgDetalle.Col = nColPla_cCuentaContable

              pSetFocus tdbgDetalle
              
              Exit Function
           End If
  '=====================================================================================================================
           'Valida el Centro de Costo si fue ingresado
           If lArrDetalle.Value(nfila, nCol_cFlgCCosto) = "1" Then
              If CE(lArrDetalle.Value(nfila, nColCos_cCodigo)) = "" Then
                 UpdateGrilla
                 DoEvents

                 Mensajes "La cuenta " & Trim(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & ", item " & CE(lArrDetalle.Value(nfila, nColAsd_nItem)) & Salto(1) & "No tiene ingresado el Centro de Costo", vbInformation
                 
                 On Error Resume Next
                 tdbgDetalle.Bookmark = nfila
                 tdbgDetalle.Col = nColCos_cCodigo
    
                 pSetFocus tdbgDetalle

                 Exit Function
              End If
           End If
  '=====================================================================================================================
           sTipoEnti = CE(lArrDetalle.Value(nfila, nCol_cTipoEntiCta))
           
           'Obliga ingresar la entidad si la cuenta tiene configurado el tipo de Entidad
           If CE(sTipoEnti) <> "" And CE(lArrDetalle.Value(nfila, nColEnt_cCodEntidad)) = "" Then
              UpdateGrilla
              DoEvents

              Mensajes "En la cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & ", item " & CE(lArrDetalle.Value(nfila, nColAsd_nItem)) & Salto(1) & "Se tiene que ingresar la Entidad", vbInformation
              RefreshGrilla

              On Error Resume Next
              tdbgDetalle.Bookmark = nfila
              tdbgDetalle.Col = nColEnt_cCodEntidad

              pSetFocus tdbgDetalle

              Exit Function
           End If
           
           If CE(sTipoEnti) <> "" Then
              If CE(sTipoEnti) <> CE(lArrDetalle.Value(nfila, nColTen_cTipoEntidad)) Then
                 UpdateGrilla
                 DoEvents

                 Mensajes "En la cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & ", item " & CE(lArrDetalle.Value(nfila, nColAsd_nItem)) & Salto(1) & "Se cambio el Tipo de Entidad, vuelva a ingresar la entidad", vbInformation
                 RefreshGrilla
                 
                 On Error Resume Next
                 tdbgDetalle.Bookmark = nfila
                 tdbgDetalle.Col = nColEnt_cCodEntidad
    
                 pSetFocus tdbgDetalle

                 Exit Function
              End If
           End If
  '=====================================================================================================================
           If CE(lArrDetalle.Value(nfila, nColAsd_cOperaTC)) = "" Then
                 UpdateGrilla
                 DoEvents

                 Mensajes "Codigo de Tipo de Operación para TC no existe, verificar...", vbInformation
                 RefreshGrilla
                 On Error Resume Next
                 tdbgDetalle.Bookmark = nfila
                 tdbgDetalle.Col = nColAsd_cOperaTC
                 pSetFocus tdbgDetalle

                 Exit Function
           End If
  '=====================================================================================================================
           'Obliga ingresar la entidad y documento
           If CE(lArrDetalle.Value(nfila, nCol_cTipoEntiCta)) <> "" And CE(lArrDetalle.Value(nfila, nColEnt_cCodEntidad)) = "" Then
              UpdateGrilla
              DoEvents

              Mensajes "En la cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & ", item " & CE(lArrDetalle.Value(nfila, nColAsd_nItem)) & Salto(1) & "Se debe ingresar la entidad", vbInformation
              RefreshGrilla
              
              On Error Resume Next
              tdbgDetalle.Bookmark = nfila
              tdbgDetalle.Col = nColEnt_cCodEntidad
              pSetFocus tdbgDetalle

              Exit Function
           End If

  '=====================================================================================================================
           'Valida el Documento si fue ingresado
           If lArrDetalle.Value(nfila, nColPla_cDocumento) = "1" Then
              If CE(lArrDetalle.Value(nfila, nColAsd_cTipoDoc)) = "98" Or CE(lArrDetalle.Value(nfila, nColAsd_cTipoDoc)) = "99" Then
                    
                  If CE(lArrDetalle(nfila, nColAsd_cNumDoc)) = "" And CE(lArrDetalle(nfila, nColAsd_cSerieDoc)) = "" Then
                     UpdateGrilla
                     DoEvents

                     Mensajes "La cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & ", item " & CE(lArrDetalle.Value(nfila, nColAsd_nItem)) & Salto(1) & "No tiene ingresado la serie o número de documento", vbInformation

                     On Error Resume Next
                     tdbgDetalle.Col = nColAsd_cNumDoc
                     tdbgDetalle.Bookmark = nfila
                     pSetFocus tdbgDetalle

                     Exit Function
                  End If
                    
              End If
              
              If CE(lArrDetalle.Value(nfila, nColAsd_cTipoDoc)) <> "98" And CE(lArrDetalle.Value(nfila, nColAsd_cTipoDoc)) <> "99" Then
                  If CE(lArrDetalle.Value(nfila, nColAsd_cTipoDoc)) = "" Then
                     UpdateGrilla
                     DoEvents

                     Mensajes "La cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & ", item " & CE(lArrDetalle.Value(nfila, nColAsd_nItem)) & Salto(1) & "No tiene ingresado el tipo de documento", vbInformation

                     On Error Resume Next
                     tdbgDetalle.Bookmark = nfila
                     tdbgDetalle.Col = nColAsd_cTipoDoc
                     pSetFocus tdbgDetalle
                     Exit Function
                  End If


                  If CE(lArrDetalle.Value(nfila, nColAsd_cTipoDoc)) <> "" And CE(lArrDetalle.Value(nfila, nColAsd_cSerieDoc)) = "" Then
                        RefreshGrilla
                        DoEvents

                     Mensajes "La cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & ", item " & CE(lArrDetalle.Value(nfila, nColAsd_nItem)) & Salto(1) & "No tiene ingresado la serie del documento", vbInformation

                     
                     
                     On Error Resume Next
                     tdbgDetalle.Col = nColAsd_cSerieDoc
                     tdbgDetalle.Bookmark = nfila
                     pSetFocus tdbgDetalle

                     Exit Function
                  End If

                  If CE(lArrDetalle.Value(nfila, nColAsd_cTipoDoc)) <> "" And CE(lArrDetalle.Value(nfila, nColAsd_cNumDoc)) = "" Then
                     RefreshGrilla
                     DoEvents

                     Mensajes "La cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & ", item " & CE(lArrDetalle.Value(nfila, nColAsd_nItem)) & Salto(1) & "No tiene ingresado el número Documento", vbInformation
                     
                     On Error Resume Next
                     tdbgDetalle.Col = nColAsd_cNumDoc
                     tdbgDetalle.Bookmark = nfila
                     pSetFocus tdbgDetalle

                     Exit Function
                  End If

              End If
           End If
  '=====================================================================================================================
           If ValidaProvCancel(nfila) = False Then
                Exit Function
           End If
  '=====================================================================================================================
'           'Valida si el documento es Detracción, que oblige ingresar el Nro y Fecha de Deposito
'           If CE(lArrDetalle(nfila, nCol_cFlgDetRet)) = "D" Then
'              If CE(lArrDetalle.Value(nfila, nColAsd_cNumSpot)) = "" Or CE(lArrDetalle.Value(nfila, nColAsd_dFechaSpot)) = "" Then
'                    RefreshGrilla
'                    DoEvents
'
'                 Mensajes "La cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & ", item " & CE(lArrDetalle.Value(nfila, nColAsd_nItem)) & Salto(1) & "Tiene definido DETRACCION, debe ingresar el numero y fecha de deposito", vbInformation
'                 RefreshGrilla
'
'                 On Error Resume Next
'                 tdbgDetalle.Bookmark = nfila
'                 tdbgDetalle.Col = nColPla_cCuentaContable
'                 pSetFocus tdbgDetalle
'
'                 Exit Function
'              End If
'           End If
           '--------------------------------------------------------------------------------------------
           If Left(CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)), 2) = "40" Then
               'Valida si el documento es Retencion, que oblige ingresar el Nro y Fecha de Deposito
               If CE(lArrDetalle(nfila, nCol_cFlgDetRet)) = "R" Then
                  If CE(lArrDetalle(nfila, nColAsd_cTipoDocRef)) = "" Or _
                     CE(lArrDetalle(nfila, nColAsd_cSerieDocRef)) = "" Or _
                     CE(lArrDetalle(nfila, nColAsd_cNumDocRef)) = "" Or _
                     IsDate(lArrDetalle(nfila, nColAsd_dFecDocRef)) = False Then

                     UpdateGrilla
                     DoEvents

                     Mensajes "La cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & ", item " & CE(lArrDetalle.Value(nfila, nColAsd_nItem)) & Salto(1) & "Tiene definido RETENCION, debe ingresar el tipo, serie, numero, fecha del documento de referencia y tipo de transacción", vbInformation
                     RefreshGrilla

                     On Error Resume Next
                     tdbgDetalle.Bookmark = nfila
                     tdbgDetalle.Col = nColPla_cCuentaContable
                     pSetFocus tdbgDetalle

                     Exit Function
                  End If
               End If
               'Valida si el documento es Percepcion, que oblige ingresar el Nro y Fecha de Deposito
               If CE(lArrDetalle(nfila, nCol_cFlgDetRet)) = "P" Then
                  If CE(lArrDetalle(nfila, nColAsd_cTipoDocRef)) = "" Or _
                     CE(lArrDetalle(nfila, nColAsd_cSerieDocRef)) = "" Or _
                     CE(lArrDetalle(nfila, nColAsd_cNumDocRef)) = "" Or _
                     IsDate(lArrDetalle(nfila, nColAsd_dFecDocRef)) = False Then

                     RefreshGrilla
                     DoEvents

                     Mensajes "La cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & ", item " & CE(lArrDetalle.Value(nfila, nColAsd_nItem)) & Salto(1) & "Tiene definido PERCEPCION, debe ingresar el tipo, serie, numero, fecha del documento de referencia y tipo de transacción", vbInformation
                     RefreshGrilla

                     On Error Resume Next
                     tdbgDetalle.Bookmark = nfila
                     tdbgDetalle.Col = nColPla_cCuentaContable

                     pSetFocus tdbgDetalle

                     Exit Function
                  End If
               End If
               
           End If
        
    End If
    Next
    
    ValidaDetMov = True
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ValidaProvCancel
' Description:       Funcion que retorna si el valido el documento de provicion / cancelacion
'
' Parameters :       nfila (Integer)
'--------------------------------------------------------------------------------
Private Function ValidaProvCancel(nfila As Integer) As Boolean

    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If

    If NE(lArrDetalle(nfila, nColAsd_nImporteEditado)) = 0 And _
       CE(lArrDetalle(nfila, nColAsd_cProvCanc)) = "C" Then
        
        ValidaProvCancel = True
        Exit Function
    End If
    
    ValidaProvCancel = False
    
    Dim sTipoEnti As String
    Dim tipoTer As String
    Dim nImpDocMN  As Double
    Dim nImpDocME As Double
    Dim sqlver As String
    Dim arrDatos() As Variant
    Dim clDatos As clsMantoTablas
    Set clDatos = New clsMantoTablas
    Dim rsArreglo  As ADODB.Recordset
    Set rsArreglo = New ADODB.Recordset
    Dim nSaldo  As Double
    Dim TC As Double
    
    Call pUpdateArray
    
    'SI ES PROVISION.
    sTipoEnti = CE(lArrDetalle.Value(nfila, nCol_cTipoEntiCta))
    
    If CE(lArrDetalle.Value(nfila, nColAsd_cProvCanc)) = "P" And CE(lArrDetalle.Value(nfila, nCol_cFlgProv)) = "1" Then
       'If CE(lArrDetalle.Value(nFila, nColAsd_cTipoDoc)) <> "98" And CE(lArrDetalle.Value(nFila, nColAsd_cTipoDoc)) <> "99" Then
          'Valida si los importes fueron modificados
          nImpDocMN = NE(lArrDetalle(nfila, nColAsd_nDebeSoles)) + NE(lArrDetalle(nfila, nColAsd_nHaberSoles))
          nImpDocME = NE(lArrDetalle(nfila, nColAsd_nDebeMonExt)) + NE(lArrDetalle(nfila, nColAsd_nHaberMonExt))
    
          If NE(lArrDetalle(nfila, nColAsd_cDetNac)) <> nImpDocMN Or _
             NE(lArrDetalle(nfila, nColAsd_cDetExt)) <> nImpDocME Then
    
              'Valida que no exista el documento en otro voucher
              Dim Interno  As String
              If CE(lArrDetalle.Value(nfila, nCol_cFlgProv)) = "1" Then
                    tipoTer = CE(lArrDetalle.Value(nfila, nColTen_cTipoEntidad))
                    Interno = NroCorre_Documento_Provisionado(tipoTer, CE(lArrDetalle.Value(nfila, nColEnt_cCodEntidad)), CE(lArrDetalle.Value(nfila, nColAsd_cTipoDoc)), _
                               CE(lArrDetalle.Value(nfila, nColAsd_cSerieDoc)), CE(lArrDetalle.Value(nfila, nColAsd_cNumDoc)), Me.dtpFecha.Value, gsCorrelProv, CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)))

                If Interno <> "" And tdbtNumVoucher.Text <> Left(Interno, 10) Then
                     UpdateGrilla
                     DoEvents

                     Mensajes "En la cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & " se tiene un documento que ya ha sido provisionado" & Salto(1) & "en el voucher " & Interno, vbInformation
                     RefreshGrilla

                     On Error Resume Next
'                     tdbgDetalle.Columns(nColAsd_cNumDoc) = ""
                     tdbgDetalle.Col = nColAsd_cNumDoc
                     tdbgDetalle.Bookmark = nfila

                     pSetFocus tdbgDetalle

                     Set clDatos = Nothing
                     Set rsArreglo = Nothing
                     
                     Exit Function
                End If
              End If
          End If
       'End If
    End If
    '=====================================================================================================================
    
    Dim SaldoMN As Double
    Dim SaldoME As Double
    'SI ES CANCELACION.
    Dim Soles As Double
    Dim Extranjera As Double
    
    Dim DSoles As Double
    Dim HSoles As Double
    
    Dim ValidaMonExt As Boolean
    
    If CE(lArrDetalle.Value(nfila, nColAsd_cProvCanc)) = "C" And CE(lArrDetalle.Value(nfila, nCol_cFlgProv)) = "1" And _
       NE(lArrDetalle.Value(nfila, nColAsd_nCorre)) > 0 Then
          
          pUpdateArray
          
          If lArrDetalle.Value(nfila, nCol_cFlgMonNac) = "0" Then 'Si es Moneda ext
                  
             DSoles = Cortar(NE(lArrDetalle(nfila, nColAsd_nDebeMonExt)) * NE(lArrDetalle(nfila, nColAsd_nTipoCambio)), 2)
             HSoles = Cortar(NE(lArrDetalle(nfila, nColAsd_nHaberMonExt)) * NE(lArrDetalle(nfila, nColAsd_nTipoCambio)), 2)
          Else
          
             DSoles = NE(lArrDetalle(nfila, nColAsd_nDebeSoles))
             HSoles = NE(lArrDetalle(nfila, nColAsd_nHaberSoles))
          
          End If
    
          nImpDocMN = DSoles + HSoles
          nImpDocME = NE(lArrDetalle(nfila, nColAsd_nDebeMonExt)) + NE(lArrDetalle(nfila, nColAsd_nHaberMonExt))
    
          'si se modifico el importe en el detalle al modificar el voucher
          
          If NE(lArrDetalle(nfila, nColAsd_cDetNac)) <> nImpDocMN Or _
             NE(lArrDetalle(nfila, nColAsd_cDetExt)) <> nImpDocME Then

'              sqlver = "SELECT Cnp_nCorre, Ase_cNummov,Ase_nVoucher , " & _
'                       "Cnp_nMonSolProv, Cnp_nMonExtProv, " & _
'                       "Cnp_nMonSolCancel , Cnp_nMonExtCancel ,  " & _
'                       "Cnp_nMonSolProv-Cnp_nMonSolCancel As SaldoMN, " & _
'                       "Cnp_nMonExtProv-Cnp_nMonExtCancel As SaldoME " & _
'                       "From CND_ASIENTO_PROV " & _
'                       "WHERE Cnp_nCorre = " & NE(lArrDetalle.Value(nFila, nColAsd_nCorre))
              
              sqlver = "spCn_ConsultaProvisionesDoc 'BUSCAPROV', '" & gsEmpresa & "', '" & gsAnio & "'," & _
                       "'" & CE(lArrDetalle.Value(nfila, nColEnt_cCodEntidad)) & "'," & _
                       "'" & CE(lArrDetalle.Value(nfila, nColAsd_dFecDoc)) & "'," & _
                       "'" & CE(lArrDetalle.Value(nfila, nColAsd_cTipoDoc)) & "'," & _
                       "'" & CE(lArrDetalle.Value(nfila, nColAsd_cSerieDoc)) & "'," & _
                       "'" & CE(lArrDetalle.Value(nfila, nColAsd_cNumDoc)) & "'," & _
                       "'" & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & "'"
              
              arrDatos = Array(sqlver)
              
              Set rsArreglo = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
              If Not rsArreglo Is Nothing Then
    
                     SaldoMN = NE(rsArreglo.Fields("Cnp_nMonSolProv")) - NE(rsArreglo.Fields("Cnp_nMonSolCancel"))
                     SaldoME = NE(rsArreglo.Fields("Cnp_nMonExtProv")) - NE(rsArreglo.Fields("Cnp_nMonExtCancel"))
                     'I03---------------------------------------------------------------------
                     'si es cancelacion el monto a ingresar no debe ser mayor al saldo + monto grabado de la linea del detalle
                     If lnOpcion = 0 Then 'si es nuevo
                     
                     ValidaMonExt = True
                     
                     If lArrDetalle.Value(nfila, nCol_cFlgMonNac) = "0" Then 'Si es Moneda ext
                        If Val(nImpDocME) > Val(SaldoME) Then
                            ValidaMonExt = False
                        End If
                     End If
                     
                     If Val(nImpDocMN) > Val(SaldoMN) Or ValidaMonExt = False Then
    
                         nSaldo = SaldoMN
                         
                         UpdateGrilla
                         DoEvents
                         Mensajes "En la cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & " se tiene " & Salto(1) & _
                                  "un documento provisionado Nro " & CE(lArrDetalle(nfila, nColAsd_cNumDoc)) & Salto(1) & _
                                  "El importe ingresado no debe ser mayor al saldo del documento" & Salto(2) & _
                                  "Saldo S/. " & Format(CE(nSaldo), "#,###.00" & " ,   Saldo US$ " & Format(CE(SaldoME), "#,###.00")), vbInformation
    
                         ValidaProvCancel = False
                         
                         Call AsignaBookmark(nfila)
                         
                         
                         TC = NE(tdbgDetalle.Columns(nColAsd_nTipoCambio))
                         
                         If lArrDetalle.Value(nfila, nCol_cFlgMonNac) = "1" Then 'Si es Moneda Nacional
                            If NE(tdbgDetalle.Columns(nColAsd_nDebeSoles)) > 0 Then
                                tdbgDetalle.Columns(nColAsd_nDebeSoles) = nSaldo
                                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nDebeSoles) = nSaldo
                            Else
                                tdbgDetalle.Columns(nColAsd_nHaberSoles) = nSaldo
                                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nHaberSoles) = nSaldo
                            End If
                         Else
                         
                            tdbgDetalle.Columns(nColAsd_nDebeSoles) = 0
                            tdbgDetalle.Columns(nColAsd_nHaberSoles) = 0
                            tdbgDetalle.Columns(nColAsd_nDebeMonExt) = 0
                            tdbgDetalle.Columns(nColAsd_nHaberMonExt) = 0
                            
                         End If
                         
                         tdbgDetalle.Col = nColPla_cCuentaContable
                         pSetFocus tdbgDetalle
                         DoEvents
                         SumarTotales
                         
    
                         Set clDatos = Nothing
                         Set rsArreglo = Nothing

                         Exit Function
                      End If
                      End If
                     'F03---------------------------------------------------------------------

                     'I04---------------------------------------------------------------------
                     'si es cancelacion el monto a ingresar no debe ser mayor al saldo + monto grabado de la linea del detalle
                     If lnOpcion = 1 Then 'si es edicion
                         
                     ValidaMonExt = True
                     
                     If lArrDetalle.Value(nfila, nCol_cFlgMonNac) = "0" Then 'Si es Moneda ext
                        If nImpDocME > NE(lArrDetalle(nfila, nColAsd_cDetExt)) + SaldoME Then ValidaMonExt = False
                     End If
                     
                     If nImpDocMN > NE(lArrDetalle(nfila, nColAsd_cDetNac)) + SaldoMN Or ValidaMonExt = False Then
                         
                         nSaldo = NE(lArrDetalle(nfila, nColAsd_cDetNac)) + SaldoMN
    
                         UpdateGrilla
                         DoEvents
                                  
                         Mensajes "En la cuenta " & CE(lArrDetalle.Value(nfila, nColPla_cCuentaContable)) & " se tiene " & Salto(1) & _
                                  "un documento provisionado Nro " & CE(lArrDetalle(nfila, nColAsd_cNumDoc)) & Salto(1) & _
                                  "El importe ingresado no debe ser mayor al saldo del documento" & Salto(2) & _
                                  "Saldo S/. " & Format(CE(nSaldo), "#,###.00" & " ,   Saldo US$ " & Format(CE(SaldoME), "#,###.00")), vbInformation
                                  
                         'RefreshGrilla
                         ValidaProvCancel = False
                         
                         Call AsignaBookmark(nfila)
                         
                         TC = NE(tdbgDetalle.Columns(nColAsd_nTipoCambio))
                         
                         If lArrDetalle.Value(nfila, nCol_cFlgMonNac) = "1" Then 'Si es Moneda Nacional
                            If NE(tdbgDetalle.Columns(nColAsd_nDebeSoles)) > 0 Then
                                tdbgDetalle.Columns(nColAsd_nDebeSoles) = nSaldo
                                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nDebeSoles) = nSaldo
                            Else
                                tdbgDetalle.Columns(nColAsd_nHaberSoles) = nSaldo
                                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_nHaberSoles) = nSaldo
                            End If
                         Else
                         
                            tdbgDetalle.Columns(nColAsd_nDebeSoles) = 0
                            tdbgDetalle.Columns(nColAsd_nHaberSoles) = 0
                            tdbgDetalle.Columns(nColAsd_nDebeMonExt) = 0
                            tdbgDetalle.Columns(nColAsd_nHaberMonExt) = 0
                            
                         End If
                         
                         tdbgDetalle.Col = nColPla_cCuentaContable
                         pSetFocus tdbgDetalle
                         pUpdateArray
                         tdbgDetalle.RefreshRow
                         
                         DoEvents
                         SumarTotales
                         
                         Set clDatos = Nothing
                         Set rsArreglo = Nothing

                         Exit Function
                      End If
                      End If
                      'F04---------------------------------------------------------------------
              End If
         End If
    End If

    ValidaProvCancel = True
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       AsignaBookmark
' Description:       Procedimiento que asigna lafila al bookmark
'
' Parameters :       nfila (Integer)
'--------------------------------------------------------------------------------
Private Sub AsignaBookmark(nfila As Integer)
    On Error Resume Next
    tdbgDetalle.Bookmark = nfila
    DoEvents
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Cortar
' Description:       Funcion que retorna corta el numero segun los digitos que se ingresan como parametros
'
' Parameters :       Valor (Double)
'                    Digitos (Integer)
'--------------------------------------------------------------------------------
Private Function Cortar(Valor As Double, Digitos As Integer) As Double

    Dim cad As String
    Dim Pos As Integer
    cad = CE(Valor)
    Pos = InStr(1, cad, ".")
    cad = Mid(cad, 1, Pos + Digitos)
    
    Cortar = NE(cad)

End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       validarDatos
' Description:       Funcino que valoda los datos del detalle del voucher
'
' Parameters :       iFila (Integer)
'--------------------------------------------------------------------------------
Private Function validarDatos(iFila As Integer) As Boolean
    Dim i As Integer
    
    validarDatos = False
    
    ' *** Validar Cabecera
    If TextoLleno(tdbtNumVoucher, "Numero de Voucher") = False Then Exit Function
    
    
    ' *** Validando Detalle
    
    If lItem = 0 Then
       Mensajes "Ingrese datos al detalle", vbInformation
       Exit Function
    End If
    
    ' *** Convertir los montos a su moneda original
    UpdateGrilla
    DoEvents
    
    Call SumarTotales
    DoEvents
    
    ' *** Verificar que cuadre el debe con el haber
    If (tdbgDetalle.Columns(nColAsd_nDebeSoles).FooterText <> tdbgDetalle.Columns(nColAsd_nHaberSoles).FooterText) Or _
       (tdbgDetalle.Columns(nColAsd_nDebeMonExt).FooterText <> tdbgDetalle.Columns(nColAsd_nHaberMonExt).FooterText) Then
            
        'Validando el cuadre de las columnas por la moneda del voucher
        If NE(tdbgDetalle.Columns(nColAsd_nDebeSoles).FooterText) <> NE(tdbgDetalle.Columns(nColAsd_nHaberSoles).FooterText) Then
            RefreshGrilla
            DoEvents
        
            Mensajes "El debe y el haber en Moneda Nacional no cuadra. Verificar...", vbInformation
            RefreshGrilla
            validarDatos = False
            Exit Function
        End If

        If NE(tdbgDetalle.Columns(nColAsd_nDebeMonExt).FooterText) <> NE(tdbgDetalle.Columns(nColAsd_nHaberMonExt).FooterText) And gsByMoneda = 1 Then
            RefreshGrilla
            DoEvents
        
            Mensajes "El debe y el haber en Moneda Extranjera no cuadra. Verificar...", vbInformation
            validarDatos = False
            Exit Function
        End If
    End If
    
    If gsByMoneda = "1" And (tdbgDetalle.Columns(nColAsd_nDebeMonExt).FooterText = 0 Or tdbgDetalle.Columns(nColAsd_nHaberMonExt).FooterText = 0) Then
            RefreshGrilla
            DoEvents
        
            Mensajes "La contabilidad es BIMONETARIA, ingrese los importes en dolares. Verificar...", vbInformation
            validarDatos = False
            Exit Function
    
    End If
    
    
    If ValidaDetMov(iFila) = False Then
        Exit Function
    End If
    
    ' *** Validando el Detalle del Movimiento Contable
    If tdbgDetalle.Bookmark < lItem Then
        If pSaltoColGridActivo(tdbgDetalle.Col) = False Then
           validarDatos = False
           Exit Function
        End If
    End If
        
    validarDatos = True
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       GenerarDifCambio
' Description:       Procedimiento que genera la fila de tipo de cambio
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub GenerarDifCambio()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    Dim dif As Double
    Dim rsArreglo As ADODB.Recordset
    Dim clDatos As New clsMantoTablas
    Dim arrDatos() As Variant
    Dim sqlCan As String
    Dim iFila As Integer
    
    AgregaFilaDetalle 1, True, "DIFE"
    
    iFila = NUM_FILAS - 1
    
    
    ' *** Genera el item por dif de Cambio.
    lArrDetalle(iFila, nColAsd_nItem) = BuscaMaximoCorrel + 1                                           ' Item
    lArrDetalle(iFila, nColPla_cCuentaContable) = ""                        ' cuenta
    lArrDetalle(iFila, nColPla_cNombreCuenta) = ""                          ' descrip cuenta
    lArrDetalle(iFila, nColAsd_cGlosa) = "DIFERENCIA POR TIPO DE CAMBIO"
    lArrDetalle(iFila, nColAsd_nDebeSoles) = 0                              ' Debe s
    lArrDetalle(iFila, nColAsd_nDebeMonExt) = 0                             ' Debe d
    lArrDetalle(iFila, nColAsd_nHaberSoles) = 0                             ' Haber s
    lArrDetalle(iFila, nColAsd_nHaberMonExt) = 0                            ' Haber d
    lArrDetalle(iFila, nColCos_cCodigo) = ""                                ' *** CENTRO DE COSTO
    lArrDetalle(iFila, nColAsd_nTipoCambio) = 0                             ' *** TIPO DE CAMBIO
    lArrDetalle(iFila, nColAsd_cOperaTC) = "SCV"                               ' *** Tipo de Operacion TC
    
    ' *** Moneda para el item del detalle
    ' Si es MN se debe generar en ME
    If tdbcMoneda.Columns(2) = "1" Then
       sqlCan = "SELECT Mon_cNombreCorto,Mon_cCodigo,Mon_cMNac FROM CNT_TIPO_MONEDA " & _
                "WHERE Emp_cCodigo= '" & gsEmpresa & "' AND Mon_cMExt='1'"
    Else
       sqlCan = "SELECT Mon_cNombreCorto,Mon_cCodigo,Mon_cMNac FROM CNT_TIPO_MONEDA " & _
                "WHERE Emp_cCodigo= '" & gsEmpresa & "' AND Mon_cMNac='1'"
    End If
    arrDatos = Array(sqlCan)
    Set rsArreglo = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
    
    If Not rsArreglo Is Nothing Then
       lArrDetalle(iFila, nColAsd_cNomMoneda) = rsArreglo("Mon_cNombreCorto").Value   ' Nombre de Moneda
       lArrDetalle(iFila, nColAsd_cTipoMoneda) = rsArreglo("Mon_cCodigo").Value       ' Moneda
       lArrDetalle(iFila, nCol_cFlgMonNac) = rsArreglo("Mon_cMNac").Value             ' Flag de Moneda Nacional
    End If
    
    Call CerrarRecordSet(rsArreglo)
    
    ' *** Verifica si es ganancia o perdida
    
    ' Si es MN se debe generar la diferencia en ME
    If tdbcMoneda.Columns(2) = "1" Then
        dif = tdbgDetalle.Columns(nColAsd_nDebeMonExt).FooterText - tdbgDetalle.Columns(nColAsd_nHaberMonExt).FooterText
        If dif > 0 Then
           ' *** Ganancia
           lArrDetalle(iFila, nColAsd_nHaberMonExt) = dif                                       ' Haber S
           lArrDetalle(iFila, nColPla_cCuentaContable) = CuentaCfgAuto("SEL_GAN")               ' Cuenta
        Else
           ' *** Perdida
           lArrDetalle(iFila, nColAsd_nDebeMonExt) = Abs(dif)                                   ' Debe S
           lArrDetalle(iFila, nColPla_cCuentaContable) = CuentaCfgAuto("SEL_PER")               ' Cuenta
        End If
    Else
        dif = tdbgDetalle.Columns(nColAsd_nDebeSoles).FooterText - tdbgDetalle.Columns(nColAsd_nHaberSoles).FooterText
        If dif > 0 Then
           ' *** Ganancia
           lArrDetalle(iFila, nColAsd_nHaberSoles) = dif                                        ' Haber S
           lArrDetalle(iFila, nColPla_cCuentaContable) = CuentaCfgAuto("SEL_GAN")               ' Cuenta
        Else
           ' *** Perdida
           lArrDetalle(iFila, nColAsd_nDebeSoles) = Abs(dif)                                    ' Debe S
           lArrDetalle(iFila, nColPla_cCuentaContable) = CuentaCfgAuto("SEL_PER")               ' Cuenta
        End If
    End If
    
    lArrDetalle(iFila, nColPla_cNombreCuenta) = ExisteCtaNoTitulo(lArrDetalle(iFila, nColPla_cCuentaContable), "N")
    
    'Datos de la Cuenta Contable
    sqlCan = "SELECT Pla_cCentroCosto, Pla_cProvision, Pla_cOperaTC, Pla_cDifCambio, Pla_cRedondeo, Ten_CTipoEntidad, Pla_cDocumento From CNM_PLAN_CTA " & _
             "WHERE Emp_cCodigo = '" & gsEmpresa & "' And Pan_cAnio='" & gsAnio & "' " & _
             "AND Pla_cCuentaContable = '" & lArrDetalle.Value(iFila, nColPla_cCuentaContable) & "' "
    arrDatos = Array(sqlCan)
    Set rsArreglo = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
    If Not rsArreglo Is Nothing Then
       lArrDetalle(iFila, nCol_cFlgCCosto) = CE(rsArreglo("Pla_cCentroCosto"))
       lArrDetalle(iFila, nCol_cFlgProv) = CE(rsArreglo("Pla_cProvision"))
       lArrDetalle(iFila, nColAsd_cOperaTC) = "SCV" 'NuloText(rsArreglo("Pla_cOperaTC"))
       lArrDetalle(iFila, nColTen_cTipoEntidad) = CE(rsArreglo("Ten_CTipoEntidad"))
       lArrDetalle(iFila, nColPla_cDocumento) = CE(rsArreglo("Pla_cDocumento"))
       
       If CE(rsArreglo("Pla_cDifCambio")) = "G" Or CE(rsArreglo("Pla_cDifCambio")) = "P" Or _
          CE(rsArreglo("Pla_cRedondeo")) = "G" Or CE(rsArreglo("Pla_cRedondeo")) = "P" Then
          
          lArrDetalle(iFila, nColAsd_cMonedaCalculo) = "1"
       End If
       
       
        ' *** En el caso de Documentos
        If CE(rsArreglo("Ten_CTipoEntidad")) <> "" Then
            lArrDetalle(iFila, nColTen_cTipoEntidad) = lArrDetalle(iFila - 1, nColTen_cTipoEntidad)     ' *** Tipo de Entidad
            lArrDetalle(iFila, nColEnt_cCodEntidad) = lArrDetalle(iFila - 1, nColEnt_cCodEntidad)       ' *** Entidad
            lArrDetalle(iFila, nColEnt_cPersona) = lArrDetalle(iFila - 1, nColEnt_cPersona)             ' *** Descripcion Entidad
        End If
       
        If CE(rsArreglo("Pla_cDocumento")) <> "0" Then
            lArrDetalle(iFila, nColAsd_cTipoDoc) = lArrDetalle(iFila - 1, nColAsd_cTipoDoc)             ' *** Td
            lArrDetalle(iFila, nColAsd_cSerieDoc) = lArrDetalle(iFila - 1, nColAsd_cSerieDoc)           ' *** Serie
            lArrDetalle(iFila, nColAsd_cNumDoc) = lArrDetalle(iFila - 1, nColAsd_cNumDoc)               ' *** Numero
            
        End If
       
    End If
    Call CerrarRecordSet(rsArreglo)
    
    lArrDetalle(iFila, nColAsd_dFecDoc) = lArrDetalle(iFila - 1, nColAsd_dFecDoc)               ' *** Fecha
    ' *** Llenar los datos
    lArrDetalle(iFila, nColAsd_nMontoInafecto) = 0                                          ' monto inafecto
    lArrDetalle(iFila, nCol_cFlgDetRet) = ""                                             ' retencion
    
    ' ***
    lArrDetalle(iFila, nColAsd_cTipoDocRef) = ""                                            ' *** TdRef
    lArrDetalle(iFila, nColAsd_cSerieDocRef) = ""                                           ' *** SerieRef
    lArrDetalle(iFila, nColAsd_cNumDocRef) = ""                                             ' *** NumeroRef
    'lArrDetalle(iFila, nColAsd_dFecDocRef) = "" ' *** FechaRef
    lArrDetalle(iFila, nColAsd_cNumSpot) = lArrDetalle(iFila - 1, nColAsd_cNumSpot)         ' *** NumSpot
    lArrDetalle(iFila, nColAsd_dFechaSpot) = lArrDetalle(iFila - 1, nColAsd_dFechaSpot)     ' *** FechaSpot
    lArrDetalle(iFila, nColAsd_cDestino) = "0"                                              ' *** AsientoDestino
    lArrDetalle(iFila, nColAsd_nCorre) = ""                                                 ' *** CorrelProv
    lArrDetalle(iFila, nCol_nPorceImp) = 0
    lArrDetalle(iFila, nColTra_cCodigo) = ""                                                ' *** Tra_cCodigo
    lArrDetalle(iFila, nColAsd_cFormaPago) = ""                                             ' *** Forma de Pago
    lArrDetalle(iFila, nColAsd_Cancelado) = ""
    
    
    lArrDetalle(iFila, nColAsd_nSaldoProv) = 0
    lArrDetalle(iFila, nColAsd_nSaldoExtProv) = 0
    lArrDetalle(iFila, nColAsd_cProvCanc) = ""
    lArrDetalle(iFila, nColAsd_cModif) = 1
    
    
    iFila = iFila + 1                                                                       ' Actualiza la cantidad de items
    
    UpdateGrilla
    DoEvents
    Set clDatos = Nothing
    
    Mensajes "Se genero cuentas de diferencia de Cambio. Verifique Datos y Grabe", vbInformation
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CargaArregloSaldos
' Description:       Procedimiento que llena el array de saldos
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub CargaArregloSaldos()
    ' *** Cargar los datos a grabar en un arreglo
    ReDim lArrCab(7) As Variant
    
    lArrCab(0) = "ACTUALIZAR"           ' Accion
    lArrCab(1) = lNumInterno            ' Numero Interno
    lArrCab(2) = gsEmpresa              ' Empresa
    lArrCab(3) = gsAnio                 ' Año
    lArrCab(4) = tdbcMes.BoundText      ' Mes
    lArrCab(5) = tdbcLibro.BoundText    ' Libro
    lArrCab(6) = tdbtNumVoucher
    lArrCab(7) = gsUsuario
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CargaArregloCab
' Description:       Procedimiento que llena el arrar de la cabecera
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub CargaArregloCab()
    ' *** Cargar los datos a grabar en un arreglo
    ReDim lArrCab(19) As Variant
    
    lArrCab(0) = IIf(lnOpcion = 1, "EDITAR", "INSERTAR") ' Accion
    lArrCab(1) = lNumInterno                            ' Numero Interno
    lArrCab(2) = gsEmpresa                              ' Empresa
    lArrCab(3) = gsAnio                                 ' Año
    lArrCab(4) = tdbcMes.BoundText                      ' Mes
    lArrCab(5) = tdbcLibro.BoundText                    ' Libro
    lArrCab(6) = tdbtNumVoucher                         ' Num Voucher
    lArrCab(7) = dtpFecha                               ' Fecha
    lArrCab(8) = "" 'tdbcOperaTC.BoundText              ' TC
    lArrCab(9) = tdbcMoneda.BoundText                   ' Moneda
    lArrCab(10) = 0 'tdbnTipoCambio                     ' 0
    lArrCab(11) = tdbtObservaciones                     ' Observaciones
    lArrCab(12) = tdbcTipoOperacion.BoundText           ' Operación de Caja
    lArrCab(13) = gsUsuario                             ' Usuario
    lArrCab(14) = "A"                                   ' @Asd_cEstado
    lArrCab(15) = CheckCuadraCompMan.Value              ' Manual
    lArrCab(16) = gsSOFT ' SOFTWARE
'PGBV - 02012013
    lArrCab(18) = EstadoOri 'Estado inicial, si el registro es nuevo
    lArrCab(19) = EstadoDes 'Estado posterior a una modificación
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       CargaArregloDet
' Description:       Procedimiento que llena el aaray del detalle del voucher
'
' Parameters :       lArreglo (XArrayDB)
'                    num (Integer)
'--------------------------------------------------------------------------------
Private Sub CargaArregloDet(ByRef lArreglo As XArrayDB, num As Integer)
    ReDim lArrDet(55) As Variant
    Dim Modificado As Integer
    gsCadenaErr = ""

    lArrDet(0) = IIf(lnOpcion = 1, "EDITAR", "INSERTAR")                        ' Accion
    
    
    If CE(lArreglo(num, nColAsd_cGuardado)) = "" Then
        lArrDet(0) = "INSERTAR"
    End If
    
    If CE(lArreglo(num, nColAsd_cGuardado)) = "N" Then
        lArrDet(0) = "INSERTAR_PROV"
    End If
    
    lArrDet(1) = lNumInterno                                                     ' Numero Interno
    lArrDet(2) = gsEmpresa                                                       ' Empresa
    lArrDet(3) = gsAnio                                                          ' Año
    lArrDet(4) = tdbcMes.BoundText                                               ' Mes
    lArrDet(5) = tdbcLibro.BoundText                                             ' Libro
    lArrDet(6) = tdbtNumVoucher.Text                                             ' Numero de Voucher
    lArrDet(7) = NE(lArreglo(num, nColAsd_nItem))                                                       ' lArreglo(num, 0)    ' @Asd_nItem
    lArrDet(8) = CE(lArreglo(num, nColPla_cCuentaContable))                      ' @Pla_cCuentaContable
    lArrDet(9) = CE(lArreglo(num, nColAsd_cGlosa))                               ' @Asd_cGlosa
    
    lArrDet(10) = NE(Format(lArreglo(num, nColAsd_nDebeSoles), "0.00"))          ' @Asd_nDebeSoles
    lArrDet(11) = NE(Format(lArreglo(num, nColAsd_nDebeMonExt), "0.00"))         ' @Asd_nDebeMonExt
    
    'If Me.chkConversion.Value = 1 Then lArrDet(11) = 0                          ' @Asd_nDebeMonExt
    lArrDet(12) = NE(Format(lArreglo(num, nColAsd_nHaberSoles), "0.00"))         ' @Asd_nHaberSoles
    lArrDet(13) = NE(Format(lArreglo(num, nColAsd_nHaberMonExt), "0.00"))        ' @Asd_nHaberMonExt
    
    'If Me.chkConversion.Value = 1 Then lArrDet(13) = 0                          ' @Asd_nHaberMonExt
    lArrDet(14) = NE(lArreglo(num, nColAsd_nTipoCambio))                         ' @Asd_nTipoCambio
    lArrDet(15) = CE(lArreglo(num, nColCos_cCodigo))                             ' @Cos_cCodigo
    lArrDet(16) = CE(lArreglo(num, nColTen_cTipoEntidad))                        ' @Ten_cTipoEntidad
    lArrDet(17) = CE(lArreglo(num, nColEnt_cCodEntidad))                         ' @Ent_cCodEntidad
    lArrDet(18) = CE(lArreglo(num, nColAsd_cTipoDoc))                            ' @Asd_cTipoDoc
    lArrDet(19) = CE(lArreglo(num, nColAsd_cSerieDoc))                           ' @Asd_cSerieDoc
    lArrDet(20) = CE(lArreglo(num, nColAsd_cNumDoc))                             ' @Asd_cNumDoc
    
    If lArreglo(num, nColAsd_dFecDoc) = "  /  /    " Then lArreglo(num, nColAsd_dFecDoc) = Null
    If lArreglo(num, nColAsd_dFecDoc) = "" Then lArreglo(num, nColAsd_dFecDoc) = Null
    If lArreglo(num, nColAsd_dFecVen) = "  /  /    " Then lArreglo(num, nColAsd_dFecVen) = Null
    If lArreglo(num, nColAsd_dFecVen) = "" Then lArreglo(num, nColAsd_dFecVen) = Null
    
    lArrDet(21) = lArreglo(num, nColAsd_dFecDoc)                                 ' @Asd_dFecDoc
    
    '---------- DOCUMENTO DE REFERENCIA ----------'
    lArrDet(22) = CE(lArreglo(num, nColAsd_cTipoDocRef))                         ' @Asd_cTipoDocRef
    lArrDet(23) = CE(lArreglo(num, nColAsd_cSerieDocRef))                        ' @Asd_cSerieDocRef
    lArrDet(24) = CE(lArreglo(num, nColAsd_cNumDocRef))                          ' @Asd_cNumDocRef
    
    If lArreglo(num, nColAsd_dFecDocRef) = "  /  /    " Then lArreglo(num, nColAsd_dFecDocRef) = Null
    If lArreglo(num, nColAsd_dFecDocRef) = "" Then lArreglo(num, nColAsd_dFecDocRef) = Null
    
    lArrDet(25) = lArreglo(num, nColAsd_dFecDocRef)                              ' @Asd_dFecDocRef
    
    '-------------------- INAFECTO -----------------------------'
    'lArrDet(26) = NE(lArreglo(num, nColAsd_nMontoInafecto))                     ' @Asd_nMontoInafecto
    If gsBaseImpDefVtas = "" Then lArrDet(26) = 0
    If gsBaseImpDefVtas <> "999" And gsBaseImpDefVtas <> "998" And gsBaseImpDefVtas <> "997" Then   'inafecto y exonerada
      lArrDet(26) = 0
    Else
      lArrDet(26) = 1
    End If
    
    '---------------- INDICADOR SI ES RETENCION ,DETRACCION O PERCEPCION -----------------------'
    lArrDet(27) = CE(lArreglo(num, nCol_cFlgDetRet))
    lArrDet(28) = ""
    
    '---------------- DOCUMENTO DEPOSITO -----------------------'
    If lArreglo(num, nColAsd_dFechaSpot) = "  /  /    " Then lArreglo(num, nColAsd_dFechaSpot) = Null
    If lArreglo(num, nColAsd_dFechaSpot) = "" Then lArreglo(num, nColAsd_dFechaSpot) = Null

    lArrDet(29) = lArreglo(num, nColAsd_dFechaSpot)
    lArrDet(30) = lArreglo(num, nColAsd_cNumSpot)
    '------------------------------------------------------------'
    lArrDet(31) = NE(lArreglo(num, nColAsd_cDestino))                           ' @Asd_cDestino
    
    If lArreglo(num, nColAsd_nCorre) = "" Then lArreglo(num, nColAsd_nCorre) = 0
    
    lArrDet(32) = NE(lArreglo(num, nColAsd_nCorre))                             ' @Asd_nCorre
    
    lArrDet(33) = gsUsuario                                                     ' @Asd_cUserCrea
    lArrDet(34) = "A"                                                           ' @Asd_cEstado
    '-----------------------------------------------------------------------------
    
    Dim FlagGeneraProv As String
    FlagGeneraProv = CE(lArreglo(num, nColAsd_cProvCanc))
    
    If NE(lArreglo(num, nCol_cFlgProv)) = 1 And FlagGeneraProv <> "C" Then
       FlagGeneraProv = "P"
    End If
    
    If CE(lArreglo(num, nColEnt_cCodEntidad)) = "" Or CE(lArreglo(num, nColAsd_cTipoDoc)) = "" Then
       FlagGeneraProv = ""
    End If
    
    
    Dim Total As Double
    Total = NE(lArreglo(num, nColAsd_nDebeSoles)) + NE(lArreglo(num, nColAsd_nDebeMonExt)) + _
            NE(lArreglo(num, nColAsd_nHaberSoles)) + NE(lArreglo(num, nColAsd_nHaberMonExt))
    
    If Total = 0 And FlagGeneraProv = "P" Then
        'FlagGeneraProv = "C"
    End If
    '-----------------------------------------------------------------------------
    lArrDet(35) = FlagGeneraProv                                             ' @Asd_cProvCanc
    lArrDet(36) = lArreglo(num, nColAsd_cOperaTC)                            ' Tipo de Operacion TC
    lArrDet(37) = lArreglo(num, nColAsd_cTipoMoneda)                         ' Tipo de Moneda
    lArrDet(38) = lArreglo(num, nColAsd_cMonedaCalculo)                      ' Conversion a otra moneda en la cuenta
    lArrDet(39) = NE(tdbnPorcIGV.Value)                                      ' Porcentaje de IGV
    lArrDet(40) = ""                                                         ' @Asd_cAfecto
    lArrDet(41) = lArreglo(num, nColAsd_dFecVen)                             ' @Asd_dFecDoc -
    lArrDet(42) = lArreglo(num, nColTra_cCodigo)                             ' Codigo de Tipo de Transaccion
    lArrDet(43) = lArreglo(num, nColAsd_cFormaPago)                          ' Forma de Pago
    lArrDet(44) = lArreglo(num, nColAsd_cBaseImp)                            ' Base Imponible
    lArrDet(45) = CE(lArreglo(num, nColAsd_cMonAdic))                        ' Base Imponible
    
    lArrDet(46) = NE(lArreglo(num, nColAsd_cImpAdic))
    lArrDet(47) = CE(lArreglo(num, nColAsd_cComprobante))
    lArrDet(48) = CE(lArreglo(num, nColAsd_cProceso))
    
    lArrDet(49) = CE(lArreglo(num, nColAsd_cEcpOperacion))
    lArrDet(50) = CE(lArreglo(num, nColAsd_cRegAux))

    lArrDet(51) = ""
    lArrDet(52) = CE(lArreglo(num, nColAsd_cManual))
    lArrDet(53) = ""
    lArrDet(54) = CE(lArreglo(num, nColAsd_cGrupo))
    lArrDet(55) = CE(lArreglo(num, nColAsd_cCodConcepto))
    
    gsCadenaErr = "Elimine y vuelva a ingresar el registro... " & Salto(2) & _
                  "Fila: " & lArrDet(7) & Salto(1) & _
                  "Cuenta: " & lArrDet(8) & Salto(1) & _
                  "CCosto: " & lArrDet(15) & Salto(1) & _
                  "Entidad: " & lArrDet(17) & Salto(1) & _
                  "Tipo: " & lArrDet(18) & Salto(1) & _
                  "Serie: " & lArrDet(19) & Salto(1) & _
                  "Numero: " & lArrDet(20) & Salto(1) & _
                  "Accion: " & lArrDet(0)

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtBusCodEnt_Change
' Description:       Evento que se ejecuta al cambiar la busqueda del codigo de entidad
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtBusCodEnt_KeyDown(KeyCode As Integer, Shift As Integer)
Dim sTipoEntidad As String
If KeyCode = vbKeyF1 Then
    sTipoEntidad = ExtraeCampo("Ten_cTipoEntidad", "CNM_PLAN_CTA", "Emp_cCodigo='" & gsEmpresa & "' And Pan_cAnio='" & gsAnio & "' And Pla_cCuentaContable='" & Me.tdbtBusCuenta & "'")
    
    Call LlamaBuscar(frmBuscador, Me.tdbtBusCodEnt.Name, lControl, "EntidadB", Me, gsPeriodo, CE(sTipoEntidad))
End If
End Sub

Private Sub tdbtBusCodEnt_LostFocus()
    If tdbtBusCodEnt.Text <> "" Then
        tdbtBusCodEnt.Text = Right("00000" & CE(tdbtBusCodEnt.Text), 5)
    End If
End Sub

Private Sub tdbtBusCuenta_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyF1 Then
        lControl = "tdbtBusCuenta"
        Call LlamaBuscar(frmBuscador, Me.tdbtBusCuenta.Name, lControl, "CuentasB", Me, gsPeriodo, Me.tdbtBusCuenta.Text)
    End If
    If KeyCode = 13 Then
        pSendKeys "{TAB}"
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtBusNumero_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque el control de busqueda de numero de documento
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtBusNumero_LostFocus()
    If tdbtBusNumero.Text <> "" Then
        tdbtBusNumero.Text = Right("00000000" & CE(tdbtBusNumero.Text), 8)
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtBusSerieDoc_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque el control de busqueda de serie de documento
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtBusSerieDoc_LostFocus()
    If tdbtBusSerieDoc.Text <> "" Then
        tdbtBusSerieDoc.Text = Right("000" & CE(tdbtBusSerieDoc.Text), 3)
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtBusTD_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque el control de busqueda de tipo de documento
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtBusTD_LostFocus()
    If tdbtBusTD.Text <> "" Then
        tdbtBusTD.Text = Right("00" & CE(tdbtBusTD.Text), 2)
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtCambio_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el tipo de cambio
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtCambio_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = 13 Then
        ControlAbs tdbtCambio
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtCambio_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el tipo de cambio
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtCambio_KeyPress(KeyAscii As Integer)
    If gsSalirControl = False Then
        gsSalirControl = True
        tdbtCambio = "0.00"
    End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtComprobante_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el numero de comprobante
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtComprobante_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then
       KeyCode = 0
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtComprobante_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el numero de comprobante
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtComprobante_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Or KeyAscii = vbKeyTab Then
        pSaltoColGrid tdbtComprobante.TabIndex
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtComprobante_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque en el numero de comprobante
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtComprobante_LostFocus()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cComprobante) = tdbtComprobante.Text
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    
    tdbgDetalle.RefreshRow
    DoEvents

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtGlosa_GotFocus
' Description:       Evento que se ejecuta al recibir el enfoque el campo de la glosa
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtGlosa_GotFocus()
    pVerificaIngCuenta
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtGlosa_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo de glosa
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtGlosa_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then
       KeyCode = 0
    End If

    If KeyCode = 13 Then
       lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
       lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cGlosa) = tdbtGlosa.Text
       'UpdateGrilla
       'tdbgDetalle.RefreshRow
       KeyCode = 0
       gsKeyCode = 0
       DoEvents
       
       pSetFocus tdbgDetalle
    End If

    gsKey = KeyCode
    
    If gsKey = 219 Then
       tdbtGlosa = Replace(tdbtGlosa, "'", "")
       tdbtGlosa.SelStart = Len(tdbtGlosa)
    End If
        
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtGlosa_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el campo de glosa
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtGlosa_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Or KeyAscii = vbKeyTab Then pSaltoColGrid tdbtGlosa.TabIndex
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtGlosa_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque el campo de glosa
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtGlosa_LostFocus()

    If tdbtGlosa.Text <> CE(tdbgDetalle.Columns(nColAsd_cGlosa)) Then
       lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    End If
    If lnOpcion <> 1 And lnOpcion <> 0 Then
        tdbgDetalle.Columns(nColAsd_cGlosa).Value = tdbtGlosa.Text
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtMonedaAdic_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el combo de moneda adicional
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtMonedaAdic_KeyDown(KeyCode As Integer, Shift As Integer)
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then
       KeyCode = 0
    End If

    If KeyCode = 13 Then
        With tdbgDetalle
            If CE(.Columns(nColPla_cCuentaContable)) = "" Then
                MsgBox "Primero ingrese una cuenta a la fila seleccionada", vbOKOnly + vbInformation, "Aviso..."
                pSetFocus tdbgDetalle
                Exit Sub
            End If
            
'Se comenta todo lo siguiente, para uso exclusivo como Valor de Embarcado
        
'            If CE(Me.tdbcMonedaAdic.BoundText) = "" Then
'                Me.tdbtMonedaAdic.Value = 0
'                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cMonAdic) = ""
'                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cImpAdic) = 0
'
'                tdbgDetalle.RefreshRow
'                DoEvents
'                'MsgBox "Primero seleccione una moneda adicional de la lista", vbOKOnly + vbInformation, "Aviso..."
'                pSetFocus tdbgDetalle
'                Exit Sub
'            End If
            
            If Left(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable), 2) = "12" Then
                If lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDocRef) = "50" Or lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cTipoDocRef) = "52" Then
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cImpAdic) = tdbtMonedaAdic.Value
                    ValEmb = tdbtMonedaAdic.Value
                Else
                    lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cImpAdic) = 0
                    tdbtMonedaAdic.Value = 0
                    ValEmb = tdbtMonedaAdic.Value
                End If
            Else
                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cImpAdic) = 0
                tdbtMonedaAdic.Value = 0
                ValEmb = tdbtMonedaAdic.Value
            End If
            tdbgDetalle.SetFocus
                tdbgDetalle.RefreshRow
                DoEvents
            
'Se comenta todo lo siguiente, para uso exclusivo como Valor de Embarcado
            
'            Dim Columna As Integer
'            Columna = .Col
'            Dim TC As Double
'            TC = BuscaTCMonedaAdic(Me.tdbcMonedaAdic.BoundText)
'            If TC > 0 Then
'                If tdbcMoneda.BoundText = gsMonedaNac Then
'                    If .Col = nColAsd_nHaberSoles Then
'                        lArrDetalle(.Bookmark, nColAsd_nDebeSoles) = 0
'                        lArrDetalle(.Bookmark, nColAsd_nHaberSoles) = TC * Me.tdbtMonedaAdic.Value
'                    Else
'                        lArrDetalle(.Bookmark, nColAsd_nDebeSoles) = TC * Me.tdbtMonedaAdic.Value
'                        lArrDetalle(.Bookmark, nColAsd_nHaberSoles) = 0
'                        Columna = nColAsd_nDebeSoles
'                    End If
'
'                    .Columns(nColAsd_nDebeSoles) = lArrDetalle(.Bookmark, nColAsd_nDebeSoles)
'                    .Columns(nColAsd_nHaberSoles) = lArrDetalle(.Bookmark, nColAsd_nHaberSoles)
'                Else
'                    If .Col = nColAsd_nHaberMonExt Then
'                        lArrDetalle(.Bookmark, nColAsd_nDebeMonExt) = 0
'                        lArrDetalle(.Bookmark, nColAsd_nHaberMonExt) = TC * Me.tdbtMonedaAdic.Value
'                    Else
'                        lArrDetalle(.Bookmark, nColAsd_nDebeMonExt) = TC * Me.tdbtMonedaAdic.Value
'                        lArrDetalle(.Bookmark, nColAsd_nHaberMonExt) = 0
'                        Columna = nColAsd_nDebeMonExt
'                    End If
'
'                    .Columns(nColAsd_nDebeMonExt) = lArrDetalle(.Bookmark, nColAsd_nDebeMonExt)
'                    .Columns(nColAsd_nHaberMonExt) = lArrDetalle(.Bookmark, nColAsd_nHaberMonExt)
'                End If
'
'                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cMonAdic) = tdbcMonedaAdic.BoundText
'                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cImpAdic) = tdbtMonedaAdic.Value
'
'                tdbgDetalle.RefreshRow
'                DoEvents
'
'                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cMonAdic) = Me.tdbcMonedaAdic.BoundText
'                lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cImpAdic) = Me.tdbtMonedaAdic.Text
'
'                tdbgDetalle.Col = Columna
'
'                RefreshGrilla
'                pSetFocus tdbgDetalle
'                pSendKeys "{Enter}"
'            Else
'                If .Col >= nColAsd_nDebeSoles And .Col <= nColAsd_nHaberMonExt Then
'                    RefreshGrilla
'                    DoEvents
'
'                    Mensajes "No se ingreso tipo de cambio para la fecha " & .Columns(nColAsd_dFecDoc).Text & " con Operación : " & .Columns(nColAsd_cOperaTC).Text & ", Ingrese TC de la fecha...", vbInformation
'                    Me.Enabled = False 'desactivo el formulario de asientos
'                    frmManTipoCambio.Show
'                    DoEvents
'                    frmManTipoCambio.SSTCentroCosto.Tab = 1
'                    frmManTipoCambio.tdbcMonedaAdic.BoundText = tdbcMonedaAdic.BoundText
'                    frmManTipoCambio.tdbcMes(1).BoundText = Right("00" & CStr(Month(.Columns(nColAsd_dFecDoc).Text)), 2)
'                    DoEvents
'                    frmManTipoCambio.ConfigurarControlFecha (1)
'                    DoEvents
'                    frmManTipoCambio.dtpFechaBus(1).Value = .Columns(nColAsd_dFecDoc).Text
'                    frmManTipoCambio.chkFecha(1).Value = vbChecked
'                    DoEvents
'                    frmManTipoCambio.ManNuevo
'                    frmManTipoCambio.dtpFecha.Value = .Columns(nColAsd_dFecDoc).Text
'                    pSetFocus frmManTipoCambio.tdbnCompra
'                    frmManTipoCambio.MonAdic = True
'                    frmManTipoCambio.ColumnaTC = .Col
'                End If
'            End If
        End With
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscaTCMonedaAdic
' Description:       Funcion que retorna el tipo de cambio de la moneda adicional
'
' Parameters :       Moneda (String)
'--------------------------------------------------------------------------------
Private Function BuscaTCMonedaAdic(Moneda As String) As Double
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If

    Dim rsTc As New ADODB.Recordset
    Dim sql As String
    Dim OperaTC As String
    
    BuscaTCMonedaAdic = 0
    OperaTC = lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cOperaTC)
    
    Call Conectar
    sql = "spCn_HallarTC '" & gsEmpresa & "', '" & lArrDetalle(tdbgDetalle.Bookmark, nColAsd_dFecDoc) & "', '" & Me.tdbcMonedaAdic.BoundText & "'"
    Set rsTc = gcnSistema.Execute(sql)
    
    If Not rsTc.EOF And Not rsTc.BOF Then
       Select Case Trim(OperaTC)
              Case "COM"
                   BuscaTCMonedaAdic = NE(rsTc("Tca_nCompra"))
              Case "COP"
                   BuscaTCMonedaAdic = NE(rsTc("Tca_nCompraP"))
              Case "VEN"
                   BuscaTCMonedaAdic = NE(rsTc("Tca_nVenta"))
              Case "VEP"
                   BuscaTCMonedaAdic = NE(rsTc("Tca_nVentaP"))
       End Select
       
    If Moneda <> gsMonedaExt And Moneda <> gsMonedaNac Then
        BuscaTCMonedaAdic = NE(rsTc("Tca_nVentaP"))
    End If
       
    End If
    
    Call CerrarRecordSet(rsTc)
    Call Desconectar
End Function

Private Sub tdbtMonedaAdic_LostFocus()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cNumDocRef) = tdbtNroDocRef.Text
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    ValEmb = tdbtMonedaAdic.Value
    'UpdateGrilla
    tdbgDetalle.RefreshRow
    DoEvents
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtMonedaBus_Change
' Description:       Evento que se ejecuta al cambiar la moneda
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtMonedaBus_Change()
    If gsKey = 219 Then
       tdbtMonedaBus = Replace(tdbtMonedaBus, "'", "")
       tdbtMonedaBus.SelStart = Len(tdbtMonedaBus)
    End If

    Call FiltrarRecordSet
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtMonedaBus_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo de moneda
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtMonedaBus_KeyDown(KeyCode As Integer, Shift As Integer)
    gsKey = KeyCode
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtMonedaBus_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el campo de moneda
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtMonedaBus_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    pSetFocus tdbgAsientos
End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtMonedaBus_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque el campo de moneda
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtMonedaBus_LostFocus()
    pSetFocus tdbgAsientos
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtMonto_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo del monto
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtMonto_KeyDown(KeyCode As Integer, Shift As Integer)

    If KeyCode = 13 Then
        ControlAbs tdbtMonto
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtMonto2_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo del monto
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtMonto2_KeyDown(KeyCode As Integer, Shift As Integer)


    If KeyCode = 13 Then
        ControlAbs tdbtMonto2
    End If
End Sub


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtMonto3_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo del monto
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtMonto3_KeyDown(KeyCode As Integer, Shift As Integer)


    If KeyCode = 13 Then
        ControlAbs tdbtMonto3
    End If
End Sub



'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtMonto4_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo del monto
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtMonto4_KeyDown(KeyCode As Integer, Shift As Integer)


    If KeyCode = 13 Then
        ControlAbs tdbtMonto4
    End If
End Sub


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtNroConsta_GotFocus
' Description:       Evento que se ejecuta al recibir el enfoque el numero de constancia
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtNroConsta_GotFocus()
    pVerificaIngCuenta
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtNroConsta_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo de numero de constancia
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtNroConsta_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then
       KeyCode = 0
    End If

    'pMueveGrid (KeyCode)
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtNroConsta_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el campo de numero de constancia
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtNroConsta_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Or KeyAscii = vbKeyTab Then
        pSaltoColGrid tdbtNroConsta.TabIndex
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtNroConsta_LostFocus
' Description:       Evento que se ejecuta al recibir el enfoque el numero de constancia
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtNroConsta_LostFocus()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cNumSpot) = tdbtNroConsta.Text
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    DocDepo = Trim(tdbtNroConsta.Text)
    tdbgDetalle.RefreshRow
    DoEvents
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtNroDocRef_GotFocus
' Description:       Evento que se ejecuta al recibir el enfoque en el numero de documento de referencia
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtNroDocRef_GotFocus()
    pVerificaIngCuenta
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtNroDocRef_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo de numero de documento de referencia
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtNroDocRef_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then
       KeyCode = 0
    End If

    If KeyCode = 13 And CE(tdbtNroDocRef.Text) <> "" Then
            If Len(CE(tdbtNroDocRef.Text)) > 8 Then
                tdbtNroDocRef.Text = CE(tdbtNroDocRef.Text)
            Else
                tdbtNroDocRef.Text = Right("00000000" & CE(tdbtNroDocRef.Text), 8)
            End If
    End If

    'pMueveGrid (KeyCode)
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtNroDocRef_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el campo de documento de referencia
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtNroDocRef_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Or KeyAscii = vbKeyTab Then pSaltoColGrid tdbtNroDocRef.TabIndex
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtNroDocRef_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque en el campo de documento de referencia
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtNroDocRef_LostFocus()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    If CE(tdbtNroDocRef.Text) <> "" Then
            If Len(CE(tdbtNroDocRef.Text)) > 8 Then
                tdbtNroDocRef.Text = CE(tdbtNroDocRef.Text)
            Else
                tdbtNroDocRef.Text = Right("00000000" & tdbtNroDocRef.Text, 8)
            End If
    End If
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cNumDocRef) = tdbtNroDocRef.Text
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    NumDocRef = tdbtNroDocRef.Text
    'UpdateGrilla
    tdbgDetalle.RefreshRow
    DoEvents
    
End Sub


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtNumVoucher_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo de numero de voucher
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtNumVoucher_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then
       KeyCode = 0
    End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtNumVoucher_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el campo de numero de voucher
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtNumVoucher_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Then
       If fValidNroAsiento() Then
          'pSetFocus tdbcMoneda
          pSetFocus dtpFecha
       Else
          pSetFocus tdbtNumVoucher
       End If
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       fValidNroAsiento
' Description:       Funcion que valida el numero de asiento
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function fValidNroAsiento() As Boolean
    Dim rsArreglo As ADODB.Recordset
    Dim clDatos As clsMantoTablas
    Dim arrDatos() As Variant, sqlSp As String
    Dim NuevoVoucher As String

    fValidNroAsiento = False
    
    If CE(tdbtNumVoucher.Text) = "" Then
       Mensajes "El número de asiento contable es invalido" & Salto(1) & "Se asignará un número de voucher valido", vbInformation
       tdbtNumVoucher.Text = numeroVoucher("VOUCHER", gsAnio, tdbcMes.BoundText, tdbcLibro.BoundText)
       Exit Function
    End If
    
    If Len(CE(tdbtNumVoucher.Text)) <> 10 Then
       Mensajes "El número de asiento contable es invalido" & Salto(1) & "Se asignará un número de voucher valido", vbInformation
       tdbtNumVoucher.Text = numeroVoucher("VOUCHER", gsAnio, tdbcMes.BoundText, tdbcLibro.BoundText)
       Exit Function
    End If
    
    
    If IsNumeric(tdbtNumVoucher.Text) = False Then
       Mensajes "El número de asiento contable es invalido" & Salto(1) & "Se asignará un número de voucher valido", vbInformation
       tdbtNumVoucher.Text = numeroVoucher("VOUCHER", gsAnio, tdbcMes.BoundText, tdbcLibro.BoundText)
       Exit Function
    End If
    
    If Left(tdbtNumVoucher.Text, 2) <> tdbcLibro.BoundText Then
       Mensajes "El número de voucher no corresponde al libro seleccionado" & Salto(1) & "Se asignará un número de voucher valido", vbInformation
       tdbtNumVoucher.Text = numeroVoucher("VOUCHER", gsAnio, tdbcMes.BoundText, tdbcLibro.BoundText)
       Exit Function
    End If
    

    
    If Mid(tdbtNumVoucher.Text, 3, 2) <> gsMesSistema Then
       Mensajes "El número de voucher no corresponde al mes seleccionado" & Salto(1) & "Se asignará un número de voucher valido", vbInformation
       tdbtNumVoucher.Text = numeroVoucher("VOUCHER", gsAnio, tdbcMes.BoundText, tdbcLibro.BoundText)
       Exit Function
    End If


    
    
    Set clDatos = New clsMantoTablas
    sqlSp = "spCn_ConsultaAsientos 'BUSCAVOUCHER', '','" & gsEmpresa & _
            "', '" & gsAnio & "', '" & tdbcMes.BoundText & "', '" & tdbcLibro.BoundText & "', '" & tdbtNumVoucher.Text & "'"
    arrDatos = Array(sqlSp)
    Set rsArreglo = clDatos.ConsultaDatosTabla(gsCadenaConexion, "pSTD_EjecutaQuery", arrDatos())
    If Not rsArreglo Is Nothing Then
        NuevoVoucher = numeroVoucher("VOUCHER", gsAnio, tdbcMes.BoundText, tdbcLibro.BoundText)
        Mensajes "El número de voucher " & tdbtNumVoucher.Text & Salto(1) & "fue cambiado por el " & NuevoVoucher & Salto(1) & "Dado que ya se encuentra registrado", vbInformation
        
        Set rsArreglo = Nothing
        tdbtNumVoucher.Text = NuevoVoucher
        
        Exit Function
    End If
    
    fValidNroAsiento = True
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtNumVoucher_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque en el numero del voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtNumVoucher_LostFocus()
If SSTab1.Tab = 1 Then
    If fValidNroAsiento() Then
           If dtpFecha.Enabled = True Then
                pSetFocus dtpFecha
           Else
                pSetFocus tdbcMoneda
           End If
       Else
                pSetFocus tdbtNumVoucher
       End If
    End If
    
    gsKeyCodePress = False
End Sub
'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtNumVoucherBus_Change
' Description:       Evento que se ejecuta al cambiar el numero del voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtNumVoucherBus_Change()
    Call FiltrarRecordSet
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       FiltrarRecordSet
' Description:       Procedimiento que filtra el RS de los vouchers por mes
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub FiltrarRecordSet()
    ' *** Filtrar segun los textos indicados
    Dim cadena As String
    Dim filtros(3) As String
    Dim i As Integer
    
    If lrsAsientos Is Nothing Then Exit Sub
    
    cadena = ""
    If Trim(Me.tdbtNumVoucherBus.Text) <> "" Then filtros(2) = "Ase_nVoucher like '*" & tdbtNumVoucherBus & "*'"
    If Trim(Me.tdbtMonedaBus.Text) <> "" Then filtros(3) = "Ase_cGlosa like '*" & tdbtMonedaBus & "*'"
    
    For i = 0 To 3
        If filtros(i) <> "" Then
           If cadena = "" Then
              cadena = cadena + filtros(i)
           Else
              cadena = cadena + " and " + filtros(i)
           End If
        End If
    Next
    
    ' *** Filtrando segun campos
    If Trim(cadena) <> "" Then
       lrsAsientos.Filter = cadena
    Else
       lrsAsientos.Filter = 0
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtNumVoucherBus_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el campo de numero de voucher de busqueda
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtNumVoucherBus_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Then
        pSetFocus tdbtMonedaBus
    End If
End Sub


'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtObservaciones_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo de obsercaciones
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtObservaciones_KeyDown(KeyCode As Integer, Shift As Integer)
    gsKey = KeyCode
    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then
       KeyCode = 0
    End If
    
    If gsKey = 219 Then
       tdbtObservaciones = Replace(tdbtObservaciones, "'", "")
       tdbtObservaciones.SelStart = Len(tdbtObservaciones)
    End If
    
    If KeyCode = 13 Then
        If VerificaGlosa = False Then
            Mensajes "Llene la Descripción de la Glosa del voucher", vbOKOnly + vbInformation
            KeyCode = 0
            pSetFocus tdbtObservaciones
            Exit Sub
        End If
    
        If tdbnPorcIGV.Visible = False And tdbcTipoOperacion.Visible = False Then
        
        
            tdbgDetalle.Col = nColPla_cCuentaContable
            tdbgDetalle.Row = 0
'            tdbgDetalle.SetFocus
            pSetFocus tdbgDetalle
            On Error Resume Next
            If lItem >= 1 Then
                tdbgDetalle.Bookmark = lItem - 1
            Else
                tdbgDetalle.Bookmark = 0
            End If
            RefreshGrilla
        End If
    End If
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       VerificaGlosa
' Description:       Funcion que valida si la glosa esta llena
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function VerificaGlosa() As Boolean
    If CE(tdbtObservaciones) = "" Then
        VerificaGlosa = False
    Else
        VerificaGlosa = True
    End If
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtObservaciones_LostFocus
' Description:       Evento que se ejecuta al perder el enfoqueel campode observaciones
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtObservaciones_LostFocus()
        gsKeyCodePress = False
        
'        If VerificaGlosa = False And strSalida = True Then
'            Mensajes "Llene la Descripción de la Glosa del voucher", vbOKOnly + vbInformation
'            pSetFocus tdbtObservaciones
'            Exit Sub
'        End If
        
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ActualizaGlosas
' Description:       Procedimiento que actualiza las glosas del detalle del voucher
'
' Parameters :       Filas (Integer)
'--------------------------------------------------------------------------------
Private Sub ActualizaGlosas(Filas As Integer)

    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    Dim i As Integer
    'Dim Filas As Integer
    'Filas = NumeroFilas
    For i = 0 To Filas - 1
        If CE(lArrDetalle(i, nColAsd_nItem)) <> "" And CE(lArrDetalle(i, nColPla_cCuentaContable)) <> "" Then
            lArrDetalle(i, nColAsd_cGlosa) = gsUltimaGlosa
            lArrDetalle(i, nColAsd_cModif) = 1
        End If
    Next i
    
    tdbtGlosa.Text = gsUltimaGlosa
    tdbgDetalle.RefreshRow
    DoEvents
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtSerDocRef_GotFocus
' Description:       Evento que se ejecuta al recibir el enfoqueel campo de la serie de documento de referencia
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtSerDocRef_GotFocus()
    pVerificaIngCuenta
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtSerDocRef_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo de serie de docuemtno de referencia
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtSerDocRef_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then
       KeyCode = 0
    End If
    
    If KeyCode = 13 And CE(tdbtSerDocRef.Text) <> "" Then
        If Len(CE(tdbtSerDocRef)) > 3 Then
            tdbtSerDocRef.Text = CE(tdbtSerDocRef.Text)
        Else
            tdbtSerDocRef.Text = Right("0000" & CE(tdbtSerDocRef.Text), 4)
        End If
    End If
    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtSerDocRef_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el campo de serie de documento de referencia
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtSerDocRef_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Or KeyAscii = vbKeyTab Then pSaltoColGrid tdbtSerDocRef.TabIndex
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtSerDocRef_LostFocus
' Description:       Evento que se ejecuta al salir del enfoque en el campo de serie de documento de referencia
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtSerDocRef_LostFocus()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    If CE(tdbtSerDocRef.Text) <> "" Then
        If Len(CE(tdbtSerDocRef.Text)) > 3 Then
            tdbtSerDocRef.Text = CE(tdbtSerDocRef.Text)
        Else
            tdbtSerDocRef.Text = Right("0000" & tdbtSerDocRef.Text, 4)
        End If
    End If
    
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cSerieDocRef) = tdbtSerDocRef.Text
    SerieDocRef = tdbtSerDocRef.Text
    tdbgDetalle.RefreshRow
    DoEvents
    
    
End Sub

Private Sub tdbtTipDocRef_Change()
If tdbtTipDocRef.Text <> "" Then tipoDocRef = tdbtTipDocRef.Text
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtTipDocRef_GotFocus
' Description:       Evento que se ejecuta al recibir el enfoque en el tipo de documento de referencia
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtTipDocRef_GotFocus()
    pVerificaIngCuenta
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtTipDocRef_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo de tipo de documento de referencia
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtTipDocRef_KeyDown(KeyCode As Integer, Shift As Integer)

    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then
       KeyCode = 0
    End If

    If KeyCode = vbKeyF1 Then
       Call LlamaBuscar(frmBuscador, "TipoDocumentoRef", lControl, "TipoDocumento", Me, tdbcMes.BoundText, "")
    Else
       'pMueveGrid (KeyCode)
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtTipDocRef_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el campo de de tipo de documento de referencia
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub tdbtTipDocRef_KeyPress(KeyAscii As Integer)
    If KeyAscii = 13 Or KeyAscii = vbKeyTab Then
        pSaltoColGrid tdbtTipDocRef.TabIndex
    End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       tdbtTipDocRef_LostFocus
' Description:       Evento que se ejecuta al perder el enfoque el tipo de documento de referencia
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub tdbtTipDocRef_LostFocus()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    Dim sqlver As String, valorDato As String
    
    If Len(CE(tdbtTipDocRef.Text)) > 0 Then
    
        valorDato = BuscaTDArray(tdbtTipDocRef.Text)
        
        If valorDato = "" Then
           Mensajes "Codigo de Documento de Referencia no existe, verificar...", vbInformation
           
           tdbtTipDocRef.Text = ""
           
           pSetFocus tdbtTipDocRef
           Exit Sub
        End If
    End If
    
    If tdbtTipDocRef.Text = "50" Or valorDato = "52" Then
        tdbtMonedaAdic.Enabled = True
    Else
        tdbtMonedaAdic.Enabled = False
        tdbtMonedaAdic.Value = 0
        lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cImpAdic) = 0
    End If
    

    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cModif) = 1
    lArrDetalle.Value(tdbgDetalle.Bookmark, nColAsd_cTipoDocRef) = tdbtTipDocRef.Text
    
    tipoDocRef = tdbtTipDocRef.Text
    tdbgDetalle.RefreshRow
    DoEvents

    
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Text1_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo de libro anterior en el cambio de libro
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub Text1_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then
       KeyCode = 0
    End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Text2_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo de ultimo numero de voucher en el cambio de libro
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub Text2_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then
       KeyCode = 0
    End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Text3_KeyDown
' Description:       Evento que se ejecuta al presionar una tecla en el campo de ultimo voucher libro nuevo en el cambio de libro
'
' Parameters :       KeyCode (Integer)
'                    Shift (Integer)
'--------------------------------------------------------------------------------
Private Sub Text3_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyUp Or KeyCode = vbKeyDown Then
       KeyCode = 0
    End If

End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Text3_KeyPress
' Description:       Evento que se ejecuta al presionar una tecla en el campo de ultimo voucher libro nuevo en el cambio de libro
'
' Parameters :       KeyAscii (Integer)
'--------------------------------------------------------------------------------
Private Sub Text3_KeyPress(KeyAscii As Integer)
If KeyAscii = 13 Then
    pSetFocus Command3
End If
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       TimerKey_Timer
' Description:       Evento que ejecuta el timer cuando esta activo
'
' Parameters :
'--------------------------------------------------------------------------------
Private Sub TimerKey_Timer()
    gsKeyCodePress = True
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       BuscarMaximoGrupo
' Description:       Funcin que retorna el numero maximo del grupo del detalle del voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function BuscarMaximoGrupo() As String
    On Error GoTo serror
    Dim i As Integer
    Dim Maximo As Integer
    Dim Grupo As Integer
    Maximo = 0
    
    For i = 0 To lArrDetalle.Count(1) - 1
        If CE(lArrDetalle(i, nColAsd_cGrupo)) = "" Then
            Grupo = 0
        Else
            Grupo = Val(Mid(lArrDetalle(i, nColAsd_cGrupo), 2, Len(lArrDetalle(i, nColAsd_cGrupo)) - 1))
        End If
        If Grupo > Maximo Then
            Maximo = Grupo
        End If
    Next i
    
    Maximo = Maximo + 1
    
    BuscarMaximoGrupo = "G" & CStr(Maximo)
    Exit Function
serror:
    BuscarMaximoGrupo = "G1"

End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Grupos_Agrupar
' Description:       Procedimiento que asigna un grupo a las filas seleccionadas
'
' Parameters :
'--------------------------------------------------------------------------------
Public Sub Grupos_Agrupar()
    On Error GoTo serror

    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If

    Dim i As Integer
    Dim Grupo As String
    
    Grupo = BuscarMaximoGrupo()
    
    For i = 0 To lArrDetalle.Count(1) - 1
        If tdbgDetalle.IsSelected(i) >= 0 And CE(lArrDetalle(i, nColPla_cCuentaContable)) <> "" Then
            lArrDetalle(i, nColAsd_cGrupo) = Grupo
            lArrDetalle(i, nColAsd_cModif) = 1
        End If
    Next i
    
    tdbgDetalle.Refresh
    Exit Sub
serror:
    Mensajes Err.Description
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Grupos_Desagrupar
' Description:       Procedimiento que desagrupa las filas seleccionadas
'
' Parameters :
'--------------------------------------------------------------------------------
Public Sub Grupos_Desagrupar()
    On Error GoTo serror
    Dim i As Integer
    
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    For i = 0 To lArrDetalle.Count(1) - 1
        If tdbgDetalle.IsSelected(i) >= 0 And CE(lArrDetalle(i, nColPla_cCuentaContable)) <> "" Then
            lArrDetalle(i, nColAsd_cGrupo) = ""
            lArrDetalle(i, nColAsd_cModif) = 1
        End If
    Next i
    
    tdbgDetalle.Refresh
    Exit Sub
serror:
    Mensajes Err.Description
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Grupos_Copiar
' Description:       Procedimiento que copia el codigo del grupo de la fila seleccionada
'
' Parameters :
'--------------------------------------------------------------------------------
Public Sub Grupos_Copiar()
    On Error GoTo serror
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    If tdbgDetalle.IsSelected(tdbgDetalle.Bookmark) >= 0 And CE(lArrDetalle(tdbgDetalle.Bookmark, nColPla_cCuentaContable)) <> "" Then
        gsGrupoMemoria = lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cGrupo)
    End If
    
    Exit Sub
serror:
    Mensajes Err.Description
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Grupos_Pegar
' Description:       Procedimiento que pega el codigo del grupo seleccionado
'
' Parameters :
'--------------------------------------------------------------------------------
Public Sub Grupos_Pegar()
    On Error GoTo serror
    Dim i As Integer
    
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    For i = 0 To lArrDetalle.Count(1) - 1
        If tdbgDetalle.IsSelected(i) >= 0 And CE(lArrDetalle(i, nColPla_cCuentaContable)) <> "" Then
            lArrDetalle(i, nColAsd_cGrupo) = CE(gsGrupoMemoria)
            lArrDetalle(i, nColAsd_cModif) = 1
        End If
    Next i
    
    tdbgDetalle.Refresh
    Exit Sub
serror:
    Mensajes Err.Description
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Grupos_DesagruparTodo
' Description:       Procedimiento que desagrupa todas las filas del detalle del voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Public Sub Grupos_DesagruparTodo()
    On Error GoTo serror
    Dim i As Integer
    
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    For i = 0 To lArrDetalle.Count(1) - 1
            lArrDetalle(i, nColAsd_cGrupo) = ""
            lArrDetalle(i, nColAsd_cModif) = 1
    Next i
    
    tdbgDetalle.Refresh
    Exit Sub
serror:
    Mensajes Err.Description
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Concepto_Asignar
' Description:       Procedimiento que asigna un concepto a un grupo de cuentas
'
' Parameters :
'--------------------------------------------------------------------------------
Public Sub Concepto_Asignar()
    On Error GoTo serror
    Dim i As Integer
    
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    Dim cCodigoConcepto As String
    cCodigoConcepto = BuscarConceptos(Me, tdbcLibro.BoundText)
    
    For i = 0 To lArrDetalle.Count(1) - 1
        If tdbgDetalle.IsSelected(i) >= 0 And CE(lArrDetalle(i, nColPla_cCuentaContable)) <> "" Then
            lArrDetalle(i, nColAsd_cCodConcepto) = cCodigoConcepto
            lArrDetalle(i, nColAsd_cDesConcepto) = gsDetalle
            lArrDetalle(i, nColAsd_cModif) = 1
        End If
                
    Next i
    
    tdbgDetalle.Refresh
    Exit Sub
serror:
    Mensajes Err.Description
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Concepto_Quitar
' Description:       Procedimiento que quita un concepto a un grupo de cuentas
'
' Parameters :
'--------------------------------------------------------------------------------
Public Sub Concepto_Quitar()
    On Error GoTo serror
    Dim i As Integer
    
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    For i = 0 To lArrDetalle.Count(1) - 1
        If tdbgDetalle.IsSelected(i) >= 0 And CE(lArrDetalle(i, nColPla_cCuentaContable)) <> "" Then
            lArrDetalle(i, nColAsd_cCodConcepto) = ""
            lArrDetalle(i, nColAsd_cDesConcepto) = ""
            lArrDetalle(i, nColAsd_cModif) = 1
        End If
                
    Next i
    
    tdbgDetalle.Refresh
    Exit Sub
serror:
    Mensajes Err.Description
End Sub

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       Concepto_QuitarTodos
' Description:       Procedimiento que quita todos los conceptos a un grupo de cuentas
'
' Parameters :
'--------------------------------------------------------------------------------
Public Sub Concepto_QuitarTodos()
    On Error GoTo serror
    Dim i As Integer
    
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Sub
    End If
    
    For i = 0 To lArrDetalle.Count(1) - 1
            lArrDetalle(i, nColAsd_cCodConcepto) = ""
            lArrDetalle(i, nColAsd_cDesConcepto) = ""
            lArrDetalle(i, nColAsd_cModif) = 1
    Next i
    
    tdbgDetalle.Refresh
    Exit Sub
serror:
    Mensajes Err.Description
End Sub
'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ValidaConceptos
' Description:       Funcion que valida los conceptos asignados para el libro diario simplificado
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function ValidaConceptos() As Boolean
    On Error GoTo serror
    ValidaConceptos = False
    Dim i As Integer
    
    If gsDiarioSimplificado = 0 Then
        ValidaConceptos = True
        Exit Function
    End If
    
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If
    
    For i = 0 To lArrDetalle.Count(1) - 1
        If CE(lArrDetalle(i, nColAsd_cCodConcepto)) = "" And CE(lArrDetalle(i, nColPla_cCuentaContable)) <> "" Then
            Mensajes "En el item " & CE(lArrDetalle(i, nColAsd_nItem)) & " debe asignarse un valor para la columna:" & Salto(1) & "Glosa o descripción de la operación para el Diario Simplificado" & Salto(2) & "Importante:" & Salto(1) & "La columna mencionada debe estar llena para todas la cuentas de este voucher" & Salto(2) & "Procedimiento:" & Salto(1) & "1. Seleccione las filas del voucher y haga clic derecho" & Salto(1) & "2. Seleccione la opcion Diario simplificado" & Salto(1) & "3. Seleccione la opción, asignar concepto de operación" & Salto(1) & "4. En la ventanta emergente seleccione la descripción de la operación" & Salto(1) & "5. Haga doble clic o presione ENTER en la operación seleccionada para enviarlo al voucher"
            ValidaConceptos = False
            Exit Function
        End If
    Next i
    
    ValidaConceptos = True
    Exit Function
serror:
    Mensajes Err.Description
    ValidaConceptos = False

End Function
'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ValidaGrupos
' Description:       Funcion que valida los grupos del detalle voucher
'
' Parameters :
'--------------------------------------------------------------------------------
Private Function ValidaGrupos() As Boolean
    On Error GoTo serror
    ValidaGrupos = False
    
    If tdbgDetalle.Columns(41).Visible = False Then
        ValidaGrupos = True
        Exit Function
    End If
    

    Dim i As Integer
    Dim Cont As Integer
    Dim ContCC_CP As Integer
    Dim ContCta10 As Integer
    
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If
    
    Cont = 0
    ContCC_CP = 0
    ContCta10 = 0
    
    For i = 0 To lArrDetalle.Count(1) - 1
        If CE(lArrDetalle(i, nColAsd_cGrupo)) = "" And NE(lArrDetalle(i, nCol_cFlgProv)) = 1 Then
            Cont = Cont + 1
        End If
        
        If NE(lArrDetalle(i, nCol_cFlgProv)) = 1 Then
            ContCC_CP = ContCC_CP + 1
        End If
        
        If Left(CE(lArrDetalle(i, nColPla_cCuentaContable)), 2) = "10" Then
            ContCta10 = ContCta10 + 1
        End If
    Next i
    
    If ContCC_CP = ContCta10 And ContCta10 > 1 Then
        If Cont > 0 And Cont <> ContCC_CP Then
            If MsgBox("El número de Grupos y El número de Cuentas por Cobrar/Pagar son Diferentes" & Salto(1) & "(Agrupe todo el detalle del voucher)" & Salto(2) & "Desea continuar grabando sin agrupar el detalle del voucher...", vbYesNo + vbQuestion) = vbNo Then
                ValidaGrupos = False
                Exit Function
            End If
        End If
                
        If Cont > 1 Then
            If MsgBox("El voucher tiene mas de una cuenta por Cobrar/Pagar" & Salto(1) & "(Agrupe todo el detalle del voucher)" & Salto(2) & "Desea continuar grabando sin agrupar el detalle del voucher", vbYesNo + vbQuestion) = vbNo Then
                ValidaGrupos = False
                Exit Function
                
            End If
        End If
    End If
    
    ValidaGrupos = True
    Exit Function
serror:
    Mensajes Err.Description
    ValidaGrupos = False
End Function

'--------------------------------------------------------------------------------
' Project    :       Contabilidad
' Procedure  :       ValoresMonedaAdic
' Description:       Funcion que Asigna el valor de de las monedas adicionales al detalle, esta funcion es llamada de desde el formulario de TC
'
' Parameters :
'--------------------------------------------------------------------------------
Public Function ValoresMonedaAdic()
    If lArrDetalle Is Nothing Or IsNull(tdbgDetalle.Bookmark) Then
        Exit Function
    End If

   lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cMonAdic) = Me.tdbcMonedaAdic.BoundText
   lArrDetalle(tdbgDetalle.Bookmark, nColAsd_cImpAdic) = Me.tdbtMonedaAdic.Text
End Function
